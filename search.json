[
  {
    "objectID": "blog_posts/beyond-self-attention.html",
    "href": "blog_posts/beyond-self-attention.html",
    "title": "Beyond Self-Attention: How a Small Language Model Predicts the Next Token",
    "section": "",
    "text": "I trained a small (~10 million parameter) transformer following Andrej Karpathy’s excellent tutorial, Let’s build GPT: from scratch, in code, spelled out. After getting it working, I wanted to understand, as deeply as possible, what it was doing internally and how it produced its results.\nThe original paper, as well every transformer tutorial I found, focuses primarily on multi-head self-attention, the mechanism by which transformers learn multiple relationships between tokens without relying on recurrences or convolution. But none of the papers or tutorials I encountered give a satisfying explanation of what happens after attention: how exactly do the results of the attention computation turn into accurate predictions for the next token?\nI thought I could run a few example prompts through the small but working transformer I’d trained, examine the internal states, and figure this out. What I thought would be a quick investigation turned out to be a 6-month deep dive, but yielded some results I think are worth sharing. Specifically, I have a working theory that explains how the transformer produces its predictions and some empirical evidence that suggests this explanation is at least plausible.\nFor those readers familiar with transformers and eager for the punchline, here it is: Each transformer block (containing a multi-head self-attention layer and feed-forward network) learns weights that associate a given prompt with a class of strings found in the training corpus. The distribution of tokens that follow those strings in the training corpus is, approximately, what the block outputs as its predictions for the next token. Each block may associate the same prompt with a different class of training corpus strings, resulting in a different distribution of next tokens and thus different predictions. The final transformer output is a linear combination of each block’s predictions.\nI implemented imperative code that does what I’m proposing the transformer is doing. It produces outputs very similar to the transformer, which I’ll review in detail in a later section.\nIn this post, I’m going to briefly introduce the model and training data, demo some evidence for my proposed explanation, give a detailed walkthrough of the imperative code implementation of it, and present the supporting evidence I have for my theory. I’ve tried to keep the main narrative succinct, with links to relevant technical details and justifications in the appendices or other notebooks in the repo.",
    "crumbs": [
      "blog_posts",
      "Beyond Self-Attention: How a Small Language Model Predicts the Next Token"
    ]
  },
  {
    "objectID": "blog_posts/beyond-self-attention.html#the-model-and-setup",
    "href": "blog_posts/beyond-self-attention.html#the-model-and-setup",
    "title": "Beyond Self-Attention: How a Small Language Model Predicts the Next Token",
    "section": "The Model and Setup",
    "text": "The Model and Setup\n\nDisclaimer\nI want to start by saying upfront: the code for the model I trained isn’t mine. It came from Andrej Karpathy’s video, Let’s build GPT: from scratch, in code, spelled out (highly recommend).\nI typed in the code by copying what I saw on the screen as I watched the video. For things that weren’t clear onscreen, I referenced the GitHub repo for the video and the nanoGPT repo. After getting it working, I made only minor changes to make it work with the rest of the code in/structure of my repository, resulting in this implementation. In summary: the core language model is Andrej Karpathy’s work, not mine. The analysis and all the supporting code behind it are my original contributions. I’ll acknowledge and cite influential papers, posts, tutorials, and other resources in the relevant places.\n\n\nModel Overview\nThe model is a 6-block, decoder-only transformer:\n\n\nDrawing code for architecture diagram\nclass ArchDiagram(Scene):\n    def construct(self):\n        # Instantiate the model and tokenizer, which we'll use to\n        # embed prompts.\n        device = 'cuda' if torch.cuda.is_available() else 'cpu'\n        ts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\n        m, tokenizer = create_model_and_tokenizer(\n            saved_model_filename=environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt',\n            dataset=ts,\n            device=device,\n        )\n        encoding_helpers = EncodingHelpers(tokenizer, device)\n\n        prompt = 'ROMEO:'\n        tokens = MobjectTable(\n            [[Text(f'{t}', font='Arial') for t in tokenizer.encode(prompt)]],\n            include_outer_lines=True,\n        ).scale(0.25)\n        tokens = VGroup(\n            Text('Input Tokens', font='Arial').scale(0.4).next_to(tokens, UP, buff=0.1),\n            tokens,\n        )\n\n        token_emb = m.token_embedding_table(encoding_helpers.tokenize_string(prompt))\n        token_emb = MobjectTable(\n            [[Text(f'{x:.1f}', font='Arial') for x in token_emb[0, :, row]] for row in range(0, 2)]\n            + [[Text('...', font='Arial').rotate(PI/2) for _ in prompt]]\n            + [\n                [Text(f'{x:.1f}', font='Arial') for x in token_emb[0, :, row]]\n                for row in range(n_embed - 2, n_embed)\n            ],\n            include_outer_lines=True,\n        ).scale(0.25)\n\n        pos_emb = m.position_embedding_table(\n            torch.arange(0, len(prompt), device=device)\n        )\n        pos_emb = MobjectTable(\n            [[Text(f'{x:.1f}', font='Arial') for x in pos_emb[:, row]] for row in range(0, 2)]\n            + [[Text('...', font='Arial').rotate(PI/2) for _ in prompt]]\n            + [\n                [Text(f'{x:.1f}', font='Arial') for x in pos_emb[:, row]]\n                for row in range(n_embed - 2, n_embed)\n            ],\n            include_outer_lines=True,\n        ).scale(0.25)\n\n        embs = VGroup(\n            token_emb,\n            pos_emb,\n        ).arrange(RIGHT, buff=2)\n\n        embs = VGroup(\n            tokens,\n            embs,\n        ).arrange(DOWN, buff=0.5)\n\n        emb_labels = VGroup(\n            Text('Token Embeddings', font='Arial')\n            .scale(0.4)\n            .next_to(token_emb, DOWN, buff=0.1)\n            .align_to(token_emb, LEFT),\n            Text('Position Embeddings', font='Arial')\n            .scale(0.4)\n            .next_to(pos_emb, DOWN, buff=0.1)\n            .align_to(pos_emb, RIGHT),\n        )\n\n        blocks1_2 = [Rectangle(height=0.4, width=3) for _ in range(2)]\n        vert_ellipsis = VGroup(\n            *[Circle(radius=0.025, color=WHITE) for _ in range(3)],\n        ).arrange(direction=DOWN, buff=0.1)\n        block6 = Rectangle(height=0.4, width=3)\n        blocks = VGroup(\n            *blocks1_2,\n            vert_ellipsis,\n            block6,\n        ).arrange(DOWN, buff=0.1)\n\n        empty_rect = Rectangle(height=0.25, width=3, color=BLACK)\n\n        out_blocks = [Rectangle(height=0.4, width=3) for _ in range(3)]\n\n        arch = VGroup(\n            embs,\n            emb_labels,\n            blocks,\n            empty_rect,\n            *out_blocks,\n            empty_rect.copy()\n        ).arrange(DOWN, buff=0.1)\n        self.add(arch)\n\n        # Add annotations\n\n        # Lines and arrows between tokens and embedding tables\n        left_line = Line(start=tokens[1].get_left(), end=(tokens[1].get_left() * [0., 1., 0.]) + (token_emb.get_center() * [1., 0., 0.]))\n        self.add(left_line)\n        left_arrow_down = Arrow(max_tip_length_to_length_ratio=0.15)\n        left_arrow_down.put_start_and_end_on(\n            start=left_line.get_left(),\n            end=left_line.get_left() * [1., 0., 0.] + token_emb.get_top() * [0., 1., 0.],\n        )\n        self.add(left_arrow_down)\n\n        right_line = Line(start=tokens[1].get_right(), end=(tokens[1].get_right() * [0., 1., 0.]) + (pos_emb.get_center() * [1., 0., 0.]))\n        self.add(right_line)\n        right_arrow_down = Arrow(max_tip_length_to_length_ratio=0.15)\n        right_arrow_down.put_start_and_end_on(\n            start=right_line.get_right(),\n            end=right_line.get_right() * [1., 0., 0.] + pos_emb.get_top() * [0., 1., 0.],\n        )\n        self.add(right_arrow_down)\n\n        # Circle with the plus between the embedding tables\n        circle = (\n            Circle(radius=0.4, color=WHITE)\n            .move_to((token_emb.get_right() + pos_emb.get_left()) / 2)\n        )\n        self.add(circle)\n        plus = Text('+', font='Arial').move_to(circle.get_center())\n        self.add(plus)\n\n        # Arrows from embedding tables to circled plus\n        right_arrow = Arrow(max_tip_length_to_length_ratio=0.15)\n        right_arrow.put_start_and_end_on(\n            start=token_emb.get_right(),\n            end=circle.get_left()\n        )\n        self.add(right_arrow)\n\n        left_arrow = Arrow(max_tip_length_to_length_ratio=0.15)\n        left_arrow.put_start_and_end_on(\n            start=pos_emb.get_left(),\n            end=circle.get_right()\n        )\n        self.add(left_arrow)\n\n        # Arrow down to the first block\n        down_arrow = Arrow(max_tip_length_to_length_ratio=0.15)\n        down_arrow.put_start_and_end_on(\n            start=circle.get_bottom(),\n            end=blocks1_2[0].get_top(),\n        )\n        self.add(down_arrow)\n\n        # Block labels\n        blocks1_2_labels = [Text(f'Block {b+1}', font='Arial').move_to(blocks1_2[b].get_center()).scale(0.4) for b in range(2)]\n        self.add(*blocks1_2_labels)\n        block6_label = Text('Block 6', font='Arial').move_to(block6.get_center()).scale(0.4)\n        self.add(block6_label)\n\n        # Output blocks labels\n        labels = ['Layer Norm', 'Linear', 'Softmax']\n        out_block_labels = [Text(f'{l}', font='Arial').move_to(out_blocks[b].get_center()).scale(0.4) for b, l in enumerate(labels)]\n        self.add(*out_block_labels)\n\n        # Arrow between last block and output blocks\n        out_block_arrow = Arrow(max_tip_length_to_length_ratio=0.08)\n        out_block_arrow.put_start_and_end_on(\n            start=block6.get_bottom(),\n            end=out_blocks[0].get_top(),\n        )\n        self.add(out_block_arrow)\n\n        # Text at the bottom\n        out_prob_text = Text('Output Probabilities', font='Arial').scale(0.4).next_to(out_blocks[-1], DOWN, buff=0.5)\n        self.add(out_prob_text)\n\n        # Arrow between softmax and output probs\n        out_prob_arrow = Arrow(max_tip_length_to_length_ratio=0.08)\n        out_prob_arrow.put_start_and_end_on(\n            start=out_blocks[-1].get_bottom(),\n            end=out_prob_text.get_top(),\n        )\n        self.add(out_prob_arrow)\n\n\n\n\n\n\n\n\n\n\n\nIt’s trained on the TinyShakespeare data set which contains 40,000 lines of Shakespeare’s plays. After about an hour of training on an RTX 4000 GPU, it is able to produce reasonable-looking faux Shakespeare.\nGiven a prompt, the model predicts tokens that it thinks should follow. Let’s look at an example: starting with the prompt, ROMEO:, and sampling 500 tokens from the model’s predictions, we get:\n\n\nCode to spin up model and generate example output from prompt, ‘ROMEO:’\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\nm, tokenizer = create_model_and_tokenizer(\n    saved_model_filename=environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt',\n    dataset=ts,\n    device=device,\n)\nencoding_helpers = EncodingHelpers(tokenizer, device)\naccessors = TransformerAccessors(m, device)\n\ntorch.manual_seed(2321) # Keep the output deterministic across runs\nprompt = 'ROMEO:'\ntokens = encoding_helpers.tokenize_string(prompt)\nprint(tokenizer.decode(m.generate(tokens, max_new_tokens=500)[0].tolist()))\n\n\nROMEO:\nIf thou wilt triumphant be virtue, and since from any\nbold virtue that is made a bawd of earth, then the\nduke desires of patience and perish:\ntake up the other husband, dislike his tent\nback.\n\nFirst Citizen:\nOurself goes, go back: you have no consul, but the disguised gods.\n\nSecond Citizen:\nWe choose him in the world, he did runk itself.\n\nFirst Citizen:\nSir, I am I a man changed him and thriving, I have heard the\nking.\n\nCORIOLANUS:\nConsider him!\n\nAUFIDIUS:\nMost gracious irice, and you must danc\n\n\nIt’s not Shakespeare but structurally, it’s plausible Shakespeare. It looks like the script for a play, the language sounds archaic, the character names/titles come from real Shakespeare plays. Most of the words are English words. Punctuation and capitalization are mostly sensible. Clearly, none of the text actually makes sense, but still, it’s not bad for an hour of training.\nThe tokens in the model are characters, not words. Given a prompt, the model predicts a probability distribution for the next character. For example, given the prompt 'my most gr, the model predicts these probabilities for the next token:\n\n\nCode to display probabilities for next token after my most gr\nprompt = 'my most gr'\ntokens = encoding_helpers.tokenize_string(prompt)\nlogits, _ = m(tokens)\nlogits = LogitsWrapper(logits.detach(), tokenizer)\nfor token, prob in logits.topk_tokens(k=10)[0][-1]:\n    print(f'{repr(token)} {prob:.3f}')\n\n\n'a' 0.819\n'e' 0.081\n'i' 0.059\n'o' 0.036\n'u' 0.004\n'y' 0.001\n'w' 0.000\n'r' 0.000\n'g' 0.000\n's' 0.000\n\n\nAppendix I provides a few more details about the model. Beyond that, if you want to know more, the code and Andrej’s video are the best resources.\n\n\nTransformer Block Structure\nEach of the 6 blocks in the architecture diagram above contains two significant sub-components: a multi-head self-attention layer and a feed-forward network, wired together via a mix of direct and residual connections as follows:\n\n\nDrawing code for block internals architecture diagram\nclass BlockArchDiagram(Scene):\n    def construct(self):\n        input_emb = Rectangle(height=0.4, width=3)\n        input_emb_label = (\n            Text('Block Input', font='Arial').move_to(input_emb.get_center()).scale(0.4)\n        )\n        input_emb = VGroup(input_emb, input_emb_label)\n\n        ln1 = Rectangle(height=0.4, width=3)\n        ln1_label = Text('Layer Norm', font='Arial').move_to(ln1.get_center()).scale(0.4)\n        ln1 = VGroup(ln1, ln1_label)\n\n        sa = Rectangle(height=0.6, width=3.5)\n        sa_label = Text('Multi-Head Self-Attention', font='Arial').move_to(sa.get_center()).scale(0.4)\n        sa = VGroup(sa, sa_label)\n\n        stack1 = VGroup(ln1, sa).arrange(DOWN, buff=0.4)\n\n        first_plus = self.circled_plus(radius=0.3)\n\n        ln2 = Rectangle(height=0.4, width=3)\n        ln2_label = Text('Layer Norm', font='Arial').move_to(ln2.get_center()).scale(0.4)\n        ln2 = VGroup(ln2, ln2_label)\n\n        ffwd = Rectangle(height=0.6, width=3.5)\n        ffwd_label = Text('Feed Forward', font='Arial').move_to(ffwd.get_center()).scale(0.4)\n        ffwd = VGroup(ffwd, ffwd_label)\n\n        stack2 = VGroup(ln2, ffwd).arrange(DOWN, buff=0.4)\n\n        empty_rect = Rectangle(height=0.2, width=3, color=BLACK)\n\n        second_plus = self.circled_plus(radius=0.3)\n\n        self.add(\n            VGroup(\n                empty_rect,\n                input_emb,\n                stack1,\n                first_plus,\n                empty_rect.copy(),\n                stack2,\n                second_plus,\n                empty_rect.copy(),\n            ).arrange(DOWN, buff=0.5)\n        )\n        stack1.shift(LEFT * 2)\n        stack2.shift(LEFT * 2)\n\n        # Add annotations\n\n        arrow_stroke_width = 2.0\n        # Arrow from input emb to ln1\n        self.add(\n            self.arrow_via_points(\n                [\n                    input_emb.get_left(),\n                    ln1.get_top() * [1.0, 0.0, 0.0]\n                    + input_emb.get_left() * [0.0, 1.0, 0.0],\n                    ln1.get_top(),\n                ],\n                stroke_width=arrow_stroke_width,\n            )\n        )\n\n        # Arrow from ln1 to sa\n        self.add(\n            self.arrow_via_points(\n                [\n                    ln1.get_bottom(),\n                    sa.get_top(),\n                ],\n                stroke_width=2 * arrow_stroke_width,\n            )\n        )\n\n        # Arrow from sa to first plus\n        self.add(\n            self.arrow_via_points(\n                [\n                    sa.get_bottom(),\n                    sa.get_bottom() * [1.0, 0.0, 0.0]\n                    + first_plus.get_left() * [0.0, 1.0, 0.0],\n                    first_plus.get_left(),\n                ],\n                stroke_width=arrow_stroke_width,\n            )\n        )\n\n        # Arrow from input emb to circled plus\n        self.add(\n            self.arrow_via_points(\n                [\n                    input_emb.get_right(),\n                    ln1.get_top() * [-1.0, 0.0, 0.0]\n                    + input_emb.get_right() * [0.0, 1.0, 0.0],\n                    ln1.get_top() * [-1.0, 0.0, 0.0]\n                    + first_plus.get_right() * [0.0, 1.0, 0.0],\n                    first_plus.get_right(),\n                ],\n                stroke_width=arrow_stroke_width,\n            )\n        )\n\n        # Arrow from first plus to ln2\n        self.add(\n            self.arrow_via_points(\n                [\n                    first_plus.get_bottom(),\n                    first_plus.get_bottom()\n                    + (ln2.get_top() - first_plus.get_bottom()) * [0.0, 0.5, 0.0],\n                    ln2.get_top()\n                    - (ln2.get_top() - first_plus.get_bottom()) * [0.0, 0.5, 0.0],\n                    ln2.get_top(),\n                ],\n                stroke_width=arrow_stroke_width,\n            )\n        )\n\n        # Arrow from ln2 to ffwd\n        ln2_ffwd_arrow = Arrow(max_tip_length_to_length_ratio=0.08)\n        ln2_ffwd_arrow.put_start_and_end_on(\n            start=ln2.get_bottom(),\n            end=ffwd.get_top(),\n        )\n        self.add(ln2_ffwd_arrow)\n\n        # Arrow from ffwd to second plus\n        self.add(\n            self.arrow_via_points(\n                [\n                    ffwd.get_bottom(),\n                    ffwd.get_bottom() * [1.0, 0.0, 0.0]\n                    + second_plus.get_left() * [0.0, 1.0, 0.0],\n                    second_plus.get_left(),\n                ],\n                stroke_width=arrow_stroke_width,\n            )\n        )\n\n        # Arrow from first plus to second plus\n        self.add(\n            self.arrow_via_points(\n                [\n                    first_plus.get_bottom()\n                    + (ln2.get_top() - first_plus.get_bottom()) * [0.0, 0.5, 0.0],\n                    second_plus.get_top(),\n                ],\n                stroke_width=2 * arrow_stroke_width,\n            )\n        )\n\n        # Arrow from second plus to output\n        self.add(\n            self.arrow_via_points(\n                [\n                    second_plus.get_bottom(),\n                    second_plus.get_bottom() + DOWN * 0.4,\n                ],\n                stroke_width=2 * arrow_stroke_width,\n            )\n        )\n\n    def arrow_via_points(self, points: Iterable[np.ndarray], stroke_width: float = 2.0):\n        assert (\n            len(points) &gt;= 2\n        ), 'Must provide at least two points to draw an arrow between'\n\n        lines = VGroup()\n        if len(points) &gt; 2:\n            # Draw lines up to the the second to last point\n            lines.add(\n                *[\n                    Line(start=points[i], end=points[i + 1], stroke_width=stroke_width)\n                    for i in range(len(points) - 1)\n                ]\n            )\n\n        # Draw the final arrow\n        arrow_length = np.linalg.norm(points[-1] - points[-2])\n        arrow = Arrow(\n            max_tip_length_to_length_ratio=0.08,\n            max_stroke_width_to_length_ratio=stroke_width / arrow_length,\n        )\n        arrow.put_start_and_end_on(\n            start=points[-2],\n            end=points[-1],\n        )\n        arrow.set_stroke(\n            width=stroke_width / 2\n        )  # I don't know why but to get the width right I need to divide by 2\n        lines.add(arrow)\n        return lines\n\n    def circled_plus(self, radius: float = 0.4):\n        circle = Circle(radius=radius, color=WHITE)\n        plus = Text('+', font='Arial').move_to(circle.get_center())\n        return VGroup(circle, plus)\n\n\n\n\n\n\n\n\n\n\n\nThe Block module implements this wiring in PyTorch:\nclass Block(nn.Module):\n    \"\"\"One transformer block\"\"\"\n\n    def __init__(self, n_embed, n_head):\n        super().__init__()\n        head_size = n_embed // n_head\n        self.sa = MultiHeadAttention(n_head, head_size)\n        self.ffwd = FeedForward(n_embed)\n        self.ln1  = nn.LayerNorm(n_embed)\n        self.ln2 = nn.LayerNorm(n_embed)\n\n\n    def forward(self, x):\n        x = x + self.sa(self.ln1(x)) # The `x +` part is a skip connection\n        x = x + self.ffwd(self.ln2(x)) # The `x +` part is a skip connection\n\n        return x\nWhile many words have been written and spoken about multi-head attention, comparatively little has been said about the feed-forward network because, it seems, comparatively little is known:\n\n\n\n\n\n\n\n\n\n\n\nScreenshot from https://stats.stackexchange.com/q/485910\n\n\nI started this investigation wondering what comes after attention. Literally, the feed-forward network does. In the transformer I studied, across all 6 blocks, the feed-forward networks comprise over 65% of the total trainable parameters, so they must play some important role.\nAs I’ll show later, it turns out that the output of the feed-forward network is the primary factor that determines how a block transforms its input into its output.",
    "crumbs": [
      "blog_posts",
      "Beyond Self-Attention: How a Small Language Model Predicts the Next Token"
    ]
  },
  {
    "objectID": "blog_posts/beyond-self-attention.html#demo-my-proposal-in-action",
    "href": "blog_posts/beyond-self-attention.html#demo-my-proposal-in-action",
    "title": "Beyond Self-Attention: How a Small Language Model Predicts the Next Token",
    "section": "Demo: My Proposal In Action",
    "text": "Demo: My Proposal In Action\nIn this section, I’m going to show an example that illustrates what I’m proposing the transformer is doing. In the next section, I’ll go into detail about how this is implemented.\nImagine we did the following:\n\nRan the prompt, 'And only l', through the model and extracted the output value of the feed-forward network in the first transformer block.\nWent back to the training corpus, found all substrings of the same length as our prompt (10-characters), ran all of them through the model, and filtered out just the ones whose feed-forward network outputs in the first block have a cosine similarity of 0.95 or greater when compared to that of the prompt, 'And only l'.\n\nWe’d come up with this set of strings:\n\n\nHelper function to print results in a table\ndef text_table(\n    headers: Iterable[str], data_columns: Sequence[Sequence[str]], col_widths: Sequence[int]\n):\n    assert len(headers) == 0 or len(headers) == len(\n        data_columns\n    ), \"Must have either zero headers or the same number as data columns\"\n\n    assert len(data_columns) == len(col_widths), \"Must have same number of column widths as data columns\"\n\n    if len(headers) &gt; 0:\n        output = \"\".join([f\"{header:{col_widths[i]}}\" for i, header in enumerate(headers)]) + \"\\n\"\n        header_underlines = [\"-\" * len(header) for header in headers]\n        output += (\n            \"\".join(\n                [\n                    f\"{header_underline:{col_widths[i]}}\"\n                    for i, header_underline in enumerate(header_underlines)\n                ]\n            )\n            + \"\\n\"\n        )\n    else:\n        output = \"\"\n\n    max_len = max([len(col) for col in data_columns])\n    for i in range(max_len):\n        items = [\n            data_column[i] if i &lt; len(data_column) else \" \"\n            for data_column in data_columns\n        ]\n        output += \"\".join([f\"{item:{col_widths[i]}}\" for i, item in enumerate(items)]) + \"\\n\"\n\n    return output\n\n\n\n\nCode to generate similar strings (will be explained later)\n# Get all the unique substrings in the text\nstrings10 = all_unique_substrings(text=ts.text, substring_length=10)\n\n# Set up to look at prefiltering\nprefiltered_threshold=0.7\nprefiltered_results_folder = environment.data_root / 'cosine_sim_results/large_files/slen10' / f'prefiltered_{prefiltered_threshold}'\n\ndef prefiltered_filename(block_idx: int, q_idx: int) -&gt; Path:\n    return prefiltered_results_folder / f'cosine_sim_ffwd_out_{q_idx:05d}_{block_idx:02d}.pt'\n\ndef load_prefiltered_data(block_idx: int, q_idx: int):\n    return torch.load(prefiltered_filename(block_idx, q_idx))\n\nblock_idx = 0\nsimilarity_threshold=0.95\nq_idx = 57 # Query index for `And only l`\nsimilar_indices = filter_on_prefiltered_results(\n    load_prefiltered=lambda q_idx: load_prefiltered_data(block_idx, q_idx),\n    q_idx_start=q_idx,\n    q_idx_end=q_idx+1,\n    filter_fn=lambda values: values &gt; similarity_threshold\n)\nsimilar_strings = [\n    [strings10[i] for i in indices]\n    for indices in similar_indices\n]\n\ndata_columns=[\n    [repr(s) for s in similar_strings[0][i : i + 20]] for i in range(0, len(similar_strings[0]), 20)\n]\n\nprint(text_table(\n    headers=[],\n    data_columns=data_columns,\n    col_widths=[16 for _ in data_columns]\n))\n\n\n'hat only l'    's sickly l'    ' as\\nthey l'   'r kingly l'    're; they l'    \n'eby they l'    'ar, they l'    'im, only l'    'ling any l'    'life may l'    \n'nobility l'    'e\\nBy any l'   ' as they l'    ', if any l'    ' hastily l'    \n'tly they l'    ' ghastly l'    '\\nMy only l'   'For many l'    'r in any l'    \n' till my l'    'all they l'    'hen they l'    'at Henry l'    'oolishly l'    \n'er:\\nThey l'   'may they l'    'or stony l'    'ur Henry l'    'l gladly l'    \n'yet they l'    'y;\\nDelay l'   'e, on my l'    'or Henry l'    'I dearly l'    \n' if they l'    ' she may l'    't\\nfairly l'   'ould say l'    'd all my l'    \n'her they l'    ' Stanley l'    ' and may l'    'uld they l'    'u all my l'    \n'friendly l'    'h gently l'    'e deadly l'    'f all my l'    'n all my l'    \n'Ere they l'    'steel my l'    ' tell my l'    'e kingly l'    'learn my l'    \n'd he say l'    't basely l'    'Thursday l'    'iciously l'    \" 'if any l\"    \n' as many l'    'hy glory l'    'not very l'    'a goodly l'    'e surely l'    \n'quiously l'    ', fairly l'    'lord! my l'    'entle my l'    ', he may l'    \n'our holy l'    ' worldly l'    ' my only l'    ' all, my l'                    \n'ul, they l'    'o lately l'    's in any l'    ' no lady l'                    \n'ter many l'    'Our holy l'    't vainly l'    'e\\nA lady l'                   \n' you may l'    'y greedy l'    'untimely l'    'directly l'                    \n'er on my l'    'e wistly l'    'ng Henry l'    'And only l'                    \n's kindly l'    'KE:\\nThey l'   ' of many l'    'o, on my l'                    \n\n\n\nThere’s a clear pattern across these: they all end in y l and several of them end in ly l. Similarity in the space of feed-forward network outputs seems to correspond to human-interpretable patterns.\nNext, imagine we went back to the training corpus, found each of these strings and built a distribution of all the characters that came after them. We’d find, for example:\n\n'hat only l' is followed by i (“That only like a gulf it did remain”)\n'l gladly l' is followed by e (“I’ll gladly learn.”)\n'n all my l' is followed by both a and i (“In all my lands and leases whatsoever” and “never saw you before in all my life”)\n\nDoing this for the complete set of 94 strings, we’d end up with this distribution:\n\n\nHelper function to plot probability distribution for tokens\ndef plot_prob_distribution_for_tokens(\n    prob_distribution: torch.Tensor,\n    title: str = \"\",\n    ax: Optional[Axes] = None,\n    figsize=(12, 4),\n):\n    if ax is None:\n        _, ax = plt.subplots(figsize=figsize)\n\n    x_indices = np.arange(tokenizer.vocab_size)\n    x_labels = [repr(c)[1:-1] for c in tokenizer.chars]\n\n    ax.bar(x_indices, prob_distribution)\n    ax.set_xticks(x_indices, x_labels, rotation=\"vertical\")\n    ax.set_title(title)\n    ax.set_ylim(0.0, 1.0)\n\n\n\n\nCode to produce distribution from tokens that follow similar strings\nnext_token_map10 = build_next_token_map(\n    text=ts.text,\n    prefix_len=10,\n    vocab_size=tokenizer.vocab_size,\n    stoi=tokenizer.stoi\n)\ntotal_freq_distribution = torch.stack([\n    next_token_map10[string] for string in similar_strings[0]\n]).sum(dim=0)\nprob_distribution = total_freq_distribution / total_freq_distribution.sum()\nplot_prob_distribution_for_tokens(prob_distribution, title='Normalized frequency distribution from block 0 similar strings')\n\n\n\n\n\n\n\n\n\nThe various tokens in our model’s vocabulary appear on the x-axis and the normalized frequency of occurrence on the y-axis. This plot shows that i was the most frequent, then o, then a, and finally, e.\nNow let’s look at the final output of the transformer as a whole when given And only l as a prompt:\n\n\nCode to produce model predictions\nprompt = 'And only l'\ntokens = encoding_helpers.tokenize_string(prompt)\nlogits, _ = m(tokens)\nlogits = LogitsWrapper(logits.detach(), tokenizer)\nlogits.plot_probs(title='Probability distribution from model')\n\n\n\n\n\n\n\n\n\nThis is a probability distribution representing the model’s predictions for the next token. Notice that it’s strikingly similar to the normalized frequency distribution shown in the previous plot!\nWe can quantify how similar they are. Hellinger distance is a measure of overlap between probability distributions. Given distributions \\(P\\) and \\(Q\\), the Hellinger distance between them is:\n\\[\nH(P, Q) = \\frac{1}{\\sqrt{2}} \\sqrt{\\sum_{i=1}^n (\\sqrt{p_i} - \\sqrt{q_i})^2}\n\\]\nOr, in code:\n\ndef hellinger_distance(\n    p: torch.Tensor,\n    q: torch.Tensor,\n):\n    return ((p.sqrt() - q.sqrt())**2).sum(dim=-1).sqrt() / math.sqrt(2)\n\nHellinger distance of 0 means the two distributions are identical and 1 means they have no overlap.\nThe Hellinger distance between the two distributions above - the distribution formed from the tokens that follow the strings with similar feed-forward network outputs and the distribution the model predicts - is 0.07: very nearly identical.\nFor the sake of keeping the demo brief, I chose an example where the first block’s similar strings alone are enough to produce a distribution that closely matches the final output of the transformer. Typically, we’d need to need to do the same exercise - finding the strings in the training corpus that produce similar feed-forward network outputs to the prompt and building a distribution from the tokens that succeed them - for all 6 transformer blocks, and then calculate a weighted sum of the resulting distributions in order to get a good match. We’ll do that in the next section and see that across a sample of 20,000 prompts, the average Hellinger distance between distributions computed this way and the corresponding transformer output was just 0.17.\nThis small average Hellinger distances suggests the results produced by this approach are a good approximation for the transformer’s outputs. In addition, as I’ll explain in the interpretation section, I think the approach itself is a reasonable approximation of what the transformer is actually doing.",
    "crumbs": [
      "blog_posts",
      "Beyond Self-Attention: How a Small Language Model Predicts the Next Token"
    ]
  },
  {
    "objectID": "blog_posts/beyond-self-attention.html#implementation-approximating-the-transformer-output-with-feed-forward-network-outputs",
    "href": "blog_posts/beyond-self-attention.html#implementation-approximating-the-transformer-output-with-feed-forward-network-outputs",
    "title": "Beyond Self-Attention: How a Small Language Model Predicts the Next Token",
    "section": "Implementation: Approximating the Transformer Output with Feed-forward Network Outputs",
    "text": "Implementation: Approximating the Transformer Output with Feed-forward Network Outputs\nIn this section, I’m going to walk through in some detail and with code, the exact procedure I used to approximate the transformer’s output using strings that produced similar feed-forward network outputs. If you’re not interested in the implementation, skip this section and proceed to the evaluation section.\nTo recap, this is the procedure to compute the approximation:\n\nRun a prompt through the model and save the feed-forward network outputs for each block.\nFor each block:\n\nFind the strings in the training corpus that produce the most similar feed-forward network outputs to the prompt for that block.\nFor each string found, build a frequency distribution of the tokens that come after it in the training corpus.\nSum the frequency distributions for all strings found for the current block.\n\nCompute a weighted sum of the frequency distributions for each block computed in the previous step.\nNormalize the weighted sum to get a probability distribution.\n\n\nProcedure Setup\nThe first step of the procedure - running a prompt through the model and saving the feed-forward network outputs for each block - is straightforward to accomplish with some basic PyTorch hooks. But the first part of step two - finding the strings in the training corpus that produce similar feed-forward network outputs - requires some additional machinery to do efficiently.\nI did all the analysis with length 10 strings for compute and storage efficiency (but I also observed that the results hold for both shorter and longer strings). The 1,115,394-character long training corpus contains 858,923 unique, length 10 substrings. Each feed-forward network output is a 384-dimensional vector of float32 values and the model produces 6 of them (one for each block). Comparing the 6 384-dimensional feed-forward outputs for any prompt to 6 * 858,923 = 5,153,538 feed-forward outputs from all the other strings takes a long time. To able to work with this data, I had to pre-compute things. I built the following pipeline:\n\nI chose 20,000 length 10 strings from the training corpus at random to use as prompts in this experiment.\nOvernight, I ran a process to compute the cosine similarity between the feed-forward network outputs the model produced for the 20,000 prompts and those it produced for the 858,923 unique length 10 substrings of the training corpus. I did this in batches and saved the results to disk.\nEven after pre-computing the cosine similarity results, searching through all of them to find the closest matches took a long time. Experiments showed matches of interest never had a cosine similarity below 0.7, so I ran another step to pre-filter the results of step 2 to just those entries with cosine similarity &gt;= 0.7. This greatly reduced the number of entries to search through.\n\nThe code for this pre-computation and pre-filtering is too much to include in this post, but the implementation is available in the cosine-sims experiment notebook.\n\n\nProcedure Walkthrough\nIn this section, we’ll build up the code step by step and run it on one prompt at a time and for just one block. Over the following sections, we’ll extend it to additional blocks, run it across a large number of prompts, and examine the results.\nFirst, we need to grab 20,000 length 10 strings from the training corpus to use as prompts:\n\n# Get all the unique substrings in the text\nstrings10 = all_unique_substrings(text=ts.text, substring_length=10)\n\nn_prompts = 20000\n\ntorch.manual_seed(1337)\nindices = torch.randperm(len(strings10))[:n_prompts]\nprompts = [strings10[i.item()] for i in indices]\n\nAs described in the Procedure Setup section, I previously ran all these strings through the model, grabbed the feed-forward network outputs for each block, and pre-computed the cosine similarities to all the unique length 10 substrings in the training corpus. And then I pre-filtered the results to just those with cosine similarity &gt;= 0.7.\nThe the cosine-sims experiment notebook that implements all this also exports a helper function, filter_on_prefiltered_results(), that we can use to find the most similar strings to a given prompt by searching over the pre-filtered results.\n\nIf you’re curious about how this works, check out the notebook. It’s pretty straightforward and the unit test provides a simple example that illustrates the shape of the inputs and outputs.\n\nTo use filter_on_prefiltered_results(), we just need to tell it how to find the prefiltered files:\n\nprefiltered_threshold=0.7\nprefiltered_results_folder = environment.data_root / 'cosine_sim_results/large_files/slen10' / f'prefiltered_{prefiltered_threshold}'\n\ndef prefiltered_filename(block_idx: int, q_idx: int) -&gt; Path:\n    return prefiltered_results_folder / f'cosine_sim_ffwd_out_{q_idx:05d}_{block_idx:02d}.pt'\n\ndef load_prefiltered_data(block_idx: int, q_idx: int):\n    return torch.load(prefiltered_filename(block_idx, q_idx))\n\n\nNote on the use of q_idx here and in the rest of the code: q_idx refers to “query index”. The job that pre-computes all the cosine similarities takes a set of “queries” or values to compare to. These queries are the feed-forward network outputs the model produces for the prompts. There is a 1:1 correspondence between queries and prompts and so I’ve used the terms interchangeably in the code.\n\nTo start, we’ll use the same prompt - 'And only l' - we used in the earlier demo. It happens to be the prompt at index 57:\n\nprompts[57]\n\n'And only l'\n\n\nWe’ll find the strings whose feed-forward network outputs in block 0 had a cosine similarity of 0.95 or greater when compared to the block 0 feed forward network output of the prompt.\n\nblock_idx = 0\nsimilarity_threshold=0.95\nq_idx = 57\nsimilar_indices = filter_on_prefiltered_results(\n    load_prefiltered=lambda q_idx: load_prefiltered_data(block_idx, q_idx),\n    q_idx_start=q_idx,\n    q_idx_end=q_idx+1,\n    filter_fn=lambda values: values &gt; similarity_threshold\n)\nsimilar_strings = [\n    [strings10[i] for i in indices]\n    for indices in similar_indices\n]\nlen(similar_strings[0])\n\n94\n\n\nThis produced the 94 similar strings we saw in the demo. We can print them again to be sure:\n\nprint(f\"Original string: {repr(prompts[q_idx])}\")\nprint(\"Similar strings: \\n\")\n\ndata_columns=[\n    [repr(s) for s in similar_strings[0][i : i + 20]] for i in range(0, len(similar_strings[0]), 20)\n]\n\nprint(text_table(\n    headers=[],\n    data_columns=data_columns,\n    col_widths=[18 for _ in data_columns]\n))\n\nOriginal string: 'And only l'\nSimilar strings: \n\n'hat only l'      's sickly l'      ' as\\nthey l'     'r kingly l'      're; they l'      \n'eby they l'      'ar, they l'      'im, only l'      'ling any l'      'life may l'      \n'nobility l'      'e\\nBy any l'     ' as they l'      ', if any l'      ' hastily l'      \n'tly they l'      ' ghastly l'      '\\nMy only l'     'For many l'      'r in any l'      \n' till my l'      'all they l'      'hen they l'      'at Henry l'      'oolishly l'      \n'er:\\nThey l'     'may they l'      'or stony l'      'ur Henry l'      'l gladly l'      \n'yet they l'      'y;\\nDelay l'     'e, on my l'      'or Henry l'      'I dearly l'      \n' if they l'      ' she may l'      't\\nfairly l'     'ould say l'      'd all my l'      \n'her they l'      ' Stanley l'      ' and may l'      'uld they l'      'u all my l'      \n'friendly l'      'h gently l'      'e deadly l'      'f all my l'      'n all my l'      \n'Ere they l'      'steel my l'      ' tell my l'      'e kingly l'      'learn my l'      \n'd he say l'      't basely l'      'Thursday l'      'iciously l'      \" 'if any l\"      \n' as many l'      'hy glory l'      'not very l'      'a goodly l'      'e surely l'      \n'quiously l'      ', fairly l'      'lord! my l'      'entle my l'      ', he may l'      \n'our holy l'      ' worldly l'      ' my only l'      ' all, my l'                        \n'ul, they l'      'o lately l'      's in any l'      ' no lady l'                        \n'ter many l'      'Our holy l'      't vainly l'      'e\\nA lady l'                       \n' you may l'      'y greedy l'      'untimely l'      'directly l'                        \n'er on my l'      'e wistly l'      'ng Henry l'      'And only l'                        \n's kindly l'      'KE:\\nThey l'     ' of many l'      'o, on my l'                        \n\n\n\nNext, we’ll need to build a frequency distribution for the tokens that came after these strings in the text. To make this easy and efficient (we’ll eventually be doing many times), we can pre-compute the next token frequency distributions for all the unique length 10 substrings in the training corpus. The helper function build_next_token_map(), implemented in the text-analysis module, does this.\n\nnext_token_map10 = build_next_token_map(\n    text=ts.text,\n    prefix_len=10,\n    vocab_size=tokenizer.vocab_size,\n    stoi=tokenizer.stoi\n)\n\nThe return value stored in next_token_map10 is a dictionary that maps each unique length 10 substring in the training corpus to a frequency distribution of the tokens that come after it. Conceptually, it looks something like this:\n{\n    'the common': {\n        ' ': 12, \"'\": 1, ',': 1, '?': 1, 'a': 1, 's': 5, 'w': 3\n    },\n    ' the gods ': {\n        'b': 1, 'c': 1, 'd': 2, 'f': 1, 'g': 1, 'h': 2, 'k': 2, 's': 2, 't': 1, 'w': 2\n    },\n    ' authority': {\n        '\\n': 1, ' ': 5, ',': 5, ':': 2, ';': 1\n    },\n    ...\n}\nIn reality, the values are actually tensors of shape (vocab_size,) where vocab_size is the number of unique tokens the vocabulary (65, in our case). The item at index i in the tensor is the count of occurrences of the ith token after the string in that entry’s key. So it looks more like:\n{\n      'the common': torch.tensor([\n            0, 12,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,\n            0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,\n            0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,\n            0,  0,  0,  5,  0,  0,  0,  3,  0,  0,  0\n      ]),\n      ' the gods ': torch.tensor([\n            0, 12,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,\n            0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,\n            0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,\n            0,  0,  0,  5,  0,  0,  0,  3,  0,  0,  0\n      ]),\n      ' authority': torch.tensor([\n          0, 12,  0,  0,  0,  1,  1,  0,  0,  0,  0,  0,  1,  0,  0,  0,  0,  0,\n          0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,\n          0,  0,  0,  1,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,\n          0,  0,  0,  5,  0,  0,  0,  3,  0,  0,  0\n      ]),\n    ...\n}\nNext, we need to sum the frequency distributions for all the strings we found to have similar feed-forward network outputs to our prompt. Because next_token_map10 stores the individual frequency distributions as tensors, this is easy to accomplish:\n\ntotal_freq_distribution = torch.stack([\n    next_token_map10[string] for string in similar_strings[0]\n]).sum(dim=0)\n\nWe stack up the distributions for each similar string into a single tensor and then sum across all of them. We can now turn this into a probability distribution by dividing each entry by the sum of all the entries:\n\nprob_distribution = total_freq_distribution / total_freq_distribution.sum()\n\nFinally, we can visualize this distribution:\n\nplot_prob_distribution_for_tokens(prob_distribution, title='Probability distribution using only block 0 similar strings')\n\n\n\n\n\n\n\n\nIt’s the same distribution we saw in the demo.\nNow let’s code the comparison to the model output:\n\ntokens = encoding_helpers.tokenize_string(prompts[q_idx])\nlogits, _ = m(tokens)\nlogits = LogitsWrapper(logits.detach(), tokenizer)\nlogits.plot_probs(title='Probability distribution from model')\n\n\n\n\n\n\n\n\nAgain, the two distributions look very similar, and in this example, the approximation uses only values from the first block. To better compare them, we can look at the distributions in text form:\n\n\nHelper function to print comparison of distributions as a table\ndef print_distribution_comparison(\n    approx_top_tokens: Sequence[Tuple[str, float]],\n    model_top_tokens: Sequence[Tuple[str, float]],\n):\n    max_len = min(len(approx_top_tokens), len(model_top_tokens))\n\n    print(\n        text_table(\n            headers=[\"Model Predictions\", \"Approximation Predictions\"],\n            data_columns=[\n                [\n                    f\"{repr(token)[1:-1]}: {prob:.3f}\"\n                    for i, (token, prob) in enumerate(model_top_tokens)\n                    if i &lt; max_len\n                ],\n                [\n                    f\"{repr(token)[1:-1]}: {prob:.3f}\"\n                    for i, (token, prob) in enumerate(approx_top_tokens)\n                    if i &lt; max_len\n                ],\n            ],\n            col_widths=[20, 20],\n        )\n    )\n\n\n\napprox_top_tokens = top_nonzero_tokens(prob_distribution, tokenizer.itos)\nmodel_top_tokens = logits.topk_tokens(k=10)[0][-1]\n\nprint_distribution_comparison(approx_top_tokens, model_top_tokens)\n\nModel Predictions   Approximation Predictions\n-----------------   -------------------------\ni: 0.437            i: 0.389            \no: 0.204            o: 0.250            \na: 0.195            a: 0.222            \ne: 0.160            e: 0.139            \n\n\n\nFinally, we can also compare the Hellinger distance between these distributions:\n\nhellinger_distance(prob_distribution, logits.probs()[0][-1])\n\ntensor(0.0711)\n\n\nBy combining the next token frequency distributions of the similar strings from just the first layer of the model, we are able to pretty closely approximate the output of the transformer. Of course, I chose an example that works particularly well.\nHere’s an example where the frequency distribution from just the first layer doesn’t work well:\n\nq_idx=40\nprompts[q_idx]\n\n'hing tremb'\n\n\nUsing the same method, we can identify 57 strings from the training corpus that produce similar feed-forward network outputs to the prompt:\n\nblock_idx = 0\nsimilarity_threshold=0.95\nsimilar_indices = filter_on_prefiltered_results(\n    load_prefiltered=lambda q_idx: load_prefiltered_data(block_idx, q_idx),\n    q_idx_start=q_idx,\n    q_idx_end=q_idx+1,\n    filter_fn=lambda values: values &gt; similarity_threshold\n)\nsimilar_strings = [\n    [strings10[i] for i in indices]\n    for indices in similar_indices\n]\nlen(similar_strings[0])\n\n57\n\n\nWe can look up, sum, and normalize the frequency distributions of tokens that follow these strings in the training corpus, and compare the result to the model outputs, as we did before:\n\ntotal_freq_distribution = torch.stack([\n    next_token_map10[string] for string in similar_strings[0]\n]).sum(dim=0)\nprob_distribution = total_freq_distribution / total_freq_distribution.sum()\n\napprox_top_tokens = top_nonzero_tokens(prob_distribution, tokenizer.itos)\n\ntokens = encoding_helpers.tokenize_string(prompts[q_idx])\nlogits, _ = m(tokens)\nlogits = LogitsWrapper(logits.detach(), tokenizer)\nmodel_top_tokens = logits.topk_tokens(k=10)[0][-1]\n\nprint_distribution_comparison(approx_top_tokens, model_top_tokens)\n\nModel Predictions   Approximation Predictions\n-----------------   -------------------------\nl: 0.999            e: 0.543            \ne: 0.000            l: 0.343            \nr: 0.000            r: 0.114            \n\n\n\nUnlike the previous example, these distributions are quite different. The top 3 tokens are the same in each, but they’re in the wrong order and their probabilities are far apart. These differences contribute to a large Hellinger distance:\n\ntokens = encoding_helpers.tokenize_string(prompts[q_idx])\nlogits, _ = m(tokens)\nlogits = LogitsWrapper(logits.detach(), tokenizer)\nhellinger_distance(prob_distribution, logits.probs()[0][-1])\n\ntensor(0.6305)\n\n\nFor the prompt, 'hing tremb', just using the values from the first block results in a poor approximation of the transformer’s output. We’ll soon add the contributions from other blocks and when we do, we’ll get the Hellinger distance between the approximation and the real transformer output for this prompt down from 0.63 to just 0.02.\n\n\nSimilarity Thresholds\nIn the preceding examples, I used a similarity threshold of 0.95: I searched for strings whose feed-forward network outputs in block 0 produced values with a cosine similarity of 0.95 or greater when compared to the feed-forward network output of the prompt.\nA different threshold would have yielded different results. For example, doing the same exercise for prompt id 57 ('And only l') with a threshold of 0.90 finds 612 similar strings, vs the 94 we had before:\n\nblock_idx = 0\nsimilarity_threshold=0.90\nq_idx = 57\nsimilar_indices = filter_on_prefiltered_results(\n    load_prefiltered=lambda q_idx: load_prefiltered_data(block_idx, q_idx),\n    q_idx_start=q_idx,\n    q_idx_end=q_idx+1,\n    filter_fn=lambda values: values &gt; similarity_threshold\n)\nsimilar_strings = [\n    [strings10[i] for i in indices]\n    for indices in similar_indices\n]\nlen(similar_strings[0])\n\n612\n\n\nIf we do the rest of the approximation procedure, we see different (and worse) results:\n\ntotal_freq_distribution = torch.stack([\n    next_token_map10[string] for string in similar_strings[0]\n]).sum(dim=0)\nprob_distribution = total_freq_distribution / total_freq_distribution.sum()\n\napprox_top_tokens = top_nonzero_tokens(prob_distribution, tokenizer.itos)\n\ntokens = encoding_helpers.tokenize_string(prompts[q_idx])\nlogits, _ = m(tokens)\nlogits = LogitsWrapper(logits.detach(), tokenizer)\nmodel_top_tokens = logits.topk_tokens(k=10)[0][-1]\n\nprint_distribution_comparison(approx_top_tokens, model_top_tokens)\n\nModel Predictions   Approximation Predictions\n-----------------   -------------------------\ni: 0.437            o: 0.584            \no: 0.204            i: 0.251            \na: 0.195            a: 0.095            \ne: 0.160            e: 0.066            \nu: 0.004            u: 0.002            \nl: 0.000            y: 0.001            \n\n\n\nThe top 5 tokens are the same, but when ranked by probability, the approximation has a different ordering than the model. The Hellinger distance is also higher:\n\nhellinger_distance(prob_distribution, logits.probs()[0][-1])\n\ntensor(0.2856)\n\n\nLoosening the similarity threshold introduced strings into the calculation that resulted in a worse approximation. Tightening beyond 0.95 also produces worse results than we got with 0.95, presumably because we’re excluding strings that were needed to produce a good approximation:\n\nblock_idx = 0\nsimilarity_threshold=0.97\nq_idx = 57\nsimilar_indices = filter_on_prefiltered_results(\n    load_prefiltered=lambda q_idx: load_prefiltered_data(block_idx, q_idx),\n    q_idx_start=q_idx,\n    q_idx_end=q_idx+1,\n    filter_fn=lambda values: values &gt; similarity_threshold\n)\nsimilar_strings = [\n    [strings10[i] for i in indices]\n    for indices in similar_indices\n]\nlen(similar_strings[0])\n\n33\n\n\n\ntotal_freq_distribution = torch.stack([\n    next_token_map10[string] for string in similar_strings[0]\n]).sum(dim=0)\nprob_distribution = total_freq_distribution / total_freq_distribution.sum()\n\napprox_top_tokens = top_nonzero_tokens(prob_distribution, tokenizer.itos)\n\ntokens = encoding_helpers.tokenize_string(prompts[q_idx])\nlogits, _ = m(tokens)\nlogits = LogitsWrapper(logits.detach(), tokenizer)\nmodel_top_tokens = logits.topk_tokens(k=10)[0][-1]\n\nprint_distribution_comparison(approx_top_tokens, model_top_tokens)\n\nModel Predictions   Approximation Predictions\n-----------------   -------------------------\ni: 0.437            o: 0.278            \no: 0.204            i: 0.250            \na: 0.195            a: 0.250            \ne: 0.160            e: 0.222            \n\n\n\n\nhellinger_distance(prob_distribution, logits.probs()[0][-1])\n\ntensor(0.1498)\n\n\nFor the first block, 0.95 appears to be a sweet spot. I came up with this threshold through manual tuning: trying different values and binary searching towards one that produced the best results. The full history of this tuning exercise is in the similar space analysis notebook.\nIn the end, I found the following thresholds produce the best results for each block:\n\n\n\nBlock\nSimilarity Threshold\n\n\n\n\n0\n0.95\n\n\n1\n0.94\n\n\n2\n0.85\n\n\n3\n0.76\n\n\n4\n0.81\n\n\n5\n0.89\n\n\n\n\nWhen I first started exploring this space, I assumed the approximation would get better the more similarity I could find. I tried a number of techniques, including experimenting with Euclidean distance vs cosine similarity, searching across strings of different lengths, etc. Every time I succeeded in finding strings with more similar feed-forward network outputs to use in the approximation, the results got worse. I realized that, at least for some blocks, including less similar values in the mix produced better approximations, probably because those blocks had learned to map prompts to broader classes of strings in the training corpus.\n\n\n\nGoing Beyond the First Block\nThus far, we’ve only considered feed-forward network outputs from the first block. Now we’ll incorporate the contributions from the other blocks.\nFirst, let’s find the strings that produce similar feed-forward network outputs in each block, using the similarity thresholds listed above. For now, we’ll do this for just one query (index 57, 'And only l'):\n\nsimilarity_thresholds=[0.95, 0.94, 0.85, 0.76, 0.81, 0.89]\nq_idx = 57\n\nsimilar_strings_per_block = []\n\nfor block_idx in range(n_layer):\n    similar_indices = filter_on_prefiltered_results(\n        load_prefiltered=lambda q_idx: load_prefiltered_data(block_idx, q_idx),\n        q_idx_start=q_idx,\n        q_idx_end=q_idx+1,\n        filter_fn=lambda values: values &gt; similarity_thresholds[block_idx]\n    )\n    similar_strings = [\n        [strings10[i] for i in indices]\n        for indices in similar_indices\n    ]\n    similar_strings_per_block.append(similar_strings)\n\nLet’s summarize how many strings we found for each block based on these thresholds:\n\nprint(text_table(\n    headers=[\"Block Index\", \"Similarity Threshold\", \"# of Similar Strings\"],\n    data_columns=[\n        [f\"{block_idx:&gt;10}\" for block_idx in range(n_layer)],\n        [f\"{threshold:&gt;19}\" for threshold in similarity_thresholds],\n        [f\"{len(similar_strings[0]):&gt;19}\" for similar_strings in similar_strings_per_block],\n    ],\n    col_widths=[14, 23, 23]\n))\n\nBlock Index   Similarity Threshold   # of Similar Strings   \n-----------   --------------------   --------------------   \n         0                   0.95                     94    \n         1                   0.94                     47    \n         2                   0.85                     70    \n         3                   0.76                    108    \n         4                   0.81                    175    \n         5                   0.89                   2237    \n\n\n\nNow that we’ve identified the right strings for each block, we can do the next step of the approximation procedure: build the frequency distributions for the tokens that follow those strings, and sum them up. We’re going to be doing this several times over, so let’s define a function for it:\n\ndef frequency_distribution_from_similar_strings(\n    similar_strings_per_block: Sequence[Sequence[Sequence[str]]],\n    next_token_map: Dict[str, torch.Tensor],\n) -&gt; torch.Tensor:\n    # freqs_per_block_per_query is a list of lists of tensors. The outer list has\n    # one item per block. The inner list has one item per query. Each\n    # tensor is the next token frequency distribution for a particular\n    # block and query.\n    freqs_per_block_per_query: List[List[torch.Tensor]] = [[] for _ in range(n_layer)]\n\n    for block_idx in range(n_layer):\n        for similar_strings in similar_strings_per_block[block_idx]:\n            freqs_per_block_per_query[block_idx].append(\n                torch.stack([next_token_map[string] for string in similar_strings]).sum(\n                    dim=0\n                )\n            )\n\n    # Stack all frequency tensors into a single tensor of shape\n    # (n_layer, n_queries, vocab_size)\n    freqs = torch.stack(\n        [\n            torch.stack(freqs_per_block_per_query[block_idx])\n            for block_idx in range(n_layer)\n        ]\n    )\n\n    return freqs\n\nThis function, frequency_distribution_from_similar_strings(), does the equivalent of this code we looked at earlier:\ntotal_freq_distribution = torch.stack([\n    next_token_map10[string] for string in similar_strings[0]\n]).sum(dim=0)\nBut with two key differences:\n\nIt does this calculation for all the blocks, using the similar strings we found for each block above.\nIt allows for more than one query. In the code we’ve looked at so far, we only evaluated the approximation for a single prompt. In the next section, we’ll be running it for lots of prompts so I’ve written the code in a more general form to a allow for this. Specifically, the code allows for similar_strings_per_block to contain not just a single list of strings per block but multiple: one for each query.\n\nLet’s run this on the similar_strings_per_block we constructed earlier:\n\nfreq_distribution = frequency_distribution_from_similar_strings(\n    similar_strings_per_block,\n    next_token_map10,\n)\nfreq_distribution.shape\n\ntorch.Size([6, 1, 65])\n\n\nIt produces a tensor of shape (6, 1, 65): 6 blocks, 1 query, 65 tokens in the vocabulary. If we’d been working with more queries, the middle dimension would be larger.\nSo now we have a frequency distribution for each block, based on the strings found for each block using the similarity thresholds. We now need to turn this into a probability distribution.\nEarlier, when we just had a single frequency distribution for a single block, we just normalized it. But now we have multiple frequency distributions - one for each block - and need to combine them. In my experiments, I found that a weighted sum of these distributions produced the best results.\nAs with the similarity thresholds, I was able to find a set of good weights by trial and error. I also tried a deep-learning approach to find weights, but did not get better results than with the hand-tuned approach. The procedure for both hand-tuning and learning weights is implemented in the similar space notebook, the same one used for tuning thresholds.\nFor now, let’s use the optimal weights I found:\n\nweights = torch.tensor([0.01, 0.01, 0.1, 1.5, 6, 0.01]).unsqueeze(dim=1).unsqueeze(dim=2) # (n_layer, 1, 1)\ntotal_freq_distribution = (freq_distribution * weights).sum(dim=0)\nprob_distribution = total_freq_distribution / total_freq_distribution.sum(dim=-1, keepdim=True)\n\nWe multiply the frequency distributions by the weights, sum across all blocks, and then normalize into a probability distribution. We can now look at how the approximation’s distribution compares to the model’s.\n\nNote: in the code below, we have to index into the prob_distribution tensor with [0] because its first dimension is the number of queries. We’re only working with a single query, so we can just take the first element.\n\n\napprox_top_tokens = top_nonzero_tokens(prob_distribution[0], tokenizer.itos)\n\ntokens = encoding_helpers.tokenize_string(prompts[q_idx])\nlogits, _ = m(tokens)\nlogits = LogitsWrapper(logits.detach(), tokenizer)\nmodel_top_tokens = logits.topk_tokens(k=10)[0][-1]\n\nprint_distribution_comparison(approx_top_tokens, model_top_tokens)\n\nModel Predictions   Approximation Predictions\n-----------------   -------------------------\ni: 0.437            i: 0.363            \no: 0.204            o: 0.265            \na: 0.195            a: 0.213            \ne: 0.160            e: 0.147            \nu: 0.004            u: 0.011            \nl: 0.000            y: 0.000            \n\n\n\n\nhellinger_distance(prob_distribution[0], logits.probs()[0][-1])\n\ntensor(0.0731)\n\n\nIn this particular case, adding the other layers didn’t change the approximation much (if anything, it’s very slightly worse based on Hellinger distance). But let’s look at the example that didn’t work well when we considered just the first layer: prompt id 40 ('hing tremb').\n\nsimilarity_thresholds=[0.95, 0.94, 0.85, 0.76, 0.81, 0.89]\nq_idx = 40\n\nsimilar_strings_per_block = []\n\nfor block_idx in range(n_layer):\n    similar_indices = filter_on_prefiltered_results(\n        load_prefiltered=lambda q_idx: load_prefiltered_data(block_idx, q_idx),\n        q_idx_start=q_idx,\n        q_idx_end=q_idx+1,\n        filter_fn=lambda values: values &gt; similarity_thresholds[block_idx]\n    )\n    similar_strings = [\n        [strings10[i] for i in indices]\n        for indices in similar_indices\n    ]\n    similar_strings_per_block.append(similar_strings)\n\nfreq_distribution = frequency_distribution_from_similar_strings(\n    similar_strings_per_block,\n    next_token_map10,\n)\nweights = torch.tensor([0.01, 0.01, 0.1, 1.5, 6, 0.01]).unsqueeze(dim=1).unsqueeze(dim=2) # (n_layer, 1, 1)\ntotal_freq_distribution = (freq_distribution * weights).sum(dim=0)\nprob_distribution = total_freq_distribution / total_freq_distribution.sum(dim=-1, keepdim=True)\ntokens = encoding_helpers.tokenize_string(prompts[q_idx])\nlogits, _ = m(tokens)\nlogits = LogitsWrapper(logits.detach(), tokenizer)\n\napprox_top_tokens = top_nonzero_tokens(prob_distribution[0], tokenizer.itos)\nmodel_top_tokens = logits.topk_tokens(k=10)[0][-1]\n\nprint_distribution_comparison(approx_top_tokens, model_top_tokens)\n\nModel Predictions   Approximation Predictions\n-----------------   -------------------------\nl: 0.999            l: 0.997            \ne: 0.000            e: 0.002            \nr: 0.000            r: 0.000            \n\n\n\n\nhellinger_distance(prob_distribution, logits.probs()[0][-1])\n\ntensor([0.0233])\n\n\nRemember that for this example, when we used just the first layer’s similar strings, the approximation was quite different from the model’s prediction and had a Hellinger distance of &gt;0.63. Now it’s nearly identical and has a Hellinger distance of 0.02. So using the rest of the layers really helped this example.\nIn the next section, we’ll extend the code to evaluate the approximation over the whole set of 20,000 prompts. The section after that will look at how well the approximation does across all the prompts.\n\n\nExtending to All 20,000 Prompts\nWe now have all the pieces we need to run the approximation procedure for all 20,000 prompts. First, let’s find the strings with similar feed-forward network outputs for all the prompts, for all blocks:\n\n# Takes about 7 minutes to run\n\nsimilarity_thresholds=[0.95, 0.94, 0.85, 0.76, 0.81, 0.89]\n\nsimilar_strings_per_block = []\n\nfor block_idx in range(n_layer):\n    similar_indices = filter_on_prefiltered_results(\n        load_prefiltered=lambda q_idx: load_prefiltered_data(block_idx, q_idx),\n        q_idx_start=0,\n        q_idx_end=n_prompts,\n        filter_fn=lambda values: values &gt; similarity_thresholds[block_idx]\n    )\n    similar_strings = [\n        [strings10[i] for i in indices]\n        for indices in similar_indices\n    ]\n    similar_strings_per_block.append(similar_strings)\n\nNext, we compute the frequency distributions for each query based on the strings we found, perform the weighted sum, and normalize to produce a probability distribution.\n\nfreq_distribution = frequency_distribution_from_similar_strings(\n    similar_strings_per_block,\n    next_token_map10,\n)\nweights = torch.tensor([0.01, 0.01, 0.1, 1.5, 6, 0.01]).unsqueeze(dim=1).unsqueeze(dim=2) # (n_layer, 1, 1)\ntotal_freq_distribution = (freq_distribution * weights).sum(dim=0)\nprob_distribution = total_freq_distribution / total_freq_distribution.sum(dim=-1, keepdim=True)\nprob_distribution.shape\n\ntorch.Size([20000, 65])\n\n\nThe output is a tensor of shape (20000, 65): one 65-entry distribution for each of 20,000 prompts.\nIn order to compare, we need to run all the prompts through the model and get the output probability distributions the model predicts:\n\ntokens = encoding_helpers.tokenize_strings(prompts)\nlogits, _ = m(tokens)\nlogits = LogitsWrapper(logits.detach(), tokenizer)\nmodel_probs = logits.probs()\nmodel_probs = model_probs[:, -1, :] # We're only interested in the last token\n\nNow we have outputs from the approximation and from the model for all prompts. In the next section, we’ll measure the Hellinger distance between them and evaluate the results.",
    "crumbs": [
      "blog_posts",
      "Beyond Self-Attention: How a Small Language Model Predicts the Next Token"
    ]
  },
  {
    "objectID": "blog_posts/beyond-self-attention.html#evaluating-the-approximation",
    "href": "blog_posts/beyond-self-attention.html#evaluating-the-approximation",
    "title": "Beyond Self-Attention: How a Small Language Model Predicts the Next Token",
    "section": "Evaluating the Approximation",
    "text": "Evaluating the Approximation\nIn earlier sections, we compared output from the approximation to output from the model for individual prompts. Now that we have both outputs for all prompts, we can compare them and look at aggregate results.\nFirst, we can compute the Hellinger distance between the approximation and the model’s prediction for each prompt:\n\nh = hellinger_distance(prob_distribution, model_probs)\nh.shape\n\ntorch.Size([20000])\n\n\nThis produced 20,000 Hellinger distance scores, one for each prompt. We can start by looking at some basic stats:\n\nh.mean(), h.std(), h.min(), h.max()\n\n(tensor(0.1677), tensor(0.1215), tensor(0.0013), tensor(0.9994))\n\n\nThe average Hellinger distance is just below 0.17, with a standard deviation of around 0.12, suggesting a distribution that skews low (a good thing). We’ve also got at least one really excellent sample (a min of 0.0013) and at least one really terrible one (max of 0.9994).\nLet’s look at the distribution:\n\n\nCode for distribution plot\nsns.kdeplot(h.numpy(), fill=True)\nplt.title(\"Distribution of Hellinger Distance across 20,000 Samples (Transformer vs Approximation)\")\nplt.show()\n\n\n\n\n\n\n\n\n\nIndeed, the distribution is skewed left, indicating most queries have Hellinger distance scores on the lower end.\nThe numbers and the distribution graph look promising, but is the approximation really a good one? It’s hard to say without something to compare against and it’s not obvious what a good comparison might be.\nA thought experiment: let’s imagine that for some prompt, the model produced a distribution that looked like this:\n\n\nCode to generate first imagined distribution\nimagined_dist = torch.zeros(tokenizer.vocab_size)\nimagined_dist[tokenizer.stoi['b']] = 0.49\nimagined_dist[tokenizer.stoi['d']] = 0.51\nplot_prob_distribution_for_tokens(imagined_dist, title='Imagined Distribution')\n\n\n\n\n\n\n\n\n\nThe tokens b and d have nearly the same predicted probability (0.49 vs 0.51). The model predicts an approximately equal chance of these tokens coming next. Now imagine our approximation, or another model, predicted this distribution:\n\n\nCode to generate second imagined distribution\nimagined_dist2 = torch.zeros(tokenizer.vocab_size)\nimagined_dist2[tokenizer.stoi['b']] = 0.51\nimagined_dist2[tokenizer.stoi['d']] = 0.49\nplot_prob_distribution_for_tokens(imagined_dist2, title='Imagined Distribution 2')\n\n\n\n\n\n\n\n\n\nNearly the same, but the probabilities are reversed: b has probability 0.51 and d has 0.49. Would we care about this difference? Clearly both distributions are saying that b and d are about equally likely. If used for inference, either distribution would probably produce acceptable results. For most use cases I could imagine, the difference would just be noise.\nThe Hellinger distance between the two imagined distributions above is 0.0141. Not zero, but we’re saying it doesn’t matter for practical purposes. If 0.0141 is a Hellinger distance that doesn’t matter much, what about 0.02? Or 0.025? We can imagine there is some threshold Hellinger distance below which we wouldn’t care and above which we would consider distributions to be meaningfully different. What is that threshold value?\nIf we knew it, then we could look at how close the average Hellinger distance between our approximation’s predictions and model’s come to this threshold. That would be a measure of the goodness of the approximation.\nI did an experiment to estimate what the threshold is. I trained the same transformer architecture three more times, starting with a different random seed each time and stopping at approximately the same training and validation loss as I did for the original model. This gave me three alternative transformers with roughly the same performance, but with different weights due to the different random initial starting points:\n\n\n\n\n\n\n\n\n\nModel\nSeed\nEst. Training Loss\nEst. Validation Loss\n\n\n\n\nOriginal Model\n1337\n0.9334\n1.5063\n\n\nAlternate 1\n1442\n0.9293\n1.5038\n\n\nAlternate 2\n88\n0.9294\n1.4991\n\n\nAlternate 3\n99999\n0.9339\n1.4941\n\n\n\n\nI used the same training/validation sets, hyperparameters, optimizer, etc. for the three alternate models as for the original model. The training code and output for the alternate models is in the alternate-models experiment notebook. Training code for the original model is at the end of the main transformer notebook.\n\nI then ran the same 20,000 prompts through the alternative models and calculated the Hellinger distance between their outputs and that of the original model. Appendix II shows the code used to do this. The table below shows the aggregate results.\n\n\n\nComparison\nMean Hellinger Distance\n\n\n\n\nOriginal vs Alternate 1\n0.1064 ± 0.0823\n\n\nOriginal vs Alternate 2\n0.1057 ± 0.0817\n\n\nOriginal vs Alternate 3\n0.1053 ± 0.0828\n\n\n\nThe original model and the three alternate models are “equivalent” in the sense that they perform about equally well in terms of training and validation loss. I could have used any of them as the basis for this post. In other words, the differences between them likely aren’t meaningful - just noise.\nAcross all three alternate models, the average Hellinger distance was ~0.11 ± 0.08. We only have 3 data points, so it’s not a perfect measure, but ~0.11 is probably a reasonable lower bound for the threshold Hellinger distance we are looking for.\nFor comparison, the average Hellinger distance between the model and the approximation was ~0.17. A little higher than 0.11, but within a standard deviation.\nPlotting the distributions of the various Hellinger distances shows this nicely:\n\n\nCode to generate plot of Hellinger Distance Distributions\nalt_models_dir = environment.data_root / 'alternate-models/model-training/20240112-training/outputs/'\nassert alt_models_dir.exists(), \"Alternate models directory does not exist. Run the training code in ../experiments/alternate-models.ipynb.\"\n\n# Instantiate the three alternative trained models\nm_alt1, _ = create_model_and_tokenizer(\n    saved_model_filename=alt_models_dir / 'shakespeare-20240112-1.pt',\n    dataset=ts,\n    device=device,\n)\nm_alt2, _ = create_model_and_tokenizer(\n    saved_model_filename=alt_models_dir / 'shakespeare-20240112-2.pt',\n    dataset=ts,\n    device=device,\n)\nm_alt3, _ = create_model_and_tokenizer(\n    saved_model_filename=alt_models_dir / 'shakespeare-20240112-3.pt',\n    dataset=ts,\n    device=device,\n)\n\ndef get_model_probs(model: TransformerLanguageModel, tokens: torch.Tensor):\n    \"\"\"Helper function to get a model's output probability distribution for a\n    batch of tokenized inputs.\"\"\"\n    logits, _ = model(tokens)\n    logits = LogitsWrapper(logits.detach(), tokenizer)\n    return logits.probs()[:, -1, :] # We'e only interested in the last token\n\nalt_model_probs1 = get_model_probs(m_alt1, tokens)\nalt_model_probs2 = get_model_probs(m_alt2, tokens)\nalt_model_probs3 = get_model_probs(m_alt3, tokens)\n\nh_alt1 = hellinger_distance(model_probs, alt_model_probs1)\nh_alt2 = hellinger_distance(model_probs, alt_model_probs2)\nh_alt3 = hellinger_distance(model_probs, alt_model_probs3)\n\n_, ax = plt.subplots(figsize=(12, 6))\nsns.kdeplot(data=h_alt1.numpy(), fill=False, color='blue', ax=ax, label='vs alternate model 1')\nsns.kdeplot(data=h_alt2.numpy(), fill=False, color='green', ax=ax, label='vs alternate model 2')\nsns.kdeplot(data=h_alt3.numpy(), fill=False, color='orange', ax=ax, label='vs alternate model 3')\nsns.kdeplot(data=h.numpy(), fill=False, color='red', ax=ax, label='vs approximation')\n_ = ax.legend()\n_ = plt.title(\"Distribution of Hellinger Distance between Original Model Ouput and Alternate Model/Approximation Outputs across 20,000 Samples\")\n\n\n\n\n\n\n\n\n\nThere is clearly less deviation between the alternates and the original model than between the approximation and the original model, but it’s not wildly different. I think this result suggests the approximation is quite good. Most of the difference is within the “acceptable noise” threshold.",
    "crumbs": [
      "blog_posts",
      "Beyond Self-Attention: How a Small Language Model Predicts the Next Token"
    ]
  },
  {
    "objectID": "blog_posts/beyond-self-attention.html#interpretation-why-does-the-approximation-work",
    "href": "blog_posts/beyond-self-attention.html#interpretation-why-does-the-approximation-work",
    "title": "Beyond Self-Attention: How a Small Language Model Predicts the Next Token",
    "section": "Interpretation: Why Does the Approximation Work?",
    "text": "Interpretation: Why Does the Approximation Work?\nThe analysis in the previous section shows that the outputs of the approximation are quite similar to the transformer’s outputs. But that doesn’t necessarily mean that the approximation procedure is similar to what the transformer is actually doing. The approximation and the transformer might just represent two different ways of computing the same result.\nMy intuition is that this is not the case: I think the approximation is at least something like what the transformer is doing. In this section, I’ll break down how I think the transformer computes something similar to the approximation and then present some supporting evidence.\nThe key ideas are:\n\nThe transformer, as its name suggests*, performs a series of transformations on its embedded input. The transformer blocks transform embeddings within embedding space and the final linear layer at the end transforms from embedding space to logit space.\nWithin each transformer block, the transformation from input to output embedding is done via vector addition: the block’s output embedding is its input embedding plus the output of the self-attention layer, plus the output of the feed-forward network. Of the two added components, the feed-forward network output value is dominant in determining the final output.\nWithin embedding space, subspaces exist that correspond to specific tokens. An embedding within the subspace for a particular token produces an output distribution in which all the probability is concentrated on that token (that token has probability near 1 and all other tokens have probability near 0). Embeddings that lie between the subspaces for multiple tokens result in outputs that distribute all the probability across those tokens.\nThe feed-forward network output at each block is an “adjustment vector” that orients the block output towards the subspaces for the tokens that the approximation procedure would predict: those that follow the strings in the training corpus that produce similar feed-forward network outputs at that block.\n\nIn the subsections below, I’ll go into each of these ideas in more detail.\n\n*It’s unclear whether the name “transformer” alludes to transforming an input sequence to an output sequence (the use case in the original paper was machine translation) or the transformations within the layers of the model.\n\n\nThe Model is a Series of Transformations\nOnce the input to the model has been embedded, we can view the model as a series of transformations:\n\n\nDrawing code for diagram showing transformations within the model\nclass TransformationsDiagram(Scene):\n    def construct(self):\n        blocks = VGroup(\n            *[Rectangle(height=0.4, width=3) for _ in range(n_layer)],\n        ).arrange(DOWN, buff=0.1)\n\n        empty_rect = Rectangle(height=0.2, width=3, color=BLACK)\n\n        out_emb_text = Text(\"Output Embedding\", font=\"Arial\").scale(0.4)\n\n        lm_head_blocks = [Rectangle(height=0.4, width=3) for _ in range(2)]\n\n        logits_text = Text(\"Logits\", font=\"Arial\").scale(0.4)\n\n        softmax_block = Rectangle(height=0.4, width=3)\n\n        arch = VGroup(\n            blocks,\n            empty_rect,\n            out_emb_text,\n            empty_rect.copy(),\n            *lm_head_blocks,\n            empty_rect.copy(),\n            logits_text,\n            empty_rect.copy(),\n            softmax_block,\n            empty_rect.copy(),\n        ).arrange(DOWN, buff=0.1)\n        self.add(arch)\n\n        # Text at the top\n        in_emb_text = (\n            Text(\"Input Embedding\", font=\"Arial\")\n            .scale(0.4)\n            .next_to(blocks[0], UP, buff=0.4)\n        )\n        self.add(in_emb_text)\n\n        # Block labels\n        block_labels = [\n            Text(f\"Block {b+1}\", font=\"Arial\")\n            .move_to(blocks[b].get_center())\n            .scale(0.4)\n            for b in range(n_layer)\n        ]\n        self.add(*block_labels)\n\n        # Output block labels\n        labels = [\"Layer Norm\", \"Linear\"]\n        lm_head_labels = [\n            Text(f\"{l}\", font=\"Arial\")\n            .move_to(lm_head_blocks[b].get_center())\n            .scale(0.4)\n            for b, l in enumerate(labels)\n        ]\n        self.add(*lm_head_labels)\n\n        softmax_block_label = (\n            Text(\"Softmax\", font=\"Arial\").move_to(softmax_block.get_center()).scale(0.4)\n        )\n        self.add(softmax_block_label)\n\n        arrow_buffer = np.array([0.0, 0.05, 0.0])\n\n        # Arrow between input embeddings and blocks\n        in_emb_arrow = Arrow(max_tip_length_to_length_ratio=0.08)\n        in_emb_arrow.put_start_and_end_on(\n            start=in_emb_text.get_bottom() - arrow_buffer,\n            end=blocks[0].get_top(),\n        )\n        self.add(in_emb_arrow)\n\n        # Arrow between last block and output embedding label\n        blocks_to_out_emb_arrow = Arrow(max_tip_length_to_length_ratio=0.08)\n        blocks_to_out_emb_arrow.put_start_and_end_on(\n            start=blocks[-1].get_bottom(),\n            end=out_emb_text.get_top() + arrow_buffer,\n        )\n        self.add(blocks_to_out_emb_arrow)\n\n        # Arrow between output embedding label and LM head blocks\n        out_embs_to_layer_norm_arrow = Arrow(max_tip_length_to_length_ratio=0.08)\n        out_embs_to_layer_norm_arrow.put_start_and_end_on(\n            start=out_emb_text.get_bottom() - arrow_buffer,\n            end=lm_head_blocks[0].get_top(),\n        )\n        self.add(out_embs_to_layer_norm_arrow)\n\n        # Arrow between LM head blocks and logits\n        out_blocks_to_logits_arrow = Arrow(max_tip_length_to_length_ratio=0.08)\n        out_blocks_to_logits_arrow.put_start_and_end_on(\n            start=lm_head_blocks[-1].get_bottom(),\n            end=logits_text.get_top() + arrow_buffer,\n        )\n        self.add(out_blocks_to_logits_arrow)\n\n        # Arrow between logits and softmax\n        logits_to_softmax_arrow = Arrow(max_tip_length_to_length_ratio=0.08)\n        logits_to_softmax_arrow.put_start_and_end_on(\n            start=logits_text.get_bottom() - arrow_buffer,\n            end=softmax_block.get_top(),\n        )\n        self.add(logits_to_softmax_arrow)\n\n        # Text at the bottom\n        out_prob_text = (\n            Text(\"Output Probabilities\", font=\"Arial\")\n            .scale(0.4)\n            .next_to(softmax_block[-1], DOWN, buff=0.4)\n        )\n        self.add(out_prob_text)\n\n        # Arrow between softmax and output probs\n        out_prob_arrow = Arrow(max_tip_length_to_length_ratio=0.08)\n        out_prob_arrow.put_start_and_end_on(\n            start=softmax_block.get_bottom(),\n            end=out_prob_text.get_top(),\n        )\n        self.add(out_prob_arrow)\n\n        # Brace next to blocks\n        blocks_brace = BraceLabel(\n            blocks,\n            brace_direction=LEFT,\n            text=\"transformations within\\nembedding space\",\n            label_constructor=lambda text, **kwargs: Text(\n                text, font=\"Arial\", **kwargs\n            ).scale(0.4),\n        )\n        self.add(blocks_brace)\n\n        # Brace next to linear layer block\n        linear_layer_brace = BraceLabel(\n            lm_head_blocks[-1],\n            brace_direction=LEFT,\n            text=\"transformation from \\nembedding space to\\nlogit space\",\n            label_constructor=lambda text, **kwargs: Text(\n                text, font=\"Arial\", **kwargs\n            ).scale(0.4),\n        )\n        self.add(linear_layer_brace)\n\n\n\n\n\n\n\n\n\n\n\nThe sequence of 6 transformer blocks takes a tensor in embedding space (\\(\\mathbb{R}^{384}\\), since n_embed=384) as input and outputs another tensor in embedding space. In this sense, represents a transformation within embedding space. In fact, each transformer block is itself a transformation within embedding space and the stack of all 6 blocks composes these individual transformations. It isn’t literally implemented this way in code, but its equivalent to:\noutput_embedding = block6(block5(block4(block3(block2(block1(input_embedding))))))\nAt the end of the sequence of blocks, the model sends the output embedding through a LayerNorm operation and then a linear layer that transforms from embedding space into logit space (\\(\\mathbb{R}^{65}\\), since vocab_size=65). Finally, the softmax layer at the end turns the logits into probabilities for the next token.\n\n\nTransformation via Vector Addition\nWe looked at the internal logic within a transformer block in the earlier Transformer Block Structure section. To recap, the forward() method of the Block module looks like this:\nclass Block(nn.Module):\n    \"\"\"One transformer block\"\"\"\n\n    ...\n\n    def forward(self, x):\n        x = x + self.sa(self.ln1(x)) # The `x +` part is a skip connection\n        x = x + self.ffwd(self.ln2(x)) # The `x +` part is a skip connection\n\n        return x\n This is equivalent to the following code, which, by using some intermediate local variables, clarifies what’s really going on:\n    def forward(self, x):\n        sa_out = self.sa(self.ln1(x))\n        ffwd_out = self.ffwd(self.ln2(x + sa_out))\n\n        return x + sa_out + ffwd_out\nThe output of the block is equal to the input (x), plus the self-attention output (sa_out), plus the feed forward network output (ffwd_out). We can think of the block as taking the input embedding, and then making two adjustments to it.\nThese values being added together are vectors in \\(\\mathbb{R}^{384}\\). If we imagine the embedding space reduced to just two dimensions, it might look something like this:\n\n\nCode to generate plot of of 1 block’s vector additions in 2D\n# These values are generated in ../analyses/70_embedding_adjustments.ipynb. They\n# are 2D vectors that have the same norms and cosine similarity relationships as\n# the block intermediate values for q_idx=57.\nvectors = [\n    torch.tensor([ 0.7202,  0.6359]),\n    torch.tensor([-1.2350,  1.5638]),\n    torch.tensor([-3.2156,  4.6376]),\n    torch.tensor([-2.1867, -0.3706]),\n    torch.tensor([-3.2978,  0.2411]),\n    torch.tensor([-2.1838, -1.4804]),\n    torch.tensor([-3.9066, -1.8245]),\n    torch.tensor([-1.1337, -2.6656]),\n    torch.tensor([-1.9595, -3.2921]),\n    torch.tensor([-0.1060, -2.4951]),\n    torch.tensor([-0.9699, -4.8422]),\n    torch.tensor([ 0.8515, -2.2819]),\n    torch.tensor([ 0.5064, -5.7759])\n]\ncolors = ['r', *['g' if i % 2 == 0 else 'b' for i, _ in enumerate(vectors)]]\n\n_, ax = plt.subplots(figsize=(5, 5))\nprev = torch.tensor([0.0, 0.0])\n\nmin_val = prev.min().item()\nmax_val = prev.max().item()\n\nfor vector, color in zip(vectors[:3], colors[:3]):\n    ax.quiver(prev[0], prev[1], vector[0], vector[1], angles='xy', scale_units='xy', scale=1, color=color)\n    prev = prev + vector\n    min_val = min(min_val, prev.min().item())\n    max_val = max(max_val, prev.max().item())\n\nax.set_aspect('equal')\n\nax.set_xlim(min_val-1, max_val+1)\nax.set_ylim(min_val-1, max_val+1)\n\nax.grid(True)\n\nendpoint = sum(vectors[:3])\n\n_ = ax.quiver(0, 0, endpoint[0], endpoint[1], angles='xy', scale_units='xy', scale=1, color='gray')\n\n\n\n\n\n\n\n\n\nThe red vector represents the input embedding. The green vector represents the self-attention output (sa_out in code), and the blue vector represents the feed-forward network output (ffwd_out in code). The gray arrow represent the final sum, or the output of the first block: where you end up when you arrange the individual vectors tip to tail.\nThe plot above shows the additions that happen within just one block. Subsequent blocks add their self-attention outputs and feed-forward network outputs, starting from the output of this block. If we add the vectors from those other blocks to the diagram, it looks like this:\n\n\nCode to generate plot of all blocks’ vector additions in 2D\n_, ax = plt.subplots(figsize=(5, 5))\nprev = torch.tensor([0.0, 0.0])\n\nmin_val = prev.min().item()\nmax_val = prev.max().item()\n\nfor vector, color in zip(vectors, colors):\n    ax.quiver(prev[0], prev[1], vector[0], vector[1], angles='xy', scale_units='xy', scale=1, color=color)\n    prev = prev + vector\n    min_val = min(min_val, prev.min().item())\n    max_val = max(max_val, prev.max().item())\n\nax.set_aspect('equal')\n\nax.set_xlim(min_val-1, max_val+1)\nax.set_ylim(min_val-1, max_val+1)\n\nax.grid(True)\n\nendpoint = sum(vectors)\n\n_ = ax.quiver(0, 0, endpoint[0], endpoint[1], angles='xy', scale_units='xy', scale=1, color='gray')\n\n\n\n\n\n\n\n\n\nAgain, the red arrow represents the input vector, each green arrow represents one block’s self-attention output, each blue arrow represents one block’s feed-forward network output. Arranged tip to tail, their endpoint represents the final output from the stack of 6 blocks, depicted by the gray arrow.\nThough it’s only in two dimensions, the diagram above is based on real data and is drawn “to scale”, in a way: the length of each 2D vector is the same as the \\(\\mathbb{R}^{384}\\) vector it represents for a real query (index 57). In addition, the cosine similarity between each 2D blue / green arrow and the sum of the arrows that precede it is the same as the cosine similarity between the corresponding self-attention/feed-forward network output and the block input in the real data.\n\nCode to generate the 2D representation from real data is in the embedding adjustments analysis notebook.\n\nWe can observe two interesting patterns:\n\nThe feed-forward network outputs are generally longer than the self-attention outputs (the vectors have larger norms)\nWithin a given block, the feed-forward network output and the self-attention output point in roughly the same direction.\n\nLook at what happens when we eliminate the self-attention outputs from the vector sum, leaving just the feed-forward network outputs:\n\n\nCode to generate plot of overlaying just the feed-forward vectors added\n_, ax = plt.subplots(figsize=(5, 5))\nprev = torch.tensor([0.0, 0.0])\n\nmin_val = prev.min().item()\nmax_val = prev.max().item()\n\nfor vector, color in zip(vectors, colors):\n    ax.quiver(prev[0], prev[1], vector[0], vector[1], angles='xy', scale_units='xy', scale=1, color=color)\n    prev = prev + vector\n    min_val = min(min_val, prev.min().item())\n    max_val = max(max_val, prev.max().item())\n\nffwd_vectors = [v for i, v in enumerate(vectors[1:]) if i % 2 == 1]\nprev = vectors[0]\nfor vector in ffwd_vectors:\n    ax.quiver(prev[0], prev[1], vector[0], vector[1], angles='xy', scale_units='xy', scale=1, color='b')\n    prev = prev + vector\n\nax.set_aspect('equal')\n\nax.set_xlim(min_val-1, max_val+1)\nax.set_ylim(min_val-1, max_val+1)\n\nax.grid(True)\n\nendpoint = sum(vectors)\nendpoint_ffwd = vectors[0] + sum(ffwd_vectors)\n\n_ = ax.quiver(0, 0, endpoint[0], endpoint[1], angles='xy', scale_units='xy', scale=1, color='gray')\n_ = ax.quiver(0, 0, endpoint_ffwd[0], endpoint_ffwd[1], angles='xy', scale_units='xy', scale=1, color='gray')\n\n\n\n\n\n\n\n\n\nThe inner blue curve in the above plot represents the sum of the input vector and only the feed-forward network outputs from each block. The tip to tail arrangement of these vectors ends at a point far from where the previous arrangement (including the self-attention outputs) ended. But notice that the feed-forward-only endpoint (shorter gray arrow) is quite closely aligned in direction with the original endpoint (longer gray arrow).\nThis plot shows values for only one query and we lose a lot of information dropping from 384 dimensions to 2. But the pattern does seem to hold in general and in the full, high-dimensional embedding space. The embedding adjustments analysis notebook provides a deep-dive into this phenomenon across all 20,000 queries.\nThe takeaway is that simplifying the transformation performed by the blocks to just the contributions of the feed-forward networks results in an output vector that is shorter (has a smaller norm) than the original output but points in roughly the same direction. And the difference in norms would have no impact on the transformer’s final output, because of the LayerNorm operation after the stack of blocks. That LayerNorm step will adjust the norm of any input vector to similar value regardless of its initial magnitude; the final linear layer that follows it will always see inputs of approximately the same norm (see Appendix III for a walk-through of this).\nAn important clarification: I’m not suggesting that we could remove the self attention computation from the transformer. The feed-forward networks take the self-attention output as part of their input (ffwd_out = self.ffwd(self.ln2(x +sa_out))); they would compute very different values were the self-attention outputs removed. What I am saying is that, after all block processing has been completed as normal including the self-attention computations, we get roughly the same result if we consider only the feed-forward network contributions, as our approximation does. This is probably because the feed-forward network outputs pass on some of the information they receive as input from the self-attention output.\nFor some additional evidence that an approximation based only on feed-forward network outputs can produce similar outputs to the transformer, see Appendix IV.\n\n\nToken Subspaces\nIn the examples we’ve seen so far, the model outputs have been distributions that include significant non-zero probabilities for several tokens. For example:\n\n\nCode to generate plot of containing non-zero probabilities for several tokens\ntokens = encoding_helpers.tokenize_string('And only l')\nlogits, _ = m(tokens)\nlogits = LogitsWrapper(logits.detach(), tokenizer)\nlogits.plot_probs(title='Next Token Probability Distribution for Prompt \"And only l\"')\n\n\n\n\n\n\n\n\n\nThough we haven’t seen one yet, we might wonder whether specific inputs exist that compel the model to predict a single token with near certainty. In other words, do some inputs cause the model to output a probability distribution in which just one token has probability very near 1 and all other tokens very near zero? Such a distribution might look like this:\n\n\nCode to generate distribution in which one token has all the probability mass\nimagined_dist = torch.zeros(tokenizer.vocab_size)\nimagined_dist += 1\nimagined_dist[tokenizer.stoi['a']] = 10\nimagined_dist = F.softmax(imagined_dist, dim=-1)\nplot_prob_distribution_for_tokens(imagined_dist, title='Distribution in Which One Token Has Probability Near 1')\n\n\n\n\n\n\n\n\n\nIn fact, we can ask this question about any stage of the model. “Input” doesn’t have to refer to the initial input to the model, but could be the input to any layer within the model. For example, consider only the layers that transform the final block’s output embedding to logit space (the final LayerNorm and linear layers):\n\n\nDrawing code for diagram showing block 6 output to final layers\nclass OnlyOutputLayersDiagram(Scene):\n    def construct(self):\n\n        empty_rect = Rectangle(height=0.2, width=3, color=BLACK)\n\n        out_emb_text = Text(\"Block 6 Output Embedding\", font=\"Arial\").scale(0.4)\n\n        lm_head_blocks = [Rectangle(height=0.4, width=3) for _ in range(2)]\n\n        logits_text = Text(\"Logits\", font=\"Arial\").scale(0.4)\n\n        softmax_block = Rectangle(height=0.4, width=3)\n\n        arch = VGroup(\n            empty_rect,\n            out_emb_text,\n            empty_rect.copy(),\n            *lm_head_blocks,\n            empty_rect.copy(),\n            logits_text,\n            empty_rect.copy(),\n            softmax_block,\n            empty_rect.copy(),\n        ).arrange(DOWN, buff=0.1)\n        self.add(arch)\n\n\n        # Output block labels\n        labels = [\"Layer Norm\", \"Linear\"]\n        lm_head_labels = [\n            Text(f\"{l}\", font=\"Arial\")\n            .move_to(lm_head_blocks[b].get_center())\n            .scale(0.4)\n            for b, l in enumerate(labels)\n        ]\n        self.add(*lm_head_labels)\n\n        softmax_block_label = (\n            Text(\"Softmax\", font=\"Arial\").move_to(softmax_block.get_center()).scale(0.4)\n        )\n        self.add(softmax_block_label)\n\n        arrow_buffer = np.array([0.0, 0.05, 0.0])\n\n        # Arrow between output embedding label and LM head blocks\n        out_embs_to_layer_norm_arrow = Arrow(max_tip_length_to_length_ratio=0.08)\n        out_embs_to_layer_norm_arrow.put_start_and_end_on(\n            start=out_emb_text.get_bottom() - arrow_buffer,\n            end=lm_head_blocks[0].get_top(),\n        )\n        self.add(out_embs_to_layer_norm_arrow)\n\n        # Arrow between LM head blocks and logits\n        out_blocks_to_logits_arrow = Arrow(max_tip_length_to_length_ratio=0.08)\n        out_blocks_to_logits_arrow.put_start_and_end_on(\n            start=lm_head_blocks[-1].get_bottom(),\n            end=logits_text.get_top() + arrow_buffer,\n        )\n        self.add(out_blocks_to_logits_arrow)\n\n        # Arrow between logits and softmax\n        logits_to_softmax_arrow = Arrow(max_tip_length_to_length_ratio=0.08)\n        logits_to_softmax_arrow.put_start_and_end_on(\n            start=logits_text.get_bottom() - arrow_buffer,\n            end=softmax_block.get_top(),\n        )\n        self.add(logits_to_softmax_arrow)\n\n        # Text at the bottom\n        out_prob_text = (\n            Text(\"Output Probabilities\", font=\"Arial\")\n            .scale(0.4)\n            .next_to(softmax_block[-1], DOWN, buff=0.4)\n        )\n        self.add(out_prob_text)\n\n        # Arrow between softmax and output probs\n        out_prob_arrow = Arrow(max_tip_length_to_length_ratio=0.08)\n        out_prob_arrow.put_start_and_end_on(\n            start=softmax_block.get_bottom(),\n            end=out_prob_text.get_top(),\n        )\n        self.add(out_prob_arrow)\n\n\n\n\n\n\n\n\n\n\n\nIs there some embedding block 6 might emit that would yield an output probability distribution in which some token, say the letter a, has probability very near 1?\n\nLearning Token Subspaces\nWith the right math, it may be possible to find this embedding analytically. But it’s also possible to “learn” (in the sense of deep learning) such an embedding. Here’s the basic idea:\n\nPick a point in the transformer where the input to subsequent layers is an embedding. This could be the input to any of the transformer blocks, or the point right after the final block (as shown in the diagram above).\nPick a token to learn an embedding for.\nCreate an embedding tensor and initialize it with random values. This tensor is the parameter the learning algorithm will optimize; the weights of the transformer are fixed.\nExecute a forward pass by evaluating the transformer from the selected point, using the embedding as input. This will produce some set of logits.\nCompute negative log likelihood loss relative to the token we’re learning an embedding for.\nDo a backward pass, updating the embedding tensor according to the gradients.\n\nMy implementation of this is in the learned embeddings notebook. I used it to learn embeddings for all tokens at various stages of the model and saved them. We can load one - a learned embedding that produces a distribution giving token a probability almost 1 - and check that it does what we expect when given to the part of the model shown in the diagram above:\n\n\nCode to generate plot of probabilities from learned embedding for a\nlearned_embeddings_dir = environment.data_root / 'learned_embeddings'\nemb_a = torch.load(learned_embeddings_dir / 'no_blocks' / 'lower_a.pt', map_location=device)[0, -1, :]\nlogits = LogitsWrapper(accessors.logits_from_embedding(unsqueeze_emb(emb_a)), tokenizer)\nlogits.plot_probs(title='Next Token Probability Distribution for From Learned Embedding for Token \"a\"')\n\n\n\n\n\n\n\n\n\nAs expected, all the probability mass is concentrated on a. Inference using this distribution would generate a with near certainty.\nThe same procedure can learn embeddings for use at other parts of the model. If we wanted to find an embedding for a that could be input to block 6, we could run the same learning algorithm but use this part of the transformer in the forward pass:\n\n\nDrawing code for diagram showing block 6 onwards\nclass Block6OnwardsDiagram(Scene):\n    def construct(self):\n        block_idx_start = n_layer - 1\n        blocks = VGroup(\n            *[Rectangle(height=0.4, width=3) for _ in range(block_idx_start, n_layer)],\n        ).arrange(DOWN, buff=0.1)\n\n        empty_rect = Rectangle(height=0.2, width=3, color=BLACK)\n\n        out_emb_text = Text(\"Output Embedding\", font=\"Arial\").scale(0.4)\n\n        lm_head_blocks = [Rectangle(height=0.4, width=3) for _ in range(2)]\n\n        logits_text = Text(\"Logits\", font=\"Arial\").scale(0.4)\n\n        softmax_block = Rectangle(height=0.4, width=3)\n\n        arch = VGroup(\n            blocks,\n            empty_rect,\n            out_emb_text,\n            empty_rect.copy(),\n            *lm_head_blocks,\n            empty_rect.copy(),\n            logits_text,\n            empty_rect.copy(),\n            softmax_block,\n            empty_rect.copy(),\n        ).arrange(DOWN, buff=0.1)\n        self.add(arch)\n\n        # Text at the top\n        in_emb_text = (\n            Text(\"Block 5 Output Embedding\", font=\"Arial\")\n            .scale(0.4)\n            .next_to(blocks[0], UP, buff=0.4)\n        )\n        self.add(in_emb_text)\n\n        # Block labels\n        block_labels = [\n            Text(f\"Block {b+1}\", font=\"Arial\")\n            .move_to(blocks[b-block_idx_start].get_center())\n            .scale(0.4)\n            for b in range(block_idx_start, n_layer)\n        ]\n        self.add(*block_labels)\n\n        # Output block labels\n        labels = [\"Layer Norm\", \"Linear\"]\n        lm_head_labels = [\n            Text(f\"{l}\", font=\"Arial\")\n            .move_to(lm_head_blocks[b].get_center())\n            .scale(0.4)\n            for b, l in enumerate(labels)\n        ]\n        self.add(*lm_head_labels)\n\n        softmax_block_label = (\n            Text(\"Softmax\", font=\"Arial\").move_to(softmax_block.get_center()).scale(0.4)\n        )\n        self.add(softmax_block_label)\n\n        arrow_buffer = np.array([0.0, 0.05, 0.0])\n\n        # Arrow between input embeddings and blocks\n        in_emb_arrow = Arrow(max_tip_length_to_length_ratio=0.08)\n        in_emb_arrow.put_start_and_end_on(\n            start=in_emb_text.get_bottom() - arrow_buffer,\n            end=blocks[0].get_top(),\n        )\n        self.add(in_emb_arrow)\n\n        # Arrow between last block and output embedding label\n        blocks_to_out_emb_arrow = Arrow(max_tip_length_to_length_ratio=0.08)\n        blocks_to_out_emb_arrow.put_start_and_end_on(\n            start=blocks[-1].get_bottom(),\n            end=out_emb_text.get_top() + arrow_buffer,\n        )\n        self.add(blocks_to_out_emb_arrow)\n\n        # Arrow between output embedding label and LM head blocks\n        out_embs_to_layer_norm_arrow = Arrow(max_tip_length_to_length_ratio=0.08)\n        out_embs_to_layer_norm_arrow.put_start_and_end_on(\n            start=out_emb_text.get_bottom() - arrow_buffer,\n            end=lm_head_blocks[0].get_top(),\n        )\n        self.add(out_embs_to_layer_norm_arrow)\n\n        # Arrow between LM head blocks and logits\n        out_blocks_to_logits_arrow = Arrow(max_tip_length_to_length_ratio=0.08)\n        out_blocks_to_logits_arrow.put_start_and_end_on(\n            start=lm_head_blocks[-1].get_bottom(),\n            end=logits_text.get_top() + arrow_buffer,\n        )\n        self.add(out_blocks_to_logits_arrow)\n\n        # Arrow between logits and softmax\n        logits_to_softmax_arrow = Arrow(max_tip_length_to_length_ratio=0.08)\n        logits_to_softmax_arrow.put_start_and_end_on(\n            start=logits_text.get_bottom() - arrow_buffer,\n            end=softmax_block.get_top(),\n        )\n        self.add(logits_to_softmax_arrow)\n\n        # Text at the bottom\n        out_prob_text = (\n            Text(\"Output Probabilities\", font=\"Arial\")\n            .scale(0.4)\n            .next_to(softmax_block[-1], DOWN, buff=0.4)\n        )\n        self.add(out_prob_text)\n\n        # Arrow between softmax and output probs\n        out_prob_arrow = Arrow(max_tip_length_to_length_ratio=0.08)\n        out_prob_arrow.put_start_and_end_on(\n            start=softmax_block.get_bottom(),\n            end=out_prob_text.get_top(),\n        )\n        self.add(out_prob_arrow)\n\n\n\n\n\n\n\n\n\n\n\nIt’s more computationally expensive to learn embeddings at earlier stages of the model because the optimizer has to contend with a larger computation graph involving operations from all included blocks. Thankfully, as I’ll explain shortly, we need only the embeddings learned for the part of the transformer after all the blocks (embeddings that go straight into the final LayerNorm layer) to show how the transformer operates like the approximation.\n\n\nFrom Embeddings to Subspaces\nFor any token, the procedure described in the previous section can learn an embedding that makes the model predict that token with probability near 1. It turns out there isn’t just one such embedding for each token. We can learn many different embeddings that all produce probability distributions that assign a given token nearly all the probability mass. It was easy to learn thousands of unique embeddings for every token in the vocabulary.\nI think the model has learned a complex, non-linear embedding subspace corresponding to each token. Any embedding within that subspace results in an output distribution that assigns the token near certain probability. Each embedding I was able to learn is probably a point in the embedding subspace for the corresponding token.\nIf we imagine the full embedding space (\\(\\mathbb{R}^{384}\\)) reduced to \\(\\mathbb{R}^3\\) (and the complex subspaces reduced to 2D planes), it might look something like this:\n\n\nDrawing code for diagram showing token subspaces\n# Define non-parallel, non-overlapping planes by using different sets of spanning vectors\n\n# Subspace 1: Plane spanned by vectors [1, 1, 0] and [0, 1, 1]\nv1_1 = np.array([1, 1, 0])\nv1_2 = np.array([0, 1, 1])\nt1_1 = np.linspace(-1, 1, 10)\nt1_2 = np.linspace(-1, 1, 10)\npoints1 = np.array([s * v1_1 + t * v1_2 for s in t1_1 for t in t1_2])\n\n# Subspace 2: Plane spanned by vectors [1, -1, 0] and [0, 0, 1]\nv2_1 = np.array([1, -1, 0])\nv2_2 = np.array([0, 0, 1])\nt2_1 = np.linspace(-1, 1, 10)\nt2_2 = np.linspace(-1, 1, 10)\npoints2 = np.array([s * v2_1 + t * v2_2 for s in t2_1 for t in t2_2])\n\n# Subspace 3: Plane spanned by vectors [1, 0, 1] and [0, 1, 0]\nv3_1 = np.array([1, 0, 1])\nv3_2 = np.array([0, 1, 0])\nt3_1 = np.linspace(-1, 1, 10)\nt3_2 = np.linspace(-1, 1, 10)\npoints3 = np.array([s * v3_1 + t * v3_2 for s in t3_1 for t in t3_2])\n\n# Create a 3D plot\nfig = plt.figure(figsize=(10, 8))\nax = fig.add_subplot(111, projection='3d')\n\n# Plot the subspaces\nax.scatter(points1[:, 0], points1[:, 1], points1[:, 2], color='r', alpha=0.5, label='Subspace for Token 1')\nax.scatter(points2[:, 0], points2[:, 1], points2[:, 2], color='g', alpha=0.5, label='Subspace for Token 2')\nax.scatter(points3[:, 0], points3[:, 1], points3[:, 2], color='b', alpha=0.5, label='Subspace for Token 3')\n\nax.set_xticklabels([])\nax.set_yticklabels([])\nax.set_zticklabels([])\n\n# Set labels and title\nax.set_title('Imagined Token Subspaces in $\\mathbb{R}^3$')\nax.legend()\n\n# Show the plot\nplt.show()\n\n\n\n\n\n\n\n\n\nI don’t know how to determine the exact subspaces for each token mathematically. But I do know how to get a workable approximation of them if we’re willing to pretend that they are linear. They are almost certainly not linear, even at the end of the model, because of the non-linear LayerNorm operation. But they are likely closer to linear near the end of the model because the LayerNorm is the only non-linearity. Earlier in the model, each feed-forward network introduces an additional non-linearity via its ReLU operation.\n\nThis post on LessWrong illustrates of the non-linearity of LayerNorm clearly.\n\nPretending the subspaces are linear actually works quite well for the part of the model after the transformer blocks. And that is the only part of the model we need to consider for this analysis (as I’ll explain soon).\n\n\nLinear Approximations for Subspaces\nThe idea is quite simple: for a given token, we can learn a whole lot of different embeddings, treating each one as a data point. Then we can determine the best fitting line, plane, or other low-dimensional linear subspace that fits the data.\nAgain, if we imagine our embedding space reduced to just 3 dimensions, it might look something like the following diagram. The blue dots each represent a learned embedding and the red arrow is the line that minimizes projected distance from each point.\n\n\nDrawing code for diagram line fit to points in 3D space\n# Parameters\nnum_points = 300\nnoise_factor = 0.25\n\nrng = np.random.default_rng(1442)\nnoise = noise_factor * rng.standard_normal(size=(num_points, 3))\n\npoints = noise + np.array([1, 2, 3])\n\n# Perform SVD\nU, S, Vt = np.linalg.svd(points)\n\n# Top right singular vector (the last row of Vt)\ntop_singular_vector = -Vt[0] * np.linalg.norm(points, axis=1).max()\n\n\n# Create a 3D plot\nfig = plt.figure(figsize=(10, 8))\nax = fig.add_subplot(111, projection='3d')\n\n# Plot the points\nax.scatter(points[:, 0], points[:, 1], points[:, 2], color='b')\n\n# Plot the arrow corresponding to the top right singular vector\narrow_start = np.array([0, 0, 0])\narrow_end = top_singular_vector\nax.quiver(arrow_start[0], arrow_start[1], arrow_start[2],\n          top_singular_vector[0], top_singular_vector[1], top_singular_vector[2],\n          color='r', arrow_length_ratio=0.1)\n\nax.set_xlim(0, 2)\nax.set_ylim(0, 2.7)\nax.set_zlim(0, 4)\n\nax.set_xticklabels([])\nax.set_yticklabels([])\nax.set_zticklabels([])\n\nax.view_init(25, 15)\n\nax.set_title('A Line Fit to Points in $\\mathbb{R}^3$')\n\n# Show the plot\nplt.show()\n\n\n\n\n\n\n\n\n\nWe can use Singular Value Decomposition (SVD) to find the best fitting linear subspace for the learned embeddings.\n\nTo learn more about singular value decomposition in this context, I recommend reading Jeremy Kun’s excellent two-part post. Part 1 Part 2.\n\nAppendix V walks through the code that uses SVD to find a linear approximation for the subspace corresponding to one token. I did this for all tokens, using the embeddings I learned for the final stages of the transformer. In every case, I was able to find a single vector (1-D subspace) that approximates the token subspace quite well.\n\nFor completeness, I also tried this at earlier stages of the transformer and found, as expected, that the linear approximations, even at higher dimensions, didn’t fit the data as well. The relevant experiments are in the approximation details notebook\n\n\n\nMixing Subspace Approximations\nBy learning a large number of embeddings for each token and then using SVD on them, we can find one vector for each token that approximates its subspace. Given one of these vectors, any embedding that falls on its span will produce an output distribution that concentrates all the probability mass on the corresponding token. But many of the real transformer outputs we’ve seen distribute the probability mass across several tokens. How do we get from subspaces for individual tokens to embeddings that produce these more diverse distributions?\nWe can create embeddings that produce probability distributions where several tokens have substantial probability via linear combinations of the subspace approximation vectors for those tokens. This is the distribution we get when we create an embedding by simply adding the approximation vectors for the subspaces for a and b:\n\n\nCode to generate plot of probabilities from a + b\naccessors = TransformerAccessors(m, device)\n\nlearned_embeddings_dir = environment.data_root / 'learned_embeddings'\nmulti_emb_a = torch.load(learned_embeddings_dir / 'no_blocks' / 'lower_a.pt', map_location=device)\n_, Sa, Va = torch.linalg.svd(multi_emb_a[:, -1, :])\nv0a = adjust_singular_vector_sign(Va[0], multi_emb_a[:, -1, :])\n\nmulti_emb_b = torch.load(learned_embeddings_dir / 'no_blocks' / 'lower_b.pt', map_location=device)\n_, Sb, Vb = torch.linalg.svd(multi_emb_b[:, -1, :])\nv0b = adjust_singular_vector_sign(Vb[0], multi_emb_b[:, -1, :])\n\nlogits = LogitsWrapper(accessors.logits_from_embedding(unsqueeze_emb(v0a + v0b)), tokenizer)\nlogits.plot_probs(title='Probability Distribution from \"a\" + \"b\"')\n\n\n\n\n\n\n\n\n\nThe sum of subspace approximations vectors for two tokens is an embedding somewhere in between the two subspaces, which results in a final distribution that is the combination of the two tokens.\nSadly, adding the approximation vectors for a and b, without weighting either one, results in not quite a 50-50 distribution across the two tokens (as shown above). I think there are three reasons for this:\n\nThe approximation vectors are just approximations and not perfect representations of their subspaces.\nThe subspace approximation vectors are not perfectly orthogonal. To the extent that a’s vector has a small component that points in the direction of b, the sum results in an overweighting of b.\nThe final linear layer of the model produces logits of different magnitudes for different tokens. For example, given the approximation for a, the logit for a is ~18.2. The logit for b from its approximation is ~19.5.\n\nTogether, these errors accumulate and the softmax function at the very end exaggerates even small differences. For more analysis on the reasoning behind the differences and how they might be compensated for, see the combining token subspaces notebook.\nThese imperfections aside, I think we can conclude that it’s possible to derive an embedding that produces a distribution for multiple tokens via a linear combination of the approximation vectors for those tokens’ subspaces.\n\n\n\nPutting it All Together\nTo summarize where we are, the preceding sections have shown:\n\nThe transformer blocks perform a series of transformations in embedding space.\nThose transformations can be thought of as moving from one point in embedding space to another by adding the feed-forward network output vector to the input embedding.\nEmbedding space contains subspaces corresponding to predicting particular tokens and embeddings between subspaces for multiple tokens result in predictions including all those tokens.\n\nThis section adds the final piece, which is the correspondence between what the transformer is doing and what the approximation is doing:\n\nWithin a block, adding the feed-forward network output vector to the input produces an output embedding that better aligns with the embedding subspaces of specific tokens. And those tokens are the same ones predicted in the approximation: they’re the tokens that follow the strings in the training corpus that yield similar feed-forward network outputs to the current prompt.\n\nLet’s look at an example that shows this. The following is the output distribution predicted by the approximation for the prompt, med me Aut (query index 33), using only the feed-forward network outputs from the final block:\n\n\nHelper function to perform the approximation for a single query in a single block.\ndef perform_approximation(block_idx: int, q_idx: int) -&gt; torch.Tensor:\n    # Find similar strings\n    similar_indices = filter_on_prefiltered_results(\n        load_prefiltered=lambda q_idx: load_prefiltered_data(block_idx, q_idx),\n        q_idx_start=q_idx,\n        q_idx_end=q_idx+1,\n        filter_fn=lambda values: values &gt; similarity_thresholds[block_idx]\n    )\n    similar_strings = [\n        [strings10[i] for i in indices]\n        for indices in similar_indices\n    ]\n\n    # Compute Probability Distribution from Similar Strings\n    total_freq_distribution = torch.stack(\n        [next_token_map10[string] for string in similar_strings[0]]\n    ).sum(dim=0)\n    prob_distribution = total_freq_distribution / total_freq_distribution.sum()\n\n    return prob_distribution, len(similar_strings[0])\n\n\n\n\nCode to plot output distribution for q_idx=33 in block 5\nblock_idx = 5\nq_idx = 33\nprob_distribution, _ = perform_approximation(block_idx, q_idx)\nplot_prob_distribution_for_tokens(prob_distribution, title=f'Probability Distribution from Approximation (block_idx={block_idx}, q_idx={q_idx}, prompt={repr(prompts[q_idx])})')\n\n\n\n\n\n\n\n\n\nBased on the strings in the training corpus with similar feed-forward network outputs at the final block, the approximation predicts o is the most likely next token and h is next.\nNext, we need to look at the feed-forward network output for the prompt in this block and determine which token subspaces it’s most oriented towards. I’m going to show a little code here, because I think it’s the best way to explain what’s going on. Readers who aren’t interested in the implementation can focus only on the output.\nFirst we need to actually grab the feed-forward outputs (we haven’t needed them so far because we’ve been working with precomputed/prefiltered similarity data). We’ll use some helper functions that provide easy access to the transformer’s intermediate representations:\n\n# Tokenize the strings\ntokens = encoding_helpers.tokenize_strings(prompts)\n\n# Embed the tokens\nembeddings = accessors.embed_tokens(tokens)\n\n# Instantiate TransformerAccessors\naccessors = TransformerAccessors(m, device)\n\n# Run them through the model with hooks attached that let us look at\n# intermediate values\n_, io_accessors = accessors.run_model(embeddings)\n\n# Grab the outputs of the ffwd networks at each layer\nffwd_outs = torch.stack([\n    io_accessors[block_idx].output('ffwd')[:, -1, :].clone()\n    for block_idx in range(n_layer)\n])\n\n# Free up some memory\ndel io_accessors\n_ = gc.collect()\n\nffwd_outs.shape\n\ntorch.Size([6, 20000, 384])\n\n\nTo determine which token subspaces the feed-forward network output aligns with, we’ll project it onto the subspace approximation for each token, then determine which projections are most similar to the original vector. To do this, we’ll need to get the projection matrix for the rank 1 approximation to each token subspace:\n\nThe code below uses the projection_matrix_for_rank_k_approximation() helper function, defined in the SVD helpers notebook.\n\n\nIn the case of a rank 1 approximation, the projection isn’t really necessary. We could just take the cosine similarity with the approximation vector, but I wanted to keep this code general because I tried out higher-dimensional approximations in other places.\n\n\nfilename_for_token = FilenameForToken(tokenizer)\nsubspace_dims = 1\nprojection_matrices = torch.stack([\n    projection_matrix_for_rank_k_approximation(\n        original_matrix=torch.load(\n            learned_embeddings_dir /  'no_blocks' / f\"{filename_for_token(token)}.pt\",\n            map_location=device,\n        )[:, 0, :],\n        k=subspace_dims,\n    )\n    for token in tokenizer.chars\n])\n\nNow we’ll perform the projections and find the top 5 most similar ones to the original feed-forward output vector:\n\nprojections = projection_matrices @ ffwd_outs[block_idx, q_idx, :]\nvalues, indices = torch.topk(\n    F.cosine_similarity(projections, ffwd_outs[block_idx][q_idx], dim=-1),\n    k=5,\n    dim=0,\n)\ntokens = [tokenizer.chars[i.item()] for i in indices]\nlist(zip(tokens, values.tolist()))\n\n[('o', 0.5074884295463562),\n ('h', 0.40787822008132935),\n ('i', 0.26926180720329285),\n ('u', 0.22823508083820343),\n ('y', 0.20325089991092682)]\n\n\nIt turns out that o and h are the most similar, indicating that the feed-forward network output is most oriented towards the subspaces for these tokens. And these are the same tokens that the approximation predicted from the strings with similar feed-forward network outputs (see the distribution above).\nAnother example, this time looking at query index 36 (if and thy), but staying in the final block:\n\n\nCode to plot output distribution for q_idx=36 in block 5\nblock_idx = 5\nq_idx = 36\nprob_distribution, _ = perform_approximation(block_idx, q_idx)\nplot_prob_distribution_for_tokens(prob_distribution, title=f'Probability Distribution from Approximation (block_idx={block_idx}, q_idx={q_idx}, prompt={repr(prompts[q_idx])})')\n\n\n\n\n\n\n\n\n\n\nprojections = projection_matrices @ ffwd_outs[block_idx, q_idx, :]\nvalues, indices = torch.topk(\n    F.cosine_similarity(projections, ffwd_outs[block_idx][q_idx], dim=-1),\n    k=5,\n    dim=0,\n)\ntokens = [tokenizer.chars[i.item()] for i in indices]\nlist(zip(tokens, values.tolist()))\n\n[(' ', 0.5869003534317017),\n ('s', 0.47689366340637207),\n ('\\n', 0.38412901759147644),\n ('$', 0.23048195242881775),\n ('a', 0.21783535182476044)]\n\n\nHere  (space), s, and \\n (newline) were the tokens predicted from what follows the strings with similar feed-forward outputs, and indeed these are the token subspaces most aligned with the prompt’s feed-forward output.\n\nAggregate Performance\nIn the previous section, I purposely picked examples that exhibit strong correlation between the approximation’s predictions and the most aligned subspaces, to illustrate the point most clearly. Of course, there are other examples for which the correlation is less strong. Rather than looking at specific cases, let’s try to get a sense of how well the correlation holds up across all 20,000 prompts.\nThis immediately leads to a question: what is the right measure of aggregate performance? Unfortunately, even if the hypothesis - that the prompt’s feed-forward output aligns with the subspaces for tokens predicted from the strings with similar feed forward outputs - is true, a few practical issues make it difficult to demonstrate objectively:\n\nWe don’t have exact definitions of the token subspaces, just imperfect, linear approximations.\nMagnitudes don’t line up: the tokens with the most probability mass in the approximation’s predictions don’t always correspond to the subspaces with the greatest cosine similarity (because of the imperfect approximations, because the adjustment required may be bigger or smaller for some tokens vs others based on the input embedding’s current alignment, because, as explained in the Mixing Subspace Approximations section, the model is more “sensitive” to some tokens than others).\n\nGiven these impediments, we can’t just do something simple like normalizing the cosine similarities and computing Hellinger distance with the predicted probability distribution.\nInstead, we need to devise a criterion on which to judge whether the data from a particular prompt supports the hypothesis or not. Then we can evaluate aggregate performance by how many of the 20,000 prompts satisfy the criterion. I experimented with several different approaches and in the end came up with this candidate criterion:\nHigh-level description: Do the subspaces for the tokens containing 90% of the probability mass in the approximation’s predictions appear in the top half of all token subspaces when ranked by cosine similarity with the prompt’s feed-forward output vector?\nExact definition:\n\nDefine top_n as the number of tokens required to cover at least 90% of the probability mass in the approximation’s predictions for this prompt.\nDefine n_subspaces as tokenizer.vocab_size // 2 (32, based on our 65-token vocabulary).\nDetermine: Are the subspaces for the first top_n tokens predicted by the approximation in the first n_subspaces subspaces ranked by cosine similarity with the prompt’s feed-forward output vector?\n\nAdmittedly, this is an arbitrary definition and reasonable people could debate any of the specifics. But I do think it gives as an indication of whether the data from a particular example prompt supports the hypothesis, while allowing for some of the measurement challenges noted above.\nI evaluated this criteria at three places: the outputs of blocks 6, 5, and 4, using projection matrices derived from learned embeddings at each of these places.\n\nI didn’t evaluate at earlier blocks because the GPU time required to learn embeddings at those blocks became prohibitive. The further back in the model, the bigger the computation graph that the learning algorithm needs to optimize over.\n\nThe table below shows the results:\n\nThe code that produced these results appears at the end of the approximation details notebook\n\n\n\n\nBlock\n# of Prompts Satisfying Criterion\n\n\n\n\n6\n16357 (81.78%)\n\n\n5\n10142 (50.71%)\n\n\n4\n7760 (38.80%)\n\n\n\nThese numbers aren’t exactly a ringing endorsement. As expected, they get worse the further back we go, probably due to the increased non-linearity.\n What if we always used the subspace approximations from the very end of the transformer (which are likely to be the most linear), even when comparing against feed-forward network outputs from earlier blocks? The results get better:\n\n\n\nBlock\n# of Prompts Satisfying Criterion\n\n\n\n\n6\n16357 (81.78%)\n\n\n5\n13652 (68.26%)\n\n\n4\n11630 (58.15%)\n\n\n3\n11469 (57.34%)\n\n\n2\n10404 (52.02%)\n\n\n1\n9942 (49.71%)\n\n\n\n\nLike many good findings, this one resulted from a bug. I accidentally ran the analysis using the projection matrices for the final part of the transformer with the feed-forward network outputs from earlier blocks and was surprised when the numbers turned out to be so good.\n\nIt’s valid to use the subspace approximations (and corresponding projection matrices) from the end of the transformer at earlier stages. All blocks operate in the same embedding space and each one seems to make a small refinement on the output of its predecessors, rather than wild changes in direction. So if any block’s feed-forward network output adjusts an embedding towards the subspaces for a set of tokens as defined at the end of the transformer, it is likely also adjusting it towards whatever the subspaces would be for those same tokens at the block where it operates.\n\nThe logit lens post, in the section “why? / is this surprising?” provides an explanation that supports this idea. In summary, the residual connections encourage the transformer to learn weights that operate within the same basis across blocks and the use of weight decay in training results in a computation that’s spread out over as many layers as possible, with each layer making only a small, incremental change.\n\nTo put these numbers in perspective, I investigated how likely it would be for the criterion I’ve defined here to be satisfied by chance. In other words, if we assume the hypothesis is false and that the cosine similarities between the feed-forward network output and the token subspace approximation vectors are random, rather than expressing meaningful relationships, how likely would it be for the criterion to still be satisfied?\nI ran a simulation of this, taking care to ensure that the distribution of randomly generated cosine similarities matches the real data, among other details. The implementation is at the end of the approximation details notebook. The final results are:\n\n\n\nBlock\nLikely % of Prompts Satisfying Criteria By Chance\n\n\n\n\n6\n20.76% ± 0.25%\n\n\n5\n20.55% ± 0.26%\n\n\n4\n18.37% ± 0.24%\n\n\n3\n18.20% ± 0.24%\n\n\n2\n17.04% ± 0.23%\n\n\n1\n16.31% ± 0.23%\n\n\n\nSo the best performance numbers we have are clearly much better than chance. But in fairness, they’re still not a slam dunk.\nEven when we use approximations for the most linear subspaces we have, I think there is still a lot of noise in the measurement, for all the reasons outlined earlier in this section. Personally, I take the numbers to be overall supportive of the hypothesis, at least directionally, though I wish the evidence was more conclusive.\n\n\n\nFinal Summary of Correspondence Between Transformer and Approximation\nThe analyses in this post point towards two ideas. First, that the approximation and the transformer produce similar outputs. Second, that there is a correspondence between the approximation procedure and what the transformer is doing. I think the evidence for the first idea is quite strong. The evidence for the second is less clear cut, but still suggests it’s probably at least partially right.\nTo close, I want to provide a high-level summary of what I think that correspondence is, even if I can’t yet demonstrate it more definitively:\n\n\n\nConcept\nTransformer\nApproximation\n\n\n\n\nPrompts map to classes of strings in the training corpus.\nThe transformer learns an embedding scheme, along with weights in its self-attention and feed-forward networks, that cause strings in the training corpus with similar characteristics to produce similar output values. Prompts that share those characteristics also produce similar output values.\nThe approximation performs the same mapping as the transformer by examining the feed-forward network outputs from all substrings in the training corpus and identifying the ones similar to the outputs from a given prompt.\n\n\nPredictions for the tokens likely to follow a prompt derive from the frequency distribution of tokens that follow strings in the training corpus that produce feed-forward network output values similar to those of the prompt.\nA feed-forward network output is a compressed, latent representation, in the embedding space, of the frequency distribution of the tokens that follow strings in the training corpus that produce similar outputs. The weights in the final linear layer map the latent representation into logit space such that it become the correct probability distribution after applying the softmax operation.\nThe approximation reconstructs the same frequency distribution manually, by looking up the strings identified as having similar outputs in the training corpus and counting the tokens that follow them. Normalizing the frequency distribution turns it into a probability distribution.\n\n\nFinal output is a weighted sum of predictions from each block.\nAs shown earlier, the transformer output is roughly the vector sum of all feed-forward network outputs and the input embedding. The learned weights in the layers within a block determine the magnitude and direction of the output and thus how much it influences the overall direction of the final sum.\nThe approximation performs a weighted sum of the distributions determined for each block. The weights control the degree of influence of any given block and are manually selected to produce results as close to the transformer’s as possible.\n\n\n\n\n\nWhat About Attention?\nI began this post by observing that most explanations of how transformers work focus on attention but don’t say how attention results turn into the final predictions. I may be guilty of the opposite: I’ve written at length about how the transformers produce their output probabilities and said very little about attention.\nTo wrap up the analysis, I’d like to rectify this with a few words about attention. In the mechanism I’ve laid out, whether executed in the form of the approximation or the transformer, a key operation is mapping the prompt to a class of strings from the training corpus at each block. Predictions for the next token follow directly from the distribution of tokens that follow those strings in the training corpus. Making good predictions depends on mapping the prompt to the right class of training corpus strings. And that is the job of self-attention.\nThe self-attention layers learn to identify patterns across the tokens that make up a prompt. Those patterns might be simple, such as a common sequence appearing at the beginning or end of the prompt (for example, as we saw earlier, strings that end in ‘y l’). They can also be more general: instead of matching specific tokens, they might match kinds of tokens, such as vowels or capitals, in specific places. The learned weights in the attention heads determine which patterns they respond to, and thus which strings in the training corpus produce similar values. The output of the self-attention heads, when passed through the feed-forward network, yield representations in embedding space that encode information about the distribution of tokens in the training corpus that follow those strings.\nBecause the transformer has multiple blocks and each block has multiple attention heads (6 blocks and 6 heads per block in the one we looked at), it’s possible to evaluate each prompt against a large number of different potential patterns. The richness and diversity of the patterns that the attention heads can identify gives the transformer its predictive power.",
    "crumbs": [
      "blog_posts",
      "Beyond Self-Attention: How a Small Language Model Predicts the Next Token"
    ]
  },
  {
    "objectID": "blog_posts/beyond-self-attention.html#closing-thoughts",
    "href": "blog_posts/beyond-self-attention.html#closing-thoughts",
    "title": "Beyond Self-Attention: How a Small Language Model Predicts the Next Token",
    "section": "Closing Thoughts",
    "text": "Closing Thoughts\nI started this project because I wanted to understand the transformer architecture. It’s given me a satisfying explanation of what at least one transformer is doing, but has been even more fruitful as an exercise in learning how to learn. This was my first foray into an open-ended ML research project on my own. It taught me how to interrogate the internals of models, how to set up experiments to answer questions, and, perhaps most importantly, how to keep moving the project forward when I felt stuck.\nLanguage models have always seemed magical to me, from the first time I used ChatGPT. I wondered if finding a reductive explanation for what happens internally would rob them of their magic. In fact, I think the opposite has happened. I’ve come to appreciate the beauty in an elegantly simple mechanism that produces such rich complexity in its outputs.\nI don’t know whether the results I found here have any generality beyond the small transformer I trained or if any of it will be of use to anyone else. Regardless, it’s been a joy to do this work and I’m grateful to have had the things I needed along the way: time, resources, and endless support from my family and mentors.",
    "crumbs": [
      "blog_posts",
      "Beyond Self-Attention: How a Small Language Model Predicts the Next Token"
    ]
  },
  {
    "objectID": "blog_posts/beyond-self-attention.html#appendices",
    "href": "blog_posts/beyond-self-attention.html#appendices",
    "title": "Beyond Self-Attention: How a Small Language Model Predicts the Next Token",
    "section": "Appendices",
    "text": "Appendices\n\nI: Model Details\nSome notable specs:\n\nVocabulary size: 65 (the unique characters in the TinyShakespeare dataset)\nEmbedding size (n_embed): 384\nNumber of transformer blocks (n_layer): 6\nNumber of attention heads (n_head): 6\nContext window size (block_size): 256\n\nThe feed-forward networks comprise over 65% of the total trainable parameters:\n\nall_trainable_params = [p for p in m.parameters() if p.requires_grad]\nn_all_trainable_params = sum([np.prod(p.size()) for p in all_trainable_params])\n\nffwd_trainable_params = [\n    p\n    for block_idx in range(n_layer)\n    for p in m.blocks[block_idx].ffwd.parameters()\n    if p.requires_grad\n]\nn_ffwd_trainable_params = sum([np.prod(p.size()) for p in ffwd_trainable_params])\n\nprint(\n    f\"{n_ffwd_trainable_params:,} ffwd params out of {n_all_trainable_params:,} total params ({n_ffwd_trainable_params / n_all_trainable_params:.2%})\"\n)\n\n7,089,408 ffwd params out of 10,788,929 total params (65.71%)\n\n\n\n\nII: Evaluation of Main Model vs 3 Alternate Models\nAs described in the Evaluation section, I trained the same transformer architecture used for the main model in this post three additional times, starting from a different random seed each time. This appendix shows the code used to measure the average Hellinger distance between the output of the main models and each of the three alternates, across the 20,000 sample prompts. The results provide a plausible lower bound for the threshold Hellinger distance that indicates a meaningful change in an output probability distribution.\nFirst, we instantiate the three alternate models from their saved weights:\n\nalt_models_dir = environment.data_root / 'alternate-models/model-training/20240112-training/outputs/'\nassert alt_models_dir.exists(), \"Alternate models directory does not exist. Run the training code in ../experiments/alternate-models.ipynb.\"\n\n\n# Instantiate the three alternative trained models\nm_alt1, _ = create_model_and_tokenizer(\n    saved_model_filename=alt_models_dir / 'shakespeare-20240112-1.pt',\n    dataset=ts,\n    device=device,\n)\nm_alt2, _ = create_model_and_tokenizer(\n    saved_model_filename=alt_models_dir / 'shakespeare-20240112-2.pt',\n    dataset=ts,\n    device=device,\n)\nm_alt3, _ = create_model_and_tokenizer(\n    saved_model_filename=alt_models_dir / 'shakespeare-20240112-3.pt',\n    dataset=ts,\n    device=device,\n)\n\nNext, we feed the input tokens into the original model and the three alternate models and get their output probability distributions:\n\n\nHelper function to get the model’s output probability distribution for a batch of tokenized inputs.\ndef get_model_probs(model: TransformerLanguageModel, tokens: torch.Tensor):\n    \"\"\"Helper function to get a model's output probability distribution for a\n    batch of tokenized inputs.\"\"\"\n    logits, _ = model(tokens)\n    logits = LogitsWrapper(logits.detach(), tokenizer)\n    return logits.probs()[:, -1, :] # We'e only interested in the last token\n\n\n\ntokens = encoding_helpers.tokenize_strings(prompts)\n\nmodel_probs = get_model_probs(m, tokens)\nalt_model_probs1 = get_model_probs(m_alt1, tokens)\nalt_model_probs2 = get_model_probs(m_alt2, tokens)\nalt_model_probs3 = get_model_probs(m_alt3, tokens)\n\nNow we can compute the Hellinger distance between the outputs from the three alternative models and the outputs from the original model. Remember that each of the model probabilities tensors (model_probs and alt_model_probs*) is a 20,000x65 tensor i.e. 20,000 probability distributions of 65 elements each.\nWe’re computing the Hellinger distance between those probability distributions. So for each alternative model, we end up with 20,000 Hellinger distance values. These values tell us, for each prompt, how the probability distribution for the next token predicted by one of the alternate models differed from the probability distribution predicted by the original model.\n\nh_alt1 = hellinger_distance(model_probs, alt_model_probs1)\nh_alt2 = hellinger_distance(model_probs, alt_model_probs2)\nh_alt3 = hellinger_distance(model_probs, alt_model_probs3)\n\nWith the Hellinger distances computed, we can look at aggregate stats:\n\nh_alts = torch.stack([h_alt1, h_alt2, h_alt3], dim=1)\nh_alts.mean(dim=0), h_alts.std(dim=0), h_alts.min(dim=0).values, h_alts.max(dim=0).values\n\n(tensor([0.1064, 0.1057, 0.1053]),\n tensor([0.0823, 0.0817, 0.0828]),\n tensor([0.0005, 0.0008, 0.0008]),\n tensor([0.8351, 0.7881, 0.8743]))\n\n\nFor all three alternate models, the average Hellinger distance was ~0.11 ± 0.08. All had very small minimums (&lt;= 0.0008) and maximums around ~0.80.\n\n\nIII: The Output Embedding’s Norm Doesn’t Matter Because of the Final LayerNorm\nThis appendix demonstrates the assertion from the Transformation via Vector Addition that the norm of the output embeddings from the final transformer block does not matter, because of the LayerNorm before the final linear layer.\nTo begin, let’s grab the final block outputs for the first 1000 prompts:\n\n# Get the block outputs for the first 1000 prompts\n\ntokens_sample = encoding_helpers.tokenize_strings(prompts[:1000])\n_, io_accessors_sample = accessors.run_model(accessors.embed_tokens(tokens_sample))\n\nfinal_block_outputs = io_accessors_sample[-1].output('.')[:, -1, :].clone()\n\ndel io_accessors_sample\n_ = gc.collect()\n\nfinal_block_outputs.shape\n\ntorch.Size([1000, 384])\n\n\nNext, let’s create a copy of those outputs scaled by a factor of 10:\n\nscaled_final_block_outputs = final_block_outputs * 10\nscaled_final_block_outputs.shape\n\ntorch.Size([1000, 384])\n\n\nComparing average norms, we see that those of the scaled outputs indeed are 10 times bigger:\n\nfinal_block_outputs.norm(dim=-1).mean(), scaled_final_block_outputs.norm(dim=-1).mean()\n\n(tensor(22.8909), tensor(228.9091))\n\n\nNow, let’s put both the original and scaled outputs through the final LayerNorm of the model and calculate the average norm of the results:\n\nlayer_normed_original = m.ln_f(final_block_outputs).detach()\nlayer_normed_scaled = m.ln_f(scaled_final_block_outputs).detach()\n\nlayer_normed_original.norm(dim=-1).mean(), layer_normed_scaled.norm(dim=-1).mean()\n\n(tensor(23.1262), tensor(23.1263))\n\n\nThey’re virtually identical.\nIn the preceding example, the output norms were so close to identical because the two inputs differed only in scale: they had the same direction, or cosine similarity of 1. Vectors that have different norms and different directions will emerge from the LayerNorm with norms that are still quite similar but a little further apart.\nTo see an example, we can add a little noise to one of the vectors and then scale it:\n\noriginal_vector = final_block_outputs[0]\n\n# Add some random noise to the original vector\ntorch.manual_seed(42) # keep the noise consistent\ncomparison_vector = original_vector + torch.randn_like(original_vector) * 0.1\n\n# And scale it\ncomparison_vector = comparison_vector / comparison_vector.norm()\ncomparison_vector *= 10 * original_vector.norm()\n\noriginal_vector.norm(), comparison_vector.norm(), F.cosine_similarity(original_vector, comparison_vector, dim=-1)\n\n(tensor(23.7909), tensor(237.9092), tensor(0.9967))\n\n\nThe comparison_vector’s norm is exactly 10x that of original_vector, but they’re not perfectly aligned in direction, though still quite close.\n\nm.ln_f(original_vector).detach().norm(), m.ln_f(comparison_vector).detach().norm()\n\n(tensor(23.1496), tensor(23.1671))\n\n\nTheir norms after layer norm are close but further apart than in the previous example.\nIf we add a lot more noise, we’ll end up with two vectors with quite different directions:\n\noriginal_vector = final_block_outputs[0]\n\n# Add some random noise to the original vector\ntorch.manual_seed(4211) # keep the noise consistent\ncomparison_vector = original_vector + torch.randn_like(original_vector) * 2\n\n# And scale it\ncomparison_vector = comparison_vector / comparison_vector.norm()\ncomparison_vector *= 10 * original_vector.norm()\n\noriginal_vector.norm(), comparison_vector.norm(), F.cosine_similarity(original_vector, comparison_vector, dim=-1)\n\n(tensor(23.7909), tensor(237.9093), tensor(0.5178))\n\n\nBut their norms after layer norm are only a little more divergent:\n\nm.ln_f(original_vector).detach().norm(), m.ln_f(comparison_vector).detach().norm()\n\n(tensor(23.1496), tensor(23.0546))\n\n\nSo in summary:\n\nThe LayerNorm will remove substantial differences in input norms.\nNorms of the outputs from the LayerNorm will vary a little depending on how closely aligned the input vectors were.\n\n\n\nIV: Summary of Experiment on Relative Impact of Self-Attention and Feed Forward Network Outputs\nThe embedding adjustments analysis notebook contains the implementation of an experiment to understand the relative impact of the self-attention outputs and the feed-forward network outputs on the final output of the transformer. This appendix summarizes the experiment and the results.\nExperiment procedure:\n\nI ran all 20,000 prompts through the model and captured the final output probability distributions as well as the intermediate self-attention outputs, feed-forward network outputs, and final block outputs for each block.\nFor each block, I then ran two tests. First, instead of sending the block output as normally implemented (x + sa_out + ffwd_out, as shown earlier) to the next stage of the model, I sent a version that omits the self-attention output i.e. just x + ffwd_out, and saved the final output probability distribution that resulted. Then, I did the same thing but removed the feed-forward network output instead, sending on just x + sa_out.\nI then calculated the Hellinger distance between the probability distribution produced with the regular block output and that produced by each of the two modifications.\n\nThe table below shows the results, averaged across all 20,000 prompts:\n\nFor the implementation of this analysis, see embedding adjustments analysis notebook\n\n\n\n\n\n\n\n\n\nBlock\nH(output(x+sa_out+ffwd_out), output(x+ffwd_out))\nH(output(x+sa_out+ffwd_out), output(x+sa_out))\n\n\n\n\n1\n0.11 ± 0.07\n0.70 ± 0.17\n\n\n2\n0.07 ± 0.04\n0.19 ± 0.11\n\n\n3\n0.09 ± 0.07\n0.15 ± 0.10\n\n\n4\n0.06 ± 0.05\n0.13 ± 0.10\n\n\n5\n0.04 ± 0.03\n0.14 ± 0.10\n\n\n6\n0.03 ± 0.03\n0.17 ± 0.10\n\n\n\n\nRemember that Hellinger distance ranges between 0 and 1, with 0 meaning identical and 1 meaning no overlap. A larger Hellinger distance in this table means a larger divergence between the experiment output and the normal transformer output.\n\nThe effect is most pronounced in the first block: omitting the feed-forward network output results in an almost completely different probability distribution (H = 0.70) but omitting the self-attention output results in a very similar distribution (H = 0.11). Across the rest of the layers, the difference is less dramatic, but the feed-forward network output always has the larger impact.\n\nThough I think these results support the notion that an approximation based only on feed-forward network outputs can produce similar results to the transformer, it would be interesting to see if the approximation would improve if we include the self-attention outputs, particularly for some of the intermediate layers. But I’m leaving that as an area for future investigation.\n\n\n\nV: Performing SVD to Get a Linear Approximation of a Token Subspace\nThis appendix walks through an example of how we can find a linear approximation for a token subspace using SVD. First, let’s load all the embeddings learned for the token a at the output of the last block of the transformer (input to the final layer norm and linear layer):\n\nlearned_embeddings_dir = environment.data_root / 'learned_embeddings'\nmulti_emb_a = torch.load(learned_embeddings_dir / 'no_blocks' / 'lower_a.pt', map_location=device)\nmulti_emb_a.shape\n\ntorch.Size([100, 1, 384])\n\n\nWe’ve got 100 different 384-dimensional embedding vectors. Each one, when given as input to the final blocks in the transformer, produces an output distribution that assigns nearly all the probability mass to the token, a. Each one can be thought of as a point in the subspace for token a.\nWe can stack these embeddings form a 100x384 matrix:\n\\[\n\\begin{bmatrix}\n    e_{1,1} & e_{1,2} & \\dots  & e_{1,384} \\\\\n    e_{2,1} & e_{2,2} & \\dots  & e_{2,384} \\\\\n    \\vdots & \\vdots & \\ddots & \\vdots \\\\\n    e_{100,1} & e_{100,2} & \\dots & e_{100,384}\n\\end{bmatrix}\n\\]\nNext, we can run SVD on this matrix:\n\n_, S, V = torch.linalg.svd(multi_emb_a[:, -1, :])\n\nFor this analysis, we’re only interested in the singular values (S) and the right singular vectors (V). We can plot the singular values:\n\n_ = plt.plot(S.numpy(), '-o')\n\n\n\n\n\n\n\n\nThe first singular value is much larger (over 6x) than the next, which suggests the first right singular vector alone might be a good approximation for the subspace that predicts token a. We can test what gets predicted when we use this first right singular vector as an embedding:\n\nv0a = adjust_singular_vector_sign(V[0], multi_emb_a[:, -1, :])\nlogits = LogitsWrapper(accessors.logits_from_embedding(unsqueeze_emb(v0a)), tokenizer)\nlogits.plot_probs(title='Next Token Probability Distribution from First Right Singular Vector of embeddings for Token \"a\"')\n\n\n\n\n\n\n\n\nIn this distribution, a has probability near 1 and every other token has probability near 0. So the first right singular vector is effectively another embedding that produces an output predicting a with near certainty.\nBut it’s different from the other 100 learned embeddings in an important way: it’s the vector that is best aligned with all of them. More formally, it’s the vector that minimizes the squared distance to all 100 other embedding vectors. In this way, the first right singular vector is like a good summary of the embedding vectors we started from.\nThe first right singular vector is a unit vector (as are all the singular vectors):\n\nv0a.norm()\n\ntensor(1.0000)\n\n\nAny vector along its span will produce an output distribution predicting a, similar to the one above (see Appendix III for an explanation of why the transformer output is invariant to the scale of the final embedding). So the span of this vector is a good, linear approximation to the subspace for token a.\nThe same results we saw here for token a hold for the other tokens too. For each, if we stack all the learned embeddings and perform SVD, we find that the first right singular vector forms a good linear approximation of the token subspace.",
    "crumbs": [
      "blog_posts",
      "Beyond Self-Attention: How a Small Language Model Predicts the Next Token"
    ]
  },
  {
    "objectID": "models/transformer.html",
    "href": "models/transformer.html",
    "title": "transformer",
    "section": "",
    "text": "The code in this notebook (transformer.ipynb) and the resulting module (transformer_experiments.models.transformer) is not mine. It comes from Andrej Karpathy’s excellent video, Let’s build GPT: from scratch, in code, spelled out. I typed in the code by copying what I saw on the screen as I watched the video. For things that weren’t clear onscreen, I referenced the GitHub repo for the video and the nanoGPT repo. After getting it working, I made only minor changes to make it work with the rest of the code in/structure of this repository. In summary: this module is Andrej Karpathy’s work, not mine.\n\n# Not exported - these are used only for training\nfrom datetime import datetime\nfrom functools import partial\nfrom pathlib import Path\n\nfrom transformer_experiments.dataset_split import split_text_dataset\nfrom transformer_experiments.datasets.tinyshakespeare import (\n    TinyShakespeareDataSet,\n)\nfrom transformer_experiments.environments import get_environment\nfrom transformer_experiments.tokenizers.char_tokenizer import CharacterTokenizer\nfrom transformer_experiments.training_utils import (\n    CheckPointer,\n    GetBatchFunction,\n    Trainer,\n)",
    "crumbs": [
      "models",
      "transformer"
    ]
  },
  {
    "objectID": "models/transformer.html#attribution",
    "href": "models/transformer.html#attribution",
    "title": "transformer",
    "section": "",
    "text": "The code in this notebook (transformer.ipynb) and the resulting module (transformer_experiments.models.transformer) is not mine. It comes from Andrej Karpathy’s excellent video, Let’s build GPT: from scratch, in code, spelled out. I typed in the code by copying what I saw on the screen as I watched the video. For things that weren’t clear onscreen, I referenced the GitHub repo for the video and the nanoGPT repo. After getting it working, I made only minor changes to make it work with the rest of the code in/structure of this repository. In summary: this module is Andrej Karpathy’s work, not mine.\n\n# Not exported - these are used only for training\nfrom datetime import datetime\nfrom functools import partial\nfrom pathlib import Path\n\nfrom transformer_experiments.dataset_split import split_text_dataset\nfrom transformer_experiments.datasets.tinyshakespeare import (\n    TinyShakespeareDataSet,\n)\nfrom transformer_experiments.environments import get_environment\nfrom transformer_experiments.tokenizers.char_tokenizer import CharacterTokenizer\nfrom transformer_experiments.training_utils import (\n    CheckPointer,\n    GetBatchFunction,\n    Trainer,\n)",
    "crumbs": [
      "models",
      "transformer"
    ]
  },
  {
    "objectID": "models/transformer.html#hyperparameters",
    "href": "models/transformer.html#hyperparameters",
    "title": "transformer",
    "section": "Hyperparameters",
    "text": "Hyperparameters",
    "crumbs": [
      "models",
      "transformer"
    ]
  },
  {
    "objectID": "models/transformer.html#model-definition",
    "href": "models/transformer.html#model-definition",
    "title": "transformer",
    "section": "Model Definition",
    "text": "Model Definition\n\nsource\n\nHead\n\n Head (head_size)\n\nOne self-attention head\n\nsource\n\n\nMultiHeadAttention\n\n MultiHeadAttention (num_heads, head_size)\n\nMultiple heads of self attention in parallel\n\nsource\n\n\nFeedForward\n\n FeedForward (n_embed)\n\nThe feed-forward network at the end of a block\n\nsource\n\n\nBlock\n\n Block (n_embed, n_head)\n\nOne transformer block\n\nsource\n\n\nTransformerLanguageModel\n\n TransformerLanguageModel (vocab_size:int, device:str)\n\nThe full transformer language model, tying all the pieces together.",
    "crumbs": [
      "models",
      "transformer"
    ]
  },
  {
    "objectID": "models/transformer.html#training",
    "href": "models/transformer.html#training",
    "title": "transformer",
    "section": "Training",
    "text": "Training\n\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nprint(f\"device is {device}\")\n\ndevice is cuda\n\n\n\nenvironment = get_environment()\nprint(f\"environment is {environment.name}\")\n\nenvironment is paperspace\n\n\n\nts = TinyShakespeareDataSet(environment.code_root / 'nbs/artifacts/input.txt')\ntokenizer = CharacterTokenizer(ts.text)\n\n\ntrain_data, val_data = split_text_dataset(ts.text, tokenizer, train_pct=0.9, device=device)\n\n\nsource\n\nget_batch\n\n get_batch (batch_size:int, block_size:int, split:str,\n            train_data:torch.Tensor, val_data:torch.Tensor, device:str)\n\n\nsource\n\n\nestimate_loss\n\n estimate_loss (model:__main__.TransformerLanguageModel, eval_iters:int,\n                get_batch_func:transformer_experiments.training_utils.GetB\n                atchFunction)\n\n\ntraining_root = environment.data_root / 'model-training' / f'{datetime.now().strftime(\"%Y%m%d\")}-training'\ntraining_root.mkdir(exist_ok=True, parents=True)\n\n\ncheckpoint_dir = training_root / 'training_checkpoints'\ncheckpoint_dir.mkdir(exist_ok=True, parents=True)\n\n\nget_batch_func = partial(\n    get_batch,\n    batch_size=batch_size,\n    block_size=block_size,\n    train_data=train_data,\n    val_data=val_data,\n    device=device,\n)\nestimate_loss_func = partial(\n    estimate_loss, eval_iters=eval_iters, get_batch_func=get_batch_func\n)\n\n\ntorch.manual_seed(1337)\nm = TransformerLanguageModel(vocab_size=tokenizer.vocab_size, device=device)\n\n\n_ = m.to(device)\n\n\ntrainer = Trainer(\n    model=m,\n    checkpointer=CheckPointer(checkpoint_dir, 'shakespeare_checkpoint'),\n    get_batch_func=get_batch_func,\n    estimate_loss_func=estimate_loss_func,\n    iters_trained=0,\n)\n\n\n# We want to save the batches the model was trained against.\nbatch_history = []\nn_batch_histories_saved = 0\nbatch_history_dir = training_root / 'batch_histories'\nbatch_history_dir.mkdir(exist_ok=True, parents=True)\n\ndef on_batch_trained(iters_trained: int, batch: torch.Tensor):\n    batch_history.append(batch.clone())\n\ndef on_checkpoint_saved(iters_trained: int, checkpoint_file: Path):\n    global n_batch_histories_saved\n    torch.save(\n        {\n            'batch_history': torch.stack(batch_history),\n            'checkpoint_filename': checkpoint_file.name\n        },\n        batch_history_dir / f'batch_history_{n_batch_histories_saved:04d}.pt'\n    )\n    n_batch_histories_saved += 1\n    batch_history.clear()\n\ntrainer.add_on_batch_trained_handler(on_batch_trained)\ntrainer.add_on_checkpoint_saved_handler(on_checkpoint_saved)\n\n\n# Get a starting point\nestimate_loss_func(m)\n\n{'train': tensor(4.2221), 'val': tensor(4.2306)}\n\n\n\n# Start with a modest learning rate and train 5000 iterations\nlearning_rate = 3e-4\noptimizer = torch.optim.AdamW(m.parameters(), lr=learning_rate)\ntrainer.train(3500, optimizer, eval_interval=eval_interval)\n\n\n\n\nstep 499: train loss 1.7421, val loss 1.9060\nstep 999: train loss 1.3937, val loss 1.6067\nstep 1499: train loss 1.2651, val loss 1.5243\nstep 1999: train loss 1.1887, val loss 1.5084\nstep 2499: train loss 1.1210, val loss 1.4871\nstep 2999: train loss 1.0723, val loss 1.4876\nstep 3499: train loss 1.0190, val loss 1.5104\n\n\nLooks like it’s starting to overfit. Let’s reduce the learning rate and see if we can improve without getting worse on the validation set.\n\nlearning_rate = 3e-5\noptimizer = torch.optim.AdamW(m.parameters(), lr=learning_rate)\ntrainer.train(3500, optimizer, eval_interval=eval_interval)\n\n\n\n\nstep 499: train loss 0.9530, val loss 1.4986\nstep 999: train loss 0.9334, val loss 1.5063\nstep 1499: train loss 0.9159, val loss 1.5089\nstep 1999: train loss 0.9019, val loss 1.5176\nstep 2499: train loss 0.8872, val loss 1.5231\nstep 2999: train loss 0.8716, val loss 1.5384\nstep 3499: train loss 0.8588, val loss 1.5366",
    "crumbs": [
      "models",
      "transformer"
    ]
  },
  {
    "objectID": "models/transformer.html#extract-and-save-model-from-checkpoint",
    "href": "models/transformer.html#extract-and-save-model-from-checkpoint",
    "title": "transformer",
    "section": "Extract and save model from checkpoint",
    "text": "Extract and save model from checkpoint\n\nenvironment = get_environment()\nprint(f\"environment is {environment.name}\")\n\nenvironment is local_mac\n\n\n\ntraining_root = environment.data_root / 'model-training' / f'20231112-training'\ncheckpoint_dir = training_root / 'training_checkpoints'\n\n\n# Save model from checkpoint\ncheckpoint = torch.load(checkpoint_dir / 'shakespeare_checkpoint_000008.pt', map_location=torch.device('cpu'))\ncheckpoint['iters'], checkpoint['train_loss'], checkpoint['val_loss']\n\n(4500, tensor(0.9334), tensor(1.5063))\n\n\n\ntorch.save(checkpoint['model_state_dict'], environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt')",
    "crumbs": [
      "models",
      "transformer"
    ]
  },
  {
    "objectID": "models/transformer-helpers.html",
    "href": "models/transformer-helpers.html",
    "title": "transformer-helpers.ipynb",
    "section": "",
    "text": "# Not exported because only used for testing within this notebook\nfrom transformer_experiments.datasets.tinyshakespeare import (\n    TinyShakespeareDataSet,\n)\nfrom transformer_experiments.environments import get_environment\nfrom transformer_experiments.trained_models.tinyshakespeare_transformer import (\n    create_model_and_tokenizer\n)\n# Create a model for testing\nenvironment = get_environment()\nprint(f\"environment is {environment.name}\")\n\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nprint(f\"device is {device}\")\n\nts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\nm, tokenizer = create_model_and_tokenizer(\n    saved_model_filename=environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt',\n    dataset=ts,\n    device=device,\n)\n\nenvironment is local_mac\ndevice is cpu",
    "crumbs": [
      "models",
      "transformer-helpers.ipynb"
    ]
  },
  {
    "objectID": "models/transformer-helpers.html#helper-functions-for-encodingdecoding-strings",
    "href": "models/transformer-helpers.html#helper-functions-for-encodingdecoding-strings",
    "title": "transformer-helpers.ipynb",
    "section": "Helper functions for encoding/decoding strings",
    "text": "Helper functions for encoding/decoding strings\n\nsource\n\nEncodingHelpers\n\n EncodingHelpers (tokenizer:transformer_experiments.tokenizers.char_tokeni\n                  zer.CharacterTokenizer, device:str)\n\nHelper class that wraps a tokenizer and provides methods for encoding and decoding strings. The tokenizer just deals with regular Python types whereas this class deals with PyTorch tensors.\n\n# Tests for encoding helpers\nencoding_helpers = EncodingHelpers(tokenizer, device)\ntokenized = encoding_helpers.tokenize_string('hello')\ntest_eq(tokenized.shape, (1, 5))\ntest_eq(tokenized.cpu(), torch.tensor([[46, 43, 50, 50, 53]]))\n\nstringified = encoding_helpers.stringify_tokens(tokenized[0])\ntest_eq(stringified, 'hello')\n\ntokenized = encoding_helpers.tokenize_strings(['hello', 'world'])\ntest_eq(tokenized.shape, (2, 5))\n\ntest_eq(tokenized.cpu(), torch.tensor([[46, 43, 50, 50, 53], [61, 53, 56, 50, 42]]))",
    "crumbs": [
      "models",
      "transformer-helpers.ipynb"
    ]
  },
  {
    "objectID": "models/transformer-helpers.html#helpers-for-dealing-with-embeddings",
    "href": "models/transformer-helpers.html#helpers-for-dealing-with-embeddings",
    "title": "transformer-helpers.ipynb",
    "section": "Helpers for dealing with embeddings",
    "text": "Helpers for dealing with embeddings\n\nsource\n\nunsqueeze_emb\n\n unsqueeze_emb (emb:torch.Tensor, expected_last_dim_size:int=384)\n\nA lot of things expect embedding tensors to have shape (B, T, X) where X is usually either n_embed or vocab_size. This function takes an embedding tensor that may be missing some of these dimensions and adds them as necessary.\n\n# Tests for unsqueeze_emb\nemb = torch.randn(5) # Wrong last dimension\nwith ExceptionExpected(ex=ValueError):\n    unsqueeze_emb(emb)\n\nemb = torch.randn(n_embed) # missing B and T dimensions\nemb = unsqueeze_emb(emb)\ntest_eq(emb.shape, (1, 1, n_embed))\n\nemb = torch.randn(1, n_embed) # missing B dimension\nemb = unsqueeze_emb(emb)\ntest_eq(emb.shape, (1, 1, n_embed))\n\nemb = torch.randn(3, n_embed) # missing B dimension, T is 3\nemb = unsqueeze_emb(emb)\ntest_eq(emb.shape, (1, 3, n_embed))\n\nemb = torch.randn(2, 3, n_embed) # nothing to change\nemb = unsqueeze_emb(emb)\ntest_eq(emb.shape, (2, 3, n_embed))\n\n# custom expected value for last dim\nemb = torch.randn(2, 3, 10) # nothing to change\nemb = unsqueeze_emb(emb, expected_last_dim_size=10)\ntest_eq(emb.shape, (2, 3, 10))",
    "crumbs": [
      "models",
      "transformer-helpers.ipynb"
    ]
  },
  {
    "objectID": "models/transformer-helpers.html#helpers-for-running-selective-parts-of-the-model",
    "href": "models/transformer-helpers.html#helpers-for-running-selective-parts-of-the-model",
    "title": "transformer-helpers.ipynb",
    "section": "Helpers for Running Selective Parts of the Model",
    "text": "Helpers for Running Selective Parts of the Model\nThe functions in this section enable running pieces of the model in isolation and introspecting their intermediate results. This is useful for debugging and understanding the model.\n\nsource\n\nInputOutputAccessor\n\n InputOutputAccessor (activations:Dict[str,Tuple])\n\nInitialize self. See help(type(self)) for accurate signature.\n\nsource\n\n\nTransformerAccessors\n\n TransformerAccessors\n                       (m:transformer_experiments.models.transformer.Trans\n                       formerLanguageModel, device:str)\n\nClass that provides methods for running pieces of a TransformerLanguageModel in isolation and introspecting their intermediate results.\n\n# Test embed tokens\nencoding_helpers = EncodingHelpers(tokenizer, device)\ns = 'hello'\ntokenized = encoding_helpers.tokenize_string(s)\n\naccessors = TransformerAccessors(m, device)\nembedded_from_tokens = accessors.embed_tokens(tokenized)\ntest_eq(embedded_from_tokens.shape, (1, len(s), n_embed))\n\n\n# Test check_valid_input_shape\naccessors = TransformerAccessors(m, device)\nemb = torch.randn(5) # Wrong last dimension\nwith ExceptionExpected(ex=ValueError):\n    accessors.check_valid_input_shape(emb)\n\nemb = torch.randn(n_embed) # missing B and T dimensions\nwith ExceptionExpected(ex=ValueError):\n    accessors.check_valid_input_shape(emb)\n\nemb = torch.randn(1, n_embed) # missing B dimension\nwith ExceptionExpected(ex=ValueError):\n    accessors.check_valid_input_shape(emb)\n\nemb = torch.randn(3, n_embed) # missing B dimension, T is 3\nwith ExceptionExpected(ex=ValueError):\n    accessors.check_valid_input_shape(emb)\n\nemb = torch.randn(2, 3, n_embed) # all good\naccessors.check_valid_input_shape(emb)\n\n\n# Test block copying\naccessors = TransformerAccessors(m, device)\nblock_idx = 0\nold_b = m.blocks[block_idx]\nnew_b, io_accessor = accessors.copy_block_from_model(block_idx)\ntest_eq(new_b is old_b, False)\n\nencoding_helpers = EncodingHelpers(tokenizer, device)\ntokens = encoding_helpers.tokenize_string('Citizen')\nx = accessors.embed_tokens(tokens)\nold_result = old_b(x).cpu().detach()\nnew_result = new_b(x).cpu().detach()\ntest_eq(old_result, new_result)\ntest_eq(io_accessor.input('.').cpu(), x.cpu())\ntest_eq(io_accessor.output('.').cpu(), new_result.cpu())\n\n\n# Test running the model\nencoding_helpers = EncodingHelpers(tokenizer, device)\naccessors = TransformerAccessors(m, device)\n\nprompt = 'Citizen'\ntokens = encoding_helpers.tokenize_string(prompt)\nx = accessors.embed_tokens(tokens)\nlogits, io_accessors = accessors.run_model(x)\n\ntest_eq(len(io_accessors), n_layer)\n\n# Run the model the normal way and make sure the logits are the same\norig_model_logits, _ = m(tokens)\ntest_eq(logits.cpu(), orig_model_logits.cpu().detach())\n\n\n# Test running model from block n\nencoding_helpers = EncodingHelpers(tokenizer, device)\naccessors = TransformerAccessors(m, device)\n\n# Run through the whole model once so that we can get valid\n# inputs for the intermediate blocks.\nprompt = 'Citizen'\ntokens = encoding_helpers.tokenize_string(prompt)\nx = accessors.embed_tokens(tokens)\nlogits, io_accessors = accessors.run_model(x)\n\n# Now run the model from each block in succession. Make sure the\n# logits are the same and that the number of accessors returned\n# is correct.\nfor n in range(n_layer):\n    x = io_accessors[n].input('.') # Grab the input to block n from the full model run\n    logits_from_blocks, io_accessors_from_blocks = accessors.run_model_from_block_n(x, n)\n    test_eq(len(io_accessors_from_blocks), n_layer - n)\n    test_eq(logits_from_blocks.cpu(), logits.cpu())",
    "crumbs": [
      "models",
      "transformer-helpers.ipynb"
    ]
  },
  {
    "objectID": "models/transformer-helpers.html#helpers-for-dealing-with-logits",
    "href": "models/transformer-helpers.html#helpers-for-dealing-with-logits",
    "title": "transformer-helpers.ipynb",
    "section": "Helpers for dealing with Logits",
    "text": "Helpers for dealing with Logits\n\nsource\n\nLogitsWrapper\n\n LogitsWrapper (logits:torch.Tensor, tokenizer:transformer_experiments.tok\n                enizers.char_tokenizer.CharacterTokenizer)\n\nA wrapper class around a tensor of logits that provides convenience methods for interpreting and visualizing them.\n\n# Tests for LogitsWrapper\n\n# Test that creating a LogitsWrapper from a tensor that doesn't have the B and T\n# dimensions results in an assertion error.\n\nlogits = torch.randn(tokenizer.vocab_size) # (vocab_size,)\nwith ExceptionExpected(ex=AssertionError):\n    LogitsWrapper(logits, tokenizer)\n\nlogits = torch.randn(2, tokenizer.vocab_size) # (2, vocab_size,) - missing B dimension\nwith ExceptionExpected(ex=AssertionError):\n    LogitsWrapper(logits, tokenizer)\n\n# Create a logits tensor where the tokens 'h' and 'm' have\n# equally high values.\nlogits = torch.zeros(1, 1, tokenizer.vocab_size) # (1, 1, vocab_size)\nlogits[0, 0, tokenizer.stoi['h']] = 100\nlogits[0, 0, tokenizer.stoi['m']] = 100\n\n# Create a logits wrapper\nlw = LogitsWrapper(logits, tokenizer)\n\n# Test that probs() returns the right things\nprobs = lw.probs()\ntest_eq(probs.shape, (1, 1, tokenizer.vocab_size))\ntest_close(probs[0, 0, tokenizer.stoi['h']], 0.5)\ntest_close(probs[0, 0, tokenizer.stoi['m']], 0.5)\n\n# Test that topk_tokens returns the right things\ntopk = lw.topk_tokens(k=2)[0][0]\ntokens, probs = zip(*topk)\ntest_eq(len(tokens), 2)\ntest_eq('h' in tokens, True)\ntest_eq('m' in tokens, True)\nfor p in probs:\n    test_close(p, 0.5)\n\n\n# \"Integration test\" for logits_from_embedding() and LogitsWrapper. The values\n# here will change if the model weights change but otherwise should be stable.\nstrings = ['Citizen', 'ANTONIO']\n\ntokens_batch = torch.tensor(\n    [tokenizer.encode(s) for s in strings], dtype=torch.long, device=device\n)\n\naccessors = TransformerAccessors(m, device)\n\nembedded = accessors.embed_tokens(tokens_batch)\n\nlogits = accessors.logits_from_embedding(embedded)\nlw = LogitsWrapper(logits.cpu(), tokenizer)\n\nexpected_top_tokens = ['g', 'c', ' ', 'd', 'e']\ntopk = lw.topk_tokens(k=5)[0][-1]\ntokens, probs = zip(*topk)\ntest_eq(tokens, expected_top_tokens)\nexpected_probs = [\n    0.10404,\n    0.08742,\n    0.07204,\n    0.06139,\n    0.05398,\n]\nfor i, p in enumerate(probs):\n    test_close(p, expected_probs[i], eps=1e-5)\n\n\n# Make a plot - part of the \"integration test\" above\nb_i = 0\nlw.plot_probs(b_i=0, t_i=-1, title=f\"Probabilities from {repr(strings[b_i])} embedding\")",
    "crumbs": [
      "models",
      "transformer-helpers.ipynb"
    ]
  },
  {
    "objectID": "analyses/combining_token_subspaces.html",
    "href": "analyses/combining_token_subspaces.html",
    "title": "Combining Token Subspaces",
    "section": "",
    "text": "environment = get_environment()\nprint(f\"environment is {environment.name}\")\n\nenvironment is local_mac\n\n\n\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\nm, tokenizer = create_model_and_tokenizer(\n    saved_model_filename=environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt',\n    dataset=ts,\n    device=device,\n)\n_, val_data = split_text_dataset(ts.text, tokenizer, train_pct=0.9, device=device)\nencoding_helpers = EncodingHelpers(tokenizer, device)\naccessors = TransformerAccessors(m, device)\n\n\nlearned_embeddings_dir = environment.data_root / 'learned_embeddings'\nassert learned_embeddings_dir.exists(), \"Learned embeddings directory doesn't exist. Run the code in experiments/learn-embeddings.ipynb to learn embeddings.\"\n\n\nfilename_for_token = FilenameForToken(tokenizer)\n\n\n# Load embeddings for 'a' and 'b'\nembs_a = torch.load(learned_embeddings_dir / 'no_blocks' / f'{filename_for_token(\"a\")}.pt', map_location=device)[:, -1, :]\nembs_b = torch.load(learned_embeddings_dir / 'no_blocks' / f'{filename_for_token(\"b\")}.pt', map_location=device)[:, -1, :]\n\n# Perform SVD on both\n_, _, Va = torch.linalg.svd(embs_a)\n_, _, Vb = torch.linalg.svd(embs_b)\n\n# Grab the first singular vector from each and adjust the sign.\nv0a = adjust_singular_vector_sign(Va[0], embs_a)\nv0b = adjust_singular_vector_sign(Vb[0], embs_b)\n\nAt this point v0a and v0b serve as approximations for the token spaces for a and b respectively.\n\n# Helper to plot the probability distribution of next tokens from an embedding\ndef plot_probs(emb: torch.Tensor, title: str=''):\n    logits = LogitsWrapper(accessors.logits_from_embedding(unsqueeze_emb(emb)), tokenizer)\n    logits.plot_probs(title=title)\n\nPlot them just as a sanity check.\n\nplot_probs(v0a, title='v0a')\nplot_probs(v0b, title='v0b')\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWe’d expect that if we add v0a and v0b, we’d get a distribution that predicted 50% for ‘a’ and 50% for ‘b’. But alas:\n\nplot_probs(v0a+v0b, title='v0a + v0b')\n\n\n\n\n\n\n\n\nThey’re not quite even. And there are worse examples:\n\n# Load embeddings for 'g'\nembs_g = torch.load(learned_embeddings_dir / 'no_blocks' / f'{filename_for_token(\"g\")}.pt', map_location=device)[:, -1, :]\n\n# Perform SVD\n_, _, Vg = torch.linalg.svd(embs_g)\n\n# Grab the first singular vector from each and adjust the sign.\nv0g = adjust_singular_vector_sign(Vg[0], embs_g)\n\nplot_probs(v0a + v0g, title='v0a + v0g')\n\n\n\n\n\n\n\n\nThree factors contribute:\n\nThe approximations for the token spaces are not perfect.\nThe two vectors are not perfectly orthogonal. To the extent that v0a has a small component that points in the direction of v0b, the sum results in an overweighting of b.\nThe final linear layer of the model produces logits of different magnitudes for different tokens. For example, given v0a, the logit for a is ~18.2. The logit for b from v0b is ~19.5.\n\n1 is not something we can much about without expending a lot more resources to find a better approximation. But 2 and 3 we can compensate for.",
    "crumbs": [
      "analyses",
      "Combining Token Subspaces"
    ]
  },
  {
    "objectID": "analyses/combining_token_subspaces.html#preliminaries",
    "href": "analyses/combining_token_subspaces.html#preliminaries",
    "title": "Combining Token Subspaces",
    "section": "",
    "text": "environment = get_environment()\nprint(f\"environment is {environment.name}\")\n\nenvironment is local_mac\n\n\n\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\nm, tokenizer = create_model_and_tokenizer(\n    saved_model_filename=environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt',\n    dataset=ts,\n    device=device,\n)\n_, val_data = split_text_dataset(ts.text, tokenizer, train_pct=0.9, device=device)\nencoding_helpers = EncodingHelpers(tokenizer, device)\naccessors = TransformerAccessors(m, device)\n\n\nlearned_embeddings_dir = environment.data_root / 'learned_embeddings'\nassert learned_embeddings_dir.exists(), \"Learned embeddings directory doesn't exist. Run the code in experiments/learn-embeddings.ipynb to learn embeddings.\"\n\n\nfilename_for_token = FilenameForToken(tokenizer)\n\n\n# Load embeddings for 'a' and 'b'\nembs_a = torch.load(learned_embeddings_dir / 'no_blocks' / f'{filename_for_token(\"a\")}.pt', map_location=device)[:, -1, :]\nembs_b = torch.load(learned_embeddings_dir / 'no_blocks' / f'{filename_for_token(\"b\")}.pt', map_location=device)[:, -1, :]\n\n# Perform SVD on both\n_, _, Va = torch.linalg.svd(embs_a)\n_, _, Vb = torch.linalg.svd(embs_b)\n\n# Grab the first singular vector from each and adjust the sign.\nv0a = adjust_singular_vector_sign(Va[0], embs_a)\nv0b = adjust_singular_vector_sign(Vb[0], embs_b)\n\nAt this point v0a and v0b serve as approximations for the token spaces for a and b respectively.\n\n# Helper to plot the probability distribution of next tokens from an embedding\ndef plot_probs(emb: torch.Tensor, title: str=''):\n    logits = LogitsWrapper(accessors.logits_from_embedding(unsqueeze_emb(emb)), tokenizer)\n    logits.plot_probs(title=title)\n\nPlot them just as a sanity check.\n\nplot_probs(v0a, title='v0a')\nplot_probs(v0b, title='v0b')\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nWe’d expect that if we add v0a and v0b, we’d get a distribution that predicted 50% for ‘a’ and 50% for ‘b’. But alas:\n\nplot_probs(v0a+v0b, title='v0a + v0b')\n\n\n\n\n\n\n\n\nThey’re not quite even. And there are worse examples:\n\n# Load embeddings for 'g'\nembs_g = torch.load(learned_embeddings_dir / 'no_blocks' / f'{filename_for_token(\"g\")}.pt', map_location=device)[:, -1, :]\n\n# Perform SVD\n_, _, Vg = torch.linalg.svd(embs_g)\n\n# Grab the first singular vector from each and adjust the sign.\nv0g = adjust_singular_vector_sign(Vg[0], embs_g)\n\nplot_probs(v0a + v0g, title='v0a + v0g')\n\n\n\n\n\n\n\n\nThree factors contribute:\n\nThe approximations for the token spaces are not perfect.\nThe two vectors are not perfectly orthogonal. To the extent that v0a has a small component that points in the direction of v0b, the sum results in an overweighting of b.\nThe final linear layer of the model produces logits of different magnitudes for different tokens. For example, given v0a, the logit for a is ~18.2. The logit for b from v0b is ~19.5.\n\n1 is not something we can much about without expending a lot more resources to find a better approximation. But 2 and 3 we can compensate for.",
    "crumbs": [
      "analyses",
      "Combining Token Subspaces"
    ]
  },
  {
    "objectID": "analyses/combining_token_subspaces.html#compensating-for-non-orthogonality",
    "href": "analyses/combining_token_subspaces.html#compensating-for-non-orthogonality",
    "title": "Combining Token Subspaces",
    "section": "Compensating for Non-Orthogonality",
    "text": "Compensating for Non-Orthogonality\nLet’s look at the orthogonality of the vectors for b and g relative to a:\n\nv0a.dot(v0b), v0a.dot(v0g)\n\n(tensor(0.0054), tensor(-0.0317))\n\n\nIf they were orthogonal, we’d expect the dot products to be zero. They are close to zero, but \\(v0a \\cdot v0b\\) is an order of magnitude closer to zero than \\(v0a \\cdot v0g\\).\nLet’s see what happens if we adjust v0a to make it orthogonal to v0b by removing the component that’s in line with v0b:\n\nv0a_orth_v0b = v0a - v0a.dot(v0b) * v0b\nplot_probs(v0a_orth_v0b, title='v0a_orth_v0b')\nplot_probs(v0a_orth_v0b + v0b, title='v0a_orth_v0b + v0b')\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nAfter removing the component in the direction of v0b, what’s left of v0a still results in a distribution that selects a with near certainty. And when we add them, we get much closer to a 50/50 split. Let’s try the same with v0g:\n\nv0a_orth_v0g = v0a - v0a.dot(v0g) * v0g\nplot_probs(v0a_orth_v0g, title='v0a_orth_v0g')\nplot_probs(v0a_orth_v0g + v0g, title='v0a_orth_v0g + v0g')\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSadly, this doesn’t help, and in fact seems to make things a little worse. We’ve got to look at the logit magnitude too.",
    "crumbs": [
      "analyses",
      "Combining Token Subspaces"
    ]
  },
  {
    "objectID": "analyses/combining_token_subspaces.html#compensating-for-logit-magnitude",
    "href": "analyses/combining_token_subspaces.html#compensating-for-logit-magnitude",
    "title": "Combining Token Subspaces",
    "section": "Compensating for Logit Magnitude",
    "text": "Compensating for Logit Magnitude\nLet’s look at what logit values are produced from each of the vectors:\n\nlogit_for_char = lambda v, char: accessors.logits_from_embedding(unsqueeze_emb(v))[0, 0, tokenizer.stoi[char]]\n(\n    logit_for_char(v0a, 'a'),\n    logit_for_char(v0b, 'b'),\n    logit_for_char(v0g, 'g'),\n)\n\n(tensor(18.1589), tensor(19.5089), tensor(21.7159))\n\n\nFor a, the relevant logit is ~18.2 vs ~19.5 for b and ~21.7 for g. These may seem like small differences but the softmax function really exaggerates them. We can see this with some sample data where all the elements are -1 except for index 2 which is 18.2 and index 5 which is 19.5:\n\ntest_data = torch.zeros(10)\ntest_data = test_data - 1\ntest_data[2] = 18.2\ntest_data[5] = 19.5\n_ = plt.plot(F.softmax(test_data, dim=0).numpy(), '-o')\n\n\n\n\n\n\n\n\nThe effect when it’s 18.2 vs 21.7 (g’s logit value) is even more stark:\n\ntest_data[5] = 21.7\n_ = plt.plot(F.softmax(test_data, dim=0).numpy(), '-o')\n\n\n\n\n\n\n\n\nSo these small difference have a big impact. What happens if we compensate for them?\nIn a sense, a bigger logit value for one embedding vs another means the model is more “sensitive” to that embedding. In the sum, we’d need more of the embedding the model is less sensitive to to end up with a 50/50 distribution.\nWe can try scaling v0a_orth_v0g by the ratio of the logit values:\n\nscaled_v0a_orth_v0b = (logit_for_char(v0g, \"g\") / logit_for_char(v0a_orth_v0g, \"a\")) * v0a_orth_v0g\nplot_probs(\n    scaled_v0a_orth_v0b + v0g,\n    title=\"scaled_v0a_orth_v0b + v0g\",\n)\n\n\n\n\n\n\n\n\nThis results in a much more even distribution. It’s still not quite perfectly 50/50 and I suspect the remaining error is due to the imperfect approximations.",
    "crumbs": [
      "analyses",
      "Combining Token Subspaces"
    ]
  },
  {
    "objectID": "analyses/clustering_block_intermediates.html",
    "href": "analyses/clustering_block_intermediates.html",
    "title": "Interpreting the Projection and Feed-Forward Layers in a Self-Attention Block",
    "section": "",
    "text": "# Set a manual seed so output is deterministic (used same value as @karpathy)\n_ = torch.manual_seed(1337)\nenvironment = get_environment()\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\nm, tokenizer = create_model_and_tokenizer(\n    saved_model_filename=environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt',\n    dataset=ts,\n    device=device,\n)\n_, val_data = split_text_dataset(ts.text, tokenizer, train_pct=0.9, device=device)\nencoding_helpers = EncodingHelpers(tokenizer, device)\naccessors = TransformerAccessors(m, device)\nprint(f\"environment is {environment.name}\")\nprint(f\"device is {device}\")\n\nenvironment is local_mac\ndevice is cpu\nstrings10 = all_unique_substrings(ts.text, 10)\n# Build a next token map for each prefix length that we've run experiments for.\nnext_token_map3 = build_next_token_map(ts.text, prefix_len=3, vocab_size=tokenizer.vocab_size, stoi=tokenizer.stoi)\nnext_token_map4 = build_next_token_map(ts.text, prefix_len=4, vocab_size=tokenizer.vocab_size, stoi=tokenizer.stoi)\nnext_token_map5 = build_next_token_map(ts.text, prefix_len=5, vocab_size=tokenizer.vocab_size, stoi=tokenizer.stoi)\nnext_token_map6 = build_next_token_map(ts.text, prefix_len=6, vocab_size=tokenizer.vocab_size, stoi=tokenizer.stoi)\nnext_token_map7 = build_next_token_map(ts.text, prefix_len=7, vocab_size=tokenizer.vocab_size, stoi=tokenizer.stoi)\nnext_token_map8 = build_next_token_map(ts.text, prefix_len=8, vocab_size=tokenizer.vocab_size, stoi=tokenizer.stoi)\nnext_token_map9 = build_next_token_map(ts.text, prefix_len=9, vocab_size=tokenizer.vocab_size, stoi=tokenizer.stoi)\nnext_token_map10 = build_next_token_map(ts.text, prefix_len=10, vocab_size=tokenizer.vocab_size, stoi=tokenizer.stoi)\nall_token_lens = [3, 4, 5, 6, 7, 8, 9, 10]\nall_token_maps = [\n    next_token_map3,\n    next_token_map4,\n    next_token_map5,\n    next_token_map6,\n    next_token_map7,\n    next_token_map8,\n    next_token_map9,\n    next_token_map10\n]\n# Combine all the token maps into one\nnext_token_map_all = {\n    **next_token_map3,\n    **next_token_map4,\n    **next_token_map5,\n    **next_token_map6,\n    **next_token_map7,\n    **next_token_map8,\n    **next_token_map9,\n    **next_token_map10\n}\n# Sanity check for entries that have no next token. This should only be the case\n# for cases where the last substring in the text is unique.\nfor k, v in next_token_map_all.items():\n    if v.sum() == 0:\n        print(f\"{repr(k)} has no next tokens\")\n# Sanity check all the lengths are right.\nfor l, token_map in zip(all_token_lens, all_token_maps):\n    for k in token_map.keys():\n        if len(k) != l:\n            print(f\"{repr(k)} has length {len(k)} but should have length {l}\")\nif list((environment.data_root / 'block_internals_results/large_files/slen10/').glob('*')) == []:\n    print(\"Run `make block_internals_slen10_dataset` in the project root to generate the required dataset\")\nexp10 = BatchedBlockInternalsExperiment(\n    eh=encoding_helpers,\n    accessors=accessors,\n    strings=strings10,\n    output_dir=environment.data_root / 'block_internals_results/large_files/slen10/',\n    batch_size=10000,\n)\n# Run a similar strings experiment on a bunch of sample strings we'll use for analysis\noutput_dir = environment.code_root / 'nbs/artifacts/block_internals_results/similar_strings_sample'\noutput_dir.mkdir(exist_ok=True)\n\nssexp = SimilarStringsExperiment(output_dir, encoding_helpers)\nsample_strings = ['First Citi', 'Citizen:\\nB', 'Shyamalan ', 'more in jo']\nn_similars = 10\nbatch_size=len(sample_strings)\nif not (output_dir / 'string_to_batch_map.json').exists():\n    ssexp.generate_string_to_batch_map(sample_strings, batch_size)\n\ntry:\n    _ = next(iter(output_dir.glob('embs_sim_strings-*.json')))\nexcept StopIteration:\n    ssexp.generate_embeddings_files(sample_strings, accessors, exp10, batch_size=batch_size, n_similars=n_similars)\n\ntry:\n    _ = next(iter(output_dir.glob('proj_out_sim_strings-*.json')))\nexcept StopIteration:\n    ssexp.generate_proj_out_files(sample_strings, t_i=-1, accessors=accessors, exp=exp10, batch_size=batch_size, n_similars=n_similars)\n\ntry:\n    _ = next(iter(output_dir.glob('ffwd_out_sim_strings-*.json')))\nexcept StopIteration:\n    ssexp.generate_ffwd_out_files(sample_strings, t_i=-1, accessors=accessors, exp=exp10, batch_size=batch_size, n_similars=n_similars)\nT = TypeVar('T', bound='SimilarStringsFrequencyAndDistanceData')\n\n\n@dataclass\nclass SimilarStringsFrequencyAndDistanceData:\n    \"\"\"Encapsulates the frequency and distance data associated\n    with a set of `SimilarStringsResult`s.\"\"\"\n\n    strings: Sequence[str] # N strings\n    string_to_idx: Dict[str, int]  # Maps N strings to indices 0..N-1\n    emb_freqs: torch.Tensor  # (N, n_similars, vocab_size)\n    emb_distances: torch.Tensor  # (N, n_similars)\n    proj_freqs: torch.Tensor  # (N, n_layer, n_similars, vocab_size)\n    proj_distances: torch.Tensor  # (N, n_layer, n_similars)\n    ffwd_freqs: torch.Tensor  # (N, n_layer, n_similars, vocab_size)\n    ffwd_distances: torch.Tensor  # (N, n_layer, n_similars)\n\n    @classmethod\n    def from_results(\n        cls: Type[T],\n        ss_results: Dict[str, SimilarStringsResult],\n        next_token_map: Dict[str, torch.Tensor],\n        aggregate_over_t_is: Sequence[int] = [-1],\n        largest: bool = False,\n    ) -&gt; T:\n        strings: List[str] = []\n        string_to_idx: Dict[str, int] = {}\n\n        all_emb_freqs = []\n        all_emb_distances = []\n        all_proj_freqs = []\n        all_proj_distances = []\n        all_ffwd_freqs = []\n        all_ffwd_distances = []\n\n        for i, (s, result) in enumerate(ss_results.items()):\n            strings.append(s)\n            string_to_idx[s] = i\n            aggr_proj_out, aggr_ffwd_out = result.aggregate_over_t_is(\n                aggregate_over_t_is,\n                largest=largest,\n            )\n\n            emb_freqs = torch.stack(\n                [next_token_map[s] for s in result.embs.sim_strings]\n            )\n            all_emb_freqs.append(emb_freqs)\n\n            emb_distances = result.embs.distances\n            all_emb_distances.append(emb_distances)\n\n            proj_freqs = torch.stack(\n                [\n                    torch.stack(\n                        [\n                            next_token_map[s]\n                            for s in aggr_proj_out[block_idx].sim_strings\n                        ]\n                    )\n                    for block_idx in range(n_layer)\n                ]\n            )\n            all_proj_freqs.append(proj_freqs)\n\n            proj_distances = torch.stack(\n                [aggr_proj_out[block_idx].distances for block_idx in range(n_layer)]\n            )\n            all_proj_distances.append(proj_distances)\n\n            ffwd_freqs = torch.stack(\n                [\n                    torch.stack(\n                        [\n                            next_token_map[s]\n                            for s in aggr_ffwd_out[block_idx].sim_strings\n                        ]\n                    )\n                    for block_idx in range(n_layer)\n                ]\n            )\n            all_ffwd_freqs.append(ffwd_freqs)\n\n            ffwd_distances = torch.stack(\n                [aggr_ffwd_out[block_idx].distances for block_idx in range(n_layer)]\n            )\n            all_ffwd_distances.append(ffwd_distances)\n\n        return cls(\n            strings,\n            string_to_idx,\n            torch.stack(all_emb_freqs),  # (len(ss_results), n_similars, vocab_size)\n            torch.stack(all_emb_distances),  # (len(ss_results), n_similars)\n            torch.stack(\n                all_proj_freqs\n            ),  # (len(ss_results), n_layer, n_similars, vocab_size)\n            torch.stack(all_proj_distances),  # (len(ss_results), n_layer, n_similars)\n            torch.stack(\n                all_ffwd_freqs\n            ),  # (len(ss_results), n_layer, n_similars, vocab_size)\n            torch.stack(all_ffwd_distances),  # (len(ss_results), n_layer, n_similars)\n        )\n# Tests for SimilarStringsFrequencyAndDistanceData\nss_data = SimilarStringsFrequencyAndDistanceData.from_results(\n    ss_results=ssexp.load_results_for_strings(sample_strings),\n    next_token_map=next_token_map_all,\n    aggregate_over_t_is=[-1],\n)\ntest_eq(ss_data.strings, sample_strings)\ntest_eq(len(ss_data.string_to_idx), len(sample_strings))\ntest_eq(ss_data.emb_freqs.shape, (len(sample_strings), n_similars, tokenizer.vocab_size))\ntest_eq(ss_data.emb_distances.shape, (len(sample_strings), n_similars))\ntest_eq(ss_data.proj_freqs.shape, (len(sample_strings), n_layer, n_similars, tokenizer.vocab_size))\ntest_eq(ss_data.proj_distances.shape, (len(sample_strings), n_layer, n_similars))\ntest_eq(ss_data.ffwd_freqs.shape, (len(sample_strings), n_layer, n_similars, tokenizer.vocab_size))\ntest_eq(ss_data.ffwd_distances.shape, (len(sample_strings), n_layer, n_similars))\nclass ComputeNextTokenFreqs(Protocol):\n    def __call__(\n        self, prompt_idxs: torch.Tensor, ss_data: SimilarStringsFrequencyAndDistanceData\n    ) -&gt; torch.Tensor:\n        ...\n\n\nclass ModelSimulation:\n    def __init__(\n        self,\n        ss_data: SimilarStringsFrequencyAndDistanceData,\n        compute_next_token_freqs: ComputeNextTokenFreqs,\n        encoding_helpers: EncodingHelpers,\n    ):\n        self.ss_data = ss_data\n        self.get_next_token_freqs = compute_next_token_freqs\n        self.encoding_helpers = encoding_helpers\n\n    def __call__(self, prompts: Sequence[str]):\n        prompt_idxs = torch.tensor(\n            [self.ss_data.string_to_idx[prompt] for prompt in prompts], dtype=torch.long\n        )\n\n        freqs = self.get_next_token_freqs(prompt_idxs, self.ss_data)\n\n        return [\n            top_nonzero_tokens(f, self.encoding_helpers.tokenizer.itos)[:10]\n            for f in freqs\n        ]\ndef get_model_outputs(prompts: Sequence[str], encoding_helpers: EncodingHelpers):\n    # Compute the model's predictions:\n    tokens = encoding_helpers.tokenize_strings(prompts)\n    logits, _ = m(tokens)\n\n    logits = LogitsWrapper(logits, encoding_helpers.tokenizer)\n    return [topk_tokens[-1] for topk_tokens in logits.topk_tokens(k=10)]\ndef next_token_freqs_progressive_ffwd_weight(\n    prompt_idxs: torch.Tensor, ss_data: SimilarStringsFrequencyAndDistanceData\n):\n    emb_weight = torch.tensor(1.0, dtype=torch.float32)\n    proj_weights = torch.tensor(\n        [1.0 for _ in range(n_layer)], dtype=torch.float32\n    ).unsqueeze(dim=1)\n    ffwd_weights = torch.tensor(\n        [1 + block_idx for block_idx in range(n_layer)], dtype=torch.float32\n    ).unsqueeze(dim=1)\n    freqs = (\n        (emb_weight * ss_data.emb_freqs[prompt_idxs, :]).sum(dim=1)\n        + (proj_weights * ss_data.proj_freqs[prompt_idxs, :, :, :].sum(dim=2)).sum(\n            dim=1\n        )\n        + (ffwd_weights * ss_data.ffwd_freqs[prompt_idxs, :, :, :].sum(dim=2)).sum(\n            dim=1\n        )\n    )\n    return freqs / freqs.sum(dim=1, keepdim=True)\nsimulate = ModelSimulation(\n    ss_data=ss_data,\n    compute_next_token_freqs=next_token_freqs_progressive_ffwd_weight,\n    encoding_helpers=encoding_helpers,\n)\nstrings10[14423:14433]\n\n['more in jo',\n 'ore in joy',\n 're in joy ',\n 'e in joy a',\n ' in joy at',\n 'in joy at ',\n 'n joy at f',\n ' joy at fi',\n 'joy at fir',\n 'oy at firs']\nstring_to_idx = {\n    s: i for i, s in enumerate(sample_strings)\n}\nsample_model_outputs = get_model_outputs(sample_strings, encoding_helpers)\nsimulate(['First Citi'])[0], sample_model_outputs[string_to_idx['First Citi']]\n\n([('z', 0.9380468726158142),\n  ('i', 0.03080154024064541),\n  ('e', 0.01610080525279045),\n  ('c', 0.004550227429717779),\n  ('h', 0.003850192530080676),\n  ('p', 0.002100104931741953),\n  (':', 0.0014000700321048498),\n  ('o', 0.0014000700321048498),\n  ('u', 0.0007000350160524249),\n  (' ', 0.0007000350160524249)],\n [('z', 0.9996668100357056),\n  ('u', 0.00010660554107744247),\n  ('I', 7.993520557647571e-05),\n  ('U', 2.734881672949996e-05),\n  ('K', 2.4257360564661212e-05),\n  ('P', 1.5074498151079752e-05),\n  ('L', 1.0885321898967959e-05),\n  ('n', 8.451069334114436e-06),\n  ('O', 8.223939403251279e-06),\n  ('f', 7.135453870432684e-06)])\nsimulate(['Citizen:\\nB'])[0], sample_model_outputs[string_to_idx['Citizen:\\nB']]\n\n([('e', 0.3421829044818878),\n  ('u', 0.17404130101203918),\n  ('o', 0.13716813921928406),\n  ('h', 0.09587020426988602),\n  ('y', 0.08554572612047195),\n  ('a', 0.07669616490602493),\n  ('n', 0.033923305571079254),\n  ('i', 0.028023598715662956),\n  ('r', 0.011799409985542297),\n  ('t', 0.007374631240963936)],\n [('e', 0.47825106978416443),\n  ('u', 0.2509588301181793),\n  ('y', 0.1266946792602539),\n  ('r', 0.05788085237145424),\n  ('i', 0.03135434538125992),\n  ('o', 0.02440422773361206),\n  ('a', 0.017102370038628578),\n  ('l', 0.012891546823084354),\n  ('s', 8.761954813962802e-05),\n  ('R', 7.359156006714329e-05)])\nsimulate(['Shyamalan '])[0], sample_model_outputs[string_to_idx['Shyamalan ']]\n\n([('t', 0.15815085172653198),\n  ('b', 0.1228710487484932),\n  ('o', 0.11313868314027786),\n  ('a', 0.10340632498264313),\n  ('i', 0.09975668787956238),\n  ('d', 0.058394160121679306),\n  ('s', 0.05352798104286194),\n  ('w', 0.04866180196404457),\n  ('m', 0.03041362576186657),\n  ('f', 0.027980534359812737)],\n [('t', 0.16370470821857452),\n  ('s', 0.10785210877656937),\n  ('a', 0.09744462370872498),\n  ('b', 0.09677103161811829),\n  ('c', 0.08353256434202194),\n  ('m', 0.056587863713502884),\n  ('d', 0.048968441784381866),\n  ('p', 0.04876013845205307),\n  ('h', 0.04751131683588028),\n  ('w', 0.038983285427093506)])\nsimulate(['more in jo'])[0], sample_model_outputs[string_to_idx['more in jo']]\n\n([('y', 0.6007066965103149),\n  ('t', 0.16607773303985596),\n  ('i', 0.07773851603269577),\n  ('s', 0.06713780760765076),\n  ('u', 0.038869258016347885),\n  ('m', 0.017667844891548157),\n  ('d', 0.010600706562399864),\n  ('r', 0.007067137863487005),\n  ('k', 0.0035335689317435026),\n  ('l', 0.0035335689317435026)],\n [('y', 0.8568735718727112),\n  ('i', 0.06098264083266258),\n  ('u', 0.04135835915803909),\n  ('c', 0.016126777976751328),\n  ('t', 0.012861563824117184),\n  ('l', 0.0022685928270220757),\n  ('o', 0.0021818610839545727),\n  ('s', 0.0016513006994500756),\n  ('v', 0.001559981144964695),\n  ('w', 0.0011889823945239186)])\ndef analyze_simulate_results2(strings: Sequence[str], sim_outputs: Sequence, model_outputs: Sequence):\n    \"\"\"A version of analyze_simulate_results() that computes results for the\n    full length of the returned results.\"\"\"\n\n    topn_matches = [0 for _ in range(10)]\n    topn_matches_any_order = [0 for _ in range(10)]\n    for i, s in enumerate(strings):\n        sim_output = sim_outputs[i]\n        model_output = model_outputs[i]\n        sim_tokens, _ = zip(*sim_output)\n        model_tokens, _ = zip(*model_output)\n\n        n = min(len(sim_tokens), len(model_tokens))\n        for j in range(n):\n            if sim_tokens[j] == model_tokens[j]:\n                topn_matches[j] += 1\n            if set(sim_tokens[:j+1]) == set(model_tokens[:j+1]):\n                topn_matches_any_order[j] += 1\n\n    return topn_matches, topn_matches_any_order\nn_samples = 20000\nss_exp20k = SimilarStringsExperiment(\n    exp10.output_dir / 'similar_strings',\n    encoding_helpers\n)\n\ntorch.manual_seed(1337)\nindices = torch.randperm(len(exp10.strings))[:n_samples]\nstrings = [exp10.strings[i.item()] for i in indices]\n\nss_results20k = ss_exp20k.load_results_for_strings(strings)\n\nss_data20k = SimilarStringsFrequencyAndDistanceData.from_results(\n    ss_results=ss_results20k,\n    next_token_map=next_token_map_all,\n    aggregate_over_t_is=[-1],\n)\nmodel_outputs20k = get_model_outputs(strings, encoding_helpers)\nsim20k = ModelSimulation(\n    ss_data=ss_data20k,\n    compute_next_token_freqs=next_token_freqs_progressive_ffwd_weight,\n    encoding_helpers=encoding_helpers,\n)\nsim_outputs = sim20k(strings)\ntopn_matches, topn_matches_any_order = analyze_simulate_results2(strings, sim_outputs, model_outputs20k)\nfor i in range(10):\n    print(f\"Top {i+1} matches: {topn_matches[i] / n_samples:.3f}\")\n    print(f\"Top {i+1} matches (any order): {topn_matches_any_order[i] / n_samples:.3f}\")\n\nTop 1 matches: 0.774\nTop 1 matches (any order): 0.774\nTop 2 matches: 0.398\nTop 2 matches (any order): 0.452\nTop 3 matches: 0.211\nTop 3 matches (any order): 0.238\nTop 4 matches: 0.141\nTop 4 matches (any order): 0.143\nTop 5 matches: 0.102\nTop 5 matches (any order): 0.088\nTop 6 matches: 0.081\nTop 6 matches (any order): 0.054\nTop 7 matches: 0.059\nTop 7 matches (any order): 0.028\nTop 8 matches: 0.053\nTop 8 matches (any order): 0.018\nTop 9 matches: 0.046\nTop 9 matches (any order): 0.010\nTop 10 matches: 0.037\nTop 10 matches (any order): 0.005\nt_is=[3, 4, 5, 6, 7, 8, 9]\nss_results20k_all_t_is = ss_exp20k.load_results_for_strings(strings, load_t_is=t_is)\nss_data20k_aggr = SimilarStringsFrequencyAndDistanceData.from_results(\n    ss_results=ss_results20k_all_t_is,\n    next_token_map=next_token_map_all,\n    aggregate_over_t_is=t_is,\n)\nsim20k_aggr = ModelSimulation(\n    ss_data=ss_data20k_aggr,\n    compute_next_token_freqs=next_token_freqs_progressive_ffwd_weight,\n    encoding_helpers=encoding_helpers,\n)\nsim_outputs2 = sim20k_aggr(strings)\nn_samples = 20000\ntopn_matches, topn_matches_any_order = analyze_simulate_results2(strings, sim_outputs2, model_outputs20k)\nfor i in range(10):\n    print(f\"Top {i+1} matches: {topn_matches[i] / n_samples:.3f}\")\n    print(f\"Top {i+1} matches (any order): {topn_matches_any_order[i] / n_samples:.3f}\")\n\nTop 1 matches: 0.742\nTop 1 matches (any order): 0.742\nTop 2 matches: 0.363\nTop 2 matches (any order): 0.415\nTop 3 matches: 0.197\nTop 3 matches (any order): 0.212\nTop 4 matches: 0.136\nTop 4 matches (any order): 0.130\nTop 5 matches: 0.098\nTop 5 matches (any order): 0.081\nTop 6 matches: 0.080\nTop 6 matches (any order): 0.048\nTop 7 matches: 0.060\nTop 7 matches (any order): 0.027\nTop 8 matches: 0.053\nTop 8 matches (any order): 0.016\nTop 9 matches: 0.044\nTop 9 matches (any order): 0.010\nTop 10 matches: 0.036\nTop 10 matches (any order): 0.004\nsim20k_aggr(['my most gr'])[0], model_outputs20k[ss_data20k.string_to_idx['my most gr']]\n\n([('a', 0.7179487347602844),\n  ('i', 0.09455128014087677),\n  ('e', 0.06410256773233414),\n  ('h', 0.035256411880254745),\n  ('o', 0.028846153989434242),\n  ('t', 0.025641025975346565),\n  ('u', 0.01923076994717121),\n  ('r', 0.008012820966541767),\n  ('v', 0.0032051282469183207),\n  ('c', 0.0016025641234591603)],\n [('a', 0.4602494537830353),\n  ('e', 0.35252559185028076),\n  ('o', 0.09188850224018097),\n  ('i', 0.09030349552631378),\n  ('u', 0.004192721098661423),\n  ('y', 0.0007521358784288168),\n  ('r', 6.647213740507141e-05),\n  ('l', 3.957989065384027e-06),\n  ('v', 2.812936827467638e-06),\n  ('w', 2.738903503995971e-06)])\nsim20k(['my most gr'])[0], model_outputs20k[ss_data20k.string_to_idx['my most gr']]\n\n([('a', 0.74631267786026),\n  ('i', 0.14454276859760284),\n  ('o', 0.05604719743132591),\n  ('e', 0.02654867246747017),\n  ('n', 0.005899704992771149),\n  ('c', 0.005899704992771149),\n  ('v', 0.005899704992771149),\n  ('d', 0.0029498524963855743),\n  ('r', 0.0029498524963855743),\n  ('l', 0.0029498524963855743)],\n [('a', 0.4602494537830353),\n  ('e', 0.35252559185028076),\n  ('o', 0.09188850224018097),\n  ('i', 0.09030349552631378),\n  ('u', 0.004192721098661423),\n  ('y', 0.0007521358784288168),\n  ('r', 6.647213740507141e-05),\n  ('l', 3.957989065384027e-06),\n  ('v', 2.812936827467638e-06),\n  ('w', 2.738903503995971e-06)])\ndef print_sim_strings(result: SimilarStringsResult, aggregate_over_t_is: Sequence[int], largest: bool = False):\n    aggr_proj_out, aggr_ffwd_out = result.aggregate_over_t_is(aggregate_over_t_is, largest=largest)\n    n_similars = len(aggr_proj_out[0].sim_strings)\n    print(\"Proj Outputs\")\n    for i in range(n_similars):\n        print(''.join([f\"{repr(aggr_proj_out[block_idx].sim_strings[i]):&gt;14} ({aggr_proj_out[block_idx].distances[i]:.2f})\" for block_idx in range(n_layer)]))\n\n    print()\n    print(\"FFwd Outputs\")\n    for i in range(n_similars):\n        print(''.join([f\"{repr(aggr_ffwd_out[block_idx].sim_strings[i]):&gt;14} ({aggr_ffwd_out[block_idx].distances[i]:.2f})\" for block_idx in range(n_layer)]))\nprint_sim_strings(ss_results20k_all_t_is['my most gr'], t_is)\n\nProj Outputs\n    my most gr (0.00)    my most gr (0.00)    my most gr (0.00)    my most gr (0.00)    my most gr (0.00)    my most gr (0.00)\n    ur most gr (0.79)    ur most gr (0.95)    is most gr (2.27)     y most gr (3.56)     my most r (4.90)     my most r (2.75)\n    is most gr (0.80)    ne most gr (0.96)    ur most gr (2.43)    ur most gr (3.95)     y most gr (5.00)     my most l (3.52)\n    ne most gr (0.80)    he most gr (1.05)     y most gr (2.56)     r most gr (4.34)         my gr (5.38)     my most h (3.79)\n    ilst my gr (0.82)    is most gr (1.06)    ne most gr (2.63)       most gr (4.51)         my sl (5.54)    my most st (3.91)\n    he most gr (0.84)    e, most gr (1.27)    he most gr (2.88)       most gu (4.61)     my most g (5.54)        my mos (3.97)\n    unto my gr (0.89)    o, must gr (1.35)     r most gr (2.99)       most gl (4.67)         my gh (5.69)        my mod (4.01)\n    e, most gr (0.89)    t, most gr (1.36)    e, most gr (3.16)    ne most gr (4.72)     my most l (5.76)        my mot (4.04)\n    t, most gr (0.90)    be past gr (1.37)     s most gr (3.18)     s most gr (4.85)    he most gr (5.85)        my mon (4.08)\n    yman to gr (0.92)    yet not gr (1.51)       most gr (3.20)     e most gr (4.86)    my most st (5.86)        my mou (4.14)\n\nFFwd Outputs\n    my most gr (0.00)    my most gr (0.00)    my most gr (0.00)    my most gr (0.00)    my most gr (0.00)    my most gr (0.00)\n    ne most gr (0.14)    ne most gr (0.43)    ur most gr (0.75)    ur most gr (1.77)    ur most gr (2.76)    t, most gr (3.17)\n    ur most gr (0.14)    ur most gr (0.44)    is most gr (0.78)    ne most gr (2.05)    he most gr (2.90)    e, most gr (3.23)\n    he most gr (0.14)    he most gr (0.51)    ne most gr (0.83)    is most gr (2.23)    ne most gr (2.94)    ur most gr (3.45)\n    e, most gr (0.14)    is most gr (0.57)    he most gr (0.89)    he most gr (2.56)     y most gr (2.98)     , most gr (3.49)\n    ilst my gr (0.15)    t, most gr (0.57)    e, most gr (1.23)     y most gr (3.26)     r most gr (3.41)     y most gr (3.72)\n    t, most gr (0.15)    e, most gr (0.58)    t, most gr (1.32)     r most gr (3.28)    is most gr (3.60)    ne most gr (3.88)\n    is most gr (0.15)    ver yet gr (0.66)    do them gr (2.21)    e, most gr (3.44)     e most gr (3.75)    is most gr (3.90)\n    unto my gr (0.15)     cannot gr (0.70)    im that gr (2.24)     s most gr (3.57)       most gr (3.88)    our own gr (3.95)\n    o, must gr (0.16)    o, must gr (0.71)    o, must gr (2.25)     e most gr (3.70)    e, most gr (3.89)         or gr (4.04)\nCompare to just looking at t_i=-1:\nprint_sim_strings(ss_results20k_all_t_is['my most gr'], [-1])\n\nProj Outputs\n    my most gr (0.00)    my most gr (0.00)    my most gr (0.00)    my most gr (0.00)    my most gr (0.00)    my most gr (0.00)\n    ur most gr (0.79)    ur most gr (0.95)    is most gr (2.27)    ur most gr (3.95)    he most gr (5.85)    my most st (3.91)\n    is most gr (0.80)    ne most gr (0.96)    ur most gr (2.43)    ne most gr (4.72)    my most st (5.86)    my most sa (4.33)\n    ne most gr (0.80)    he most gr (1.05)    ne most gr (2.63)    nd most gu (5.16)    ur most gr (6.43)     my most r (4.56)\n    ilst my gr (0.82)    is most gr (1.06)    he most gr (2.88)    nd most gl (5.34)     my most r (6.52)     my most l (5.16)\n    he most gr (0.84)    e, most gr (1.27)    e, most gr (3.16)    he most ge (5.49)    my young r (6.56)    my high bl (5.20)\n    unto my gr (0.89)    o, must gr (1.35)    t, most gr (3.29)    is most gr (5.53)    my young p (6.58)    m thy moth (5.22)\n    e, most gr (0.89)    t, most gr (1.36)    nd most gl (3.57)    ld most gl (5.64)    my young c (6.79)    mt my mast (5.22)\n    t, most gr (0.90)    be past gr (1.37)    ld most gl (3.71)    e; most go (5.96)    my part sh (6.84)    my most he (5.34)\n    yman to gr (0.92)    yet not gr (1.51)    he most ge (4.52)    e, most gr (6.00)    my young l (6.87)    my merry m (5.45)\n\nFFwd Outputs\n    my most gr (0.00)    my most gr (0.00)    my most gr (0.00)    my most gr (0.00)    my most gr (0.00)    my most gr (0.00)\n    ne most gr (0.14)    ne most gr (0.43)    ur most gr (0.75)    ur most gr (1.77)    ur most gr (2.76)    t, most gr (3.17)\n    ur most gr (0.14)    ur most gr (0.44)    is most gr (0.78)    ne most gr (2.05)    he most gr (2.90)    e, most gr (3.23)\n    he most gr (0.14)    he most gr (0.51)    ne most gr (0.83)    is most gr (2.23)    ne most gr (2.94)    ur most gr (3.45)\n    e, most gr (0.14)    is most gr (0.57)    he most gr (0.89)    he most gr (2.56)    is most gr (3.60)    ne most gr (3.88)\n    ilst my gr (0.15)    t, most gr (0.57)    e, most gr (1.23)    e, most gr (3.44)    e, most gr (3.89)    is most gr (3.90)\n    t, most gr (0.15)    e, most gr (0.58)    t, most gr (1.32)    t, most gr (3.77)    t, most gr (4.29)    our own gr (3.95)\n    is most gr (0.15)    ver yet gr (0.66)    do them gr (2.21)     common gr (3.88)    dd more gr (5.07)     but my gr (4.61)\n    unto my gr (0.15)     cannot gr (0.70)    im that gr (2.24)    is more gr (4.06)     but my gr (5.27)    nto her gr (4.71)\n    o, must gr (0.16)    o, must gr (0.71)    o, must gr (2.25)    dd more gr (4.06)    is more gr (5.33)    dd more gr (4.73)\nHow would we do if we just used the next tokens for the prompt?\ndef sim_just_next_tokens_from_prompt(prompt: str, next_token_map: Dict[str, torch.Tensor], encoding_helpers: EncodingHelpers):\n    next_tokens = next_token_map[prompt]\n    return top_nonzero_tokens(\n        next_tokens.float() / next_tokens.sum(), encoding_helpers.tokenizer.itos\n    )[:10]\nsim_jntfp_out = [\n    sim_just_next_tokens_from_prompt(s, next_token_map_all, encoding_helpers)\n    for s in tqdm(strings)\n]\nn_samples = 20000\ntopn_matches, topn_matches_any_order = analyze_simulate_results2(strings, sim_jntfp_out, model_outputs20k)\nfor i in range(10):\n    print(f\"Top {i+1} matches: {topn_matches[i] / n_samples:.3f}\")\n    print(f\"Top {i+1} matches (any order): {topn_matches_any_order[i] / n_samples:.3f}\")\n\nTop 1 matches: 0.606\nTop 1 matches (any order): 0.606\nTop 2 matches: 0.011\nTop 2 matches (any order): 0.012\nTop 3 matches: 0.002\nTop 3 matches (any order): 0.001\nTop 4 matches: 0.001\nTop 4 matches (any order): 0.001\nTop 5 matches: 0.001\nTop 5 matches (any order): 0.000\nTop 6 matches: 0.000\nTop 6 matches (any order): 0.000\nTop 7 matches: 0.000\nTop 7 matches (any order): 0.000\nTop 8 matches: 0.000\nTop 8 matches (any order): 0.000\nTop 9 matches: 0.000\nTop 9 matches (any order): 0.000\nTop 10 matches: 0.000\nTop 10 matches (any order): 0.000\nOK, so 60% on the top 1 token, but it quickly falls off after that.\ndef unique_contributors(result: SimilarStringsResult, aggregate_over_t_is: Sequence[int]):\n    aggr_proj_out, aggr_ffwd_out = result.aggregate_over_t_is(aggregate_over_t_is)\n\n    s_to_next_tokens_map = {}\n\n    for s in result.embs.sim_strings:\n        s_to_next_tokens_map[s] = next_token_map_all[s]\n\n    for block_idx in range(n_layer):\n        for s in aggr_proj_out[block_idx].sim_strings:\n            s_to_next_tokens_map[s] = next_token_map_all[s]\n        for s in aggr_ffwd_out[block_idx].sim_strings:\n            s_to_next_tokens_map[s] = next_token_map_all[s]\n\n    def _print(item: Tuple[str, torch.Tensor]):\n        s, next_tokens = item\n        top_tokens = top_nonzero_tokens(next_tokens.float() / next_tokens.sum(), encoding_helpers.tokenizer.itos)\n        tokens_str = ', '.join([f\"{repr(t):&gt;3} ({p:.2f})\" for t, p in top_tokens])\n        return f\"{repr(s):&gt;14}: {tokens_str}\"\n\n    return DataWrapper(s_to_next_tokens_map.items(), _print)\nunique_contributors(ss_results20k_all_t_is['my most gr'], t_is).print()\n\n  'my most gr': 'a' (1.00)\n  'my most sa': 'c' (1.00)\n  't, most gr': 'a' (1.00)\n  'my most st': 'a' (1.00)\n  'e, most gr': 'a' (1.00)\n  'ur most gr': 'a' (1.00)\n  'is most gr': 'i' (1.00)\n  'my most so': 'v' (1.00)\n  'my most re': 'd' (1.00)\n  'my most he': 'a' (1.00)\n  'ne most gr': 'a' (1.00)\n  'ilst my gr': 'o' (1.00)\n  'he most gr': 'a' (1.00)\n  'unto my gr': 'a' (1.00)\n  'yman to gr': 'i' (1.00)\n  'o, must gr': 'a' (1.00)\n  'be past gr': 'i' (1.00)\n  'yet not gr': 'e' (1.00)\n  'ver yet gr': 'e' (1.00)\n  ' cannot gr': 'e' (1.00)\n   'y most gr': 'a' (1.00)\n   'r most gr': 'a' (1.00)\n   's most gr': 'i' (1.00)\n    ' most gr': 'a' (0.89), 'i' (0.11)\n  'do them gr': 'a' (1.00)\n  'im that gr': 'a' (1.00)\n     'most gr': 'a' (0.89), 'i' (0.11)\n     'most gu': 'i' (1.00)\n    ' most gl': 'a' (1.00)\n   'e most gr': 'a' (1.00)\n   'my most r': 'e' (1.00)\n       'my gr': 'a' (0.55), 'i' (0.22), 'e' (0.16), 'o' (0.06)\n       'my sl': 'e' (0.40), 'a' (0.40), 'i' (0.20)\n   'my most g': 'r' (1.00)\n       'my gh': 'o' (1.00)\n   'my most l': 'o' (1.00)\n   'my most h': 'e' (1.00)\n      'my mos': 't' (1.00)\n      'my mod': 'e' (1.00)\n      'my mot': 'h' (1.00)\n      'my mon': 'e' (1.00)\n      'my mou': 't' (0.67), 'r' (0.33)\n   ', most gr': 'a' (1.00)\n  'our own gr': 'a' (1.00)\n       'or gr': 'a' (0.56), 'e' (0.19), 'u' (0.12), 'o' (0.06), 'i' (0.06)\ndef next_token_freqs_inv_distances(\n    prompt_idxs: torch.Tensor, ss_tensors: SimilarStringsFrequencyAndDistanceData\n):\n    emb_weight = torch.tensor(1.0, dtype=torch.float32)\n    proj_weights = torch.tensor(\n        [1.0 for _ in range(n_layer)], dtype=torch.float32\n    ).unsqueeze(dim=1)\n    ffwd_weights = torch.tensor(\n        [1 + block_idx for block_idx in range(n_layer)], dtype=torch.float32\n    ).unsqueeze(dim=1)\n\n    inv_emb_distances = (1 / (1 + ss_tensors.emb_distances[prompt_idxs, :])).unsqueeze(\n        dim=2\n    )\n\n    inv_proj_distances = (\n        1 / (1 + ss_data20k_aggr.proj_distances[prompt_idxs, :, :])\n    ).unsqueeze(dim=3)\n\n    inv_ffwd_distances = (\n        1 / (1 + ss_data20k_aggr.ffwd_distances[prompt_idxs, :, :])\n    ).unsqueeze(dim=3)\n\n    freqs = (\n        (emb_weight * ss_tensors.emb_freqs[prompt_idxs, :] * inv_emb_distances).sum(\n            dim=1\n        )\n        + (\n            proj_weights\n            * (ss_tensors.proj_freqs[prompt_idxs, :, :, :] * inv_proj_distances).sum(\n                dim=2\n            )\n        ).sum(dim=1)\n        + (\n            ffwd_weights\n            * (ss_tensors.ffwd_freqs[prompt_idxs, :, :, :] * inv_ffwd_distances).sum(\n                dim=2\n            )\n        ).sum(dim=1)\n    )\n    return freqs / freqs.sum(dim=1, keepdim=True)\nsim20k_aggr_alt = ModelSimulation(\n    ss_data=ss_data20k_aggr,\n    compute_next_token_freqs=next_token_freqs_inv_distances,\n    encoding_helpers=encoding_helpers,\n)\nsim_outputs_alt = sim20k_aggr_alt(strings)\nn_samples = 20000\ntopn_matches, topn_matches_any_order = analyze_simulate_results2(strings, sim_outputs_alt, model_outputs20k)\nfor i in range(10):\n    print(f\"Top {i+1} matches: {topn_matches[i] / n_samples:.3f}\")\n    print(f\"Top {i+1} matches (any order): {topn_matches_any_order[i] / n_samples:.3f}\")\n\nTop 1 matches: 0.699\nTop 1 matches (any order): 0.699\nTop 2 matches: 0.352\nTop 2 matches (any order): 0.404\nTop 3 matches: 0.208\nTop 3 matches (any order): 0.220\nTop 4 matches: 0.141\nTop 4 matches (any order): 0.136\nTop 5 matches: 0.103\nTop 5 matches (any order): 0.089\nTop 6 matches: 0.083\nTop 6 matches (any order): 0.055\nTop 7 matches: 0.065\nTop 7 matches (any order): 0.032\nTop 8 matches: 0.053\nTop 8 matches (any order): 0.020\nTop 9 matches: 0.043\nTop 9 matches (any order): 0.012\nTop 10 matches: 0.036\nTop 10 matches (any order): 0.005\nIt does worse at the top but a little better further down.\nTry a few other functions:\ndef next_token_freqs_only_last_ffwd(\n    prompt_idxs: torch.Tensor, ss_data: SimilarStringsFrequencyAndDistanceData\n):\n\n    freqs = ss_data.ffwd_freqs[prompt_idxs, -1, :, :].sum(dim=1)\n    return freqs / freqs.sum(dim=1, keepdim=True)\ndef next_token_freqs_only_last_ffwd_with_distances(\n    prompt_idxs: torch.Tensor, ss_data: SimilarStringsFrequencyAndDistanceData\n):\n\n    inv_ffwd_distances = (\n        1 / (1 + ss_data20k_aggr.ffwd_distances[prompt_idxs, -1, :])\n    ).unsqueeze(dim=2)\n\n    freqs = (inv_ffwd_distances * ss_data.ffwd_freqs[prompt_idxs, -1, :, :]).sum(dim=1)\n    return freqs / freqs.sum(dim=1, keepdim=True)\ndef try_next_token_freqs_function(\n    next_token_freqs_fn: ComputeNextTokenFreqs,\n    ss_data: SimilarStringsFrequencyAndDistanceData,\n    strings: Sequence[str],\n    model_outputs: Sequence[Tuple[str, float]],\n):\n    sim = ModelSimulation(\n        ss_data=ss_data,\n        compute_next_token_freqs=next_token_freqs_fn,\n        encoding_helpers=encoding_helpers,\n    )\n    sim_outputs = sim(strings)\n\n    n_samples = len(strings)\n    topn_matches, topn_matches_any_order = analyze_simulate_results2(\n        strings, sim_outputs, model_outputs\n    )\n    for i in range(10):\n        print(f\"Top {i+1} matches: {topn_matches[i] / n_samples:.3f}\")\n        print(\n            f\"Top {i+1} matches (any order): {topn_matches_any_order[i] / n_samples:.3f}\"\n        )\ntry_next_token_freqs_function(\n    next_token_freqs_only_last_ffwd, ss_data20k, strings, model_outputs20k\n)\n\nTop 1 matches: 0.744\nTop 1 matches (any order): 0.744\nTop 2 matches: 0.311\nTop 2 matches (any order): 0.362\nTop 3 matches: 0.134\nTop 3 matches (any order): 0.148\nTop 4 matches: 0.071\nTop 4 matches (any order): 0.070\nTop 5 matches: 0.037\nTop 5 matches (any order): 0.030\nTop 6 matches: 0.020\nTop 6 matches (any order): 0.010\nTop 7 matches: 0.011\nTop 7 matches (any order): 0.003\nTop 8 matches: 0.007\nTop 8 matches (any order): 0.001\nTop 9 matches: 0.004\nTop 9 matches (any order): 0.001\nTop 10 matches: 0.002\nTop 10 matches (any order): 0.000\nThis is nearly as good as the best baseline results for top1 and top2, but drops off after that.\ntry_next_token_freqs_function(\n    next_token_freqs_only_last_ffwd_with_distances, ss_data20k_aggr, strings, model_outputs20k\n)\n\nTop 1 matches: 0.676\nTop 1 matches (any order): 0.676\nTop 2 matches: 0.253\nTop 2 matches (any order): 0.300\nTop 3 matches: 0.109\nTop 3 matches (any order): 0.117\nTop 4 matches: 0.057\nTop 4 matches (any order): 0.054\nTop 5 matches: 0.032\nTop 5 matches (any order): 0.024\nTop 6 matches: 0.017\nTop 6 matches (any order): 0.009\nTop 7 matches: 0.010\nTop 7 matches (any order): 0.004\nTop 8 matches: 0.006\nTop 8 matches (any order): 0.002\nTop 9 matches: 0.005\nTop 9 matches (any order): 0.001\nTop 10 matches: 0.003\nTop 10 matches (any order): 0.001\nFor a single example, is it possible to choose weights that give you the same output as the model?\nstrings[:10]\n\n['is dreams,',\n 'by present',\n 's eyes may',\n 'eart of ho',\n ' man, as I',\n 'mour in a ',\n 'LLA:\\nAnd h',\n ' crave no ',\n 'o find the',\n 'e,\\nplease ']\nprompt = 'my most gr'\n\nprompt_idx = ss_data20k.string_to_idx[prompt]\nprompt_idxs = torch.tensor([prompt_idx], dtype=torch.long)\n\nemb_freqs = ss_data20k.emb_freqs[prompt_idxs, :, :]\nproj_freqs = ss_data20k.proj_freqs[prompt_idxs, :, :, :]\nffwd_freqs = ss_data20k.ffwd_freqs[prompt_idxs, :, :, :]\ntokens = encoding_helpers.tokenize_string(prompt)\nlogits, _ = m(tokens)\nmodel_output = F.softmax(logits[:, -1, :], dim=-1).squeeze(dim=0)\ntorch.manual_seed(1337) # Ensure stable random values\n\n# Initialize all the learnable params\nemb_weight_param = torch.nn.Parameter(\n    torch.randn(1, dtype=torch.float32), requires_grad=True\n).to(device)\nproj_weights_param = torch.nn.Parameter(\n    torch.randn(n_layer, 1, dtype=torch.float32), requires_grad=True\n).to(device)\nffwd_weights_param = torch.nn.Parameter(\n    torch.randn(n_layer, 1, dtype=torch.float32), requires_grad=True\n).to(device)\nlearning_rate = 3e-3\nmax_iters = 10000\neval_interval=500\noptimizer = torch.optim.AdamW([emb_weight_param, proj_weights_param, ffwd_weights_param], lr=learning_rate)\neval_iters = max_iters // 10\n\nlosses = []\n\nfor step in tqdm(range(max_iters)):\n    optimizer.zero_grad()\n\n    freqs = (\n        (emb_weight_param * emb_freqs).sum(dim=1)\n        + (proj_weights_param * proj_freqs.sum(dim=2)).sum(dim=1)\n        + (ffwd_weights_param * ffwd_freqs.sum(dim=2)).sum(dim=1)\n    )\n    probs = freqs.squeeze(dim=0).float() / freqs.sum(dim=1)\n\n    loss = torch.norm(probs - model_output, p=2)\n\n    losses.append(loss.item())\n\n    if step % eval_iters == 0:\n        print(f\"step {step}, loss: {loss.item():.3f}\")\n\n    # Take a step\n    loss.backward()\n\n    optimizer.step()\n\n    loss = loss.detach()\n    emb_freqs = emb_freqs.detach()\n    proj_freqs = proj_freqs.detach()\n    ffwd_freqs = ffwd_freqs.detach()\n    model_output = model_output.detach()\n\n\n\n\nstep 0, loss: 0.437\nstep 1000, loss: 0.017\nstep 2000, loss: 0.005\nstep 3000, loss: 0.005\nstep 4000, loss: 0.005\nstep 5000, loss: 0.005\nstep 6000, loss: 0.005\nstep 7000, loss: 0.005\nstep 8000, loss: 0.005\nstep 9000, loss: 0.005\nwith torch.no_grad():\n    freqs = (\n        (emb_weight_param * emb_freqs).sum(dim=1)\n        + (proj_weights_param * proj_freqs.sum(dim=2)).sum(dim=1)\n        + (ffwd_weights_param * ffwd_freqs.sum(dim=2)).sum(dim=1)\n    )\n    probs = freqs.squeeze(dim=0).float() / freqs.sum(dim=1)\n\n(\n    top_nonzero_tokens(probs, encoding_helpers.tokenizer.itos)[:10],\n    top_nonzero_tokens(model_output, encoding_helpers.tokenizer.itos)[:10]\n)\n\n([('a', 0.4609237313270569),\n  ('e', 0.35285136103630066),\n  ('o', 0.09236107766628265),\n  ('i', 0.09082776308059692),\n  ('v', 0.0006160509656183422),\n  ('r', 0.0005453210324048996),\n  ('l', 0.0005453210324048996),\n  ('n', 0.0005146691692061722),\n  ('c', 0.0005067135789431632),\n  ('d', 0.0003080254828091711)],\n [('a', 0.4602494537830353),\n  ('e', 0.35252559185028076),\n  ('o', 0.09188850224018097),\n  ('i', 0.09030349552631378),\n  ('u', 0.004192721098661423),\n  ('y', 0.0007521358784288168),\n  ('r', 6.647213740507141e-05),\n  ('l', 3.957989065384027e-06),\n  ('v', 2.812936827467638e-06),\n  ('w', 2.738903503995971e-06)])\nWhat if we tried these weights for everything?\nemb_weight_param.data, proj_weights_param.data, ffwd_weights_param.data\n\n(tensor([-1.0925]),\n tensor([[ 0.0070],\n         [-0.7119],\n         [ 1.1149],\n         [ 0.0808],\n         [-0.0404],\n         [-0.6956]]),\n tensor([[-0.1006],\n         [ 0.2627],\n         [ 0.0467],\n         [ 0.1357],\n         [ 0.6802],\n         [-1.1193]]))\n# Try a run using these weights for everything\n\ndef next_token_freqs_progressive_learned_weights(\n    prompt_idxs: torch.Tensor, ss_data: SimilarStringsFrequencyAndDistanceData\n):\n    emb_weight = emb_weight_param.data\n    proj_weights = proj_weights_param.data\n    ffwd_weights = ffwd_weights_param.data\n    freqs = (\n        (emb_weight * ss_data.emb_freqs[prompt_idxs, :]).sum(dim=1)\n        + (proj_weights * ss_data.proj_freqs[prompt_idxs, :, :, :].sum(dim=2)).sum(\n            dim=1\n        )\n        + (ffwd_weights * ss_data.ffwd_freqs[prompt_idxs, :, :, :].sum(dim=2)).sum(\n            dim=1\n        )\n    )\n    return freqs / freqs.sum(dim=1, keepdim=True)\n\ntry_next_token_freqs_function(\n    next_token_freqs_progressive_learned_weights, ss_data20k, strings, model_outputs20k\n)\n\nTop 1 matches: 0.548\nTop 1 matches (any order): 0.548\nTop 2 matches: 0.181\nTop 2 matches (any order): 0.184\nTop 3 matches: 0.098\nTop 3 matches (any order): 0.050\nTop 4 matches: 0.072\nTop 4 matches (any order): 0.021\nTop 5 matches: 0.060\nTop 5 matches (any order): 0.007\nTop 6 matches: 0.050\nTop 6 matches (any order): 0.004\nTop 7 matches: 0.040\nTop 7 matches (any order): 0.002\nTop 8 matches: 0.036\nTop 8 matches (any order): 0.002\nTop 9 matches: 0.031\nTop 9 matches (any order): 0.001\nTop 10 matches: 0.022\nTop 10 matches (any order): 0.000\nOk, clearly very bad.",
    "crumbs": [
      "analyses",
      "Interpreting the Projection and Feed-Forward Layers in a Self-Attention Block"
    ]
  },
  {
    "objectID": "analyses/clustering_block_intermediates.html#attempt-to-learn-weights-over-a-large-number-of-examples",
    "href": "analyses/clustering_block_intermediates.html#attempt-to-learn-weights-over-a-large-number-of-examples",
    "title": "Interpreting the Projection and Feed-Forward Layers in a Self-Attention Block",
    "section": "Attempt to learn weights over a large number of examples",
    "text": "Attempt to learn weights over a large number of examples\n\ndef get_batch(\n    batch_size: int,\n    ss_data: SimilarStringsFrequencyAndDistanceData,\n    split: str = 'train',\n    train_pct: float = 0.5,\n):\n    n_train = int(len(ss_data.string_to_idx) * train_pct)\n    low = 0 if split == 'train' else n_train\n    high = n_train if split == 'train' else len(ss_data.string_to_idx)\n\n    prompt_idxs = torch.randint(\n        low=low, high=high, size=(batch_size,), dtype=torch.long\n    )\n    batch_strings = [ss_data.strings[i.item()] for i in prompt_idxs]\n\n    emb_freqs = ss_data.emb_freqs[prompt_idxs, :, :]\n    proj_freqs = ss_data.proj_freqs[prompt_idxs, :, :, :]\n    ffwd_freqs = ss_data.ffwd_freqs[prompt_idxs, :, :, :]\n\n    tokens = encoding_helpers.tokenize_strings(batch_strings)\n    logits, _ = m(tokens)\n    model_output = F.softmax(logits[:, -1, :], dim=-1)\n\n    return (\n        emb_freqs.detach(),\n        proj_freqs.detach(),\n        ffwd_freqs.detach(),\n        model_output.detach(),\n    )\n\n\ntorch.manual_seed(1337) # Ensure stable random values\n\n# Initialize all the learnable params\nemb_weight_param = torch.nn.Parameter(\n    torch.randn(1, dtype=torch.float32), requires_grad=True\n).to(device)\nproj_weights_param = torch.nn.Parameter(\n    torch.randn(n_layer, 1, dtype=torch.float32), requires_grad=True\n).to(device)\nffwd_weights_param = torch.nn.Parameter(\n    torch.randn(n_layer, 1, dtype=torch.float32), requires_grad=True\n).to(device)\n\n\nlearning_rate = 3e-4\nmax_iters = 10000\neval_interval=500\neval_iters = 200\nbatch_size=100\n\n\n@torch.no_grad()\ndef estimate_loss():\n    out = {}\n    for split in ['train', 'val']:\n        losses = torch.zeros(eval_iters)\n        for k in range(eval_iters):\n            emb_freqs, proj_freqs, ffwd_freqs, model_output = get_batch(batch_size, ss_data20k, split='train', train_pct=0.5)\n\n            freqs = (\n                (emb_weight_param * emb_freqs).sum(dim=1)\n                + (proj_weights_param * proj_freqs.sum(dim=2)).sum(dim=1)\n                + (ffwd_weights_param * ffwd_freqs.sum(dim=2)).sum(dim=1)\n            )\n            probs = freqs.float() / freqs.sum(dim=1, keepdim=True)\n\n            loss = torch.norm(probs - model_output, p=2, dim=1).sum()\n            losses[k] = loss.item()\n\n        out[split] = losses.mean()\n    return out\n\n\noptimizer = torch.optim.AdamW([emb_weight_param, proj_weights_param, ffwd_weights_param], lr=learning_rate)\n\nfor step in tqdm(range(max_iters)):\n    optimizer.zero_grad()\n\n    emb_freqs, proj_freqs, ffwd_freqs, model_output = get_batch(batch_size, ss_data20k, split='train', train_pct=0.5)\n\n    freqs = (\n        (emb_weight_param * emb_freqs).sum(dim=1)\n        + (proj_weights_param * proj_freqs.sum(dim=2)).sum(dim=1)\n        + (ffwd_weights_param * ffwd_freqs.sum(dim=2)).sum(dim=1)\n    )\n    probs = freqs.float() / freqs.sum(dim=1, keepdim=True)\n\n    loss = torch.norm(probs - model_output, p=2, dim=1).sum()\n\n    if step % eval_interval == 0:\n        losses = estimate_loss()\n        print(f\"step {step}, train loss: {losses['train']:.3f}, val_loss {losses['val']:.3f}\")\n\n    # Take a step\n    loss.backward()\n\n    optimizer.step()\n\n\n\n\nstep 0, train loss: 18.787, val_loss 18.656\nstep 500, train loss: 18.488, val_loss 18.526\nstep 1000, train loss: 18.462, val_loss 18.536\nstep 1500, train loss: 18.320, val_loss 18.076\nstep 2000, train loss: 18.156, val_loss 18.145\nstep 2500, train loss: 18.047, val_loss 18.269\nstep 3000, train loss: 18.095, val_loss 18.123\nstep 3500, train loss: 18.156, val_loss 18.288\nstep 4000, train loss: 18.011, val_loss 17.939\nstep 4500, train loss: 17.811, val_loss 18.024\nstep 5000, train loss: 18.163, val_loss 18.125\nstep 5500, train loss: 18.144, val_loss 18.114\nstep 6000, train loss: 18.147, val_loss 18.117\nstep 6500, train loss: 17.959, val_loss 18.084\nstep 7000, train loss: 18.106, val_loss 18.113\nstep 7500, train loss: 17.988, val_loss 17.954\nstep 8000, train loss: 18.221, val_loss 18.156\nstep 8500, train loss: 18.161, val_loss 18.105\nstep 9000, train loss: 18.026, val_loss 18.064\nstep 9500, train loss: 18.170, val_loss 18.122\n\n\n\n# Try a run using these weights for everything\n\ndef next_token_freqs_progressive_learned_weights(\n    prompt_idxs: torch.Tensor, ss_data: SimilarStringsFrequencyAndDistanceData\n):\n    emb_weight = emb_weight_param.data\n    proj_weights = proj_weights_param.data\n    ffwd_weights = ffwd_weights_param.data\n    freqs = (\n        (emb_weight * ss_data.emb_freqs[prompt_idxs, :]).sum(dim=1)\n        + (proj_weights * ss_data.proj_freqs[prompt_idxs, :, :, :].sum(dim=2)).sum(\n            dim=1\n        )\n        + (ffwd_weights * ss_data.ffwd_freqs[prompt_idxs, :, :, :].sum(dim=2)).sum(\n            dim=1\n        )\n    )\n    return freqs / freqs.sum(dim=1, keepdim=True)\n\ntry_next_token_freqs_function(\n    next_token_freqs_progressive_learned_weights, ss_data20k, strings, model_outputs20k\n)\n\nTop 1 matches: 0.772\nTop 1 matches (any order): 0.772\nTop 2 matches: 0.403\nTop 2 matches (any order): 0.458\nTop 3 matches: 0.221\nTop 3 matches (any order): 0.251\nTop 4 matches: 0.149\nTop 4 matches (any order): 0.156\nTop 5 matches: 0.111\nTop 5 matches (any order): 0.102\nTop 6 matches: 0.088\nTop 6 matches (any order): 0.065\nTop 7 matches: 0.066\nTop 7 matches (any order): 0.037\nTop 8 matches: 0.052\nTop 8 matches (any order): 0.021\nTop 9 matches: 0.045\nTop 9 matches (any order): 0.013\nTop 10 matches: 0.033\nTop 10 matches (any order): 0.006\n\n\nThis is definitely the best result for top 2 we’ve seen and very nearly the best for top1.\n\nemb_weight_param.data, proj_weights_param.data, ffwd_weights_param.data\n\n(tensor([-0.0092]),\n tensor([[ 0.0223],\n         [-0.1555],\n         [ 0.0149],\n         [ 0.0122],\n         [-0.0932],\n         [-0.0848]]),\n tensor([[-0.5732],\n         [-0.7713],\n         [-0.6631],\n         [-0.7545],\n         [-1.1689],\n         [-2.0063]]))\n\n\n\nsim_learned_weights = ModelSimulation(\n    ss_data=ss_data20k,\n    compute_next_token_freqs=next_token_freqs_progressive_learned_weights,\n    encoding_helpers=encoding_helpers,\n)\n\n\nsim_learned_weights(['my most gr'])[0], model_outputs20k[ss_data20k.string_to_idx['my most gr']], sim20k(['my most gr'])[0]\n\n([('a', 0.7675697803497314),\n  ('i', 0.14597564935684204),\n  ('o', 0.055422890931367874),\n  ('e', 0.027286706492304802),\n  ('c', 0.0012530256062746048),\n  ('r', 0.0012431245995685458),\n  ('l', 0.0012431245995685458),\n  ('v', 0.0002444349229335785),\n  ('d', 0.00012221746146678925),\n  ('3', -0.0)],\n [('a', 0.4602494537830353),\n  ('e', 0.35252559185028076),\n  ('o', 0.09188850224018097),\n  ('i', 0.09030349552631378),\n  ('u', 0.004192721098661423),\n  ('y', 0.0007521358784288168),\n  ('r', 6.647213740507141e-05),\n  ('l', 3.957989065384027e-06),\n  ('v', 2.812936827467638e-06),\n  ('w', 2.738903503995971e-06)],\n [('a', 0.74631267786026),\n  ('i', 0.14454276859760284),\n  ('o', 0.05604719743132591),\n  ('e', 0.02654867246747017),\n  ('n', 0.005899704992771149),\n  ('c', 0.005899704992771149),\n  ('v', 0.005899704992771149),\n  ('d', 0.0029498524963855743),\n  ('r', 0.0029498524963855743),\n  ('l', 0.0029498524963855743)])",
    "crumbs": [
      "analyses",
      "Interpreting the Projection and Feed-Forward Layers in a Self-Attention Block"
    ]
  },
  {
    "objectID": "analyses/clustering_block_intermediates.html#cosine-similarity-results",
    "href": "analyses/clustering_block_intermediates.html#cosine-similarity-results",
    "title": "Interpreting the Projection and Feed-Forward Layers in a Self-Attention Block",
    "section": "Cosine Similarity Results",
    "text": "Cosine Similarity Results\nThe cosine similarity data generation ran overnight. Let’s look at the results.\n\nss_cos = SimilarStringsExperiment(\n    exp10.output_dir / 'similar_strings_cos',\n    encoding_helpers,\n)\nt_is = [7, 8, 9]\nss_cos_results = ss_cos.load_results_for_strings(strings, load_t_is=t_is)\n\n\nt_is = [7, 8, 9]\nss_data_cos = SimilarStringsFrequencyAndDistanceData.from_results(\n    ss_results=ss_cos_results,\n    next_token_map=next_token_map_all,\n    aggregate_over_t_is=t_is,\n    largest=True,\n)\ntry_next_token_freqs_function(\n    next_token_freqs_progressive_ffwd_weight, ss_data_cos, strings, model_outputs20k\n)\n\nTop 1 matches: 0.750\nTop 1 matches (any order): 0.750\nTop 2 matches: 0.366\nTop 2 matches (any order): 0.415\nTop 3 matches: 0.191\nTop 3 matches (any order): 0.207\nTop 4 matches: 0.134\nTop 4 matches (any order): 0.125\nTop 5 matches: 0.096\nTop 5 matches (any order): 0.077\nTop 6 matches: 0.077\nTop 6 matches (any order): 0.045\nTop 7 matches: 0.060\nTop 7 matches (any order): 0.024\nTop 8 matches: 0.050\nTop 8 matches (any order): 0.014\nTop 9 matches: 0.040\nTop 9 matches (any order): 0.008\nTop 10 matches: 0.033\nTop 10 matches (any order): 0.003\n\n\nThe results are pretty similar to the best we saw with Eucledian distance. But here’s something interesting: let’s flip the largest param so that it’s not looking for the largest cosine similarity, but the smallest. This will mean we’re looking at less similar samples.\n\nt_is = [7, 8, 9]\nss_data_cos = SimilarStringsFrequencyAndDistanceData.from_results(\n    ss_results=ss_cos_results,\n    next_token_map=next_token_map_all,\n    aggregate_over_t_is=t_is,\n    largest=False,\n)\n\n\ntry_next_token_freqs_function(\n    next_token_freqs_progressive_ffwd_weight, ss_data_cos, strings, model_outputs20k\n)\n\nTop 1 matches: 0.783\nTop 1 matches (any order): 0.783\nTop 2 matches: 0.422\nTop 2 matches (any order): 0.484\nTop 3 matches: 0.233\nTop 3 matches (any order): 0.271\nTop 4 matches: 0.170\nTop 4 matches (any order): 0.181\nTop 5 matches: 0.128\nTop 5 matches (any order): 0.119\nTop 6 matches: 0.101\nTop 6 matches (any order): 0.076\nTop 7 matches: 0.083\nTop 7 matches (any order): 0.041\nTop 8 matches: 0.069\nTop 8 matches (any order): 0.029\nTop 9 matches: 0.059\nTop 9 matches (any order): 0.018\nTop 10 matches: 0.051\nTop 10 matches (any order): 0.011\n\n\nThe results actually get BETTER! In fact, these are the best results yet.\n(I’m writing this up as if it were an intentional experiment but in fact I found this by accident. At first when I ran the cosine similarity results, I didn’t have a largest parameter to pass into SimilarStringsFrequencyAndDistanceData.from_results(). So it was in fact doing the largest=False version. I got the results above. Then I fixed it to thread largeest through and the results got worse. And that inspired this line of thought.)\nThis suggests I’ve gotten something fundamentally wrong thus far. I’ve been trying methods to find more and more similar values: looking for more similar values amongst shorter strings, investigating cosine similarity as a potentially better metric. But maybe the model is actually a much wider net i.e. the predictions from a given embedding are an aggregate of similar values from a much wider range.\nThis explains why efforts to produce more similar values yield worse results e.g. the results from the aggregation of t_is from 3-9 produces more similar values, but worse overall results. Perhaps there just isn’t enough variety in the most similar values to produce final results that resemble the model’s predictions.\nLet’s try a few experiments to test this hypothesis.\nFirst, let’s look at the cosine results with largest=True but only considering t_i=9:\n\nt_is = [9]\nss_cos_results_only9 = ss_cos.load_results_for_strings(strings, load_t_is=t_is)\n\n\nss_data_cos = SimilarStringsFrequencyAndDistanceData.from_results(\n    ss_results=ss_cos_results,\n    next_token_map=next_token_map_all,\n    aggregate_over_t_is=t_is,\n    largest=True,\n)\n\n\ntry_next_token_freqs_function(\n    next_token_freqs_progressive_ffwd_weight, ss_data_cos, strings, model_outputs20k\n)\n\nTop 1 matches: 0.775\nTop 1 matches (any order): 0.775\nTop 2 matches: 0.397\nTop 2 matches (any order): 0.452\nTop 3 matches: 0.211\nTop 3 matches (any order): 0.237\nTop 4 matches: 0.143\nTop 4 matches (any order): 0.142\nTop 5 matches: 0.103\nTop 5 matches (any order): 0.087\nTop 6 matches: 0.082\nTop 6 matches (any order): 0.055\nTop 7 matches: 0.065\nTop 7 matches (any order): 0.029\nTop 8 matches: 0.054\nTop 8 matches (any order): 0.021\nTop 9 matches: 0.047\nTop 9 matches (any order): 0.010\nTop 10 matches: 0.038\nTop 10 matches (any order): 0.005\n\n\nThis is better than the results from aggregating across t_is 7-9 with largest=True.\nWhat happens if we try largest=False with t_i=9?\n\nss_data_cos = SimilarStringsFrequencyAndDistanceData.from_results(\n    ss_results=ss_cos_results,\n    next_token_map=next_token_map_all,\n    aggregate_over_t_is=t_is,\n    largest=False,\n)\ntry_next_token_freqs_function(\n    next_token_freqs_progressive_ffwd_weight, ss_data_cos, strings, model_outputs20k\n)\n\nTop 1 matches: 0.783\nTop 1 matches (any order): 0.783\nTop 2 matches: 0.422\nTop 2 matches (any order): 0.484\nTop 3 matches: 0.233\nTop 3 matches (any order): 0.271\nTop 4 matches: 0.170\nTop 4 matches (any order): 0.181\nTop 5 matches: 0.128\nTop 5 matches (any order): 0.119\nTop 6 matches: 0.101\nTop 6 matches (any order): 0.076\nTop 7 matches: 0.083\nTop 7 matches (any order): 0.041\nTop 8 matches: 0.069\nTop 8 matches (any order): 0.029\nTop 9 matches: 0.059\nTop 9 matches (any order): 0.018\nTop 10 matches: 0.051\nTop 10 matches (any order): 0.011\n\n\nThis is better than largest=True but worse than when we aggregated ti_s 7-9. Probably because amonst the t_i=7 and t_i=8 values there were some less similar candidates.\nLet’s try the Euclidean distance version, but flip largest=True.\n\nt_is=[7, 8, 9]\nss_data20k_aggr_backwards = SimilarStringsFrequencyAndDistanceData.from_results(\n    ss_results=ss_results20k_all_t_is,\n    next_token_map=next_token_map_all,\n    aggregate_over_t_is=t_is,\n    largest=True,\n)\ntry_next_token_freqs_function(\n    next_token_freqs_progressive_ffwd_weight, ss_data20k_aggr_backwards, strings, model_outputs20k\n)\n\nTop 1 matches: 0.783\nTop 1 matches (any order): 0.783\nTop 2 matches: 0.426\nTop 2 matches (any order): 0.487\nTop 3 matches: 0.236\nTop 3 matches (any order): 0.275\nTop 4 matches: 0.171\nTop 4 matches (any order): 0.185\nTop 5 matches: 0.126\nTop 5 matches (any order): 0.120\nTop 6 matches: 0.102\nTop 6 matches (any order): 0.080\nTop 7 matches: 0.082\nTop 7 matches (any order): 0.045\nTop 8 matches: 0.072\nTop 8 matches (any order): 0.032\nTop 9 matches: 0.060\nTop 9 matches (any order): 0.019\nTop 10 matches: 0.052\nTop 10 matches (any order): 0.009\n\n\nI tried this several times, and it seems the sweet spot is with t_is=[7, 8, 9]. If you include smaller t_is, the results get progressively worse. Which suggests there is some upper bound to the distance that yields best results. Let’s see if we can hone in on the sweet spot.\n\nprint_sim_strings(ss_results20k_all_t_is['my most gr'], aggregate_over_t_is=[7, 8, 9], largest=True)\n\nProj Outputs\n    'om is gr' (3.76)    ' dost gi' (4.09)    'st my gr' (6.16)    'must giv' (6.67)    'ost my c' (7.47)  'my merry m' (5.45)\n    'at is gr' (3.75)    'uldst gi' (4.09)    ' some gr' (6.10)    ' many ge' (6.64)    'my own d' (7.46)  'my most he' (5.34)\n    'on my gu' (3.75)    'heart go' (4.07)    ' more gr' (6.00)    ' many gu' (6.64)    'ms thy c' (7.41)   'm my moth' (5.25)\n    ' dost gu' (3.72)    'canst gi' (4.04)    'ommon gr' (5.95)    'most gui' (6.42)    'y most g' (7.41)  'mt my mast' (5.22)\n    's not gu' (3.71)    ' last go' (4.03)    ' most gu' (5.83)   ', most gr' (6.13)    'most gen' (7.38)  'm thy moth' (5.22)\n    ' most gr' (3.68)    ' most go' (4.03)    ' most go' (5.79)  'e, most gr' (6.00)    's most r' (7.25)    'm thy mo' (5.21)\n    'or my gu' (3.68)    ' most gi' (4.00)   ' most\\ngl' (5.57)  'e; most go' (5.96)    'e most r' (7.16)    'my misfo' (5.20)\n    'nt is gu' (3.67)   '\\nMust gi' (3.94)   's more gr' (5.57)   'o most go' (5.81)    ' most gr' (7.08)  'my high bl' (5.20)\n    ' must gr' (3.64)    ' must gi' (3.92)   'd most gu' (5.55)  'ld most gl' (5.64)  'my young l' (6.87)   'mes my br' (5.18)\n    ' most gu' (3.55)    ' must go' (3.83)   'common gr' (5.48)    'most gla' (5.57)   'r most gr' (6.87)    'mt my ma' (5.17)\n\nFFwd Outputs\n   'e stirs: ' (6.66)   'm that gr' (6.03)    't not gr' (4.03)    ' many gr' (5.31)    'om my gr' (6.22)    'rk my gr' (5.52)\n   'h still: ' (6.66)   'n that gr' (6.03)    'es to gr' (4.03)    ' more gr' (5.27)    'ge or gr' (6.19)   'ty nor gr' (5.42)\n   's hands: ' (6.66)   ' great gr' (6.03)    ' past gr' (4.03)    'ut my gr' (5.26)    'at my gr' (6.12)   'on her gr' (5.41)\n   'o it is: ' (6.66)   'ferent gr' (6.02)    'ur to gr' (4.02)    ' good gr' (5.25)    'steel gr' (6.11)   'or old gr' (5.40)\n   ' sights: ' (6.66)   'ng but gr' (6.02)    ' must gr' (4.01)    ' made gr' (5.20)    'is my gr' (6.10)    'as my gr' (5.37)\n   ', it is: ' (6.65)   's most gr' (6.02)    'd not gr' (3.99)    'r own gr' (5.17)    'in me gr' (5.92)   'o many gr' (5.36)\n   'r it is: ' (6.65)   'r most gr' (6.01)    'l not gr' (3.98)    ' some gr' (5.14)   ' to my gr' (5.92)    'ot my gr' (5.33)\n   't it is: ' (6.64)   'ervant gr' (6.00)    ' fast gr' (3.97)    '-made gr' (5.06)    'ot my gr' (5.91)    ' many gr' (5.32)\n   ' a kiss: ' (6.63)   'mphant gr' (5.99)    ' from gr' (3.97)    'ommon gr' (4.96)    'ut my gr' (5.79)   'hat my gr' (5.29)\n   's it is: ' (6.63)   'cannot gr' (5.96)   'her to gr' (3.91)   'o many gr' (4.84)   'd more gr' (5.76)    'ommon gr' (5.27)\n\n\n\nprint_sim_strings(ss_results20k_all_t_is['my most gr'], aggregate_over_t_is=[6, 7, 8, 9], largest=True)\n\nProj Outputs\n    '.\\nKing ' (4.46)     ' yet gr' (4.76)    'st my gr' (6.16)    'must giv' (6.67)    'ost my c' (7.47)  'my merry m' (5.45)\n     'm to gi' (4.46)    '\\nLet go' (4.75)     'some gr' (6.14)    ' many ge' (6.64)    'my own d' (7.46)  'my most he' (5.34)\n     ', or gi' (4.46)     'most gi' (4.75)    ' some gr' (6.10)    ' many gu' (6.64)     ' most g' (7.41)   'm my moth' (5.25)\n     'k to gi' (4.46)     'past gr' (4.73)     'm my gr' (6.06)    'most gui' (6.42)    'ms thy c' (7.41)  'mt my mast' (5.22)\n     '; to gr' (4.46)     'Most go' (4.72)    ' more gr' (6.00)     'm my gr' (6.37)    'y most g' (7.41)  'm thy moth' (5.22)\n    '\\nFor gi' (4.46)     'fast gr' (4.72)    'ommon gr' (5.95)     'more gr' (6.31)    'most gen' (7.38)    'm thy mo' (5.21)\n     'm is gr' (4.44)     'must gr' (4.71)    ' most gu' (5.83)     'most gi' (6.31)    'most\\ngl' (7.37)    'my misfo' (5.20)\n     ', so gi' (4.44)    '\\nBut gr' (4.70)     'most go' (5.80)     'must gr' (6.16)     ' most y' (7.36)  'my high bl' (5.20)\n     'From gi' (4.41)     'most gr' (4.69)    ' most go' (5.79)   ', most gr' (6.13)    ' most\\ng' (7.35)   'mes my br' (5.18)\n     'n, jog ' (4.33)     'Must gi' (4.69)     'more gr' (5.78)     't my gr' (6.11)    's most r' (7.25)    'mt my ma' (5.17)\n\nFFwd Outputs\n   'e stirs: ' (6.66)   'm that gr' (6.03)     'n to gr' (4.24)    ' many gr' (5.31)     'l my gr' (6.24)     'nown gr' (5.62)\n   'h still: ' (6.66)   'n that gr' (6.03)     'w to gr' (4.23)    ' more gr' (5.27)     'mmon gr' (6.24)     'many gr' (5.53)\n   's hands: ' (6.66)   ' great gr' (6.03)     't to gr' (4.22)    'ut my gr' (5.26)    'om my gr' (6.22)    'rk my gr' (5.52)\n   'o it is: ' (6.66)   'ferent gr' (6.02)     'must gr' (4.22)    ' good gr' (5.25)     'from gr' (6.21)     ' now gr' (5.44)\n   ' sights: ' (6.66)   'ng but gr' (6.02)     'mous gr' (4.20)    ' made gr' (5.20)    'ge or gr' (6.19)     ' own gr' (5.43)\n   ', it is: ' (6.65)   's most gr' (6.02)     'r to gr' (4.13)    'r own gr' (5.17)    'at my gr' (6.12)     '? or gr' (5.43)\n   'r it is: ' (6.65)   'r most gr' (6.01)     'l to gr' (4.12)    ' some gr' (5.14)    'steel gr' (6.11)   'ty nor gr' (5.42)\n   't it is: ' (6.64)   'ervant gr' (6.00)     's to gr' (4.05)     'ttle gr' (5.07)     'teel gr' (6.10)     'ndly gr' (5.41)\n   ' a kiss: ' (6.63)   'mphant gr' (5.99)     ' not gr' (4.05)     ' not gr' (5.06)    'is my gr' (6.10)   'on her gr' (5.41)\n   's it is: ' (6.63)   'cannot gr' (5.96)    't not gr' (4.03)    '-made gr' (5.06)     't or gr' (5.97)   'or old gr' (5.40)\n\n\nThis is a pretty crude analysis because we only have what we thought were the top 10 most similar values and we’re flipping the whether we’re looking for smallest vs largest. But these numbers give a ballpark of the distances that are worth considering.",
    "crumbs": [
      "analyses",
      "Interpreting the Projection and Feed-Forward Layers in a Self-Attention Block"
    ]
  },
  {
    "objectID": "analyses/clustering_block_intermediates.html#identify-a-small-sample-of-strings-that-produce-similar-results",
    "href": "analyses/clustering_block_intermediates.html#identify-a-small-sample-of-strings-that-produce-similar-results",
    "title": "Interpreting the Projection and Feed-Forward Layers in a Self-Attention Block",
    "section": "Identify a small sample of strings that produce similar results",
    "text": "Identify a small sample of strings that produce similar results\n\nsample_size = 500\nstrings_sample = strings[:sample_size]\nmodel_outputs_sample = model_outputs20k[:sample_size]\n\n\ntry_next_token_freqs_function(\n    next_token_freqs_progressive_ffwd_weight, ss_data20k_aggr_backwards, strings_sample, model_outputs_sample\n)\n\nTop 1 matches: 0.778\nTop 1 matches (any order): 0.778\nTop 2 matches: 0.416\nTop 2 matches (any order): 0.464\nTop 3 matches: 0.212\nTop 3 matches (any order): 0.266\nTop 4 matches: 0.156\nTop 4 matches (any order): 0.166\nTop 5 matches: 0.126\nTop 5 matches (any order): 0.116\nTop 6 matches: 0.108\nTop 6 matches (any order): 0.068\nTop 7 matches: 0.094\nTop 7 matches (any order): 0.032\nTop 8 matches: 0.072\nTop 8 matches (any order): 0.032\nTop 9 matches: 0.058\nTop 9 matches (any order): 0.020\nTop 10 matches: 0.056\nTop 10 matches (any order): 0.016\n\n\nOK, these are reasonably similar results.",
    "crumbs": [
      "analyses",
      "Interpreting the Projection and Feed-Forward Layers in a Self-Attention Block"
    ]
  },
  {
    "objectID": "analyses/clustering_block_intermediates.html#analysis-of-whether-there-are-similar-strings-of-smaller-length",
    "href": "analyses/clustering_block_intermediates.html#analysis-of-whether-there-are-similar-strings-of-smaller-length",
    "title": "Interpreting the Projection and Feed-Forward Layers in a Self-Attention Block",
    "section": "Analysis of whether there are similar strings of smaller length",
    "text": "Analysis of whether there are similar strings of smaller length\n\nslens = [3, 5, 9, 10]\n\n\nstrings_n = {\n    n: all_unique_substrings(ts.text, n)\n    for n in slens\n}\n\n\nnext_token_maps = {\n    n: build_next_token_map(\n        ts.text, prefix_len=n, vocab_size=tokenizer.vocab_size, stoi=tokenizer.stoi\n    )\n    for n in slens\n}\n\n\nfor n in slens:\n    if list((environment.data_root / f'block_internals_results/large_files/slen{n}/').glob('*')) == []:\n        print(f\"Run `make block_internals_slen{n}_dataset` in the project root to generate the required dataset\")\n\n\nexps = {\n    n: BatchedBlockInternalsExperiment(\n        eh=encoding_helpers,\n        accessors=accessors,\n        strings=strings_n[n],\n        output_dir=environment.data_root / f'block_internals_results/large_files/slen{n}/',\n        batch_size=10000,\n    )\n    for n in slens\n}\n\n\ndef compare_similar_strings(\n    prompt: str,\n    block_idx: int,\n    compare_to_slen: int,\n):\n    prompt_accessors = BlockInternalsAccessors(prompt, encoding_helpers, accessors)\n\n    sim_strings_comp, distances_comp = exps[compare_to_slen].strings_with_topk_closest_proj_outputs(\n        block_idx=block_idx,\n        t_i=-1,\n        queries=prompt_accessors.proj_output(block_idx=block_idx)[:, -1, :],\n        k=10,\n        largest=False,\n    )\n\n    sim_strings, distances = exps[len(prompt)].strings_with_topk_closest_proj_outputs(\n        block_idx=block_idx,\n        t_i=-1,\n        queries=prompt_accessors.proj_output(block_idx=block_idx)[:, -1, :],\n        k=10,\n        largest=False,\n    )\n\n    print(f\"Length {compare_to_slen} similars:   Length {len(prompt)} similars:\")\n    for i in range(10):\n        print(f'{repr(sim_strings_comp[0][i])} {distances_comp[i].item():.3f}        {repr(sim_strings[0][i])} {distances[i].item():.3f}')\n\nAfter running this a bunch of times, my conclusions from this are:\n\nYes it’s possible to find similar strings with clear patterns in shorter strings\nThe distances are greater when the strings are shorter\nBut seeing which shorter strings are similar is illuminating\n\ne.g. for block_idx = 1, looking at similar strings of length 5 vs same length as the prompt:\n\nprompt = 'my most gr'\ncompare_similar_strings(prompt, block_idx=1, compare_to_slen=5)\n\nLength 5 similars:   Length 10 similars:\n'st go' 4.564        'my most gr' 0.000\n'ot gl' 4.591        'ur most gr' 0.949\n'st ga' 4.595        'ne most gr' 0.958\n'ot ga' 4.609        'he most gr' 1.053\n'st gl' 4.629        'is most gr' 1.056\n'ot gr' 4.638        'e, most gr' 1.268\n'st gr' 4.639        'o, must gr' 1.352\n'rt go' 4.647        't, most gr' 1.361\n'st gi' 4.662        'be past gr' 1.372\n'et go' 4.679        'yet not gr' 1.506\n\n\nAll the length 5 similar strings have `s t`` in common.\nNow look at block 5:\n\nprompt = 'my most gr'\ncompare_similar_strings(prompt, block_idx=5, compare_to_slen=5)\n\nLength 5 similars:   Length 10 similars:\n'my mo' 4.464        'my most gr' 0.000\n'my st' 4.917        'my most st' 3.911\n'my br' 4.969        'my most sa' 4.328\n'my tr' 4.977        ' my most r' 4.556\n'my gr' 5.039        ' my most l' 5.160\n'my sw' 5.115        'my high bl' 5.198\n'my sc' 5.132        'm thy moth' 5.221\n'my wr' 5.140        'mt my mast' 5.225\n'my bl' 5.215        'my most he' 5.338\n'my tw' 5.267        'my merry m' 5.445\n\n\nHere the common pattern in the length 5 strings is my.\nI think this says something. The closest length 5 strings could have been any substring of the full prompt. Seeing what gets picked must be meaningful.\nLet’s try with length 3:\n\nprompt = 'my most gr'\ncompare_similar_strings(prompt, block_idx=1, compare_to_slen=3)\n\nLength 3 similars:   Length 10 similars:\n' gn' 6.114        'my most gr' 0.000\n' gy' 6.142        'ur most gr' 0.949\n' gl' 6.156        'ne most gr' 0.958\n' gr' 6.166        'he most gr' 1.053\n' gu' 6.202        'is most gr' 1.056\n' gh' 6.218        'e, most gr' 1.268\n' go' 6.231        'o, must gr' 1.352\n' ga' 6.232        't, most gr' 1.361\n' ge' 6.267        'be past gr' 1.372\n' gi' 6.397        'yet not gr' 1.506\n\n\nGreater distance but still, a pattern. And block 5:\n\nprompt = 'my most gr'\ncompare_similar_strings(prompt, block_idx=5, compare_to_slen=3)\n\nLength 3 similars:   Length 10 similars:\n'mys' 6.682        'my most gr' 0.000\n'my-' 6.722        'my most st' 3.911\n'ms-' 7.015        'my most sa' 4.328\n'myr' 7.065        ' my most r' 4.556\n'mso' 7.115        ' my most l' 5.160\n\"my'\" 7.123        'my high bl' 5.198\n'my?' 7.148        'm thy moth' 5.221\n'mfu' 7.158        'mt my mast' 5.225\n'moc' 7.168        'my most he' 5.338\n\"ms'\" 7.214        'my merry m' 5.445\n\n\nA different pattern, but still a pattern.\nLet’s see if we can do this with just the length 10 data and not have to generate all the block internals data for the other string lengths from scratch.\nAs a prereq, let’s first see if the intermediate values for substrings within a longer string are the same as the values that would have been produced for those substrings on their own.\n\n# Show that for the common letters, the intermediates for a substring\n# are the same as those in a longer string.\nprompt_short = 'my mo'\nprompt_long = 'my most gr'\n\nbia_short = BlockInternalsAccessors(prompt_short, encoding_helpers, accessors)\nbia_long = BlockInternalsAccessors(prompt_long, encoding_helpers, accessors)\n\nfor t_i in range(len(prompt_short)):\n    for block_idx in range(n_layer):\n        test_close(\n            bia_short.proj_output(block_idx=block_idx)[0, t_i, :],\n            bia_long.proj_output(block_idx=block_idx)[0, t_i, :],\n        )\n        test_close(\n            bia_short.ffwd_output(block_idx=block_idx)[0, t_i, :],\n            bia_long.ffwd_output(block_idx=block_idx)[0, t_i, :],\n        )\n\nIt passes, so this shows we can use the values at the other t_i’s from the slen10 dataset. Let’s try it.\n\nfull_slen=10\ntarget_exp = exps[full_slen]\n\n\ndef compare_similar_strings2(\n    prompt: str,\n    block_idx: int,\n    compare_to_slen: int,\n):\n    \"\"\"Same as compare_similar_strings() above but just uses a single experiment.\"\"\"\n    prompt_accessors = BlockInternalsAccessors(prompt, encoding_helpers, accessors)\n\n    # indexing `compare_to_slen - 1` below because slicers2 is indexed\n    # by t_i, not string length\n    sim_strings_comp, distances_comp = target_exp.strings_with_topk_closest_proj_outputs(\n        block_idx=block_idx,\n        t_i=compare_to_slen - 1,\n        queries=prompt_accessors.proj_output(block_idx=block_idx)[:, -1, :],\n        k=10,\n        largest=False,\n    )\n\n    sim_strings, distances = exps[len(prompt)].strings_with_topk_closest_proj_outputs(\n        block_idx=block_idx,\n        t_i=-1,\n        queries=prompt_accessors.proj_output(block_idx=block_idx)[:, -1, :],\n        k=10,\n        largest=False,\n    )\n\n    print(f\"Length {compare_to_slen} similars:   Length {len(prompt)} similars:\")\n    for i in range(10):\n        print(f'{repr(sim_strings_comp[0][i][:compare_to_slen])} {distances_comp[i].item():.3f}        {repr(sim_strings[0][i])} {distances[i].item():.3f}')\n\n\nprompt = 'my most gr'\ncompare_similar_strings2(prompt, block_idx=5, compare_to_slen=5)\n\nLength 5 similars:   Length 10 similars:\n'my mo' 4.464        'my most gr' 0.000\n'my st' 4.917        'my most st' 3.911\n'my br' 4.969        'my most sa' 4.328\n'my tr' 4.977        ' my most r' 4.556\n'my gr' 5.039        ' my most l' 5.160\n'my sw' 5.115        'my high bl' 5.198\n'my sc' 5.132        'm thy moth' 5.221\n'my wr' 5.140        'mt my mast' 5.225\n'my bl' 5.215        'my most he' 5.338\n'my tw' 5.267        'my merry m' 5.445\n\n\nNotice that this is the same as the output above when we compared to a length 5 experiment’s outputs!\nAnd now we can do it for other lengths without having to run experiments for all of them.\n\nprompt = 'my most gr'\ncompare_similar_strings2(prompt, block_idx=5, compare_to_slen=9)\n\nLength 9 similars:   Length 10 similars:\n'my most r' 2.754        'my most gr' 0.000\n'my most l' 3.517        'my most st' 3.911\n'my most h' 3.795        'my most sa' 4.328\n'm my mout' 4.802        ' my most r' 4.556\n'm thy mot' 4.808        ' my most l' 5.160\n'm, my mot' 4.832        'my high bl' 5.198\n'y most gr' 4.976        'm thy moth' 5.221\n'my most g' 5.051        'mt my mast' 5.225\n'mes my br' 5.177        'my most he' 5.338\n'm my moth' 5.252        'my merry m' 5.445",
    "crumbs": [
      "analyses",
      "Interpreting the Projection and Feed-Forward Layers in a Self-Attention Block"
    ]
  },
  {
    "objectID": "analyses/clustering_block_intermediates.html#try-out-loading-with-mmap_mode",
    "href": "analyses/clustering_block_intermediates.html#try-out-loading-with-mmap_mode",
    "title": "Interpreting the Projection and Feed-Forward Layers in a Self-Attention Block",
    "section": "Try out loading with mmap_mode",
    "text": "Try out loading with mmap_mode\n\nCode in this section doesn’t run anymore because the Slicer doesn’t exist and some other internal changes have been made based on the experiments here, but I’m leaving this in for the historical record.\n\nSet up a query:\n\nprompt = 'my most gr'\nprompt_accessors = BlockInternalsAccessors(prompt, encoding_helpers, accessors)\nquery = prompt_accessors.proj_output(block_idx=0)[:, -1, :]\n\nTime loading a full batch from slen10 the regular way and subtracting the query:\n\nbatch = torch.load(exps[10].output_dir / 'proj_output-000-00.pt')\nbatch - query\n\n28.4 ms ± 348 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)\n\n\nNow load with mmap=True and try again:\n\nbatch = torch.load(str(exps[10].output_dir / 'proj_output-000-00.pt'), mmap=True)\nbatch - query\n\n11.8 ms ± 56.3 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)\n\n\nOoh, it’s way faster. Let’s see if we can load multiple batches, cat them and do the subtraction:\n\nbatch1 = torch.load(str(exps[10].output_dir / 'proj_output-000-00.pt'), mmap=True)\nbatch2 = torch.load(str(exps[10].output_dir / 'proj_output-001-00.pt'), mmap=True)\nbatch3 = torch.load(str(exps[10].output_dir / 'proj_output-002-00.pt'), mmap=True)\n\nbig_batch = torch.cat([batch1, batch2, batch3])\nbig_batch - query\n\n52.1 ms ± 637 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)\n\n\nWow. OK, this is a big deal. We did 3 batches in 51ms vs 28.ms for just one batch in the regular way. And I suspect this scales non-linearly. Let’s try it with all the batches:\n\nbig_batch = torch.cat([\n    torch.load(str(exps[10]._proj_output_filename(batch_idx=batch_idx, block_idx=0)), mmap=True)\n    for batch_idx in range(exps[10].n_batches)\n])\nbig_batch - query\n\n8.88 s ± 294 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n\n\nSo 8.88s for 86 batches. Memory usage peaked at 25GB during the run but went up and down and settled back down to where it was before the run started.\nBut that’s 103ms per batch which seems slower than just loading each batch one at a time. But the computation is simpler (no need for topk_across_batches() etc).\nLet’s try running through all the batches the old way (no mmap) and time it.\n\nfor batch_idx in range(exps[10].n_batches):\n    batch = torch.load(str(exps[10]._proj_output_filename(batch_idx=batch_idx, block_idx=0))) # no mmap\n    batch - query\n\n3.32 s ± 157 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n\n\nSo this is actually faster. But let’s try to do more of the complete operation and do multiple queries:\n\n# Define prompts and extract the query values\nprompts = ['First Citi', 'Citizen:\\nB', 'Shyamalan ', 'more in jo']\nprompts_exp = BlockInternalsExperiment(encoding_helpers, accessors, prompts)\n\nt_i = -1\n\nqueries = prompts_exp.proj_output(block_idx=0)[:, t_i, :]\n\nTime doing the equivalent of strings_with_topk_closest_ffwd_outputs() on the mmaped data:\n\nbig_batch = torch.cat([\n    torch.load(str(exps[10]._proj_output_filename(batch_idx=batch_idx, block_idx=0)), mmap=True)\n    for batch_idx in range(exps[10].n_batches)\n])\n\nn_queries, _ = queries.shape\nB, T, _ = big_batch.shape\ndistances = torch.norm(\n    big_batch[:, t_i, :].reshape(B, 1, -1).expand(-1, n_queries, -1) - queries,\n    dim=2\n)\ntopk = torch.topk(distances, k=10, dim=0, largest=False)\nexps[10].strings_from_indices(topk.indices), topk.values\n\n6.51 s ± 395 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n\n\nOK, that is slow. But I suspect there is some overhead in loading the data the first time. What if we load the data once and then process the queries on the loaded data:\n\nbig_batch = torch.cat([\n    torch.load(str(exps[10]._proj_output_filename(batch_idx=batch_idx, block_idx=0)), mmap=True)\n    for batch_idx in range(exps[10].n_batches)\n])\n\n\nn_queries, _ = queries.shape\nB, T, _ = big_batch.shape\ndistances = torch.norm(\n    big_batch[:, t_i, :].reshape(B, 1, -1).expand(-1, n_queries, -1) - queries,\n    dim=2\n)\ntopk = torch.topk(distances, k=10, dim=0, largest=False)\nexps[10].strings_from_indices(topk.indices), topk.values\n\n303 ms ± 8.63 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n\n\nCompare that to doing it with a slicer.\n\nslicers[10].strings_with_topk_closest_proj_outputs(block_idx=0, queries=queries, k=10, largest=False)\n\n471 ms ± 3.27 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n\n\nWe don’t have the required methods on the exp class anymore, but if we want to test how long this would have taken without the slicer i.e. on the same data that the mmap version is using but without using mmap, we can resurrect the relevant code:\n\n# Copy of the code from block_internals, just so we can run it below\ndef batch_distances(batch: torch.Tensor, queries: torch.Tensor) -&gt; torch.Tensor:\n    \"\"\"Returns the distance between each item in the batch and the queries.\"\"\"\n    assert batch.dim() == 2, f\"batch.dim() should be 2, was {batch.dim()}\"\n    assert queries.dim() == 2, f\"query.dim() should be 2, was {queries.dim()}\"\n    assert (\n        batch.shape[-1] == queries.shape[-1]\n    ), f\"last dimension of batch was {batch.shape[-1]}, which does not match last dimension of queries {queries.shape[-1]}\"\n\n    B, _ = batch.shape\n    n_queries, _ = queries.shape\n\n    distances = torch.norm(\n        # Reshape the batch to a singleton dimension, then expand that dimension\n        # by the number of queries. We can then subtract all the queries in one\n        # go.\n        batch.reshape(B, 1, -1).expand(-1, n_queries, -1) - queries,\n        dim=2\n    )\n    return distances\n\n\nn_queries, _ = queries.shape\nvalues, indices = topk_across_batches(\n    n_batches=exps[10].n_batches,\n    k=10,\n    largest=False,\n    load_batch=lambda i: torch.load(exps[10]._proj_output_filename(i, block_idx=0))[:, t_i, :],\n    process_batch=lambda batch: batch_distances(batch, queries=queries),\n)\nexps[10].strings_from_indices(indices), values\n\n2.18 s ± 29.7 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n\n\nThe mmap way is a faster than the slicer (303ms vs 471ms) and doesn’t require materializing the slices. And it’s waaaay faster than doing it without the slicer and without mmap (303ms vs 2.18s).\nIn summary: It seems there is a one-time cost to loading all the batches via:\nbig_batch = torch.cat([\n    torch.load(str(exps[10]._proj_output_filename(batch_idx=batch_idx, block_idx=0)), mmap=True)\n    for batch_idx in range(exps[10].n_batches)\n])\nBut this doesn’t take up too much memory (fresh Jupyter kernel running just the stuff in this and the previous section has about 13 GB of memory per Activity Monitor). So we can load this once and run a lot of queries very fast.\nLet’s check that the results are correct:\n\n# Do for real so we can compare the results\nbig_batch = torch.cat([\n    torch.load(str(exps[10]._proj_output_filename(batch_idx=batch_idx, block_idx=0)), mmap=True)\n    for batch_idx in range(exps[10].n_batches)\n])\n\nn_queries, _ = queries.shape\nB, T, _ = big_batch.shape\ndistances = torch.norm(\n    big_batch[:, t_i, :].reshape(B, 1, -1).expand(-1, n_queries, -1) - queries,\n    dim=2\n)\ntopk = torch.topk(distances, k=10, dim=0, largest=False)\nexps[10].strings_from_indices(topk.indices), topk.values\n\nsim_strings, distances = slicers[10].strings_with_topk_closest_proj_outputs(block_idx=0, queries=queries, k=10, largest=False)\ntest_eq(exps[10].strings_from_indices(topk.indices), sim_strings)\ntest_close(topk.values, distances)\n\nThese test pass, so the output is the same!\n\nPerf tests for using mmap with the slicer\nThe analysis above showed that using mmap on the raw batch data is faster than using the slicer. But yesterday I found that just setting mmap=True on the load_batch function when finding closest embeddings made a huge difference. Let’s try the same thing for the slicer and see if it makes a difference.\n\nt_i = -1\nqueries = prompts_exp.proj_output(block_idx=0)[:, t_i, :]\n\nThough we have a measurement for using the slicer above, let’s just replicate it for completeness. Ran this line before making any changes:\n\nslicers[10].strings_with_topk_closest_proj_outputs(block_idx=0, queries=queries, k=10, largest=False)\n\n482 ms ± 14.6 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n\n\nOK, that’s in line with the measurement above. Now let’s try it after changing the implementation to use mmap=True:\n\nslicers[10].strings_with_topk_closest_proj_outputs(block_idx=0, queries=queries, k=10, largest=False)\n\n361 ms ± 8.18 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n\n\nOK, so it got faster, but it’s still not as fast as using the raw batch data with mmap=True. So we’ll go with that.",
    "crumbs": [
      "analyses",
      "Interpreting the Projection and Feed-Forward Layers in a Self-Attention Block"
    ]
  },
  {
    "objectID": "analyses/clustering_block_intermediates.html#perf-tests-for-finding-closest-embeddings",
    "href": "analyses/clustering_block_intermediates.html#perf-tests-for-finding-closest-embeddings",
    "title": "Interpreting the Projection and Feed-Forward Layers in a Self-Attention Block",
    "section": "Perf tests for finding closest embeddings",
    "text": "Perf tests for finding closest embeddings\n\nexp10 = BatchedBlockInternalsExperiment(\n    eh=encoding_helpers,\n    accessors=accessors,\n    strings=strings_n[10],\n    output_dir=environment.data_root / 'block_internals_results/large_files/slen10/',\n    batch_size=10000,\n)\n\nMeasurement before any changes\n\nexp10.strings_with_topk_closest_embeddings(queries=prompts_exp.embeddings, k=10, largest=False)\n\n4.49 s ± 9.11 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n\n\nSimulate loading all the batch data at once and then finding the topk closest strings for all the queries:\n\nembeddings_data = torch.cat([\n    torch.load(str(exp10._embeddings_filename(batch_idx=batch_idx)), mmap=True)\n    for batch_idx in range(exp10.n_batches)\n])\n\n\n# Equivalent of topk_closest_embeddings - slow\nB, _, _ = embeddings_data.shape\n\nn_queries, _, _ = prompts_exp.embeddings.shape\n\ndistances = batch_distances(\n    embeddings_data.reshape(B, -1),\n    prompts_exp.embeddings.reshape(n_queries, -1)\n)\ntopk = torch.topk(distances, dim=0, k=k, largest=False)\nexp10.strings_from_indices(topk.indices), topk.values\n\nThe above was really slow and took a ton of memory.\nVerify that the equivalent thing on the proj_out data is still fast:\n\nproj_out_data = torch.cat([\n    torch.load(str(exp10._proj_output_filename(batch_idx=batch_idx, block_idx=0)), mmap=True)\n    for batch_idx in range(exp10.n_batches)\n])\n\n\nn_queries, _ = queries.shape\nB, T, _ = proj_out_data.shape\ndistances = torch.norm(\n    proj_out_data[:, t_i, :].reshape(B, 1, -1).expand(-1, n_queries, -1) - queries,\n    dim=2\n)\ntopk = torch.topk(distances, k=10, dim=0, largest=False)\nexp10.strings_from_indices(topk.indices), topk.values\n\nYes it is.\nSuspecting the issue is the reshape needed. Show that we can calculate the norm we want without the reshape.\nWhat the reshape does is stack the embeddings across the T dimension. We have embeddings\n\\[\ne_1, e_2, \\ldots, e_T \\in \\mathbb{R}^{n\\_embed}\n\\]\nBy stacking them, we get one big embedding:\n\\[\ne_{1:T} \\in \\mathbb{R}^{T * n\\_embed}\n\\]\nWe do the same with the queries:\n\\[\nq_1, q_2, \\ldots, q_T \\in \\mathbb{R}^{n\\_embed} \\rightarrow\nq_{1:T} \\in \\mathbb{R}^{T * n\\_embed}\n\\]\nWe then want to compute\n\\[\n\\Vert e_{1:T} - q_{1:T} \\Vert_2 = \\sqrt{\\sum_{i=1}^{T * n\\_embed} (e_{1:T} - q_{1:T})_i^2}\n\\]\nCan we get to this if we only have \\(e_1, e_2, \\ldots, e_T\\) and \\(q_1, q_2, \\ldots, q_T\\)? Yes, we can.\n\\[\n\\begin{align}\n\\Vert e_{1:T} - q_{1:T} \\Vert_2 &= \\sqrt{\\sum_{i=1}^{T * n\\_embed} (e_{1:T} - q_{1:T})_i^2} \\\\\n\\Vert e_{1:T} - q_{1:T} \\Vert_2^2 &= \\sum_{i=1}^{T * n\\_embed} (e_{1:T} - q_{1:T})_i^2 \\\\\n&=\\sum_{i=1}^{n\\_embed}(e_{1:T} - q_{1:T})_i^2 + \\sum_{i=n\\_embed+1}^{2*n\\_embed}(e_{1:T} - q_{1:T})_i^2 + \\ldots + \\sum_{i=(T-1)*n\\_embed+1}^{T*n\\_embed}(e_{1:T} - q_{1:T})_i^2 \\\\\n&=\\sum_{i=1}^{n\\_embed}(e_{1} - q_{1})_i^2 + \\sum_{i=1}^{n\\_embed}(e_{2} - q_{2})_i^2 + \\ldots + \\sum_{i=1}^{n\\_embed}(e_{T} - q_{T})_i^2 \\\\\n&=\\Vert e_1 - q_1 \\Vert_2^2 + \\Vert e_2 - q_2 \\Vert_2^2 + \\ldots + \\Vert e_T - q_T \\Vert_2^2 \\\\\n&=\\sum_{i=1}^{T}\\Vert e_i - q_i \\Vert_2^2\n\\end{align}\n\\]\nSo\n\\[\n\\begin{align}\n\\Vert e_{1:T} - q_{1:T} \\Vert_2 &= \\sqrt{\\sum_{i=1}^{T}\\Vert e_i - q_i \\Vert_2^2}\n\\end{align}\n\\]\nLet’s check it in code.\n\n# Show that we can effectively compute the norm without reshaping\nx = torch.randn((100, 5, 384))\nB, T, _ = x.shape\nq = torch.randn(5, 384)\n\nnorm1 = torch.norm(x.reshape(B, -1) - q.reshape(-1), dim=-1)\nnorm2 = (torch.norm(x - q, dim=-1) ** 2).sum(dim=-1).sqrt()\ntest_close(norm1, norm2)\n\nNow let’s do it with the embeddings\n\n# Version without reshaping\nB, _, _ = embeddings_data.shape\n\nn_queries, _, _ = prompts_exp.embeddings.shape\n\ndistances = (\n    torch.norm(embeddings_data.unsqueeze(dim=1).expand(-1, n_queries, -1, -1) - prompts_exp.embeddings, dim=-1) ** 2\n).sum(dim=-1).sqrt()\n\ntopk = torch.topk(distances, dim=0, k=10, largest=False)\nexp10.strings_from_indices(topk.indices), topk.values\n\n: \n\n\nThe above used so much memory that it crashed the kernel. So this is a no go. I think the fundamental problem is we’re computing over a lot more data: all elements of the T dimension vs just one with the proj_outputs/ffwd_outputs. So let’s go back to the original way of doing it in batches, but let’s see if it helps to load “super batches” by combining several of the batches on disk into one batch in memory.\n\n# Parameters for creating super batches\n\nk=10\nlargest=False\ncombine_n_batches = 5\n\nbatch_size = exp10.batch_size * combine_n_batches\nn_batches = math.ceil(len(exp10.strings) / batch_size)\nqueries = prompts_exp.embeddings\n\n\ndef _load_batch(batch_idx: int):\n    start = batch_idx * combine_n_batches\n    end = min((batch_idx + 1) * combine_n_batches, exp10.n_batches)\n\n    batch = torch.cat([\n        torch.load(\n            str(exp10._embeddings_filename(batch_idx=i)),\n            mmap=True,\n        )\n        for i in range(start, end)\n    ])\n    return batch\n\nn_queries, _, _ = queries.shape\n\ndef _process_batch(batch: torch.Tensor) -&gt; torch.Tensor:\n    B, _, _ = batch.shape\n    # Batch and queries and both shape (B, s_len, n_embed).\n    # For the purposes of finding the closest values, we\n    # reshape both the batch and queries to eliminate the\n    # s_len dimension, effectively concatenating all the\n    # embedding tensors across positions.\n    return batch_distances(batch.reshape(B, -1), queries.reshape(n_queries, -1))\n\nvalues, indices = topk_across_batches(\n    n_batches=n_batches,\n    k=k,\n    largest=largest,\n    load_batch=_load_batch,\n    process_batch=_process_batch,\n)\n\nexp10.strings_from_indices(indices), values\n\n4.19 s ± 35.9 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n\n\nThis helps only a tiny amount. And it seems to get faster the fewer number of batches we combine. So let’s just do it with one batch at a time. I added code to load the one batch in the existing implementation with mmap=True and timed it:\n\nexp10.strings_with_topk_closest_embeddings(queries=prompts_exp.embeddings, k=10, largest=False)\n\n3.34 s ± 46.2 ms per loop (mean ± std. dev. of 7 runs, 1 loop each)\n\n\nThis is the best result so far so we’ll go with this.",
    "crumbs": [
      "analyses",
      "Interpreting the Projection and Feed-Forward Layers in a Self-Attention Block"
    ]
  },
  {
    "objectID": "analyses/embedding_adjustments.html",
    "href": "analyses/embedding_adjustments.html",
    "title": "Embedding Adjustments",
    "section": "",
    "text": "environment = get_environment()\nprint(f\"environment is {environment.name}\")\n\nenvironment is local_mac\n\n\n\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\nm, tokenizer = create_model_and_tokenizer(\n    saved_model_filename=environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt',\n    dataset=ts,\n    device=device,\n)\n_, val_data = split_text_dataset(ts.text, tokenizer, train_pct=0.9, device=device)\nencoding_helpers = EncodingHelpers(tokenizer, device)\naccessors = TransformerAccessors(m, device)\n\n\n# Get all the unique substrings of length 10 from the text\nstrings10 = all_unique_substrings(text=ts.text, substring_length=10)\n\n\ntorch.manual_seed(1442)\nn_prompts = 20000\n\ntorch.manual_seed(1337)\nindices = torch.randperm(len(strings10))[:n_prompts]\nprompts = [strings10[i.item()] for i in indices]\nprompts[:5]\n\n['is dreams,', 'by present', 's eyes may', 'eart of ho', ' man, as I']\n\n\n\n# Tokenize the strings\ntokens = encoding_helpers.tokenize_strings(prompts)\n\n# Embed the tokens\naccessors = TransformerAccessors(m, device)\nembeddings = accessors.embed_tokens(tokens)\n\n# Run them through the model with hooks attached that let us look at\n# intermediate values\n_, io_accessors = accessors.run_model(embeddings)",
    "crumbs": [
      "analyses",
      "Embedding Adjustments"
    ]
  },
  {
    "objectID": "analyses/embedding_adjustments.html#preliminaries",
    "href": "analyses/embedding_adjustments.html#preliminaries",
    "title": "Embedding Adjustments",
    "section": "",
    "text": "environment = get_environment()\nprint(f\"environment is {environment.name}\")\n\nenvironment is local_mac\n\n\n\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\nm, tokenizer = create_model_and_tokenizer(\n    saved_model_filename=environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt',\n    dataset=ts,\n    device=device,\n)\n_, val_data = split_text_dataset(ts.text, tokenizer, train_pct=0.9, device=device)\nencoding_helpers = EncodingHelpers(tokenizer, device)\naccessors = TransformerAccessors(m, device)\n\n\n# Get all the unique substrings of length 10 from the text\nstrings10 = all_unique_substrings(text=ts.text, substring_length=10)\n\n\ntorch.manual_seed(1442)\nn_prompts = 20000\n\ntorch.manual_seed(1337)\nindices = torch.randperm(len(strings10))[:n_prompts]\nprompts = [strings10[i.item()] for i in indices]\nprompts[:5]\n\n['is dreams,', 'by present', 's eyes may', 'eart of ho', ' man, as I']\n\n\n\n# Tokenize the strings\ntokens = encoding_helpers.tokenize_strings(prompts)\n\n# Embed the tokens\naccessors = TransformerAccessors(m, device)\nembeddings = accessors.embed_tokens(tokens)\n\n# Run them through the model with hooks attached that let us look at\n# intermediate values\n_, io_accessors = accessors.run_model(embeddings)",
    "crumbs": [
      "analyses",
      "Embedding Adjustments"
    ]
  },
  {
    "objectID": "analyses/embedding_adjustments.html#define-some-helpful-functions",
    "href": "analyses/embedding_adjustments.html#define-some-helpful-functions",
    "title": "Embedding Adjustments",
    "section": "Define Some Helpful Functions",
    "text": "Define Some Helpful Functions\n\ndef logits_from_block_output(block_output: torch.Tensor, block_idx: int) -&gt; torch.Tensor:\n    # If we're not at the last layer, run the rest of the model, otherwise\n    # just get the logits from the embedding.\n    if block_idx &lt; n_layer - 1:\n        logits, _ = accessors.run_model_from_block_n(block_output, block_idx+1)\n    else:\n        logits = accessors.logits_from_embedding(block_output)\n    return logits\n\ndef probs_from_logits(logits: torch.Tensor) -&gt; torch.Tensor:\n    return F.softmax(logits, dim=-1)\n\n\ndef get_intermediates(block_idx: int, io_accessors: Sequence[InputOutputAccessor]) -&gt; Tuple[torch.Tensor, torch.Tensor, torch.Tensor]:\n    block_input = io_accessors[block_idx].input('.')\n    sa_output = io_accessors[block_idx].output('sa')\n    ffwd_output = io_accessors[block_idx].output('ffwd')\n    block_output = io_accessors[block_idx].output('.')\n\n    # Sanity check: block output is the sum of the block input, sa_output,\n    # and ffwd_output.\n    assert torch.all(block_output == block_input + sa_output + ffwd_output)\n\n    # Sanity check: the block output is the same as the next block's input\n    if block_idx &lt; n_layer - 1:\n        assert torch.all(block_output == io_accessors[block_idx+1].input('.'))\n\n    return block_input, sa_output, ffwd_output, block_output\n\n\ndef hellinger_distance(\n    p: torch.Tensor,\n    q: torch.Tensor,\n):\n    return ((p.sqrt() - q.sqrt())**2).sum(dim=-1).sqrt() / math.sqrt(2)",
    "crumbs": [
      "analyses",
      "Embedding Adjustments"
    ]
  },
  {
    "objectID": "analyses/embedding_adjustments.html#analysis",
    "href": "analyses/embedding_adjustments.html#analysis",
    "title": "Embedding Adjustments",
    "section": "Analysis",
    "text": "Analysis\nWithin a block, the input embedding is adjusted twice: first by adding the output of the self-attention module, then by adding the output of the feed-forward network to that sum:\nclass Block(nn.Module):\n    \"\"\"One transformer block\"\"\"\n\n    ...\n\n    def forward(self, x):\n        x = x + self.sa(self.ln1(x)) # The `x +` part is a skip connection\n        x = x + self.ffwd(self.ln2(x)) # The `x +` part is a skip connection\n\n        return x\nThis is equivalent to the following code, which, by using some intermediate local variables, makes the two adjustments a little clearer:\n    def forward(self, x):\n        sa_output = self.sa(self.ln1(x))\n        ffwd_output = self.ffwd(self.ln2(x + sa_output))\n\n        return x + sa_output + ffwd_output\nThe output of the block is the original embedding, plus the self-attention output, plus the feed-forward network output.\nIn this analysis, we’ll look at the impact of each of the two adjustments on the final output of the model. Specifically, compute the output logits from the original output of the block and compare this to the output logits that the model would have produced had the self-attention output not been added (i.e. if the block output had been just x + ffwd_output) and if the feed-forward network output had not been added (x + sa_output). We’ll also look at the impact on output probabilities.\n\ndef analyze_intermediate_impact(\n    block_idx: int,\n    sa_output: torch.Tensor,\n    ffwd_output: torch.Tensor,\n    block_output: torch.Tensor,\n):\n    print(f\"Block {block_idx}\")\n\n    # Get the logits that would have been produced by the normal block\n    # output. This is the baseline we're comparing against.\n    logits = logits_from_block_output(block_output[:, -1, :].unsqueeze(1), block_idx)\n\n    # Get the logits that would have been produced by the block output\n    # minus the self-attention output.\n    logits_no_sa = logits_from_block_output(\n        (block_output - sa_output)[:, -1, :].unsqueeze(1), block_idx\n    )\n\n    # Get the logits that would have been produced by the block output\n    # minus the feed-forward network output.\n    logits_no_ffwd = logits_from_block_output(\n        (block_output - ffwd_output)[:, -1, :].unsqueeze(1), block_idx\n    )\n\n    # Subtract the modified logits from the baseline logits and get the norms.\n    no_sa_diff_norms = (logits - logits_no_sa).norm(dim=-1)\n    no_ffwd_diff_norms = (logits - logits_no_ffwd).norm(dim=-1)\n\n    # Print stats\n    print(\n        f\"                                 Average norm of logits: {logits.norm(dim=-1).mean():&gt;5.2f} ± {logits.norm(dim=-1).std():.2f}\"\n    )\n    print(\n        f\"                Average norm of (logits - logits_no_sa): {no_sa_diff_norms.mean():&gt;5.2f} ± {no_sa_diff_norms.std():.2f}\"\n    )\n    print(\n        f\"              Average norm of (logits - logits_no_ffwd): {no_ffwd_diff_norms.mean():&gt;5.2f} ± {no_ffwd_diff_norms.std():.2f}\"\n    )\n\n    print()\n\n    # Compute probabilities from the baseline logits and the modified logits.\n    # Then compute the Hellinger distance between the two sets of probabilities.\n    h_no_sa = hellinger_distance(\n        probs_from_logits(logits), probs_from_logits(logits_no_sa)\n    )\n    h_no_ffwd = hellinger_distance(\n        probs_from_logits(logits), probs_from_logits(logits_no_ffwd)\n    )\n\n    # Print stats\n    print(\n        f\"  Average h(probs_from_logits, probs_from_logits_no_sa): {h_no_sa.mean():&gt;5.2f} ± {h_no_sa.std():.2f}, \"\n    )\n    print(\n        f\"Average h(probs_from_logits, probs_from_logits_no_ffwd): {h_no_ffwd.mean():&gt;5.2f} ± {h_no_ffwd.std():.2f}\"\n    )\n    _, ax = plt.subplots(figsize=(8, 6))\n    sns.kdeplot(h_no_sa.squeeze(dim=1), fill=False, ax=ax, label='h(probs_from_logits, probs_from_logits_no_sa)')\n    sns.kdeplot(h_no_ffwd.squeeze(dim=1), fill=False, ax=ax, label='h(probs_from_logits, probs_from_logits_no_ffwd)')\n    ax.legend()\n\n\nblock_idx = 0\n_, sa_output, ffwd_output, block_output = get_intermediates(block_idx, io_accessors)\nanalyze_intermediate_impact(block_idx, sa_output, ffwd_output, block_output)\n\nBlock 0\n                                 Average norm of logits: 26.64 ± 4.02\n                Average norm of (logits - logits_no_sa):  3.31 ± 1.23\n              Average norm of (logits - logits_no_ffwd): 20.65 ± 5.88\n\n  Average h(probs_from_logits, probs_from_logits_no_sa):  0.11 ± 0.07, \nAverage h(probs_from_logits, probs_from_logits_no_ffwd):  0.70 ± 0.17\n\n\n\n\n\n\n\n\n\n\nblock_idx = 1\n_, sa_output, ffwd_output, block_output = get_intermediates(block_idx, io_accessors)\nanalyze_intermediate_impact(block_idx, sa_output, ffwd_output, block_output)\n\nBlock 1\n                                 Average norm of logits: 28.01 ± 4.02\n                Average norm of (logits - logits_no_sa):  2.08 ± 0.75\n              Average norm of (logits - logits_no_ffwd):  5.43 ± 1.72\n\n  Average h(probs_from_logits, probs_from_logits_no_sa):  0.07 ± 0.04, \nAverage h(probs_from_logits, probs_from_logits_no_ffwd):  0.19 ± 0.11\n\n\n\n\n\n\n\n\n\n\nblock_idx = 2\n_, sa_output, ffwd_output, block_output = get_intermediates(block_idx, io_accessors)\nanalyze_intermediate_impact(block_idx, sa_output, ffwd_output, block_output)\n\nBlock 2\n                                 Average norm of logits: 29.60 ± 4.22\n                Average norm of (logits - logits_no_sa):  2.91 ± 1.39\n              Average norm of (logits - logits_no_ffwd):  4.68 ± 1.61\n\n  Average h(probs_from_logits, probs_from_logits_no_sa):  0.09 ± 0.07, \nAverage h(probs_from_logits, probs_from_logits_no_ffwd):  0.15 ± 0.10\n\n\n\n\n\n\n\n\n\n\nblock_idx = 3\n_, sa_output, ffwd_output, block_output = get_intermediates(block_idx, io_accessors)\nanalyze_intermediate_impact(block_idx, sa_output, ffwd_output, block_output)\n\nBlock 3\n                                 Average norm of logits: 30.64 ± 4.15\n                Average norm of (logits - logits_no_sa):  2.70 ± 1.13\n              Average norm of (logits - logits_no_ffwd):  4.72 ± 1.83\n\n  Average h(probs_from_logits, probs_from_logits_no_sa):  0.06 ± 0.05, \nAverage h(probs_from_logits, probs_from_logits_no_ffwd):  0.13 ± 0.10\n\n\n\n\n\n\n\n\n\n\nblock_idx = 4\n_, sa_output, ffwd_output, block_output = get_intermediates(block_idx, io_accessors)\nanalyze_intermediate_impact(block_idx, sa_output, ffwd_output, block_output)\n\nBlock 4\n                                 Average norm of logits: 31.22 ± 4.18\n                Average norm of (logits - logits_no_sa):  2.07 ± 0.71\n              Average norm of (logits - logits_no_ffwd):  5.45 ± 2.13\n\n  Average h(probs_from_logits, probs_from_logits_no_sa):  0.04 ± 0.03, \nAverage h(probs_from_logits, probs_from_logits_no_ffwd):  0.14 ± 0.10\n\n\n\n\n\n\n\n\n\n\nblock_idx = 5\n_, sa_output, ffwd_output, block_output = get_intermediates(block_idx, io_accessors)\nanalyze_intermediate_impact(block_idx, sa_output, ffwd_output, block_output)\n\nBlock 5\n                                 Average norm of logits: 31.61 ± 4.21\n                Average norm of (logits - logits_no_sa):  1.84 ± 0.61\n              Average norm of (logits - logits_no_ffwd):  7.55 ± 3.09\n\n  Average h(probs_from_logits, probs_from_logits_no_sa):  0.03 ± 0.03, \nAverage h(probs_from_logits, probs_from_logits_no_ffwd):  0.17 ± 0.10\n\n\n\n\n\n\n\n\n\nThe magnitude varies per block, but it seems that the feed-forward network output has a much larger impact on the final output of the model at each block.\n\nHow Aligned Are the Block Intermediates?\n\ndef print_alignment_stats(block_idx: int, io_accessors: Sequence[InputOutputAccessor]):\n    block_input, sa_output, ffwd_output, block_output = get_intermediates(block_idx, io_accessors)\n\n    labels = [\n        'Block Input vs SA Output',\n        'SA Output vs FFWD Output',\n        'FFWD Output vs Block Output',\n    ]\n    sims = [\n        F.cosine_similarity(block_input[:, -1, :], sa_output[:, -1, :], dim=-1),\n        F.cosine_similarity(sa_output[:, -1, :], ffwd_output[:, -1, :], dim=-1),\n        F.cosine_similarity(ffwd_output[:, -1, :], block_output[:, -1, :], dim=-1),\n    ]\n    for label, sims in zip(labels, sims):\n        print(f\"{label:&gt;30}: {sims.mean():.2f} ± {sims.std():.2f}\")\n\n\ndef plot_alignments(block_idx: int, io_accessors: Sequence[InputOutputAccessor]):\n    block_input, sa_output, ffwd_output, block_output = get_intermediates(block_idx, io_accessors)\n    _, (ax1, ax2) = plt.subplots(1, 2, figsize=(12, 6))\n    sns.kdeplot(F.cosine_similarity(block_input[:, -1, :], sa_output[:, -1, :], dim=-1), ax=ax1, label=\"Block Input vs SA Output\")\n    sns.kdeplot(F.cosine_similarity(block_input[:, -1, :], ffwd_output[:, -1, :], dim=-1), ax=ax1, label=\"Block Input vs FFWD_Output\")\n    sns.kdeplot(F.cosine_similarity(block_input[:, -1, :], block_output[:, -1, :], dim=-1), ax=ax1, label=\"Block Input vs Block Output\")\n\n    sns.kdeplot(F.cosine_similarity(block_output[:, -1, :], sa_output[:, -1, :], dim=-1), ax=ax2, label=\"Block Output vs SA Output\")\n    sns.kdeplot(F.cosine_similarity(block_output[:, -1, :], ffwd_output[:, -1, :], dim=-1), ax=ax2, label=\"Block Output vs FFWD_Output\")\n    sns.kdeplot(F.cosine_similarity(ffwd_output[:, -1, :], sa_output[:, -1, :], dim=-1), ax=ax2, label=\"FFWD Output vs SA Output\")\n\n    ax1.set_xlim(-1, 1)\n    ax2.set_xlim(-1, 1)\n    ax1.set_title(f\"Block {block_idx}: Inputs vs Outputs Alignment\")\n    ax2.set_title(f\"Block {block_idx}: Outputs Alignment\")\n\n    ax1.legend()\n    ax2.legend()\n\n\nplot_alignments(block_idx=0, io_accessors=io_accessors)\nprint_alignment_stats(block_idx=0, io_accessors=io_accessors)\n\n      Block Input vs SA Output: 0.07 ± 0.05\n      SA Output vs FFWD Output: 0.31 ± 0.05\n   FFWD Output vs Block Output: 0.96 ± 0.01\n\n\n\n\n\n\n\n\n\n\nplot_alignments(block_idx=1, io_accessors=io_accessors)\nprint_alignment_stats(block_idx=1, io_accessors=io_accessors)\n\n      Block Input vs SA Output: 0.28 ± 0.04\n      SA Output vs FFWD Output: 0.10 ± 0.06\n   FFWD Output vs Block Output: 0.72 ± 0.04\n\n\n\n\n\n\n\n\n\n\nplot_alignments(block_idx=2, io_accessors=io_accessors)\nprint_alignment_stats(block_idx=2, io_accessors=io_accessors)\n\n      Block Input vs SA Output: 0.32 ± 0.05\n      SA Output vs FFWD Output: 0.09 ± 0.06\n   FFWD Output vs Block Output: 0.58 ± 0.08\n\n\n\n\n\n\n\n\n\n\nplot_alignments(block_idx=3, io_accessors=io_accessors)\nprint_alignment_stats(block_idx=3, io_accessors=io_accessors)\n\n      Block Input vs SA Output: 0.26 ± 0.06\n      SA Output vs FFWD Output: 0.04 ± 0.07\n   FFWD Output vs Block Output: 0.47 ± 0.11\n\n\n\n\n\n\n\n\n\n\nplot_alignments(block_idx=4, io_accessors=io_accessors)\nprint_alignment_stats(block_idx=4, io_accessors=io_accessors)\n\n      Block Input vs SA Output: 0.20 ± 0.07\n      SA Output vs FFWD Output: 0.04 ± 0.09\n   FFWD Output vs Block Output: 0.44 ± 0.15\n\n\n\n\n\n\n\n\n\n\nplot_alignments(block_idx=5, io_accessors=io_accessors)\nprint_alignment_stats(block_idx=5, io_accessors=io_accessors)\n\n      Block Input vs SA Output: 0.14 ± 0.13\n      SA Output vs FFWD Output: 0.09 ± 0.13\n   FFWD Output vs Block Output: 0.58 ± 0.12\n\n\n\n\n\n\n\n\n\n\n\nDistribution of Norms\n\ndef print_norm_stats(block_idx: int, io_accessors: Sequence[InputOutputAccessor]):\n    block_input, sa_output, ffwd_output, block_output = get_intermediates(block_idx, io_accessors)\n\n    labels = ['Block Input', 'SA Output', 'FFWD Output', 'Block Output']\n    norms = [block_input[:, -1, :].norm(dim=-1), sa_output[:, -1, :].norm(dim=-1), ffwd_output[:, -1, :].norm(dim=-1), block_output[:, -1, :].norm(dim=-1)]\n    for label, norm in zip(labels, norms):\n        print(f\"{label:&gt;15}: {norm.mean():&gt;5.2f} ± {norm.std():.2f}\")\n\n\ndef plot_norms(block_idx: int, io_accessors: Sequence[InputOutputAccessor]):\n    block_input, sa_output, ffwd_output, block_output = get_intermediates(block_idx, io_accessors)\n    _, ax = plt.subplots(figsize=(8, 6))\n\n    sns.kdeplot(block_input[:, -1, :].norm(dim=-1), fill=False, ax=ax, label='Block Input')\n    sns.kdeplot(sa_output[:, -1, :].norm(dim=-1), fill=False, ax=ax, label='SA Output')\n    sns.kdeplot(ffwd_output[:, -1, :].norm(dim=-1), fill=False, ax=ax, label='FFWD Output')\n    sns.kdeplot(block_output[:, -1, :].norm(dim=-1), fill=False, ax=ax, label='Block Output')\n\n    ax.legend()\n    plt.title(f\"Distribution of Norms of Block {block_idx} Intermediates\")\n\n\nplot_norms(block_idx=0, io_accessors=io_accessors)\nprint_norm_stats(block_idx=0, io_accessors=io_accessors)\n\n    Block Input:  0.95 ± 0.03\n      SA Output:  1.78 ± 0.19\n    FFWD Output:  5.79 ± 0.62\n   Block Output:  6.78 ± 0.61\n\n\n\n\n\n\n\n\n\n\nplot_norms(block_idx=1, io_accessors=io_accessors)\nprint_norm_stats(block_idx=1, io_accessors=io_accessors)\n\n    Block Input:  6.78 ± 0.61\n      SA Output:  2.44 ± 0.20\n    FFWD Output:  3.54 ± 0.48\n   Block Output:  9.97 ± 0.75\n\n\n\n\n\n\n\n\n\n\nplot_norms(block_idx=2, io_accessors=io_accessors)\nprint_norm_stats(block_idx=2, io_accessors=io_accessors)\n\n    Block Input:  9.97 ± 0.75\n      SA Output:  3.23 ± 0.56\n    FFWD Output:  4.15 ± 0.56\n   Block Output: 13.36 ± 0.90\n\n\n\n\n\n\n\n\n\n\nplot_norms(block_idx=3, io_accessors=io_accessors)\nprint_norm_stats(block_idx=3, io_accessors=io_accessors)\n\n    Block Input: 13.36 ± 0.90\n      SA Output:  3.43 ± 0.69\n    FFWD Output:  4.53 ± 0.84\n   Block Output: 16.26 ± 1.23\n\n\n\n\n\n\n\n\n\n\nplot_norms(block_idx=4, io_accessors=io_accessors)\nprint_norm_stats(block_idx=4, io_accessors=io_accessors)\n\n    Block Input: 16.26 ± 1.23\n      SA Output:  2.86 ± 0.54\n    FFWD Output:  5.19 ± 1.29\n   Block Output: 18.83 ± 2.28\n\n\n\n\n\n\n\n\n\n\nplot_norms(block_idx=5, io_accessors=io_accessors)\nprint_norm_stats(block_idx=5, io_accessors=io_accessors)\n\n    Block Input: 18.83 ± 2.28\n      SA Output:  2.38 ± 0.50\n    FFWD Output:  7.54 ± 2.71\n   Block Output: 22.76 ± 3.51",
    "crumbs": [
      "analyses",
      "Embedding Adjustments"
    ]
  },
  {
    "objectID": "analyses/embedding_adjustments.html#plot-2d-representation",
    "href": "analyses/embedding_adjustments.html#plot-2d-representation",
    "title": "Embedding Adjustments",
    "section": "Plot 2D Representation",
    "text": "Plot 2D Representation\nThe code below creates a 2D “simulation” of the vector addition that happens across blocks. It generates a series of vectors in 2D that share some properties in common with the real block intermediates: the norms of the input, self-attention outputs, and feed-forward outputs are the same, and the cosine similarity relationships between them are also the same.\n\ndef get_norms_and_sims(q_idx: int, io_accessors: Sequence[InputOutputAccessor]):\n    \"\"\"Returns the properties of the real data that the 2D simulation\n    should preserve. Specifically, the norm of the input vector, the\n    cosine similarity of each block's sa_output and ffwd_output with\n    respect to the block input, and the norm of each block's sa_output\n    and ffwd_output.\"\"\"\n    input_vector_norm = io_accessors[0].input('.')[q_idx, -1, :].norm(dim=-1).item()\n\n    prev = io_accessors[0].input('.')[q_idx, -1, :]\n    sims = []\n    norms = []\n    for block_idx in range(n_layer):\n        _, sa_output, ffwd_output, block_output = get_intermediates(block_idx, io_accessors)\n\n        sims.append(\n            F.cosine_similarity(prev, sa_output[q_idx, -1, :], dim=-1).item()\n        )\n        norms.append(sa_output[q_idx, -1, :].norm(dim=-1).item())\n        sims.append(\n            F.cosine_similarity(prev, ffwd_output[q_idx, -1, :], dim=-1).item()\n        )\n        norms.append(ffwd_output[q_idx, -1, :].norm(dim=-1).item())\n        prev = block_output[q_idx, -1, :]\n\n    return input_vector_norm, sims, norms\n\n\ndef generate_2D_vectors(\n    input_vector_norm: float,\n    sims: Sequence[float],\n    norms: Sequence[float],\n    random_seed: int = 144223232,\n):\n    torch.manual_seed(random_seed)\n\n    # Generate a random input vector with the right norm.\n    # Start with a unit vector that points up and to the\n    # right from the origin at a random angle.\n    angle = torch.rand(1) * math.pi / 4\n    v = torch.tensor([math.cos(angle), math.sin(angle)])\n\n    # Scale by desired norm\n    input_vector = v * input_vector_norm\n\n    assert len(sims) == len(norms)\n    assert len(sims) == 2*n_layer\n\n    def generate_vector_with_sim_and_norm(\n        prev: torch.Tensor,\n        sim: float,\n        norm: float,\n    ) -&gt; torch.Tensor:\n        # Generate a unit vector in the direction of prev\n        unit_prev = prev / prev.norm()\n\n        # Rotate it by the angle determined from the cosine\n        # similarity and scale it by the target norm.\n        angle = math.acos(sim)\n        rotation_matrix = torch.tensor([\n            [math.cos(angle), -math.sin(angle)],\n            [math.sin(angle), math.cos(angle)],\n        ])\n        return (rotation_matrix @ unit_prev) * norm\n\n    # For each block, generate an sa_output vector and an ffwd_output\n    # vector that have the same norms and cosine similarities to the\n    # previous input as the real data.\n    vectors = []\n    prev = input_vector\n\n    for block_idx in range(n_layer):\n        sa_generated = generate_vector_with_sim_and_norm(\n            prev, sims[2*block_idx], norms[2*block_idx]\n        )\n        vectors.append(sa_generated)\n        ffwd_generated = generate_vector_with_sim_and_norm(\n            prev, sims[2*block_idx+1], norms[2*block_idx+1]\n        )\n        vectors.append(ffwd_generated)\n        prev = prev + sa_generated + ffwd_generated\n\n    return input_vector, vectors\n\n\ndef plot_2D_vectors(vectors: Sequence[torch.Tensor], colors: Sequence[str], ax: Optional[Axes] = None):\n    assert len(vectors) == len(colors)\n\n    used_existing_axes = True\n    if ax is None:\n        _, ax = plt.subplots(figsize=(8, 8))\n        used_existing_axes = False\n\n    prev = torch.tensor([0.0, 0.0])\n\n    min_val = prev.min().item()\n    max_val = prev.max().item()\n\n    for vector, color in zip(vectors, colors):\n        ax.quiver(prev[0], prev[1], vector[0], vector[1], angles='xy', scale_units='xy', scale=1, color=color)\n        prev = prev + vector\n        min_val = min(min_val, prev.min().item())\n        max_val = max(max_val, prev.max().item())\n\n    if not used_existing_axes:\n        ax.set_aspect('equal')\n\n        ax.set_xlim(min_val-1, max_val+1)\n        ax.set_ylim(min_val-1, max_val+1)\n\n        ax.grid(True)\n\n    return ax\n\n\nq_idx = 33\ninput_vector_norm, sims, norms = get_norms_and_sims(q_idx, io_accessors)\ninput_vector, vectors = generate_2D_vectors(input_vector_norm, sims, norms)\n\n\n# Sanity check that the relationships between the generated values\n# are the same as the relationships between the real values\nprev_generated = input_vector\nprev_real = io_accessors[0].input('.')[q_idx, -1, :]\nfor block_idx in range(n_layer):\n    sa_generated = vectors[block_idx*2]\n    ffwd_generated = vectors[block_idx*2+1]\n\n    _, sa_output, ffwd_output, block_output = get_intermediates(block_idx, io_accessors)\n\n    test_close(\n        F.cosine_similarity(prev_generated, sa_generated, dim=-1),\n        F.cosine_similarity(prev_real, sa_output[q_idx, -1, :], dim=-1)\n    )\n\n    test_close(\n        sa_generated.norm(dim=-1),\n        sa_output[q_idx, -1, :].norm(dim=-1)\n    )\n\n    test_close(\n        F.cosine_similarity(prev_generated, ffwd_generated, dim=-1),\n        F.cosine_similarity(prev_real, ffwd_output[q_idx, -1, :], dim=-1)\n    )\n\n    test_close(\n        ffwd_generated.norm(dim=-1),\n        ffwd_output[q_idx, -1, :].norm(dim=-1)\n    )\n\n    prev_generated = prev_generated + sa_generated + ffwd_generated\n    prev_real = block_output[q_idx, -1, :]\n\n\nall_vectors = [input_vector, *vectors]\ncolors = ['r', *['g' if i % 2 == 0 else 'b' for i, _ in enumerate(vectors)]]\n_ = plot_2D_vectors(all_vectors, colors)\n\n\n\n\n\n\n\n\n\n# How would it look if we just had the ffwd_outputs\nall_vectors = [input_vector, *vectors]\ncolors = ['r', *['g' if i % 2 == 0 else 'b' for i, _ in enumerate(vectors)]]\nax = plot_2D_vectors(all_vectors, colors)\n\nffwd_vectors = [v for i, v in enumerate(vectors) if i % 2 == 1]\nall_vectors = [input_vector, *ffwd_vectors]\ncolors = ['r', *['b' for i, _ in enumerate(ffwd_vectors)]]\n_ = plot_2D_vectors(all_vectors, colors, ax=ax)\n\n\n\n\n\n\n\n\n\n# Compare the final endpoints\nall_vectors = [input_vector, *vectors]\ncolors = ['r', *['g' if i % 2 == 0 else 'b' for i, _ in enumerate(vectors)]]\nax = plot_2D_vectors(all_vectors, colors)\n\nffwd_vectors = [v for i, v in enumerate(vectors) if i % 2 == 1]\nall_vectors = [input_vector, *ffwd_vectors]\ncolors = ['r', *['b' for i, _ in enumerate(ffwd_vectors)]]\n_ = plot_2D_vectors(all_vectors, colors, ax=ax)\n\nendpoint_all = input_vector + sum(vectors)\nendpoint_ffwd_only = input_vector + sum(ffwd_vectors)\n\n_ = ax.quiver(0, 0, endpoint_all[0], endpoint_all[1], angles='xy', scale_units='xy', scale=1, color='gray')\n_ = ax.quiver(0, 0, endpoint_ffwd_only[0], endpoint_ffwd_only[1], angles='xy', scale_units='xy', scale=1, color='gray')\n\n\n\n\n\n\n\n\n\n# Do another query\nq_idx = 57\ninput_vector_norm, sims, norms = get_norms_and_sims(q_idx, io_accessors)\ninput_vector, vectors = generate_2D_vectors(input_vector_norm, sims, norms)\nall_vectors = [input_vector, *vectors]\ncolors = ['r', *['g' if i % 2 == 0 else 'b' for i, _ in enumerate(vectors)]]\nax = plot_2D_vectors(all_vectors, colors)\n\n# How would it look if we just had the ffwd_outputs\nffwd_vectors = [v for i, v in enumerate(vectors) if i % 2 == 1]\nall_vectors = [input_vector, *ffwd_vectors]\ncolors = ['r', *['b' for i, _ in enumerate(ffwd_vectors)]]\n_ = plot_2D_vectors(all_vectors, colors, ax=ax)\n\nendpoint_all = input_vector + sum(vectors)\nendpoint_ffwd_only = input_vector + sum(ffwd_vectors)\n\n_ = ax.quiver(0, 0, endpoint_all[0], endpoint_all[1], angles='xy', scale_units='xy', scale=1, color='gray')\n_ = ax.quiver(0, 0, endpoint_ffwd_only[0], endpoint_ffwd_only[1], angles='xy', scale_units='xy', scale=1, color='gray')\n\n\n\n\n\n\n\n\nEven though the vectors in \\(\\mathbb{R}^{2}\\) and the vectors in \\(\\mathbb{R}^{384}\\) have the same norms and cosine relationships with each other, as expected, the norms of their sums are not the same:\n\n(\n    input_vector.norm(),\n    vectors[0].norm(),\n    vectors[1].norm(),\n    (input_vector + vectors[0] + vectors[1]).norm(),\n)\n\n(tensor(0.9608), tensor(1.9926), tensor(5.6433), tensor(7.7887))\n\n\n\nblock_idx = 0\nblock_input, sa_output, ffwd_output, block_output = get_intermediates(block_idx, io_accessors)\n(\n    block_input[q_idx, -1, :].norm(),\n    sa_output[q_idx, -1, :].norm(),\n    ffwd_output[q_idx, -1, :].norm(),\n    block_output[q_idx, -1, :].norm()\n)\n\n(tensor(0.9608), tensor(1.9926), tensor(5.6433), tensor(6.7920))\n\n\nSame with the cosine similarities between the sums and the originals:\n\n(\n    F.cosine_similarity(input_vector, input_vector + vectors[0] + vectors[1], dim=-1),\n    F.cosine_similarity(block_input[q_idx, -1, :], block_output[q_idx, -1, :], dim=-1)\n)\n\n(tensor(0.2220), tensor(0.2546))\n\n\n\nData for the Blog Post\n\nq_idx = 57\ninput_vector_norm, sims, norms = get_norms_and_sims(q_idx, io_accessors)\ninput_vector, vectors = generate_2D_vectors(input_vector_norm, sims, norms)\n[input_vector, *vectors]\n\n[tensor([0.7202, 0.6359]),\n tensor([-1.2350,  1.5638]),\n tensor([-3.2156,  4.6376]),\n tensor([-2.1867, -0.3706]),\n tensor([-3.2978,  0.2411]),\n tensor([-2.1838, -1.4804]),\n tensor([-3.9066, -1.8245]),\n tensor([-1.1337, -2.6656]),\n tensor([-1.9595, -3.2921]),\n tensor([-0.1060, -2.4951]),\n tensor([-0.9699, -4.8422]),\n tensor([ 0.8515, -2.2819]),\n tensor([ 0.5064, -5.7759])]",
    "crumbs": [
      "analyses",
      "Embedding Adjustments"
    ]
  },
  {
    "objectID": "analyses/widening_similar_space.html",
    "href": "analyses/widening_similar_space.html",
    "title": "Widening the Space of Similar Values",
    "section": "",
    "text": "environment = get_environment()\nprint(f\"environment is {environment.name}\")\n\nenvironment is local_mac\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\nm, tokenizer = create_model_and_tokenizer(\n    saved_model_filename=environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt',\n    dataset=ts,\n    device=device,\n)\n_, val_data = split_text_dataset(ts.text, tokenizer, train_pct=0.9, device=device)\nencoding_helpers = EncodingHelpers(tokenizer, device)\naccessors = TransformerAccessors(m, device)\nprint(f\"device is {device}\")\n\ndevice is cpu\nstrings10 = all_unique_substrings(ts.text, 10)\ntorch.manual_seed(1337)\nn_samples = 20000\nindices = torch.randperm(len(strings10))[:n_samples]\nstrings20k = [strings10[i.item()] for i in indices]\n# Create a sample of 500 strings\nsample_size = 500\nstrings_sample = strings20k[:sample_size]\n# TODO: put this in a common component\ndef get_model_outputs(prompts: Sequence[str], encoding_helpers: EncodingHelpers):\n    # Compute the model's predictions:\n    tokens = encoding_helpers.tokenize_strings(prompts)\n    logits, _ = m(tokens)\n\n    logits = LogitsWrapper(logits, encoding_helpers.tokenizer)\n    return [topk_tokens[-1] for topk_tokens in logits.topk_tokens(k=10)]",
    "crumbs": [
      "analyses",
      "Widening the Space of Similar Values"
    ]
  },
  {
    "objectID": "analyses/widening_similar_space.html#examine-cosine-sim-data-for-20000-strings-against-all-length-10-strings",
    "href": "analyses/widening_similar_space.html#examine-cosine-sim-data-for-20000-strings-against-all-length-10-strings",
    "title": "Widening the Space of Similar Values",
    "section": "Examine Cosine Sim Data for 20,000 Strings Against all Length 10 Strings",
    "text": "Examine Cosine Sim Data for 20,000 Strings Against all Length 10 Strings\nThis uses the output of ConsineSimilarityExperiment.\n\nresults_folder = environment.data_root / 'cosine_sim_results/large_files/slen10/'\nn_batches = 8590\nn_queries = 20000\n\n\nnext_token_map10 = build_next_token_map(ts.text, 10, tokenizer.vocab_size, tokenizer.stoi)\n\n\n# This is slow - prefer using pre-filtering and then using filter_on_prefiltered_results()\ndef filter_across_batches(\n    get_batch: Callable[[int], torch.Tensor],\n    n_batches: int,\n    filter_fn: Callable[[torch.Tensor], torch.Tensor],\n    n_queries: int,\n):\n    total_count = 0\n    matching_indices = [[] for _ in range(n_queries)]\n    for batch_idx in range(n_batches):\n        batch = get_batch(batch_idx)\n        batch_size, n_queries_batch = batch.shape\n        assert n_queries_batch == n_queries\n\n        filtered = filter_fn(batch)\n        nonzeros = torch.nonzero(filtered)\n        for i in range(nonzeros.shape[0]):\n            idx_in_batch, query_idx = nonzeros[i, :]\n            matching_indices[query_idx.item()].append(total_count + idx_in_batch.item())\n\n        total_count += batch_size\n\n    return matching_indices\n\n\n# Tests for filter_across_batches()\n\nbatches = [\n    torch.tensor([\n        [0.0, 0.6, 0.4, 0.3],\n        [0.1, 0.3, 0.5, 0.1],\n        [0.0, 0.1, 0.8, 0.0],\n    ]),\n    torch.tensor([\n        [0.7, 0.2, 0.6, 0.3],\n        [0.1, 0.8, 0.2, 0.8],\n    ]),\n]\n\nresult = filter_across_batches(\n    get_batch=lambda i: batches[i],\n    n_batches=len(batches),\n    filter_fn=lambda batch: batch &gt; 0.5,\n    n_queries=4,\n)\ntest_eq(result, [\n    [3,],\n    [0, 4],\n    [2, 3],\n    [4],\n])",
    "crumbs": [
      "analyses",
      "Widening the Space of Similar Values"
    ]
  },
  {
    "objectID": "analyses/widening_similar_space.html#prefiltering-results",
    "href": "analyses/widening_similar_space.html#prefiltering-results",
    "title": "Widening the Space of Similar Values",
    "section": "Prefiltering Results",
    "text": "Prefiltering Results\nFirst, pre-filter the results for the first 500 queries to just the values &gt; 0.7.\n\nload_batch = lambda batch_idx: torch.load(results_folder / f'cosine_sim_ffwd_out_{batch_idx:05d}.pt')\nq_idx_start = 0\nq_idx_end = 500\nthreshold = 0.7\n\n\n# Slow, takes ~15 mins to run\nprefiltered_result = pre_filter_cosine_sim_results(\n    load_batch=load_batch,\n    n_batches=n_batches,\n    q_idx_start=q_idx_start,\n    q_idx_end=q_idx_end,\n    threshold=threshold,\n)\n\nSave the prefiltered results\n\nprefiltered_results_folder = results_folder / f'prefiltered_{threshold}'\nprefiltered_results_folder.mkdir(exist_ok=True)\n\n\ndef prefiltered_filename(q_idx: int, block_idx: int) -&gt; Path:\n    return prefiltered_results_folder / f'cosine_sim_ffwd_out_{q_idx:05d}_{block_idx:02d}.pt'\n\n\nfor q_idx in tqdm(range(q_idx_start, q_idx_end)):\n    for block_idx in range(n_layer):\n        torch.save(\n            prefiltered_result[q_idx - q_idx_start][block_idx],\n            prefiltered_filename(q_idx, block_idx),\n        )\n\n\n\n\n\nPre-filter the rest of the queries\n\n# Very slow - takes about 10 hours to run\nload_batch = lambda batch_idx: torch.load(results_folder / f'cosine_sim_ffwd_out_{batch_idx:05d}.pt')\nq_idx_start = 500\nq_idx_end = n_queries\nthreshold = 0.7\nprefilter_batch_size = 500\n\nq_idx = q_idx_start\nwith tqdm(total=q_idx_end - q_idx_start) as pbar:\n    while q_idx &lt; q_idx_end:\n        q_idx_end_batch = min(q_idx + prefilter_batch_size, q_idx_end)\n        prefiltered_result = pre_filter_cosine_sim_results(\n            load_batch=load_batch,\n            n_batches=n_batches,\n            q_idx_start=q_idx,\n            q_idx_end=q_idx_end_batch,\n            threshold=threshold,\n        )\n\n        for q_idx_batch in range(q_idx, q_idx_end_batch):\n            for block_idx in range(n_layer):\n                torch.save(\n                    prefiltered_result[q_idx_batch - q_idx][block_idx],\n                    prefiltered_filename(q_idx_batch, block_idx),\n                )\n\n        q_idx = q_idx_end_batch\n        pbar.update(q_idx_end_batch - q_idx)",
    "crumbs": [
      "analyses",
      "Widening the Space of Similar Values"
    ]
  },
  {
    "objectID": "analyses/widening_similar_space.html#analyze-the-results",
    "href": "analyses/widening_similar_space.html#analyze-the-results",
    "title": "Widening the Space of Similar Values",
    "section": "Analyze the Results",
    "text": "Analyze the Results\nFirst, collect some stats about the results\n\ndef filter_result_stats(\n    filter_results: List[List[int]],\n):\n    lens = [len(result) for result in filter_results]\n    return {\n        'min': min(lens),\n        'max': max(lens),\n        'mean': np.mean(lens),\n        'std': np.std(lens),\n    }\n\n\ndef get_matching_strings(\n    filter_result: List[List[int]],\n    strings: Sequence[str],\n):\n    return [\n        [\n            strings[j]\n            for j in filter_result[i]\n        ]\n        for i in range(len(filter_result))\n    ]\n\n\n# TODO: put this in a common component\ndef analyze_simulate_results(sim_freqs, model_outputs):\n    assert len(sim_freqs) == len(model_outputs)\n    topn_matches = [0 for _ in range(10)]\n    topn_matches_any_order = [0 for _ in range(10)]\n    for i, sim_freq in enumerate(sim_freqs):\n        sim_output = top_nonzero_tokens(sim_freq, encoding_helpers.tokenizer.itos)[:10]\n        model_output = model_outputs[i]\n\n        sim_tokens, _ = zip(*sim_output)\n        model_tokens, _ = zip(*model_output)\n\n        n = min(len(sim_tokens), len(model_tokens))\n        for j in range(n):\n            if sim_tokens[j] == model_tokens[j]:\n                topn_matches[j] += 1\n            if set(sim_tokens[:j+1]) == set(model_tokens[:j+1]):\n                topn_matches_any_order[j] += 1\n\n    return topn_matches, topn_matches_any_order\n\n\ndef analyze_dataset(\n    matching_indices: Sequence[Sequence[int]],\n    n_queries: int,\n    all_strings: Sequence[str],\n    next_token_map: Dict[str, torch.Tensor],\n    model_outputs: Sequence[Sequence[Tuple[str, float]]],\n):\n    print(filter_result_stats(matching_indices))\n\n    filter_results_strings = get_matching_strings(matching_indices, all_strings)\n    filter_result_freqs = [\n        torch.stack([\n            next_token_map[matching_string]\n            for matching_string in matching_strings\n        ]).sum(dim=0)\n        for matching_strings in filter_results_strings\n    ]\n\n    filter_result_probs = [\n        freqs / freqs.sum()\n        for freqs in filter_result_freqs\n    ]\n\n    topn_matches, topn_matches_any_order = analyze_simulate_results(filter_result_probs, model_outputs)\n    for i in range(10):\n        print(f\"Top {i+1} matches: {topn_matches[i] / n_queries:.3f}\")\n        print(f\"Top {i+1} matches (any order): {topn_matches_any_order[i] / n_queries:.3f}\")\n\n    return filter_result_freqs\n\n\nn_queries_sample = 500\nq_idx_start = 0\nq_idx_end = n_queries_sample\nmodel_outputs_sample = get_model_outputs(strings20k[:n_queries_sample], encoding_helpers)\n\n\nblock_idx = 5\nffwd5_freqs = analyze_dataset(\n    matching_indices=filter_on_prefiltered_results(\n        load_prefiltered=lambda q_idx: torch.load(prefiltered_filename(q_idx, block_idx)),\n        q_idx_start=q_idx_start,\n        q_idx_end=q_idx_end,\n        filter_fn=lambda values: values &gt; 0.89,\n    ),\n    n_queries=n_queries_sample,\n    all_strings=strings10,\n    next_token_map=next_token_map10,\n    model_outputs=model_outputs_sample,\n)\n\n{'min': 1, 'max': 30527, 'mean': 2143.642, 'std': 5838.287069495299}\nTop 1 matches: 0.788\nTop 1 matches (any order): 0.788\nTop 2 matches: 0.424\nTop 2 matches (any order): 0.504\nTop 3 matches: 0.268\nTop 3 matches (any order): 0.334\nTop 4 matches: 0.186\nTop 4 matches (any order): 0.260\nTop 5 matches: 0.164\nTop 5 matches (any order): 0.198\nTop 6 matches: 0.088\nTop 6 matches (any order): 0.134\nTop 7 matches: 0.076\nTop 7 matches (any order): 0.102\nTop 8 matches: 0.058\nTop 8 matches (any order): 0.086\nTop 9 matches: 0.054\nTop 9 matches (any order): 0.062\nTop 10 matches: 0.046\nTop 10 matches (any order): 0.040\n\n\n\nblock_idx = 4\nffwd4_freqs = analyze_dataset(\n    matching_indices=filter_on_prefiltered_results(\n        load_prefiltered=lambda q_idx: torch.load(prefiltered_filename(q_idx, block_idx)),\n        q_idx_start=q_idx_start,\n        q_idx_end=q_idx_end,\n        filter_fn=lambda values: values &gt; 0.81,\n    ),\n    n_queries=n_queries_sample,\n    all_strings=strings10,\n    next_token_map=next_token_map10,\n    model_outputs=model_outputs_sample,\n)\n\n{'min': 1, 'max': 61657, 'mean': 3283.636, 'std': 9950.066907488814}\nTop 1 matches: 0.790\nTop 1 matches (any order): 0.790\nTop 2 matches: 0.450\nTop 2 matches (any order): 0.518\nTop 3 matches: 0.270\nTop 3 matches (any order): 0.318\nTop 4 matches: 0.202\nTop 4 matches (any order): 0.232\nTop 5 matches: 0.170\nTop 5 matches (any order): 0.176\nTop 6 matches: 0.106\nTop 6 matches (any order): 0.142\nTop 7 matches: 0.096\nTop 7 matches (any order): 0.108\nTop 8 matches: 0.072\nTop 8 matches (any order): 0.080\nTop 9 matches: 0.048\nTop 9 matches (any order): 0.056\nTop 10 matches: 0.036\nTop 10 matches (any order): 0.032\n\n\n\nblock_idx = 3\nffwd3_freqs = analyze_dataset(\n    matching_indices=filter_on_prefiltered_results(\n        load_prefiltered=lambda q_idx: torch.load(prefiltered_filename(q_idx, block_idx)),\n        q_idx_start=q_idx_start,\n        q_idx_end=q_idx_end,\n        filter_fn=lambda values: values &gt; 0.76,\n    ),\n    n_queries=n_queries_sample,\n    all_strings=strings10,\n    next_token_map=next_token_map10,\n    model_outputs=model_outputs_sample,\n)\n\n{'min': 1, 'max': 9100, 'mean': 624.342, 'std': 1387.415385901425}\nTop 1 matches: 0.804\nTop 1 matches (any order): 0.804\nTop 2 matches: 0.478\nTop 2 matches (any order): 0.542\nTop 3 matches: 0.304\nTop 3 matches (any order): 0.380\nTop 4 matches: 0.234\nTop 4 matches (any order): 0.274\nTop 5 matches: 0.192\nTop 5 matches (any order): 0.228\nTop 6 matches: 0.134\nTop 6 matches (any order): 0.184\nTop 7 matches: 0.112\nTop 7 matches (any order): 0.114\nTop 8 matches: 0.084\nTop 8 matches (any order): 0.104\nTop 9 matches: 0.066\nTop 9 matches (any order): 0.082\nTop 10 matches: 0.050\nTop 10 matches (any order): 0.060\n\n\n\nblock_idx = 2\nffwd2_freqs = analyze_dataset(\n    matching_indices=filter_on_prefiltered_results(\n        load_prefiltered=lambda q_idx: torch.load(prefiltered_filename(q_idx, block_idx)),\n        q_idx_start=q_idx_start,\n        q_idx_end=q_idx_end,\n        filter_fn=lambda values: values &gt; 0.85,\n    ),\n    n_queries=n_queries_sample,\n    all_strings=strings10,\n    next_token_map=next_token_map10,\n    model_outputs=model_outputs_sample,\n)\n\n{'min': 1, 'max': 7457, 'mean': 446.792, 'std': 995.0116103523616}\nTop 1 matches: 0.808\nTop 1 matches (any order): 0.808\nTop 2 matches: 0.458\nTop 2 matches (any order): 0.496\nTop 3 matches: 0.298\nTop 3 matches (any order): 0.376\nTop 4 matches: 0.222\nTop 4 matches (any order): 0.256\nTop 5 matches: 0.182\nTop 5 matches (any order): 0.196\nTop 6 matches: 0.102\nTop 6 matches (any order): 0.158\nTop 7 matches: 0.112\nTop 7 matches (any order): 0.132\nTop 8 matches: 0.090\nTop 8 matches (any order): 0.096\nTop 9 matches: 0.074\nTop 9 matches (any order): 0.070\nTop 10 matches: 0.042\nTop 10 matches (any order): 0.056\n\n\n\nblock_idx = 1\nffwd1_freqs = analyze_dataset(\n    matching_indices=filter_on_prefiltered_results(\n        load_prefiltered=lambda q_idx: torch.load(prefiltered_filename(q_idx, block_idx)),\n        q_idx_start=q_idx_start,\n        q_idx_end=q_idx_end,\n        filter_fn=lambda values: values &gt; 0.94,\n    ),\n    n_queries=n_queries_sample,\n    all_strings=strings10,\n    next_token_map=next_token_map10,\n    model_outputs=model_outputs_sample,\n)\n\n{'min': 1, 'max': 5070, 'mean': 369.31, 'std': 755.4999099271952}\nTop 1 matches: 0.750\nTop 1 matches (any order): 0.750\nTop 2 matches: 0.416\nTop 2 matches (any order): 0.470\nTop 3 matches: 0.236\nTop 3 matches (any order): 0.312\nTop 4 matches: 0.192\nTop 4 matches (any order): 0.218\nTop 5 matches: 0.172\nTop 5 matches (any order): 0.172\nTop 6 matches: 0.102\nTop 6 matches (any order): 0.126\nTop 7 matches: 0.086\nTop 7 matches (any order): 0.102\nTop 8 matches: 0.068\nTop 8 matches (any order): 0.078\nTop 9 matches: 0.060\nTop 9 matches (any order): 0.076\nTop 10 matches: 0.050\nTop 10 matches (any order): 0.060\n\n\n\nblock_idx = 0\nffwd0_freqs = analyze_dataset(\n    matching_indices=filter_on_prefiltered_results(\n        load_prefiltered=lambda q_idx: torch.load(prefiltered_filename(q_idx, block_idx)),\n        q_idx_start=q_idx_start,\n        q_idx_end=q_idx_end,\n        filter_fn=lambda values: values &gt; 0.95,\n    ),\n    n_queries=n_queries_sample,\n    all_strings=strings10,\n    next_token_map=next_token_map10,\n    model_outputs=model_outputs_sample,\n)\n\n{'min': 1, 'max': 5078, 'mean': 333.072, 'std': 663.3523097238751}\nTop 1 matches: 0.754\nTop 1 matches (any order): 0.754\nTop 2 matches: 0.410\nTop 2 matches (any order): 0.472\nTop 3 matches: 0.252\nTop 3 matches (any order): 0.316\nTop 4 matches: 0.192\nTop 4 matches (any order): 0.216\nTop 5 matches: 0.146\nTop 5 matches (any order): 0.170\nTop 6 matches: 0.108\nTop 6 matches (any order): 0.128\nTop 7 matches: 0.092\nTop 7 matches (any order): 0.100\nTop 8 matches: 0.072\nTop 8 matches (any order): 0.072\nTop 9 matches: 0.068\nTop 9 matches (any order): 0.072\nTop 10 matches: 0.046\nTop 10 matches (any order): 0.056\n\n\n\ntotal_freqs = [\n    (\n        0.01*ffwd0_freqs[i] +\n        0.01*ffwd1_freqs[i] +\n        0.1*ffwd2_freqs[i] +\n        1.5*ffwd3_freqs[i] +\n        4*ffwd4_freqs[i] +\n        0.01*ffwd5_freq\n    )\n    for i, ffwd5_freq in enumerate(ffwd5_freqs)\n]\ntotal_probs = [\n    freqs / freqs.sum()\n    for freqs in total_freqs\n]\ntopn_matches, topn_matches_any_order = analyze_simulate_results(total_probs, model_outputs_sample)\nfor i in range(10):\n    print(f\"Top {i+1} matches: {topn_matches[i] / n_queries_sample:.3f}\")\n    print(f\"Top {i+1} matches (any order): {topn_matches_any_order[i] / n_queries_sample:.3f}\")\n\nTop 1 matches: 0.796\nTop 1 matches (any order): 0.796\nTop 2 matches: 0.500\nTop 2 matches (any order): 0.572\nTop 3 matches: 0.326\nTop 3 matches (any order): 0.382\nTop 4 matches: 0.262\nTop 4 matches (any order): 0.308\nTop 5 matches: 0.192\nTop 5 matches (any order): 0.226\nTop 6 matches: 0.144\nTop 6 matches (any order): 0.186\nTop 7 matches: 0.122\nTop 7 matches (any order): 0.144\nTop 8 matches: 0.092\nTop 8 matches (any order): 0.104\nTop 9 matches: 0.076\nTop 9 matches (any order): 0.084\nTop 10 matches: 0.048\nTop 10 matches (any order): 0.054",
    "crumbs": [
      "analyses",
      "Widening the Space of Similar Values"
    ]
  },
  {
    "objectID": "analyses/widening_similar_space.html#incorporate-data-from-the-rest-of-the-strings-everything-above-just-looked-at-first-500",
    "href": "analyses/widening_similar_space.html#incorporate-data-from-the-rest-of-the-strings-everything-above-just-looked-at-first-500",
    "title": "Widening the Space of Similar Values",
    "section": "Incorporate data from the rest of the strings (everything above just looked at first 500)",
    "text": "Incorporate data from the rest of the strings (everything above just looked at first 500)\n\nmodel_outputs = get_model_outputs(strings20k, encoding_helpers)\n\n\nclass GetPrefilteredDataFunction(Protocol):\n    def __call__(self, q_idx: int, block_idx: int) -&gt; Path:\n        ...\n\n\ndef freqs_from_similar_strings(\n    get_prefiltered_data: GetPrefilteredDataFunction,\n    n_queries: int,\n    next_token_map: Dict[str, torch.Tensor],\n    all_strings: Sequence[str],\n    similarity_thresholds=[0.95, 0.94, 0.85, 0.76, 0.81, 0.89],\n) -&gt; torch.Tensor:\n    \"\"\"Builds a frequency distribution for the next token for each block in the\n    model by doing the following for each query:\n     - Finding the strings that pass a similarity threshold\n     - Looking up the frequency distribution for each similar string\n     - Summing frequency distributions across all strings\n     \"\"\"\n    freqs_list: List[List[torch.Tensor]] = [[] for _ in range(n_layer)]\n\n    for block_idx in tqdm(range(n_layer)):\n        # For each query, find the indices into `all_strings` that match the filter\n        similar_indices = filter_on_prefiltered_results(\n            load_prefiltered=lambda q_idx: get_prefiltered_data(q_idx, block_idx),\n            q_idx_start=0,\n            q_idx_end=n_queries,\n            filter_fn=lambda values: values &gt; similarity_thresholds[block_idx],\n        )\n\n        # Turn the indices into strings\n        similar_strings = get_matching_strings(similar_indices, all_strings)\n\n        # At this point we've got a one list of matching strings for each\n        # query. Now we build a frequency distribution from these strings.\n        freqs_list[block_idx] = [\n            torch.stack( # Stack the frequency distributions for each string\n                [\n                    next_token_map[string]\n                    for string in strings\n                ]\n            ).sum(dim=0) # Sum across all strings\n            for strings in similar_strings\n        ]\n\n    # Stack the frequency distributions for each block into a single tensor.\n    freqs = torch.stack(\n        [torch.stack(freqs_list[block_idx]) for block_idx in range(n_layer)]\n    )\n\n    return freqs\n\n\ndef get_prefiltered_data(q_idx: int, block_idx: int) -&gt; Path:\n    return torch.load(prefiltered_filename(q_idx, block_idx))\n\n\n# Slow - takes about 7 minutes to run\nn_queries = 20000\n\nffwd_freqs = freqs_from_similar_strings(\n    get_prefiltered_data=get_prefiltered_data,\n    n_queries=n_queries,\n    next_token_map=next_token_map10,\n    all_strings=strings10,\n)\n\n\n\n\n\nffwd_freqs.shape, len(model_outputs)\n\n(torch.Size([6, 20000, 65]), 20000)\n\n\n\n(results_folder / 'learn_coefficients').mkdir(exist_ok=True)\ntorch.save(ffwd_freqs, str(results_folder / 'learn_coefficients/ffwd_freqs.pt'))\n\n\n# Load ffwd_freqs from disk\nffwd_freqs = torch.load(results_folder / 'learn_coefficients/ffwd_freqs.pt')\n\n\n# Check that we still get the same results for the first 500\nhand_rolled_coeffs = torch.tensor([0.01, 0.01, 0.1, 1.5, 4, 0.01]).unsqueeze(dim=1).unsqueeze(dim=2) # (n_layer, 1, 1)\ntotal_freqs = (ffwd_freqs[:, :500, :] * hand_rolled_coeffs).sum(dim=0)\ntotal_probs = total_freqs / total_freqs.sum(dim=-1, keepdim=True)\ntopn_matches, topn_matches_any_order = analyze_simulate_results(total_probs, model_outputs[:500])\nfor i in range(10):\n    print(f\"Top {i+1} matches: {topn_matches[i] / n_queries_sample:.3f}\")\n    print(f\"Top {i+1} matches (any order): {topn_matches_any_order[i] / n_queries_sample:.3f}\")\n\nTop 1 matches: 0.796\nTop 1 matches (any order): 0.796\nTop 2 matches: 0.500\nTop 2 matches (any order): 0.572\nTop 3 matches: 0.326\nTop 3 matches (any order): 0.382\nTop 4 matches: 0.262\nTop 4 matches (any order): 0.308\nTop 5 matches: 0.192\nTop 5 matches (any order): 0.226\nTop 6 matches: 0.144\nTop 6 matches (any order): 0.186\nTop 7 matches: 0.122\nTop 7 matches (any order): 0.144\nTop 8 matches: 0.092\nTop 8 matches (any order): 0.104\nTop 9 matches: 0.076\nTop 9 matches (any order): 0.084\nTop 10 matches: 0.048\nTop 10 matches (any order): 0.054\n\n\n\n# Look at it for all samples\nhand_rolled_coeffs = torch.tensor([0.01, 0.01, 0.1, 1.5, 4, 0.01]).unsqueeze(dim=1).unsqueeze(dim=2) # (n_layer, 1, 1)\ntotal_freqs = (ffwd_freqs * hand_rolled_coeffs).sum(dim=0)\ntotal_probs = total_freqs / total_freqs.sum(dim=-1, keepdim=True)\ntopn_matches, topn_matches_any_order = analyze_simulate_results(total_probs, model_outputs)\nfor i in range(10):\n    print(f\"Top {i+1} matches: {topn_matches[i] / ffwd_freqs.shape[1]:.3f}\")\n    print(f\"Top {i+1} matches (any order): {topn_matches_any_order[i] / ffwd_freqs.shape[1]:.3f}\")\n\nTop 1 matches: 0.806\nTop 1 matches (any order): 0.806\nTop 2 matches: 0.501\nTop 2 matches (any order): 0.568\nTop 3 matches: 0.342\nTop 3 matches (any order): 0.405\nTop 4 matches: 0.273\nTop 4 matches (any order): 0.337\nTop 5 matches: 0.209\nTop 5 matches (any order): 0.250\nTop 6 matches: 0.168\nTop 6 matches (any order): 0.197\nTop 7 matches: 0.129\nTop 7 matches (any order): 0.153\nTop 8 matches: 0.105\nTop 8 matches (any order): 0.124\nTop 9 matches: 0.086\nTop 9 matches (any order): 0.091\nTop 10 matches: 0.055\nTop 10 matches (any order): 0.057\n\n\nBut can we tweak these hand-rolled coefficients for the full data set and get better results?\n\nhand_rolled_coeffs = torch.tensor([0.01, 0.01, 0.1, 1.5, 6, 0.01]).unsqueeze(dim=1).unsqueeze(dim=2) # (n_layer, 1, 1)\ntotal_freqs = (ffwd_freqs * hand_rolled_coeffs).sum(dim=0)\ntotal_probs = total_freqs / total_freqs.sum(dim=-1, keepdim=True)\ntopn_matches, topn_matches_any_order = analyze_simulate_results(total_probs, model_outputs)\nfor i in range(10):\n    print(f\"Top {i+1} matches: {topn_matches[i] / ffwd_freqs.shape[1]:.3f}\")\n    print(f\"Top {i+1} matches (any order): {topn_matches_any_order[i] / ffwd_freqs.shape[1]:.3f}\")\n\nTop 1 matches: 0.806\nTop 1 matches (any order): 0.806\nTop 2 matches: 0.502\nTop 2 matches (any order): 0.568\nTop 3 matches: 0.342\nTop 3 matches (any order): 0.405\nTop 4 matches: 0.273\nTop 4 matches (any order): 0.336\nTop 5 matches: 0.209\nTop 5 matches (any order): 0.248\nTop 6 matches: 0.167\nTop 6 matches (any order): 0.196\nTop 7 matches: 0.127\nTop 7 matches (any order): 0.152\nTop 8 matches: 0.105\nTop 8 matches (any order): 0.124\nTop 9 matches: 0.086\nTop 9 matches (any order): 0.090\nTop 10 matches: 0.054\nTop 10 matches (any order): 0.057\n\n\nThis is the best yet for the full data set, with hand-rolled coefficients. Let’s see if we can learn better values.",
    "crumbs": [
      "analyses",
      "Widening the Space of Similar Values"
    ]
  },
  {
    "objectID": "analyses/widening_similar_space.html#learn-coefficients",
    "href": "analyses/widening_similar_space.html#learn-coefficients",
    "title": "Widening the Space of Similar Values",
    "section": "Learn Coefficients",
    "text": "Learn Coefficients\n\nclass ModelSim(torch.nn.Module):\n    def __init__(self):\n        super().__init__()\n        self.coeffs = torch.nn.Parameter(\n            torch.randn(n_layer, 1, 1, dtype=torch.float32, requires_grad=True)\n        )\n        torch.nn.init.normal_(self.coeffs.data, mean=0.0, std=0.2)\n\n    def forward(self, freqs: torch.Tensor, model_output: Optional[torch.Tensor]=None):\n        total_freqs = (freqs * self.coeffs).sum(dim=0)\n        total_probs = total_freqs / total_freqs.sum(dim=-1, keepdim=True)\n\n        if model_output is not None:\n            loss = torch.norm(total_probs - model_output, dim=-1).sum()\n        else:\n            loss = None\n\n\n        return total_probs, loss\n\n\n@torch.no_grad()\ndef estimate_loss(\n    model: ModelSim, get_batch_func: GetBatchFunction, eval_iters: int=100\n):\n    out = {}\n    for split in [\"train\", \"val\"]:\n        losses = torch.zeros(eval_iters)\n        for k in range(eval_iters):\n            X, Y = get_batch_func(split=split)\n\n            _, loss = model(X, Y)\n\n            losses[k] = loss.item()\n\n        out[split] = losses.mean()\n    return out\n\n\ndef get_batch(batch_size: int, freqs: torch.Tensor, split: str='train', train_pct: float=0.9):\n    n = freqs.shape[1]\n    assert split in ['train', 'val']\n    n_train = int(n * train_pct)\n    low = 0 if split == 'train' else n_train\n    high = n_train if split == 'train' else n\n\n    batch_indices = torch.randint(low=low, high=high, size=(batch_size,), dtype=torch.long)\n    batch_strings = [strings20k[i.item()] for i in batch_indices]\n\n    tokens = encoding_helpers.tokenize_strings(batch_strings)\n    logits, _ = m(tokens)\n    model_output = F.softmax(logits[:, -1, :], dim=-1)\n\n    return freqs[:, batch_indices, :].clone(), model_output.detach()\n\n\nbatch_size=500\neval_iters = 100\n\nget_batch_func = partial(get_batch, batch_size=batch_size, freqs=ffwd_freqs, train_pct=0.9)\nestimate_loss_func = partial(estimate_loss, get_batch_func=get_batch_func, eval_iters=eval_iters)\n\n\n_ = torch.manual_seed(1337) # Ensure stable random values\nm2 = ModelSim()\n_ = m2.to(device)\n\n\noutput_dir = results_folder / 'learn_coefficients'\noutput_dir.mkdir(exist_ok=True)\ncheckpointer = CheckPointer(output_dir, 'coeff_model_checkpoint', start_num=0)\n\n\ntrainer = Trainer(\n    model=m2,\n    checkpointer=checkpointer,\n    get_batch_func=get_batch_func,\n    estimate_loss_func=estimate_loss_func,\n    iters_trained=0\n)\n\n\n# Get a starting point for the loss\nestimate_loss_func(m2)\n\n{'train': tensor(355.8277), 'val': tensor(390.0248)}\n\n\n\n# Start with a pretty high learning rate and go for 1000 iterations\nlearning_rate = 3e-2\noptimizer = torch.optim.AdamW(m2.parameters(), lr=learning_rate)\n\ntrainer.train(1000, optimizer, eval_interval=500)\n\n\n\n\nstep 499: train loss 92.6609, val loss 94.5815\nstep 999: train loss 98.4017, val loss 101.1536\n\n\nLooks like it got to a good place and then quickly overshot. But we don’t know if it would have recovered because we stopped after that. Let’s keep going and see what happens. We can always backtrack if it keeps getting worse.\n\ntrainer.train(5000, optimizer, eval_interval=500)\n\n\n\n\nstep 499: train loss 98.9964, val loss 99.9345\nstep 999: train loss 96.9539, val loss 97.9114\nstep 1499: train loss 90.8162, val loss 92.1447\nstep 1999: train loss 101.1968, val loss 103.3944\nstep 2499: train loss 101.8853, val loss 104.0021\nstep 2999: train loss 100.8928, val loss 104.1331\nstep 3499: train loss 101.3843, val loss 103.6743\nstep 3999: train loss 101.1491, val loss 104.2174\nstep 4499: train loss 101.8255, val loss 103.3381\nstep 4999: train loss 100.8471, val loss 103.2514\n\n\nOK, that got better but then overshot. Let’s go back to the good point and try a smaller learning rate.\n\ncheckpoint = torch.load(checkpointer.output_dir / 'coeff_model_checkpoint_000004.pt')\ncheckpoint['iters'], checkpoint['train_loss'], checkpoint['val_loss']\n\n(2500, tensor(90.8162), tensor(92.1447))\n\n\n\nm2.load_state_dict(checkpoint['model_state_dict'])\n\n&lt;All keys matched successfully&gt;\n\n\nNow we are back at a good state.\n\nm2.coeffs.data\n\ntensor([[[0.0998]],\n\n        [[0.0701]],\n\n        [[0.1811]],\n\n        [[0.1651]],\n\n        [[0.3011]],\n\n        [[0.3028]]])\n\n\n\ntotal_probs, _ = m2(ffwd_freqs)\ntopn_matches, topn_matches_any_order = analyze_simulate_results(total_probs, model_outputs)\nfor i in range(10):\n    print(f\"Top {i+1} matches: {topn_matches[i] / ffwd_freqs.shape[1]:.3f}\")\n    print(f\"Top {i+1} matches (any order): {topn_matches_any_order[i] / ffwd_freqs.shape[1]:.3f}\")\n\nTop 1 matches: 0.781\nTop 1 matches (any order): 0.781\nTop 2 matches: 0.474\nTop 2 matches (any order): 0.549\nTop 3 matches: 0.331\nTop 3 matches (any order): 0.393\nTop 4 matches: 0.266\nTop 4 matches (any order): 0.334\nTop 5 matches: 0.206\nTop 5 matches (any order): 0.245\nTop 6 matches: 0.163\nTop 6 matches (any order): 0.197\nTop 7 matches: 0.129\nTop 7 matches (any order): 0.153\nTop 8 matches: 0.104\nTop 8 matches (any order): 0.124\nTop 9 matches: 0.087\nTop 9 matches (any order): 0.092\nTop 10 matches: 0.057\nTop 10 matches (any order): 0.059\n\n\nNot bad but we know we can do better. Let’s reduce the learning rate and keep going.\n\n# Reduce the learning rate by one order of magnitude\nlearning_rate = 3e-3\noptimizer = torch.optim.AdamW(m2.parameters(), lr=learning_rate)\n\n# Train some more\ntrainer.train(2000, optimizer, eval_interval=500)\n\n\n\n\nstep 499: train loss 86.7844, val loss 85.1847\nstep 999: train loss 89.7584, val loss 85.5004\nstep 1499: train loss 86.8556, val loss 85.5568\nstep 1999: train loss 87.6787, val loss 85.1027\n\n\n\nm2.coeffs.data\n\ntensor([[[ 0.0063]],\n\n        [[-0.0217]],\n\n        [[ 0.1207]],\n\n        [[ 0.2180]],\n\n        [[ 0.3632]],\n\n        [[ 0.3682]]])\n\n\n\ntotal_probs, _ = m2(ffwd_freqs)\ntopn_matches, topn_matches_any_order = analyze_simulate_results(total_probs, model_outputs)\nfor i in range(10):\n    print(f\"Top {i+1} matches: {topn_matches[i] / ffwd_freqs.shape[1]:.3f}\")\n    print(f\"Top {i+1} matches (any order): {topn_matches_any_order[i] / ffwd_freqs.shape[1]:.3f}\")\n\nTop 1 matches: 0.795\nTop 1 matches (any order): 0.795\nTop 2 matches: 0.486\nTop 2 matches (any order): 0.558\nTop 3 matches: 0.333\nTop 3 matches (any order): 0.397\nTop 4 matches: 0.268\nTop 4 matches (any order): 0.338\nTop 5 matches: 0.206\nTop 5 matches (any order): 0.250\nTop 6 matches: 0.166\nTop 6 matches (any order): 0.199\nTop 7 matches: 0.127\nTop 7 matches (any order): 0.151\nTop 8 matches: 0.104\nTop 8 matches (any order): 0.124\nTop 9 matches: 0.085\nTop 9 matches (any order): 0.090\nTop 10 matches: 0.052\nTop 10 matches (any order): 0.058\n\n\nDoing well. Let’s try a few more rounds at the same rate.\n\ntrainer.train(2000, optimizer, eval_interval=500)\n\n\n\n\nstep 499: train loss 88.2698, val loss 85.8976\nstep 999: train loss 111.8359, val loss 105.2479\nstep 1499: train loss 84.7038, val loss 85.9471\nstep 1999: train loss 84.9063, val loss 85.6737\n\n\nIt got lost but came back to a good spot. It hasn’t made a ton of progress, though, so may be stuck. Let’s try an even smaller learning rate.\n\n# Go down one more order of magnitude\nlearning_rate = 3e-4\noptimizer = torch.optim.AdamW(m2.parameters(), lr=learning_rate)\n\n# Train some more\ntrainer.train(2000, optimizer, eval_interval=500)\n\n\n\n\nstep 499: train loss 80.4703, val loss 81.8304\nstep 999: train loss 80.1729, val loss 80.9812\nstep 1499: train loss 79.5038, val loss 81.0121\nstep 1999: train loss 79.6113, val loss 81.1012\n\n\nGoing well. Let’s let it run a bit more to see if there is more to be gained at this learning rate.\n\n# Train some more\ntrainer.train(5000, optimizer, eval_interval=500)\n\n\n\n\nstep 499: train loss 79.9726, val loss 80.9605\nstep 999: train loss 79.8885, val loss 80.7976\nstep 1499: train loss 79.4328, val loss 80.5349\nstep 1999: train loss 79.6406, val loss 80.7106\nstep 2499: train loss 78.8512, val loss 79.3027\nstep 2999: train loss 92.4660, val loss 84.4240\nstep 3499: train loss 88.8365, val loss 85.2693\nstep 3999: train loss 89.9178, val loss 84.7041\nstep 4499: train loss 89.9341, val loss 85.5066\nstep 4999: train loss 90.7773, val loss 84.8867\n\n\nThat got better but then went off the rails. Let’s go back to the best checkpoint.\n\ncheckpoint = torch.load(checkpointer.output_dir / 'coeff_model_checkpoint_000028.pt')\ncheckpoint['iters'], checkpoint['train_loss'], checkpoint['val_loss']\n\n(14500, tensor(78.8512), tensor(79.3027))\n\n\n\nm2.load_state_dict(checkpoint['model_state_dict'])\n\n&lt;All keys matched successfully&gt;\n\n\n\nm2.coeffs.data\n\ntensor([[[ 3.8330e-03]],\n\n        [[-1.5296e-03]],\n\n        [[-2.2343e-04]],\n\n        [[ 9.7601e-02]],\n\n        [[ 7.6696e-01]],\n\n        [[ 1.0677e-01]]])\n\n\n\ntotal_probs, _ = m2(ffwd_freqs)\ntopn_matches, topn_matches_any_order = analyze_simulate_results(total_probs, model_outputs)\nfor i in range(10):\n    print(f\"Top {i+1} matches: {topn_matches[i] / ffwd_freqs.shape[1]:.3f}\")\n    print(f\"Top {i+1} matches (any order): {topn_matches_any_order[i] / ffwd_freqs.shape[1]:.3f}\")\n\nTop 1 matches: 0.802\nTop 1 matches (any order): 0.802\nTop 2 matches: 0.497\nTop 2 matches (any order): 0.566\nTop 3 matches: 0.344\nTop 3 matches (any order): 0.405\nTop 4 matches: 0.275\nTop 4 matches (any order): 0.335\nTop 5 matches: 0.207\nTop 5 matches (any order): 0.246\nTop 6 matches: 0.166\nTop 6 matches (any order): 0.196\nTop 7 matches: 0.127\nTop 7 matches (any order): 0.148\nTop 8 matches: 0.106\nTop 8 matches (any order): 0.123\nTop 9 matches: 0.085\nTop 9 matches (any order): 0.086\nTop 10 matches: 0.052\nTop 10 matches (any order): 0.055\n\n\nThat’s nearly as good as the hand-rolled coefficients. Let’s try a few more rounds at a smaller learning rate.\n\n# Go down one more order of magnitude\nlearning_rate = 3e-5\noptimizer = torch.optim.AdamW(m2.parameters(), lr=learning_rate)\n\n# Train some more\ntrainer.train(5000, optimizer, eval_interval=500)\n\n\n\n\nstep 499: train loss 79.0625, val loss 79.1941\nstep 999: train loss 78.2563, val loss 79.1195\nstep 1499: train loss 78.3124, val loss 78.8700\nstep 1999: train loss 78.4172, val loss 79.0324\nstep 2499: train loss 77.7076, val loss 78.5610\nstep 2999: train loss 78.0883, val loss 77.9647\nstep 3499: train loss 76.2281, val loss 76.7733\nstep 3999: train loss 76.0516, val loss 77.5841\nstep 4499: train loss 76.8096, val loss 77.2572\nstep 4999: train loss 76.8454, val loss 77.1808\n\n\nSome improvement! Not clear if it’s stabilized or not, so let’s keep going.\n\ntrainer.train(5000, optimizer, eval_interval=500)\n\n\n\n\nstep 499: train loss 76.4978, val loss 77.1828\nstep 999: train loss 77.1313, val loss 77.3532\nstep 1499: train loss 76.6558, val loss 77.2998\nstep 1999: train loss 76.8978, val loss 77.4199\nstep 2499: train loss 76.5466, val loss 77.0944\nstep 2999: train loss 76.1288, val loss 76.6329\nstep 3499: train loss 76.5751, val loss 77.8199\nstep 3999: train loss 76.8902, val loss 77.1575\nstep 4499: train loss 76.8581, val loss 77.5016\nstep 4999: train loss 76.1585, val loss 77.7288\n\n\nOK, doesn’t seem to be going anywhere. Let’s go back to the best checkpoint.\n\ncheckpoint = torch.load(checkpointer.output_dir / 'coeff_model_checkpoint_000041.pt')\ncheckpoint['iters'], checkpoint['train_loss'], checkpoint['val_loss']\n\n(21000, tensor(76.0516), tensor(77.5841))\n\n\n\nm2.coeffs.data\n\ntensor([[[ 4.6905e-03]],\n\n        [[-1.5016e-03]],\n\n        [[ 2.6866e-04]],\n\n        [[ 1.2218e-01]],\n\n        [[ 8.1634e-01]],\n\n        [[ 7.6261e-05]]])\n\n\n\ntotal_probs, _ = m2(ffwd_freqs)\ntopn_matches, topn_matches_any_order = analyze_simulate_results(total_probs, model_outputs)\nfor i in range(10):\n    print(f\"Top {i+1} matches: {topn_matches[i] / ffwd_freqs.shape[1]:.3f}\")\n    print(f\"Top {i+1} matches (any order): {topn_matches_any_order[i] / ffwd_freqs.shape[1]:.3f}\")\n\nTop 1 matches: 0.806\nTop 1 matches (any order): 0.806\nTop 2 matches: 0.501\nTop 2 matches (any order): 0.566\nTop 3 matches: 0.341\nTop 3 matches (any order): 0.402\nTop 4 matches: 0.270\nTop 4 matches (any order): 0.334\nTop 5 matches: 0.205\nTop 5 matches (any order): 0.244\nTop 6 matches: 0.163\nTop 6 matches (any order): 0.193\nTop 7 matches: 0.123\nTop 7 matches (any order): 0.148\nTop 8 matches: 0.103\nTop 8 matches (any order): 0.122\nTop 9 matches: 0.085\nTop 9 matches (any order): 0.088\nTop 10 matches: 0.053\nTop 10 matches (any order): 0.056\n\n\nThis is really, really close to the best hand-rolled coefficients. It doesn’t seem to be getting better so let’s stop here.\nWhat if we initialize with the hand-rolled weights and see if it can improve that?\n\nm3 = ModelSim()\nm3.coeffs = torch.nn.Parameter(torch.tensor([0.01, 0.01, 0.1, 1.5, 6, 0.01]).unsqueeze(dim=1).unsqueeze(dim=2))\nm3.coeffs.shape\n\ntorch.Size([6, 1, 1])\n\n\n\noutput_dir = results_folder / 'learn_coefficients'\noutput_dir.mkdir(exist_ok=True)\ncheckpointer = CheckPointer(output_dir, 'coeff_model_hand_rolled_checkpoint', start_num=0)\n\n\ntrainer = Trainer(\n    model=m3,\n    checkpointer=checkpointer,\n    get_batch_func=get_batch_func,\n    estimate_loss_func=estimate_loss_func,\n    iters_trained=0\n)\n\n\n# Get a starting point for the loss\nestimate_loss_func(m3)\n\n{'train': tensor(77.4965), 'val': tensor(78.0544)}\n\n\n\n# Begin with a moderate learning rate\nlearning_rate = 3e-4\noptimizer = torch.optim.AdamW(m3.parameters(), lr=learning_rate)\n\ntrainer.train(1000, optimizer, eval_interval=500)\n\n\n\n\nstep 499: train loss 76.9864, val loss 77.7938\nstep 999: train loss 76.9611, val loss 77.3218\n\n\nVery slightly better, but doesn’t seem to be going anywhere. Let’s reduce the learning rate and run for longer.\n\nlearning_rate = 3e-5\noptimizer = torch.optim.AdamW(m3.parameters(), lr=learning_rate)\n\ntrainer.train(5000, optimizer, eval_interval=500)\n\n\n\n\nstep 499: train loss 76.7579, val loss 77.3010\nstep 999: train loss 76.2980, val loss 77.7475\nstep 1499: train loss 76.2058, val loss 77.4439\nstep 1999: train loss 76.5784, val loss 76.7124\nstep 2499: train loss 76.6791, val loss 77.5712\nstep 2999: train loss 76.7577, val loss 77.4296\nstep 3499: train loss 76.3487, val loss 77.2223\nstep 3999: train loss 76.9857, val loss 77.4700\nstep 4499: train loss 77.6480, val loss 77.1776\nstep 4999: train loss 76.2195, val loss 76.9608\n\n\nSlightly better but does not seem to be improving. This is probably about as good as it gets. Let’s see where we ended up. |\n\nm3.coeffs.data\n\ntensor([[[ 3.4375e-02]],\n\n        [[-1.1588e-02]],\n\n        [[-6.7676e-04]],\n\n        [[ 1.2653e+00]],\n\n        [[ 6.1962e+00]],\n\n        [[ 4.2160e-04]]])\n\n\n\ntotal_probs, _ = m3(ffwd_freqs)\ntopn_matches, topn_matches_any_order = analyze_simulate_results(total_probs, model_outputs)\nfor i in range(10):\n    print(f\"Top {i+1} matches: {topn_matches[i] / ffwd_freqs.shape[1]:.3f}\")\n    print(f\"Top {i+1} matches (any order): {topn_matches_any_order[i] / ffwd_freqs.shape[1]:.3f}\")\n\nTop 1 matches: 0.806\nTop 1 matches (any order): 0.806\nTop 2 matches: 0.501\nTop 2 matches (any order): 0.566\nTop 3 matches: 0.340\nTop 3 matches (any order): 0.402\nTop 4 matches: 0.271\nTop 4 matches (any order): 0.335\nTop 5 matches: 0.206\nTop 5 matches (any order): 0.245\nTop 6 matches: 0.163\nTop 6 matches (any order): 0.193\nTop 7 matches: 0.123\nTop 7 matches (any order): 0.147\nTop 8 matches: 0.104\nTop 8 matches (any order): 0.121\nTop 9 matches: 0.084\nTop 9 matches (any order): 0.087\nTop 10 matches: 0.053\nTop 10 matches (any order): 0.055\n\n\nVery similar to what the model got to from random initialization. And also just a hair worse than the hand-rolled coefficients. There’s probably not much more juice to squeeze out of this.",
    "crumbs": [
      "analyses",
      "Widening the Space of Similar Values"
    ]
  },
  {
    "objectID": "analyses/widening_similar_space.html#look-at-results-for-strings-used-in-training",
    "href": "analyses/widening_similar_space.html#look-at-results-for-strings-used-in-training",
    "title": "Widening the Space of Similar Values",
    "section": "Look at Results for Strings Used in Training",
    "text": "Look at Results for Strings Used in Training\n\nbatch_histories_dir = environment.data_root / 'model-training/20231112-training/batch_histories'\ntest_eq(batch_histories_dir.exists(), True)\n\nBased on the training log, the final model we ended up using is from the checkpoint file shakespeare_checkpoint_000008.pt. And it was a straight succession of training runs to get to that point (no backtracking to intermediate checkpoints). So the relevant history is just all the batch histories up to the final checkpoint.\n\nbatch_history_files = [\n    'batch_history_0000.pt',\n    'batch_history_0001.pt',\n    'batch_history_0002.pt',\n    'batch_history_0003.pt',\n    'batch_history_0004.pt',\n    'batch_history_0005.pt',\n    'batch_history_0006.pt',\n    'batch_history_0007.pt',\n    'batch_history_0008.pt',\n]\n\n\nfull_history = torch.cat([\n    torch.load(batch_histories_dir / batch_history_file)['batch_history']\n    for batch_history_file in batch_history_files\n], dim=0)\nfull_history.shape\n\ntorch.Size([4500, 64, 256])\n\n\nThe training process used a batch size of 64. So the shape above indicates we did 4500 iterations with 64 strings per iteration. The grouping into batches isn’t meaningful, so we can just combine the first two dimensions.\n\nassert full_history.shape[-1] == block_size\nfull_history = full_history.reshape(-1, block_size)\nfull_history.shape\n\ntorch.Size([288000, 256])\n\n\n\n# The history data consists of tokens. Now  we turn those into strings.\n# We'll create a map of unique strings to the count of times they were\n# trained on.\n\nstrings_trained_on = defaultdict(int)\nn_strings, _ = full_history.shape\nfor i in range(n_strings):\n    string = encoding_helpers.stringify_tokens(full_history[i, :])\n    strings_trained_on[string] += 1\nstrings_trained_on.default_factory = None\n\n\nlen(strings_trained_on)\n\n250403\n\n\n\n# Pre-compute some things that will make later lookups faster\n\n# All the evaluation in this notebook is done on length 10 strings\nslen = 10\n\n# All length 10 strings that appeared at the start of any training string\nprefixes_trained_on = defaultdict(int)\nfor string, count in strings_trained_on.items():\n    prefixes_trained_on[string[:slen]] += count\nprefixes_trained_on.default_factory = None\n\n# All length 10 strings that appeared at the end of any training string\nsuffixes_trained_on = defaultdict(int)\nfor string, count in strings_trained_on.items():\n    suffixes_trained_on[string[-slen:]] += count\nsuffixes_trained_on.default_factory = None\n\n# All length 10 strings that appeared anywhere in any training string\nsubstrings_trained_on = defaultdict(int)\nfor string, count in strings_trained_on.items():\n    for substring in all_unique_substrings(string, 10):\n        substrings_trained_on[substring] += count\nsubstrings_trained_on.default_factory = None\n\nlen(prefixes_trained_on), len(suffixes_trained_on), len(substrings_trained_on)\n\n(221305, 221236, 780165)\n\n\n\ndef filter_by_trained_on(\n    strings: Sequence[str],\n    trained_on: Dict[str, int],\n) -&gt; Tuple[List[str], torch.Tensor]:\n    strings_used_in_training = []\n    indicies_used_in_training = []\n\n    for i, string in enumerate(strings):\n        if string in trained_on:\n            strings_used_in_training.append(string)\n            indicies_used_in_training.append(i)\n\n    return strings_used_in_training, torch.tensor(\n        indicies_used_in_training, dtype=torch.long\n    )\n\n\ndef eval_on_subset(\n    indices_to_consider: torch.Tensor,\n    model_outputs: Sequence[Sequence[Tuple[str, float]]],\n    ffwd_freqs: torch.Tensor,\n    coeffs: torch.Tensor,\n):\n    model_outputs_subset = []\n    for i in indices_to_consider:\n        model_outputs_subset.append(model_outputs[i.item()])\n\n    n_items = len(indices_to_consider)\n    total_freqs = (ffwd_freqs[:, indices_to_consider, :] * coeffs).sum(dim=0)\n    total_probs = total_freqs / total_freqs.sum(dim=-1, keepdim=True)\n    topn_matches, topn_matches_any_order = analyze_simulate_results(total_probs, model_outputs_subset)\n    for i in range(10):\n        print(f\"Top {i+1} matches: {topn_matches[i] / n_items:.3f}\")\n        print(f\"Top {i+1} matches (any order): {topn_matches_any_order[i] / n_items:.3f}\")\n\n\nhand_rolled_coeffs = torch.tensor([0.01, 0.01, 0.1, 1.5, 6, 0.01]).unsqueeze(dim=1).unsqueeze(dim=2) # (n_layer, 1, 1)\n\n\n# Prefixes\nstrings_used_in_training, indices_used_in_training = filter_by_trained_on(\n    strings20k,\n    prefixes_trained_on,\n)\nprint(f\"{len(strings_used_in_training)} of {len(strings20k)} strings used in training\")\n\neval_on_subset(indices_used_in_training, model_outputs, ffwd_freqs, hand_rolled_coeffs)\n\n5132 of 20000 strings used in training\nTop 1 matches: 0.810\nTop 1 matches (any order): 0.810\nTop 2 matches: 0.502\nTop 2 matches (any order): 0.570\nTop 3 matches: 0.337\nTop 3 matches (any order): 0.403\nTop 4 matches: 0.271\nTop 4 matches (any order): 0.332\nTop 5 matches: 0.207\nTop 5 matches (any order): 0.253\nTop 6 matches: 0.169\nTop 6 matches (any order): 0.202\nTop 7 matches: 0.126\nTop 7 matches (any order): 0.155\nTop 8 matches: 0.104\nTop 8 matches (any order): 0.129\nTop 9 matches: 0.088\nTop 9 matches (any order): 0.089\nTop 10 matches: 0.055\nTop 10 matches (any order): 0.059\n\n\n\n# Suffixes\nstrings_used_in_training, indices_used_in_training = filter_by_trained_on(\n    strings20k,\n    suffixes_trained_on,\n)\nprint(f\"{len(strings_used_in_training)} of {len(strings20k)} strings used in training\")\n\neval_on_subset(indices_used_in_training, model_outputs, ffwd_freqs, hand_rolled_coeffs)\n\n5132 of 20000 strings used in training\nTop 1 matches: 0.811\nTop 1 matches (any order): 0.811\nTop 2 matches: 0.497\nTop 2 matches (any order): 0.567\nTop 3 matches: 0.343\nTop 3 matches (any order): 0.403\nTop 4 matches: 0.274\nTop 4 matches (any order): 0.329\nTop 5 matches: 0.206\nTop 5 matches (any order): 0.244\nTop 6 matches: 0.168\nTop 6 matches (any order): 0.193\nTop 7 matches: 0.128\nTop 7 matches (any order): 0.157\nTop 8 matches: 0.107\nTop 8 matches (any order): 0.129\nTop 9 matches: 0.087\nTop 9 matches (any order): 0.089\nTop 10 matches: 0.060\nTop 10 matches (any order): 0.062\n\n\nIt’s a huge coincidence that the number of the 20,000 eval strings that appeared as prefixes and the number that appeared as suffixes is 5132. Let’s double check that these aren’t exactly the same.\n\n# Sanity check\n\nstrings_used_in_training_prefix, indices_used_in_training_prefix = filter_by_trained_on(\n    strings20k,\n    prefixes_trained_on,\n)\nstrings_used_in_training_suffix, indices_used_in_training_suffix = filter_by_trained_on(\n    strings20k,\n    suffixes_trained_on,\n)\n\ntest_eq(all(indices_used_in_training_prefix == indices_used_in_training_suffix), False)\n\nThese aren’t the same 5132 strings, so maybe it is just a coincidence. Carrying on…\n\n# Substrings anywhere\nstrings_used_in_training, indices_used_in_training = filter_by_trained_on(\n    strings20k,\n    substrings_trained_on,\n)\nprint(f\"{len(strings_used_in_training)} of {len(strings20k)} strings used in training\")\n\neval_on_subset(indices_used_in_training, model_outputs, ffwd_freqs, hand_rolled_coeffs)\n\n18171 of 20000 strings used in training\nTop 1 matches: 0.809\nTop 1 matches (any order): 0.809\nTop 2 matches: 0.503\nTop 2 matches (any order): 0.570\nTop 3 matches: 0.344\nTop 3 matches (any order): 0.407\nTop 4 matches: 0.274\nTop 4 matches (any order): 0.337\nTop 5 matches: 0.210\nTop 5 matches (any order): 0.249\nTop 6 matches: 0.168\nTop 6 matches (any order): 0.197\nTop 7 matches: 0.127\nTop 7 matches (any order): 0.153\nTop 8 matches: 0.105\nTop 8 matches (any order): 0.125\nTop 9 matches: 0.088\nTop 9 matches (any order): 0.091\nTop 10 matches: 0.055\nTop 10 matches (any order): 0.057\n\n\nConclusions:\n\nMost of the eval strings appeared somewhere in the training strings.\nFiltering down to eval strings that were just prefixes or suffixes of training strings greatly reduces the number of strings in the sample, and while this does give a small lift to the top 1 accuracy, it slightly reduces everything else.\nConsidering the strings that appeared anywhere in the training strings very slightly lifts accuracy.",
    "crumbs": [
      "analyses",
      "Widening the Space of Similar Values"
    ]
  },
  {
    "objectID": "analyses/widening_similar_space.html#understanding-characteristics-of-the-model-outputs",
    "href": "analyses/widening_similar_space.html#understanding-characteristics-of-the-model-outputs",
    "title": "Widening the Space of Similar Values",
    "section": "Understanding Characteristics of the Model Outputs",
    "text": "Understanding Characteristics of the Model Outputs\n\n# What do the model outputs look like?\nmodel_outputs[0]\n\n[('\\n', 0.5250111222267151),\n (' ', 0.46654149889945984),\n ('-', 0.007815942168235779),\n (\"'\", 0.00047109558363445103),\n ('.', 2.7687412512023002e-05),\n (',', 1.7208614735864103e-05),\n (':', 1.5419789633597247e-05),\n ('?', 1.3534416211768985e-05),\n (';', 9.159703949990217e-06),\n ('l', 8.144122148223687e-06)]\n\n\n\ndef filter_model_outputs(\n    model_outputs: Sequence[Sequence[Tuple[str, float]]],\n    filter_fn: Callable[[Sequence[Tuple[str, float]]], bool],\n) -&gt; torch.Tensor:\n    matching_indices = []\n    for i, model_output in enumerate(model_outputs):\n        if filter_fn(model_output):\n            matching_indices.append(i)\n    return torch.tensor(matching_indices, dtype=torch.long)\n\n\nmatching_indices = filter_model_outputs(\n    model_outputs,\n    lambda model_output: model_output[0][1] &gt; 0.99,\n)\nprint(f\"{len(matching_indices)} of {len(model_outputs)} string\")\neval_on_subset(matching_indices, model_outputs, ffwd_freqs, hand_rolled_coeffs)\n\n3057 of 20000 string\nTop 1 matches: 0.998\nTop 1 matches (any order): 0.998\nTop 2 matches: 0.349\nTop 2 matches (any order): 0.351\nTop 3 matches: 0.137\nTop 3 matches (any order): 0.149\nTop 4 matches: 0.060\nTop 4 matches (any order): 0.062\nTop 5 matches: 0.028\nTop 5 matches (any order): 0.026\nTop 6 matches: 0.020\nTop 6 matches (any order): 0.022\nTop 7 matches: 0.013\nTop 7 matches (any order): 0.012\nTop 8 matches: 0.011\nTop 8 matches (any order): 0.010\nTop 9 matches: 0.010\nTop 9 matches (any order): 0.008\nTop 10 matches: 0.005\nTop 10 matches (any order): 0.004\n\n\n\nmatching_indices = filter_model_outputs(\n    model_outputs,\n    lambda model_output: sum([model_output[i][1] for i in range(2)]) &gt; 0.85,\n)\nprint(f\"{len(matching_indices)} of {len(model_outputs)} string\")\neval_on_subset(matching_indices, model_outputs, ffwd_freqs, hand_rolled_coeffs)\n\n10710 of 20000 string\nTop 1 matches: 0.936\nTop 1 matches (any order): 0.936\nTop 2 matches: 0.601\nTop 2 matches (any order): 0.652\nTop 3 matches: 0.367\nTop 3 matches (any order): 0.421\nTop 4 matches: 0.256\nTop 4 matches (any order): 0.318\nTop 5 matches: 0.148\nTop 5 matches (any order): 0.182\nTop 6 matches: 0.110\nTop 6 matches (any order): 0.136\nTop 7 matches: 0.082\nTop 7 matches (any order): 0.098\nTop 8 matches: 0.069\nTop 8 matches (any order): 0.087\nTop 9 matches: 0.061\nTop 9 matches (any order): 0.069\nTop 10 matches: 0.023\nTop 10 matches (any order): 0.022\n\n\n\ncustom_coeffs = torch.tensor([0.1, 0.1, 15, 10, 1000, 0.1]).unsqueeze(dim=1).unsqueeze(dim=2) # (n_layer, 1, 1)\nmatching_indices = filter_model_outputs(\n    model_outputs,\n    lambda model_output: sum([model_output[i][1] for i in range(2)]) &gt; 0.85,\n)\nprint(f\"{len(matching_indices)} of {len(model_outputs)} string\")\neval_on_subset(matching_indices, model_outputs, ffwd_freqs, custom_coeffs)\n\n10710 of 20000 string\nTop 1 matches: 0.939\nTop 1 matches (any order): 0.939\nTop 2 matches: 0.603\nTop 2 matches (any order): 0.652\nTop 3 matches: 0.366\nTop 3 matches (any order): 0.414\nTop 4 matches: 0.252\nTop 4 matches (any order): 0.315\nTop 5 matches: 0.145\nTop 5 matches (any order): 0.178\nTop 6 matches: 0.106\nTop 6 matches (any order): 0.133\nTop 7 matches: 0.077\nTop 7 matches (any order): 0.095\nTop 8 matches: 0.066\nTop 8 matches (any order): 0.085\nTop 9 matches: 0.061\nTop 9 matches (any order): 0.068\nTop 10 matches: 0.023\nTop 10 matches (any order): 0.022",
    "crumbs": [
      "analyses",
      "Widening the Space of Similar Values"
    ]
  },
  {
    "objectID": "analyses/widening_similar_space.html#look-at-some-specific-examples",
    "href": "analyses/widening_similar_space.html#look-at-some-specific-examples",
    "title": "Widening the Space of Similar Values",
    "section": "Look at some specific examples",
    "text": "Look at some specific examples\n\nthresholds = [0.95, 0.94, 0.85, 0.76, 0.81, 0.89]\nblock_idx = 3\nq_idx_start = 0\nq_idx_end = 10\nmatching_strings = []\nfor block_idx in range(n_layer):\n    matching_strings.append(\n        get_matching_strings(\n            filter_on_prefiltered_results(\n                load_prefiltered=lambda q_idx: torch.load(prefiltered_filename(q_idx, block_idx)),\n                q_idx_start=q_idx_start,\n                q_idx_end=q_idx_end,\n                filter_fn=lambda values: values &gt; thresholds[block_idx],\n            ),\n            strings10,\n        )\n    )\n\n\ndef print_results(q_idx: int, query_string: str, matching_strings):\n    print(f\"Query string: {repr(query_string)[1:-1]}\")\n    max_len = max(\n        [len(matching_strings[block_idx][q_idx]) for block_idx in range(n_layer)]\n    )\n    for i in range(max_len):\n        line_items = [\n            matching_strings[block_idx][q_idx][i]\n            if i &lt; len(matching_strings[block_idx][q_idx])\n            else '          '\n            for block_idx in range(n_layer)\n        ]\n        print(' | '.join([f'{repr(line_item)[1:-1]:&gt;15}' for line_item in line_items]))\n\n\nq_idx=2\nprint_results(q_idx=q_idx, query_string=strings20k[q_idx], matching_strings=matching_strings)\n\nQuery string: s eyes may\n     h, you may |      h, you may |      h, you may |      swords may |      swords may |      swords may\n     le: it may |      le: it may |      le: it may |       craft may |       craft may |       craft may\n     you, I may |      you, I may |      swords may |      office may |      office may |       if it may\n     swords may |      swords may |      at you may |      itness may |      ods he may |      itness may\n     at you may |      at you may |     ering,\\nMay |      rvices may |      itness may |      rvices may\n     hom we may |      hom we may |      hom we may |      r sort may |      rvices may |       souls may\n      craft may |       craft may |       craft may |       grant may |      pliant may |      hat it may\n    f it\\nI may |     f it\\nI may |      office may |      pliant may |     erhaps\\nMay |      but it may\n     office may |      office may |      e that may |       never may |       souls may |      ourses may\n     e that may |      e that may |      s: you may |      le joy may |       haply may |      boughs may\n     That I may |      That I may |      y, you may |       souls may |       grace may |      n pity may\n    en:\\nWe may |     en:\\nWe may |       if it may |       haply may |       alive may |       sense may\n     s: you may |      s: you may |      ods he may |      e lord may |      ourses may |      s eyes may\n     y, you may |      y, you may |      'd; we may |       grace may |      tongue may |      e case may\n      if it may |       if it may |      t thou may |      growth may |      tments may |       as it may\n     that I may |      that I may |      itness may |       sword may |      boughs may |      y oath may\n    you,\\nI may |     you,\\nI may |      rvices may |       alive may |      esence may |      heaven may\n    S:\\nYou may |     S:\\nYou may |       sort, may |      ourses may |      n pity may |      al man may\n     ods he may |      ods he may |      r sort may |      tongue may |      years\\nMay |      nd men may\n     'd; we may |      'd; we may |     l time\\nMay |      tments may |      rosper may |      reason may\n    :\\nWhat may |     :\\nWhat may |       grant may |      boughs may |     ,\\nPity may |      awares may\n    ple,\\nI may |     ple,\\nI may |      blame\\nMay |      aft'st may |      taking may |      bjects may\n     r: you may |      r: you may |     olsces\\nMay |      esence may |     \\nWomen may |      nd now may\n     t thou may |      t thou may |      other, may |     of men\\nMay |      liance may |      r foes may\n     itness may |      itness may |      ence?  may |      n pity may |       write may |       bones may\n     rvices may |      rvices may |     y,\\nYou may |     ,\\nPity may |      e jest may |       women may\n      sort, may |       sort, may |      honour may |      ounsel may |       lover may |      a time may\n     r sort may |      r sort may |     aspect\\nMay |     \\nWomen may |       sense may |      bility may\n    r:\\nYou may |     r:\\nYou may |     o\\nThou may |      liance may |      s eyes may |      ffairs may\n      grant may |       grant may |      pliant may |      e jest may |     es\\nAnd may |      inkers may\n     other, may |      other, may |       never may |       lover may |      en and may |      tleman may\n     ence?  may |      ence?  may |     S:\\nShe may |       sense may |     \\nFlies may |      y life may\n    y,\\nYou may |     y,\\nYou may |     R:\\nShe may |      s eyes may |      othing may |      at men may\n     honour may |      honour may |     o?\\nShe may |      en and may |      e case may |      nd, it may\n    o\\nThou may |     o\\nThou may |     t:\\nShe may |       Romeo may |       taker may |      th him may\n     pliant may |      pliant may |      t? She may |     \\nFlies may |      y oath may |      e time may\n     eby he may |      eby he may |      le joy may |      e case may |     \\nNe'er may |      ctions may\n      never may |       never may |     !\\nLong may |       taker may |      heaven may |      n time may\n    R:\\nYou may |     R:\\nYou may |      of you may |      ul war may |      nd men may |       woman may\n    S:\\nShe may |     S:\\nShe may |      hat we may |       as it may |      partly may |      ied as may\n    R:\\nShe may |     R:\\nShe may |     erhaps\\nMay |      y oath may |      branch may |      angers may\n    o?\\nShe may |     o?\\nShe may |       souls may |      o York may |      reason may |      tripes may\n    t:\\nShe may |     t:\\nShe may |      moon,\\nMay |     \\nNe'er may |     ems\\nAs may |                \n    .\\nWhat may |     .\\nWhat may |     n,\\nAnd may |      heaven may |      awares may |                \n     t? She may |      t? She may |     h.\\nAll may |      al man may |      bjects may |                \n     marry, may |      marry, may |      te you may |      o both may |      prayer may |                \n     le joy may |      le joy may |      d that may |      nd men may |      nd now may |                \n    !\\nLong may |     !\\nLong may |     \\nwhich may |      partly may |      master may |                \n     of you may |      of you may |      lords, may |      reason may |       crown may |                \n     hat we may |      hat we may |     :\\nLord may |      awares may |      r foes may |                \n      souls may |       souls may |       haply may |      bjects may |       bones may |                \n    n,\\nAnd may |     n,\\nAnd may |      d lord may |      prayer may |       women may |                \n    h.\\nAll may |     h.\\nAll may |      hat it may |      nd now may |      a time may |                \n     d, the may |      d, the may |      e lord may |      master may |      bility may |                \n     te you may |      te you may |      nd you may |       crown may |      chance may |                \n    .\\nIf I may |     .\\nIf I may |      heart\\nMay |      r foes may |       I now may |                \n    ER:\\nHe may |     ER:\\nHe may |      r ever may |       bones may |      ffairs may |                \n     heed I may |      heed I may |       grace may |       heart may |      inkers may |                \n    rds\\nWe may |     rds\\nWe may |      growth may |       women may |      eating may |                \n     d that may |      d that may |      So she may |      a time may |      iction may |                \n    \\nwhich may |     \\nwhich may |       which may |      bility may |       there may |                \n    y:\\nYou may |     y:\\nYou may |      but it may |      chance may |      tleman may |                \n     lords, may |      lords, may |      n thou may |       I now may |      y life may |                \n     gs the may |      gs the may |      t they may |      ffairs may |       haste may |                \n    :\\nLord may |     :\\nLord may |      ou, we may |      inkers may |      faults may |                \n      haply may |       haply may |      at she may |      iction may |      th him may |                \n     d lord may |      d lord may |       sword may |       there may |      e time may |                \n    m.\\nThe may |     m.\\nThe may |       alive may |      tleman may |      are he may |                \n     hat it may |      hat it may |       alas, may |      y life may |      r they may |                \n     'd the may |      'd the may |     ,\\nThey may |      ay she may |      ctions may |                \n     ot the may |      ot the may |      ent we may |      at men may |      n time may |                \n    M:\\nThe may |     M:\\nThe may |      God we may |      faults may |      enants may |                \n     e lord may |      e lord may |      d tale may |      th him may |       woman may |                \n     f, the may |      f, the may |      ourses may |      e time may |      ds she may |                \n     nd you may |      nd you may |      ll, we may |      ctions may |      ied as may |                \n    nce,\\nI may |     nce,\\nI may |      ng, it may |      ven so may |      angers may |                \n      no; I may |       no; I may |     RK:\\nIt may |      n time may |      tripes may |                \n     r ever may |      r ever may |      tongue may |     esence\\nMay |                 |                \n      grace may |       grace may |     ay:\\nSo may |      enants may |                 |                \n     growth may |      growth may |      tments may |       woman may |                 |                \n    r,\\nThe may |     r,\\nThe may |      l that may |      ds she may |                 |                \n      how I may |       how I may |     ' feet\\nMay |      and so may |                 |                \n     So she may |      So she may |      boughs may |      ied as may |                 |                \n      which may |       which may |      aft'st may |      angers may |                 |                \n     but it may |      but it may |      o not, may |      tripes may |                 |                \n     n thou may |      n thou may |     ies\\nAs may |                 |                 |                \n     , as I may |      , as I may |      esence may |                 |                 |                \n     side I may |      side I may |     of men\\nMay |                 |                 |                \n     t they may |      t they may |      n pity may |                 |                 |                \n     ou, we may |      ou, we may |      years\\nMay |                 |                 |                \n     at she may |      at she may |      rosper may |                 |                 |                \n      sword may |       sword may |     e.\\nIll may |                 |                 |                \n      alive may |       alive may |     ,\\nPity may |                 |                 |                \n      for I may |       for I may |      nails\\nMay |                 |                 |                \n      alas, may |       alas, may |      taking may |                 |                 |                \n    ,\\nThey may |     ,\\nThey may |      ounsel may |                 |                 |                \n     ent we may |      ent we may |      Ere we may |                 |                 |                \n     God we may |      God we may |     ng one\\nMay |                 |                 |                \n     d tale may |      d tale may |       trick may |                 |                 |                \n     ourses may |      ourses may |      e thou may |                 |                 |                \n    EN:\\nIt may |     EN:\\nIt may |     reath,\\nMay |                 |                 |                \n     ll, we may |      ll, we may |      e, and may |                 |                 |                \n     ng, it may |      ng, it may |     \\nWomen may |                 |                 |                \n    RK:\\nIt may |     RK:\\nIt may |      liance may |                 |                 |                \n     tongue may |      tongue may |       write may |                 |                 |                \n    ay:\\nSo may |     ay:\\nSo may |      e jest may |                 |                 |                \n     tments may |      tments may |     y,\\nTwo may |                 |                 |                \n     l that may |      l that may |       lover may |                 |                 |                \n     h you; may |      h you; may |       sense may |                 |                 |                \n     boughs may |      boughs may |      s eyes may |                 |                 |                \n     aft'st may |      aft'st may |     es\\nAnd may |                 |                 |                \n     o not, may |      o not, may |      en and may |                 |                 |                \n    ies\\nAs may |     ies\\nAs may |       Romeo may |                 |                 |                \n    \\nIf he may |     \\nIf he may |     \\nFlies may |                 |                 |                \n     esence may |      esence may |     te,\\nIt may |                 |                 |                \n    iew\\nHe may |     iew\\nHe may |     y\\nThat may |                 |                 |                \n    e:\\nYou may |     e:\\nYou may |     alone,\\nMay |                 |                 |                \n     n pity may |      n pity may |     :\\nThat may |                 |                 |                \n      me; I may |       me; I may |      othing may |                 |                 |                \n      a man may |       a man may |      th, we may |                 |                 |                \n     rosper may |      rosper may |      e case may |                 |                 |                \n    e.\\nIll may |     e.\\nIll may |       taker may |                 |                 |                \n    ,\\nPity may |     ,\\nPity may |       trunk may |                 |                 |                \n     taking may |      taking may |     ing it\\nMay |                 |                 |                \n     ounsel may |      ounsel may |      O, how may |                 |                 |                \n     here I may |      here I may |       if he may |                 |                 |                \n     Ere we may |      Ere we may |      ul war may |                 |                 |                \n    :\\nWhy, may |       trick may |       as it may |                 |                 |                \n      trick may |      oe, he may |      ay; we may |                 |                 |                \n     oe, he may |     ,\\nThou may |      venged may |                 |                 |                \n    ,\\nThou may |      e thou may |      y oath may |                 |                 |                \n     e thou may |      e, and may |      oenix, may |                 |                 |                \n     e, and may |     \\nWomen may |      o York may |                 |                 |                \n    \\nWomen may |      liance may |     beside\\nMay |                 |                 |                \n     liance may |       write may |     \\nNe'er may |                 |                 |                \n      write may |      e jest may |      usband may |                 |                 |                \n     e jest may |     y,\\nTwo may |      heaven may |                 |                 |                \n    y,\\nTwo may |      ough I may |     :\\nThis may |                 |                 |                \n     ough I may |       lover may |      al man may |                 |                 |                \n      lover may |       sense may |     fight,\\nMay |                 |                 |                \n      sense may |      s eyes may |     m now,\\nMay |                 |                 |                \n     s eyes may |     es\\nAnd may |      o both may |                 |                 |                \n    es\\nAnd may |      en and may |      rgaret may |                 |                 |                \n     en and may |       Romeo may |      nd men may |                 |                 |                \n      Romeo may |     \\nFlies may |      partly may |                 |                 |                \n    \\nFlies may |     te,\\nIt may |      branch may |                 |                 |                \n    te,\\nIt may |     y\\nThat may |      reason may |                 |                 |                \n    y\\nThat may |      hich I may |     ems\\nAs may |                 |                 |                \n     hich I may |     :\\nThat may |     ak,\\nAs may |                 |                 |                \n    :\\nThat may |      when I may |      awares may |                 |                 |                \n     when I may |     ET:\\nIt may |      as you may |                 |                 |                \n    ET:\\nIt may |      othing may |      arwick may |                 |                 |                \n     othing may |      ll, he may |      ile we may |                 |                 |                \n     ll, he may |      th, we may |      bjects may |                 |                 |                \n     th, we may |      e case may |      prayer may |                 |                 |                \n     e case may |     :\\nIf I may |     d land\\nMay |                 |                 |                \n    :\\nIf I may |       taker may |      nd now may |                 |                 |                \n      taker may |       trunk may |     s\\nWhat may |                 |                 |                \n      trunk may |      O, how may |      master may |                 |                 |                \n     O, how may |       if he may |       crown may |                 |                 |                \n      if he may |      ul war may |       as we may |                 |                 |                \n     ul war may |       as it may |      r foes may |                 |                 |                \n      as it may |      ay; we may |       bones may |                 |                 |                \n     ay; we may |      venged may |      : long may |                 |                 |                \n     venged may |      y oath may |       heart may |                 |                 |                \n     y oath may |      oenix, may |     ience,\\nmay |                 |                 |                \n     oenix, may |      o York may |      f what may |                 |                 |                \n     o York may |     \\nNe'er may |      ; that may |                 |                 |                \n    \\nNe'er may |      usband may |     t\\nThou may |                 |                 |                \n     usband may |      heaven may |      p, who may |                 |                 |                \n     heaven may |     :\\nThis may |      r that may |                 |                 |                \n    :\\nThis may |      al man may |      s, you may |                 |                 |                \n     al man may |      o both may |       There may |                 |                 |                \n     o both may |      rgaret may |      nd one may |                 |                 |                \n     rgaret may |      nd men may |       women may |                 |                 |                \n     nd men may |      partly may |     orlorn\\nMay |                 |                 |                \n     partly may |      branch may |      How he may |                 |                 |                \n     branch may |      reason may |      a time may |                 |                 |                \n     reason may |     ems\\nAs may |      bility may |                 |                 |                \n    ems\\nAs may |     ak,\\nAs may |      chance may |                 |                 |                \n    ak,\\nAs may |     iage\\nI may |     e dead\\nMay |                 |                 |                \n    iage\\nI may |     rd,\\nWe may |     \\nWhich may |                 |                 |                \n    rd,\\nWe may |      awares may |      d what may |                 |                 |                \n     awares may |      as you may |     !\\nWell may |                 |                 |                \n     as you may |      arwick may |      f thou may |                 |                 |                \n     arwick may |      ile we may |       I now may |                 |                 |                \n     ile we may |      bjects may |      ffairs may |                 |                 |                \n     bjects may |      prayer may |      inkers may |                 |                 |                \n     prayer may |      nd now may |      I well may |                 |                 |                \n     nd now may |     s\\nWhat may |      eating may |                 |                 |                \n    s\\nWhat may |      master may |      p that may |                 |                 |                \n     master may |       crown may |      is you may |                 |                 |                \n      crown may |       as we may |      If you may |                 |                 |                \n      as we may |      r foes may |     roject\\nMay |                 |                 |                \n     r foes may |       bones may |      re you may |                 |                 |                \n      bones may |      : long may |     millo,\\nMay |                 |                 |                \n     : long may |       heart may |      iction may |                 |                 |                \n      heart may |      f what may |      and we may |                 |                 |                \n    th!\\nO, may |      ; that may |     w\\nthat may |                 |                 |                \n     f what may |     NES:\\nI may |       there may |                 |                 |                \n     ; that may |     t\\nThou may |     issue,\\nMay |                 |                 |                \n    NES:\\nI may |     ord,\\nI may |     d:\\nYou may |                 |                 |                \n    t\\nThou may |      p, who may |      tleman may |                 |                 |                \n    ord,\\nI may |      r that may |      y life may |                 |                 |                \n     p, who may |      s, you may |      fancy\\nMay |                 |                 |                \n    LLO:\\nI may |       There may |      ere we may |                 |                 |                \n     r that may |      nd one may |       haste may |                 |                 |                \n     s, you may |       women may |      And we may |                 |                 |                \n      There may |     ler:\\nI may |      , this may |                 |                 |                \n     nd one may |      How he may |      love,\\nmay |                 |                 |                \n      women may |      a time may |      ay she may |                 |                 |                \n    ler:\\nI may |      bility may |     e;\\nWho may |                 |                 |                \n     How he may |      chance may |     m;\\nYou may |                 |                 |                \n     a time may |     \\nWhich may |      life,\\nMay |                 |                 |                \n     bility may |      d what may |      asure; may |                 |                 |                \n     chance may |     !\\nWell may |      at men may |                 |                 |                \n    \\nWhich may |      f thou may |      odesty may |                 |                 |                \n     d what may |       I now may |     O:\\nYet may |                 |                 |                \n    !\\nWell may |      ffairs may |      nd, it may |                 |                 |                \n     f thou may |      inkers may |      faults may |                 |                 |                \n      I now may |      I well may |      r, you may |                 |                 |                \n     ffairs may |      eating may |      th him may |                 |                 |                \n     inkers may |     ,\\nIf I may |      e time may |                 |                 |                \n     I well may |      p that may |      er, it may |                 |                 |                \n     eating may |      is you may |     hat\\nit may |                 |                 |                \n     d you; may |      If you may |      are he may |                 |                 |                \n    ,\\nIf I may |      re you may |      uance, may |                 |                 |                \n     p that may |      iction may |      r they may |                 |                 |                \n     is you may |      and we may |     e!\\nHow may |                 |                 |                \n     If you may |      who, I may |      k, how may |                 |                 |                \n     re you may |      , if I may |      ctions may |                 |                 |                \n     iction may |     w\\nthat may |      ven so may |                 |                 |                \n     and we may |       there may |      n time may |                 |                 |                \n     who, I may |     rd:\\nWe may |      d, she may |                 |                 |                \n     , if I may |     d:\\nYou may |      And he may |                 |                 |                \n    w\\nthat may |      tleman may |      ad: so may |                 |                 |                \n      there may |      y life may |      t, you may |                 |                 |                \n    rd:\\nWe may |      ere we may |     e wife\\nMay |                 |                 |                \n    d:\\nYou may |       haste may |     esence\\nMay |                 |                 |                \n     tleman may |      And we may |      ! thou may |                 |                 |                \n     y life may |      , this may |      a, you may |                 |                 |                \n     ere we may |      ay she may |      but we may |                 |                 |                \n      haste may |     e;\\nWho may |      vato,' may |                 |                 |                \n     And we may |     \\nHow I may |     m:\\nshe may |                 |                 |                \n     , this may |     m;\\nYou may |     s,\\nShe may |                 |                 |                \n     ay she may |      may, I may |      e more may |                 |                 |                \n    e;\\nWho may |     t.\\nYou may |       ye we may |                 |                 |                \n    \\nHow I may |      asure; may |      enants may |                 |                 |                \n    m;\\nYou may |      at men may |     :\\nWell may |                 |                 |                \n     may, I may |      odesty may |     r\\nIron may |                 |                 |                \n    t.\\nYou may |     O:\\nYet may |     NA:\\nSo may |                 |                 |                \n     asure; may |      nd, it may |      o? how may |                 |                 |                \n     at men may |      er, he may |     y;\\nYou may |                 |                 |                \n     odesty may |      faults may |       woman may |                 |                 |                \n    O:\\nYet may |      r, you may |      , thou may |                 |                 |                \n     nd, it may |      th him may |     A:\\nAnd may |                 |                 |                \n     er, he may |      e time may |      ell we may |                 |                 |                \n     faults may |      er, it may |      ptista may |                 |                 |                \n     r, you may |      are he may |      ds she may |                 |                 |                \n     th him may |      uance, may |      and so may |                 |                 |                \n     e time may |      r they may |      at hap may |                 |                 |                \n     er, it may |      , what may |      ied as may |                 |                 |                \n    hat\\nit may |     e!\\nHow may |      angers may |                 |                 |                \n     are he may |      k, how may |      ready; may |                 |                 |                \n     uance, may |      elo? I may |      tripes may |                 |                 |                \n     r they may |      ctions may |      so you may |                 |                 |                \n     , what may |      rning, may |                 |                 |                 |                \n    e!\\nHow may |      ven so may |                 |                 |                 |                \n     ittle: may |      n time may |                 |                 |                 |                \n     k, how may |      d, she may |                 |                 |                 |                \n     elo? I may |      And he may |                 |                 |                 |                \n     ctions may |      ad: so may |                 |                 |                 |                \n     rning, may |      t, you may |                 |                 |                 |                \n     ven so may |      ! thou may |                 |                 |                 |                \n    IO:\\nIt may |      a, you may |                 |                 |                 |                \n     n time may |      rust I may |                 |                 |                 |                \n     d, she may |      o too, may |                 |                 |                 |                \n     And he may |     O:\\nYou may |                 |                 |                 |                \n     ad: so may |      but we may |                 |                 |                 |                \n     t, you may |      vato,' may |                 |                 |                 |                \n     ! thou may |      best I may |                 |                 |                 |                \n     a, you may |     m:\\nshe may |                 |                 |                 |                \n     rust I may |      t so I may |                 |                 |                 |                \n     o too, may |      . If I may |                 |                 |                 |                \n    O:\\nYou may |     s,\\nShe may |                 |                 |                 |                \n     but we may |      e more may |                 |                 |                 |                \n     It is: may |       ye we may |                 |                 |                 |                \n     vato,' may |      ? what may |                 |                 |                 |                \n     best I may |     age,\\nI may |                 |                 |                 |                \n    m:\\nshe may |      enants may |                 |                 |                 |                \n     t so I may |     :\\nWell may |                 |                 |                 |                \n     . If I may |     r\\nIron may |                 |                 |                 |                \n    s,\\nShe may |     NA:\\nSo may |                 |                 |                 |                \n     e more may |     O:\\nAnd may |                 |                 |                 |                \n      ye we may |      time I may |                 |                 |                 |                \n     ? what may |      o? how may |                 |                 |                 |                \n    age,\\nI may |     y;\\nYou may |                 |                 |                 |                \n     enants may |       woman may |                 |                 |                 |                \n    :\\nWell may |      , thou may |                 |                 |                 |                \n    r\\nIron may |     A:\\nAnd may |                 |                 |                 |                \n    NA:\\nSo may |      ell we may |                 |                 |                 |                \n    O:\\nAnd may |      ptista may |                 |                 |                 |                \n     time I may |      ds she may |                 |                 |                 |                \n     o? how may |      and so may |                 |                 |                 |                \n    y;\\nYou may |      at hap may |                 |                 |                 |                \n      woman may |      ied as may |                 |                 |                 |                \n     , thou may |      Hope I may |                 |                 |                 |                \n    A:\\nAnd may |      angers may |                 |                 |                 |                \n     ell we may |      ready; may |                 |                 |                 |                \n     ptista may |      tripes may |                 |                 |                 |                \n     ds she may |      ir, he may |                 |                 |                 |                \n     and so may |      so you may |                 |                 |                 |                \n    TIO:\\nI may |                 |                 |                 |                 |                \n     at hap may |                 |                 |                 |                 |                \n     ied as may |                 |                 |                 |                 |                \n     Hope I may |                 |                 |                 |                 |                \n     angers may |                 |                 |                 |                 |                \n     ready; may |                 |                 |                 |                 |                \n     tripes may |                 |                 |                 |                 |                \n     ir, he may |                 |                 |                 |                 |                \n     so you may |                 |                 |                 |                 |                \n\n\n\nq_idx=9\nprint_results(q_idx=q_idx, query_string=strings20k[q_idx], matching_strings=matching_strings)\n\nQuery string: e,\\nplease \n    to\\nplease  |     to\\nplease  |     to\\nplease  |     to\\nplease  |     to\\nplease  |     to\\nplease \n      increase  |       increase  |     t\\ndisease  |       increase  |      ather see  |     e,\\nplease \n    t\\ndisease  |     t\\ndisease  |     e,\\nplease  |     t\\ndisease  |     t\\ndisease  |      't please \n     hese base  |      why cease  |      e: please  |      r, praise  |     e,\\nplease  |      ou please \n     why cease  |      d. Please  |      't please  |      d. Please  |      ll praise  |      ld please \n     d. Please  |     e,\\nplease  |      ou please  |      es praise  |      e: please  |      t appease \n    e,\\nplease  |      t. Please  |      ld please  |      do repose  |      o despise  |      as please \n     t. Please  |     d\\nTo ease  |      t appease  |      t purpose  |      e disease  |      ip please \n    d\\nTo ease  |      e: please  |      as please  |     e,\\nplease  |      let's see  |      ht please \n     e: please  |      e disease  |      ip please  |      at passes  |      I purpose  |      it please \n     e disease  |      a disease  |      ht please  |      t. Please  |      e, advise  |      to please \n     a disease  |       surcease  |      it please  |      ll praise  |      't please  |      so please \n     with base  |      f. Please  |      to please  |     d\\nTo ease  |      to excuse  |      st please \n      surcease  |      't please  |     n:\\nPlease  |      e: please  |      No excuse  |      od please \n     ch a case  |      ou please  |      so please  |      To oppose  |      ou please  |     r,\\nPlease \n     heir base  |      ld please  |      To please  |      e disease  |      ld please  |      ho please \n     f. Please  |      t appease  |      st please  |       surcease  |       duty see  |      at please \n     't please  |       purchase  |     \\nTo cease  |      f. Please  |     ;\\nAnd see  |      ll please \n     ou please  |      as please  |      So please  |      't please  |      ; and see  |      ay please \n     ld please  |      ip please  |     t:\\nPlease  |     \\nProvokes  |      t appease  |      er please \n     et debase  |      ht please  |      od please  |      to excuse  |      as please  |      ch please \n     t appease  |      it please  |      s: please  |      ou please  |     \\nPersuade  |     ,\\nRelease \n      purchase  |       to chase  |     r,\\nPlease  |      ld please  |      ip please  |     f,\\nPlease \n     as please  |      they ease  |      n: please  |      t appease  |      ht please  |      ss please \n     ip please  |      to please  |      ho please  |       purchase  |      it please  |                \n     ht please  |     n:\\nPlease  |      at please  |      as please  |       to chase  |                \n    s\\nTo base  |      so please  |      ll please  |      ll repose  |     d,\\nEnsues  |                \n     it please  |       and ease  |     \\nPurchase  |      t promise  |      , and see  |                \n      to chase  |      To please  |      ay please  |      ip please  |      to please  |                \n     they ease  |      and chase  |     e.\\nPlease  |      ht please  |     n:\\nPlease  |                \n     to please  |      st please  |      t? please  |      to depose  |      l espouse  |                \n    n:\\nPlease  |      h release  |      er please  |      it please  |      so please  |                \n    im;\\nAbase  |      oth cease  |     A:\\nPlease  |       to chase  |      et me see  |                \n     so please  |     \\nTo cease  |      ch please  |      d promise  |     :\\nSuppose  |                \n     d so base  |      t at ease  |     ,\\nRelease  |      to please  |     ,\\nYet see  |                \n      and ease  |      So please  |      displease  |     n:\\nPlease  |      To please  |                \n     r in base  |       nor ease  |     f,\\nPlease  |      ay praise  |      and chase  |                \n     To please  |     t:\\nPlease  |       I please  |      so please  |      ne'er see  |                \n     and chase  |      od please  |      ss please  |      d purpose  |       disperse  |                \n      the base  |      ver cease  |     N:\\nPlease  |      To please  |      d eye see  |                \n     do debase  |      s: please  |                 |     l\\nDispose  |      st please  |                \n     ou debase  |     r,\\nPlease  |                 |      and chase  |      y can see  |                \n     st please  |      n: please  |                 |      st please  |      , who see  |                \n     this base  |      ho please  |                 |      you raise  |      never see  |                \n     h release  |      at please  |                 |      h release  |      hat sense  |                \n     lory base  |      ll please  |                 |      oth cease  |      , enemies  |                \n     me a case  |     \\nPurchase  |                 |      et repose  |     ,\\nAnd see  |                \n     oth cease  |      ay please  |                 |     \\nTo cease  |      t presses  |                \n    \\nTo cease  |      h. Please  |                 |      t at ease  |      nd expire  |                \n     t at ease  |      uld chase  |                 |       paradise  |      et repose  |                \n      the case  |     e.\\nPlease  |                 |      dispraise  |     \\nTo cease  |                \n     So please  |      it Please  |                 |      So please  |      lief\\nsee  |                \n      nor ease  |      t? please  |                 |      l dispose  |      ot excuse  |                \n    t:\\nPlease  |      er please  |                 |       nor ease  |      efore use  |                \n      and case  |     A:\\nPlease  |                 |      And raise  |      s can see  |                \n     od please  |      ch please  |                 |      , promise  |      That sees  |                \n     ver cease  |      with ease  |                 |     t:\\nPlease  |      So please  |                \n    ,\\nIf case  |      he phrase  |                 |       surprise  |     rning\\nSee  |                \n     What case  |     ,\\nRelease  |                 |      od please  |       nor ease  |                \n     s: please  |      ven cease  |                 |      ot praise  |      ce serves  |                \n    r,\\nPlease  |      displease  |                 |     fe to\\nsee  |      et, arise  |                \n     n: please  |     f,\\nPlease  |                 |      s: please  |       nor sees  |                \n     ho please  |       I please  |                 |     :'\\nPraise  |      r and see  |                \n     at please  |      ss please  |                 |     r,\\nPlease  |     t:\\nPlease  |                \n     ll please  |      ere cease  |                 |      As passes  |      could see  |                \n    \\nPurchase  |     N:\\nPlease  |                 |      n: please  |     t\\nAnd see  |                \n     ay please  |                 |                 |      on praise  |       and case  |                \n     e discase  |                 |                 |      ho please  |      od please  |                \n     h my case  |                 |                 |      at please  |     !\\nSuppose  |                \n     h. Please  |                 |                 |      ll please  |      e, excuse  |                \n     uld chase  |                 |                 |     \\nPurchase  |     n\\nAnd see  |                \n    e.\\nPlease  |                 |                 |      ay please  |      ot praise  |                \n     it Please  |                 |                 |      To choose  |      er excuse  |                \n     t? please  |                 |                 |      h. Please  |       once see  |                \n     er please  |                 |                 |      uld chase  |      aven sees  |                \n    A:\\nPlease  |                 |                 |     e.\\nPlease  |      arth sees  |                \n    e\\nIn base  |                 |                 |      it Please  |      s: please  |                \n     ch please  |                 |                 |      t? please  |     r,\\nPlease  |                \n     with ease  |                 |                 |      t precise  |      l and see  |                \n     he phrase  |                 |                 |      er please  |      n: please  |                \n    ,\\nRelease  |                 |                 |      hall pose  |     e\\nAnd see  |                \n     ven cease  |                 |                 |     A:\\nPlease  |      ho please  |                \n     displease  |                 |                 |      ch please  |      ir, spare  |                \n    ce\\nUncase  |                 |                 |     ,\\nRelease  |      d but see  |                \n     wful case  |                 |                 |      ll depose  |      at please  |                \n    f,\\nPlease  |                 |                 |      to repose  |      t becomes  |                \n     this case  |                 |                 |      displease  |      first see  |                \n      I please  |                 |                 |      and raise  |      ll please  |                \n    \\nThe base  |                 |                 |     f,\\nPlease  |      ay please  |                \n     ss please  |                 |                 |       I please  |      n; kisses  |                \n      our case  |                 |                 |      ss please  |      e discase  |                \n     e! Please  |                 |                 |      e! Please  |      uld chase  |                \n     ere cease  |                 |                 |     N:\\nPlease  |      to expose  |                \n    N:\\nPlease  |                 |                 |                 |      ll desire  |                \n                |                 |                 |                 |      t? please  |                \n                |                 |                 |                 |      onour see  |                \n                |                 |                 |                 |      est sense  |                \n                |                 |                 |                 |      im, spare  |                \n                |                 |                 |                 |      er please  |                \n                |                 |                 |                 |     A:\\nPlease  |                \n                |                 |                 |                 |      do excuse  |                \n                |                 |                 |                 |      I suppose  |                \n                |                 |                 |                 |     \\nDo curse  |                \n                |                 |                 |                 |      ch please  |                \n                |                 |                 |                 |      , resides  |                \n                |                 |                 |                 |      me excuse  |                \n                |                 |                 |                 |     ,\\nRelease  |                \n                |                 |                 |                 |      ety raise  |                \n                |                 |                 |                 |      To accuse  |                \n                |                 |                 |                 |      , resists  |                \n                |                 |                 |                 |      r, advise  |                \n                |                 |                 |                 |      ven cease  |                \n                |                 |                 |                 |      e and use  |                \n                |                 |                 |                 |      displease  |                \n                |                 |                 |                 |     ce\\nUncase  |                \n                |                 |                 |                 |       ever see  |                \n                |                 |                 |                 |     f,\\nPlease  |                \n                |                 |                 |                 |       I please  |                \n                |                 |                 |                 |       and sees  |                \n                |                 |                 |                 |      ss please  |                \n                |                 |                 |                 |      sir:\\nsee  |                \n                |                 |                 |                 |      e and see  |                \n                |                 |                 |                 |       no sense  |                \n                |                 |                 |                 |      ere cease  |                \n                |                 |                 |                 |      nd serves  |                \n                |                 |                 |                 |     ,\\nAnd use  |                \n\n\n\nq_idx=6\nprint_results(q_idx=q_idx, query_string=strings20k[q_idx], matching_strings=matching_strings)\n\nQuery string: LLA:\\nAnd h\n      see and h |     lead\\nAnd h |      nce, and h |      nce, and h |     hem!\\nAnd h |      nce, and h\n     Rome and h |     sce,\\nAnd h |     hem!\\nAnd h |      rds, and h |      hee; and h |     LIA:\\nBut h\n    lead\\nAnd h |     hem!\\nAnd h |      hee; and h |     sce,\\nAnd h |      try: and h |      rds, and h\n     ears and h |     ide,\\nAnd h |      try: and h |     hem!\\nAnd h |     you;\\nAnd h |     hem!\\nAnd h\n     nce, and h |     you;\\nAnd h |      yes, and h |      hee; and h |     man:\\nAnd h |      hee; and h\n     rds, and h |     ars,\\nAnd h |      aty, and h |      try: and h |      ome; and h |     Soldier:\\nH\n     mile and h |     man:\\nAnd h |     you;\\nAnd h |      yes, and h |       me: and h |      nner is, h\n    sce,\\nAnd h |      lip\\nAnd h |     man:\\nAnd h |      aty, and h |      lie: and h |      try: and h\n     luto and h |     snow\\nAnd h |      ies; and h |     ide,\\nAnd h |      ood; and h |      aty, and h\n    hem!\\nAnd h |     bune\\nAnd h |      ome; and h |     you;\\nAnd h |     rer:\\nAnd h |      advised, h\n     hee; and h |     hem,\\nAnd h |      her, and h |     man:\\nAnd h |      nce? and h |      ture is, h\n     dius and h |     ost,\\nAnd h |     snow\\nAnd h |      ies; and h |      ife; and h |     you;\\nAnd h\n     e I find h |     lain\\nAnd h |      try, and h |      ome; and h |     ucy,\\nAnd h |      se wars, h\n     ight and h |     his,\\nAnd h |      aly, and h |      her, and h |     ing.\\nAnd h |      sook me, h\n     arfs and h |     oly,\\nAnd h |       me: and h |      try, and h |     r'd;\\nAnd h |     gman:\\nAn h\n     try: and h |     oke,\\nAnd h |      ell, and h |      aly, and h |     ent;\\nAnd h |      e'll go, h\n     yes, and h |     ate,\\nAnd h |     hem,\\nAnd h |       me: and h |      ken; and h |     man:\\nAnd h\n     aty, and h |      ood; and h |      lie: and h |      ell, and h |     all;\\nAnd h |      term it, h\n      joy and h |     rer:\\nAnd h |      oth, and h |     hem,\\nAnd h |     ves.\\nAnd h |      ies; and h\n      I stand h |     ept,\\nAnd h |     lain\\nAnd h |     ost,\\nAnd h |      ght; and h |      in gold, h\n     seen and h |     her,\\nAnd h |      ous, and h |      lie: and h |      h'd: and h |      ome; and h\n    ide,\\nAnd h |     ucy,\\nAnd h |     his,\\nAnd h |      oth, and h |      ome: and h |      her, and h\n     vine and h |     res,\\nAnd h |     oly,\\nAnd h |      ous, and h |     y,--\\nAnd h |     e,\\nAlas, h\n     You find h |     ing.\\nAnd h |      ath, and h |     his,\\nAnd h |     der;\\nAnd h |      try, and h\n     m do and h |     ere,\\nAnd h |      ood; and h |     oly,\\nAnd h |     ath:\\nAnd h |      aly, and h\n     okes and h |     r'd;\\nAnd h |      out, and h |     oke,\\nAnd h |      rmy; and h |       me: and h\n     ople and h |     ent;\\nAnd h |      you, and h |      ath, and h |     RET:\\nAnd h |      ell, and h\n    you;\\nAnd h |     tent\\nAnd h |     rer:\\nAnd h |     ate,\\nAnd h |     ong;\\nAnd h |     em;\\nand, h\n      husband h |     well\\nAnd h |       me, and h |      ood; and h |     oop;\\nAnd h |      d for't, h\n    ars,\\nAnd h |     ess;\\nAnd h |      his, and h |      out, and h |     and;\\nAnd h |      as lies, h\n     nger and h |     ays,\\nAnd h |     ept,\\nAnd h |      you, and h |     oon,\\nAnd h |      lie: and h\n     son\\nand h |     nom,\\nAnd h |     her,\\nAnd h |     rer:\\nAnd h |      it;\\nAnd h |      oth, and h\n    man:\\nAnd h |     rth,\\nAnd h |      nce? and h |       me, and h |     TER:\\nAnd h |      d, hold, h\n     ther and h |     ath,\\nAnd h |      ome, and h |      his, and h |     pen;\\nAnd h |      ous, and h\n     ies; and h |     all;\\nAnd h |      ife; and h |     ept,\\nAnd h |     rcy?\\nAnd h |     his,\\nAnd h\n     mies and h |     awd;\\nAnd h |     ucy,\\nAnd h |     her,\\nAnd h |     SET:\\nAnd h |     oly,\\nAnd h\n     lip\\nAnd h |     lous\\nAnd h |     res,\\nAnd h |      nce? and h |      ust! and h |     oke,\\nAnd h\n     ome; and h |     ves.\\nAnd h |     ing.\\nAnd h |      ome, and h |     ZEL:\\nAnd h |      ath, and h\n     her, and h |     ove,\\nAnd h |      ury, and h |      ife; and h |      rth. And h |      anchors, h\n     lord and h |     man,\\nAnd h |     ere,\\nAnd h |     ucy,\\nAnd h |     \\nAy, and h |      ood; and h\n    snow\\nAnd h |      h'd: and h |     ent;\\nAnd h |     res,\\nAnd h |     nna,\\nAnd h |      out, and h\n     try, and h |     rave\\nAnd h |      rey, and h |     ing.\\nAnd h |     LLA:\\nAnd h |     rer:\\nAnd h\n     eels and h |     ift,\\nAnd h |     tent\\nAnd h |      ury, and h |      nes; and h |       me, and h\n     ioli and h |     ent,\\nAnd h |      own, and h |     ere,\\nAnd h |      low; and h |      his, and h\n     aly, and h |     per,\\nAnd h |      him, and h |     r'd;\\nAnd h |      ice; and h |     her,\\nAnd h\n      me: and h |     one,\\nAnd h |     well\\nAnd h |     ent;\\nAnd h |     ELO:\\nAnd h |      ard? and h\n     ell, and h |     y,--\\nAnd h |      ken; and h |      own, and h |      ake; and h |      nce? and h\n    bune\\nAnd h |     ied;\\nAnd h |      ife, and h |      him, and h |      nse: and h |      ome, and h\n    hem,\\nAnd h |     der;\\nAnd h |      man, and h |     well\\nAnd h |      rue: and h |       to age, h\n    ost,\\nAnd h |     ath:\\nAnd h |      ied, and h |      ken; and h |     TIO:\\nAnd h |      ife; and h\n     ords and h |     aves\\nAnd h |     nom,\\nAnd h |      ife, and h |     oon:\\nAnd h |     e,\\nThat, h\n     lie: and h |     ong;\\nAnd h |      ble, and h |     ess;\\nAnd h |     her;\\nAnd h |     ucy,\\nAnd h\n     oth, and h |     nity\\nAnd h |      les, and h |      man, and h |     aca,\\nAnd h |     hell\\nGo, h\n     oble and h |     ess?\\nAnd h |      hen, and h |     ays,\\nAnd h |      sir; and h |     ing.\\nAnd h\n    lain\\nAnd h |     ords\\nAnd h |      eir, and h |     nom,\\nAnd h |     n,--\\nAnd h |      gham and h\n     idow and h |     oop;\\nAnd h |      ity, and h |      ble, and h |     bed;\\nAnd h |      ury, and h\n     ous, and h |     nce,\\nAnd h |     all;\\nAnd h |      les, and h |     NIO:\\nAnd h |      h gapes, h\n    his,\\nAnd h |     and;\\nAnd h |      ate, and h |      hen, and h |      ell; and h |     ere,\\nAnd h\n    oly,\\nAnd h |     oon,\\nAnd h |      ove, and h |     rth,\\nAnd h |     ill;\\nAnd h |      en; but, h\n     band and h |     ife,\\nAnd h |     lous\\nAnd h |      eir, and h |     dua,\\nAnd h |     r'd;\\nAnd h\n    oke,\\nAnd h |      it;\\nAnd h |     ves.\\nAnd h |     ath,\\nAnd h |     own;\\nAnd h |     ent;\\nAnd h\n     oung and h |     TER:\\nAnd h |      hou? and h |      ity, and h |     ife;\\nAnd h |      rey, and h\n     at stand h |     pen;\\nAnd h |      ips, and h |     all;\\nAnd h |      ved; and h |      own, and h\n     ath, and h |     rcy?\\nAnd h |      son, and h |      ate, and h |      ing: and h |      him, and h\n    ate,\\nAnd h |     SET:\\nAnd h |     ove,\\nAnd h |      ove, and h |      not; and h |     well\\nAnd h\n     ueen and h |     lem,\\nAnd h |      one, and h |     awd;\\nAnd h |                 |      ken; and h\n     ood; and h |     ains\\nAnd h |      she? and h |     ves.\\nAnd h |                 |      love and h\n     out, and h |     ence\\nAnd h |      rth, and h |      mes, and h |                 |      ife, and h\n     you, and h |     ZEL:\\nAnd h |      ght; and h |      hou? and h |                 |      s goods, h\n     rkly and h |      rth. And h |     man,\\nAnd h |     und,\\nAnd h |                 |      e haste, h\n    rer:\\nAnd h |     oved\\nAnd h |      h'd: and h |      ips, and h |                 |     vant:\\nAn h\n      me, and h |     nna,\\nAnd h |     rave\\nAnd h |      son, and h |                 |     ess;\\nAnd h\n     his, and h |     LLA:\\nAnd h |      ome: and h |     ove,\\nAnd h |                 |     tor.\\nBut h\n    ept,\\nAnd h |     ild;\\nAnd h |      led, and h |      one, and h |                 |      man, and h\n    her,\\nAnd h |     ELO:\\nAnd h |     per,\\nAnd h |      she? and h |                 |      y hands, h\n     ard? and h |     TIO:\\nAnd h |     one,\\nAnd h |      rth, and h |                 |     nom,\\nAnd h\n     nce? and h |     oon:\\nAnd h |     y,--\\nAnd h |      ght; and h |                 |      ill not, h\n     nces and h |     ion,\\nAnd h |     ied;\\nAnd h |     man,\\nAnd h |                 |      thin and h\n     ome, and h |     hid,\\nAnd h |      ive, and h |      h'd: and h |                 |      ble, and h\n     alth and h |     ides\\nAnd h |      iet, and h |     rave\\nAnd h |                 |      les, and h\n     ost find h |     ear,\\nAnd h |     der;\\nAnd h |     ift,\\nAnd h |                 |      hen, and h\n      you and h |     mber\\nAnd h |     ath:\\nAnd h |      ome: and h |                 |      eir, and h\n     ife; and h |     and,\\nAnd h |      rmy; and h |     ent,\\nAnd h |                 |      ity, and h\n     ster and h |     aid,\\nAnd h |      ret, and h |     per,\\nAnd h |                 |     all;\\nAnd h\n    ucy,\\nAnd h |     her;\\nAnd h |     aves\\nAnd h |     one,\\nAnd h |                 |      ate, and h\n    res,\\nAnd h |     aca,\\nAnd h |      tay, and h |     y,--\\nAnd h |                 |      ove, and h\n     then and h |     eld,\\nAnd h |     ong;\\nAnd h |     ied;\\nAnd h |                 |     him.\\nBut h\n     itch and h |     ooks\\nAnd h |     nity\\nAnd h |      ive, and h |                 |      tate and h\n    ing.\\nAnd h |     n,--\\nAnd h |     oop;\\nAnd h |      iet, and h |                 |     awd;\\nAnd h\n     gham and h |     day,\\nAnd h |     and;\\nAnd h |     der;\\nAnd h |                 |      uoth he: h\n     ury, and h |     ing;\\nAnd h |     oon,\\nAnd h |     ath:\\nAnd h |                 |     ves.\\nAnd h\n    ings\\nAnd h |     bed;\\nAnd h |     ife,\\nAnd h |      rmy; and h |                 |      hou? and h\n    ere,\\nAnd h |     NIO:\\nAnd h |      nry, and h |      ret, and h |                 |     urse:\\nAn h\n     nity and h |     ill;\\nAnd h |      it;\\nAnd h |      tay, and h |                 |      aylight, h\n     hers and h |     dua,\\nAnd h |     TER:\\nAnd h |     RET:\\nAnd h |                 |      ips, and h\n     nour and h |     own;\\nAnd h |     pen;\\nAnd h |     ong;\\nAnd h |                 |       son and h\n    r'd;\\nAnd h |     ife;\\nAnd h |      tre, and h |     ess?\\nAnd h |                 |      in love, h\n    ent;\\nAnd h |     hape\\nAnd h |     rcy?\\nAnd h |      ing, and h |                 |      high and h\n     rey, and h |     ilan\\nAnd h |     SET:\\nAnd h |     oop;\\nAnd h |                 |      son, and h\n    tent\\nAnd h |      not; and h |      l'd, and h |     nce,\\nAnd h |                 |     ars;\\nLo, h\n     foot and h |     gain\\nAnd h |     lem,\\nAnd h |     and;\\nAnd h |                 |      tale and h\n     thousand h |                 |       so, and h |     oon,\\nAnd h |                 |      one, and h\n    \\nEngland h |                 |     ains\\nAnd h |     ife,\\nAnd h |                 |      t taken: h\n     own, and h |                 |      n't, and h |      nry, and h |                 |      mad man, h\n     eign and h |                 |      ust! and h |     ass,\\nAnd h |                 |      she? and h\n     king and h |                 |      hem; and h |      it;\\nAnd h |                 |      rth, and h\n     him, and h |                 |      hem, and h |     TER:\\nAnd h |                 |      ght; and h\n     orts and h |                 |      der, and h |     pen;\\nAnd h |                 |     wo;\\nFor, h\n    well\\nAnd h |                 |     ZEL:\\nAnd h |      tre, and h |                 |     ter too,\\nH\n     ken; and h |                 |      ses; and h |     rcy?\\nAnd h |                 |      h'd: and h\n     love and h |                 |      yea, and h |     SET:\\nAnd h |                 |      em told, h\n     ife, and h |                 |      ugh, and h |      ard, and h |                 |      ome: and h\n     r's hand h |                 |      rth. And h |      l'd, and h |                 |     oly man.\\nH\n     ters and h |                 |      ick, and h |     lem,\\nAnd h |                 |      nd amen, h\n     oney and h |                 |     \\nAy, and h |       so, and h |                 |     's cold:\\nH\n    ess;\\nAnd h |                 |     oved\\nAnd h |      n't, and h |                 |      led, and h\n     man, and h |                 |     nna,\\nAnd h |      ust! and h |                 |     y,--\\nAnd h\n     ied, and h |                 |     LLA:\\nAnd h |      hem; and h |                 |     rt poor:\\nH\n     ve found h |                 |      nes; and h |      hem, and h |                 |      end it,--h\n    ays,\\nAnd h |                 |      low; and h |      der, and h |                 |     ied;\\nAnd h\n     ower and h |                 |      ice; and h |     ZEL:\\nAnd h |                 |      ive, and h\n    nom,\\nAnd h |                 |     ild;\\nAnd h |      ses; and h |                 |      m I mad, h\n     teel and h |                 |     ELO:\\nAnd h |      yea, and h |                 |      doth so, h\n     thin and h |                 |      ake; and h |      ugh, and h |                 |     der;\\nAnd h\n     ble, and h |                 |      nse: and h |      rth. And h |                 |     ase.\\nBut h\n     dull and h |                 |      rue: and h |      ick, and h |                 |     ath:\\nAnd h\n     orth and h |                 |      nes, and h |     \\nAy, and h |                 |      rmy; and h\n     les, and h |                 |      ong, and h |      ead, and h |                 |      tay, and h\n     er'd and h |                 |       do, and h |     nna,\\nAnd h |                 |     RET:\\nAnd h\n     bear and h |                 |     TIO:\\nAnd h |     LLA:\\nAnd h |                 |     ong;\\nAnd h\n     hen, and h |                 |      ted, and h |      nes; and h |                 |     ess?\\nAnd h\n    rth,\\nAnd h |                 |     oon:\\nAnd h |      low; and h |                 |     oop;\\nAnd h\n     eir, and h |                 |      ent, and h |      ice; and h |                 |     and;\\nAnd h\n    :\\nAscend h |                 |      hal, and h |     ild;\\nAnd h |                 |     \\nAnd so, h\n    ath,\\nAnd h |                 |     ion,\\nAnd h |     ELO:\\nAnd h |                 |     ord too,\\nH\n     And send h |                 |      sir, and h |      ake; and h |                 |      atagems, h\n     ity, and h |                 |     aid,\\nAnd h |      nse: and h |                 |     ife,\\nAnd h\n    all;\\nAnd h |                 |      ord? and h |      rue: and h |                 |     er;\\nAnd, h\n     ate, and h |                 |     her;\\nAnd h |      ong, and h |                 |      nry, and h\n     ove, and h |                 |     aca,\\nAnd h |       do, and h |                 |      it;\\nAnd h\n     tate and h |                 |      sir; and h |     TIO:\\nAnd h |                 |     TER:\\nAnd h\n    awd;\\nAnd h |                 |      woo, and h |     oon:\\nAnd h |                 |     pen;\\nAnd h\n    lous\\nAnd h |                 |      ize; and h |      hal, and h |                 |      tre, and h\n    ves.\\nAnd h |                 |      uds, and h |     ion,\\nAnd h |                 |     rcy?\\nAnd h\n     mes, and h |                 |     n,--\\nAnd h |     hid,\\nAnd h |                 |     SET:\\nAnd h\n     hou? and h |                 |     ing;\\nAnd h |      sir, and h |                 |      ut this: H\n     his hand h |                 |      uty, and h |     ear,\\nAnd h |                 |      ll'd and h\n    und,\\nAnd h |                 |     bed;\\nAnd h |     and,\\nAnd h |                 |      ard, and h\n     tino and h |                 |      and, and h |     aid,\\nAnd h |                 |      l'd, and h\n     elme and h |                 |     NIO:\\nAnd h |      ord? and h |                 |       so, and h\n     ntio and h |                 |      ell; and h |     her;\\nAnd h |                 |      ak this, h\n     utio and h |                 |     ill;\\nAnd h |     aca,\\nAnd h |                 |     st Lady:\\nH\n     tock and h |                 |     dua,\\nAnd h |     eld,\\nAnd h |                 |       honest, h\n     ips, and h |                 |      t I, and h |      sir; and h |                 |      n't, and h\n      son and h |                 |      old, and h |      woo, and h |                 |     as true,\\nH\n     head and h |                 |     own;\\nAnd h |      ize; and h |                 |      l son's, h\n     fair and h |                 |     ife;\\nAnd h |      uds, and h |                 |      life and h\n     high and h |                 |      ill, and h |     n,--\\nAnd h |                 |      os name, h\n     me stand h |                 |      ved; and h |     day,\\nAnd h |                 |      ng done: h\n     help and h |                 |     hape\\nAnd h |     ing;\\nAnd h |                 |      ust! and h\n     son, and h |                 |      ing: and h |      uty, and h |                 |      hoa, ho, h\n     here and h |                 |     ilan\\nAnd h |     bed;\\nAnd h |                 |      hem; and h\n     ings and h |                 |      not; and h |      and, and h |                 |     es;\\nand, h\n     tale and h |                 |                 |     NIO:\\nAnd h |                 |      to love, h\n    ove,\\nAnd h |                 |                 |      ell; and h |                 |      der, and h\n     one, and h |                 |                 |     ill;\\nAnd h |                 |     ZEL:\\nAnd h\n    \\nO, find h |                 |                 |     dua,\\nAnd h |                 |      ses; and h\n     she? and h |                 |                 |      old, and h |                 |      yea, and h\n     rth, and h |                 |                 |     own;\\nAnd h |                 |      ough and h\n    ,\\nAscend h |                 |                 |     ife;\\nAnd h |                 |      ugh, and h\n     ght; and h |                 |                 |      ill, and h |                 |      rth. And h\n    man,\\nAnd h |                 |                 |      ved; and h |                 |      mione's, h\n     h'd: and h |                 |                 |      ght, and h |                 |      ick, and h\n    rave\\nAnd h |                 |                 |      ing: and h |                 |     \\nAy, and h\n    ift,\\nAnd h |                 |                 |      not; and h |                 |     ine;\\nBut h\n     ome: and h |                 |                 |      eep, and h |                 |      amation, h\n     led, and h |                 |                 |                 |                 |      n stone: h\n    ent,\\nAnd h |                 |                 |                 |                 |     LLA:\\nAnd h\n    per,\\nAnd h |                 |                 |                 |                 |      hand and h\n    one,\\nAnd h |                 |                 |                 |                 |      ld save, h\n    y,--\\nAnd h |                 |                 |                 |                 |      nes; and h\n    ied;\\nAnd h |                 |                 |                 |                 |     \\nto sit, h\n     ive, and h |                 |                 |                 |                 |      low; and h\n     t attend h |                 |                 |                 |                 |      ice; and h\n     iet, and h |                 |                 |                 |                 |     SABELLA:\\nH\n     we found h |                 |                 |                 |                 |     ild;\\nAnd h\n    der;\\nAnd h |                 |                 |                 |                 |     ELO:\\nAnd h\n    ath:\\nAnd h |                 |                 |                 |                 |     r.\\nThat, h\n     liet and h |                 |                 |                 |                 |      ake; and h\n     rmy; and h |                 |                 |                 |                 |      nse: and h\n     ites and h |                 |                 |                 |                 |      rue: and h\n     vest and h |                 |                 |                 |                 |      ong, and h\n     land and h |                 |                 |                 |                 |     ck away:\\nH\n      him and h |                 |                 |                 |                 |       do, and h\n     ret, and h |                 |                 |                 |                 |     lf.\\nBut, h\n    aves\\nAnd h |                 |                 |                 |                 |     TIO:\\nAnd h\n     tay, and h |                 |                 |                 |                 |      ar none: h\n     to wound h |                 |                 |                 |                 |      ted, and h\n    RET:\\nAnd h |                 |                 |                 |                 |     TIO:\\nBut h\n      to hand h |                 |                 |                 |                 |     oon:\\nAnd h\n     edom and h |                 |                 |                 |                 |      hal, and h\n     loss and h |                 |                 |                 |                 |      at home, h\n    ong;\\nAnd h |                 |                 |                 |                 |      best is, h\n    nity\\nAnd h |                 |                 |                 |                 |     hid,\\nAnd h\n    ess?\\nAnd h |                 |                 |                 |                 |     o utter:\\nH\n    ords\\nAnd h |                 |                 |                 |                 |      sir, and h\n     ing, and h |                 |                 |                 |                 |     and,\\nAnd h\n    oop;\\nAnd h |                 |                 |                 |                 |      ord? and h\n    nce,\\nAnd h |                 |                 |                 |                 |     her;\\nAnd h\n    and;\\nAnd h |                 |                 |                 |                 |     r,\\nThat, h\n      eye and h |                 |                 |                 |                 |      sir; and h\n    oon,\\nAnd h |                 |                 |                 |                 |      That is, h\n    ife,\\nAnd h |                 |                 |                 |                 |      woo, and h\n     nry, and h |                 |                 |                 |                 |     APTISTA:\\nH\n     n me and h |                 |                 |                 |                 |      ize; and h\n     Scotland h |                 |                 |                 |                 |      uds, and h\n     rrow and h |                 |                 |                 |                 |     n,--\\nAnd h\n     gery and h |                 |                 |                 |                 |     day,\\nAnd h\n    ass,\\nAnd h |                 |                 |                 |                 |     ay.\\nAnd, h\n     it;\\nAnd h |                 |                 |                 |                 |     ing;\\nAnd h\n    TER:\\nAnd h |                 |                 |                 |                 |      uty, and h\n    pen;\\nAnd h |                 |                 |                 |                 |     bed;\\nAnd h\n     wick and h |                 |                 |                 |                 |       mad and h\n     re stand h |                 |                 |                 |                 |      and, and h\n     roke and h |                 |                 |                 |                 |     NIO:\\nAnd h\n     tre, and h |                 |                 |                 |                 |     lor:\\nBut h\n    rcy?\\nAnd h |                 |                 |                 |                 |      ell; and h\n    SET:\\nAnd h |                 |                 |                 |                 |     NIO:\\nBut h\n     ll'd and h |                 |                 |                 |                 |     ill;\\nAnd h\n     ard, and h |                 |                 |                 |                 |     dua,\\nAnd h\n     l'd, and h |                 |                 |                 |                 |     uly too,\\nH\n    lem,\\nAnd h |                 |                 |                 |                 |      t I, and h\n      so, and h |                 |                 |                 |                 |      old, and h\n    ains\\nAnd h |                 |                 |                 |                 |     own;\\nAnd h\n    ence\\nAnd h |                 |                 |                 |                 |     ife;\\nAnd h\n     hums and h |                 |                 |                 |                 |       ship so h\n     esty and h |                 |                 |                 |                 |      own lie, h\n     n't, and h |                 |                 |                 |                 |     ay'd\\nAnd h\n     life and h |                 |                 |                 |                 |      y books, h\n     come and h |                 |                 |                 |                 |      ill, and h\n     ust! and h |                 |                 |                 |                 |      ved; and h\n     hem; and h |                 |                 |                 |                 |      ave sir, h\n     eman and h |                 |                 |                 |                 |      ing: and h\n     ting and h |                 |                 |                 |                 |      ag-seed, h\n     hem, and h |                 |                 |                 |                 |      not; and h\n     der, and h |                 |                 |                 |                 |      eep, and h\n    oung\\nAnd h |                 |                 |                 |                 |                \n     sury and h |                 |                 |                 |                 |                \n    ZEL:\\nAnd h |                 |                 |                 |                 |                \n     ness and h |                 |                 |                 |                 |                \n     ses; and h |                 |                 |                 |                 |                \n     yea, and h |                 |                 |                 |                 |                \n     ough and h |                 |                 |                 |                 |                \n     ugh, and h |                 |                 |                 |                 |                \n    \\nHer and h |                 |                 |                 |                 |                \n     Can send h |                 |                 |                 |                 |                \n     rone and h |                 |                 |                 |                 |                \n     rth. And h |                 |                 |                 |                 |                \n    ng\\nfound h |                 |                 |                 |                 |                \n     bark and h |                 |                 |                 |                 |                \n    \\nman and h |                 |                 |                 |                 |                \n     ick, and h |                 |                 |                 |                 |                \n    \\nAy, and h |                 |                 |                 |                 |                \n     ead, and h |                 |                 |                 |                 |                \n     oted and h |                 |                 |                 |                 |                \n     race and h |                 |                 |                 |                 |                \n     ngue and h |                 |                 |                 |                 |                \n    oved\\nAnd h |                 |                 |                 |                 |                \n    nna,\\nAnd h |                 |                 |                 |                 |                \n    LLA:\\nAnd h |                 |                 |                 |                 |                \n     ella and h |                 |                 |                 |                 |                \n     ilth and h |                 |                 |                 |                 |                \n     hand and h |                 |                 |                 |                 |                \n     nes; and h |                 |                 |                 |                 |                \n     low; and h |                 |                 |                 |                 |                \n     ding and h |                 |                 |                 |                 |                \n     ice; and h |                 |                 |                 |                 |                \n    ild;\\nAnd h |                 |                 |                 |                 |                \n    ELO:\\nAnd h |                 |                 |                 |                 |                \n     ake; and h |                 |                 |                 |                 |                \n     nse: and h |                 |                 |                 |                 |                \n     rue: and h |                 |                 |                 |                 |                \n     nes, and h |                 |                 |                 |                 |                \n     ong, and h |                 |                 |                 |                 |                \n      do, and h |                 |                 |                 |                 |                \n    TIO:\\nAnd h |                 |                 |                 |                 |                \n     ted, and h |                 |                 |                 |                 |                \n     eard and h |                 |                 |                 |                 |                \n    oon:\\nAnd h |                 |                 |                 |                 |                \n     ent, and h |                 |                 |                 |                 |                \n     hal, and h |                 |                 |                 |                 |                \n     home and h |                 |                 |                 |                 |                \n    ion,\\nAnd h |                 |                 |                 |                 |                \n     Many and h |                 |                 |                 |                 |                \n    hid,\\nAnd h |                 |                 |                 |                 |                \n     self and h |                 |                 |                 |                 |                \n     aith and h |                 |                 |                 |                 |                \n    ides\\nAnd h |                 |                 |                 |                 |                \n     sing and h |                 |                 |                 |                 |                \n     sir, and h |                 |                 |                 |                 |                \n    ear,\\nAnd h |                 |                 |                 |                 |                \n     hipt and h |                 |                 |                 |                 |                \n    mber\\nAnd h |                 |                 |                 |                 |                \n     unds and h |                 |                 |                 |                 |                \n    and,\\nAnd h |                 |                 |                 |                 |                \n    aid,\\nAnd h |                 |                 |                 |                 |                \n     ord? and h |                 |                 |                 |                 |                \n     e me and h |                 |                 |                 |                 |                \n     athe and h |                 |                 |                 |                 |                \n    her;\\nAnd h |                 |                 |                 |                 |                \n    he\\nstand h |                 |                 |                 |                 |                \n    aca,\\nAnd h |                 |                 |                 |                 |                \n    eld,\\nAnd h |                 |                 |                 |                 |                \n     auty and h |                 |                 |                 |                 |                \n     sir; and h |                 |                 |                 |                 |                \n     woo, and h |                 |                 |                 |                 |                \n     l attend h |                 |                 |                 |                 |                \n     ize; and h |                 |                 |                 |                 |                \n    ooks\\nAnd h |                 |                 |                 |                 |                \n     uds, and h |                 |                 |                 |                 |                \n    n,--\\nAnd h |                 |                 |                 |                 |                \n    day,\\nAnd h |                 |                 |                 |                 |                \n    ing;\\nAnd h |                 |                 |                 |                 |                \n     uty, and h |                 |                 |                 |                 |                \n    bed;\\nAnd h |                 |                 |                 |                 |                \n      mad and h |                 |                 |                 |                 |                \n     anca and h |                 |                 |                 |                 |                \n     and, and h |                 |                 |                 |                 |                \n    NIO:\\nAnd h |                 |                 |                 |                 |                \n     duke and h |                 |                 |                 |                 |                \n     ell; and h |                 |                 |                 |                 |                \n     hter and h |                 |                 |                 |                 |                \n    ill;\\nAnd h |                 |                 |                 |                 |                \n    dua,\\nAnd h |                 |                 |                 |                 |                \n     t I, and h |                 |                 |                 |                 |                \n     adua and h |                 |                 |                 |                 |                \n     old, and h |                 |                 |                 |                 |                \n    own;\\nAnd h |                 |                 |                 |                 |                \n    ife;\\nAnd h |                 |                 |                 |                 |                \n      command h |                 |                 |                 |                 |                \n     weet and h |                 |                 |                 |                 |                \n    ay'd\\nAnd h |                 |                 |                 |                 |                \n     ill, and h |                 |                 |                 |                 |                \n     ved; and h |                 |                 |                 |                 |                \n    ck'd\\nAnd h |                 |                 |                 |                 |                \n    hild\\nAnd h |                 |                 |                 |                 |                \n     er grand h |                 |                 |                 |                 |                \n     ived and h |                 |                 |                 |                 |                \n    hape\\nAnd h |                 |                 |                 |                 |                \n     ght, and h |                 |                 |                 |                 |                \n     ing: and h |                 |                 |                 |                 |                \n     eeps and h |                 |                 |                 |                 |                \n    ilan\\nAnd h |                 |                 |                 |                 |                \n     not; and h |                 |                 |                 |                 |                \n     oots and h |                 |                 |                 |                 |                \n    gain\\nAnd h |                 |                 |                 |                 |                \n     wall and h |                 |                 |                 |                 |                \n     s island h |                 |                 |                 |                 |                \n     eep, and h |                 |                 |                 |                 |",
    "crumbs": [
      "analyses",
      "Widening the Space of Similar Values"
    ]
  },
  {
    "objectID": "analyses/widening_similar_space.html#best-performing-strings",
    "href": "analyses/widening_similar_space.html#best-performing-strings",
    "title": "Widening the Space of Similar Values",
    "section": "Best Performing Strings",
    "text": "Best Performing Strings\n\ndef filter_on_matching_count(\n    predicate: Callable[[int], bool],\n    ffwd_freqs: torch.Tensor,\n    coeffs: torch.Tensor,\n    model_outputs: Sequence[Sequence[Tuple[str, float]]],\n):\n    total_freqs = (ffwd_freqs * coeffs).sum(dim=0)\n    total_probs = total_freqs / total_freqs.sum(dim=-1, keepdim=True)\n    indices = []\n    for i, probs in enumerate(total_probs):\n        output = top_nonzero_tokens(probs, encoding_helpers.tokenizer.itos)[:10]\n        model_output = model_outputs[i]\n\n        sim_tokens, _ = zip(*output)\n        model_tokens, _ = zip(*model_output)\n\n        l = min(len(sim_tokens), len(model_tokens))\n        matching_count = 0\n        for j in range(l):\n            if sim_tokens[j] == model_tokens[j]:\n                matching_count += 1\n            else:\n                break\n        if predicate(matching_count):\n            indices.append(i)\n\n    return torch.tensor(indices, dtype=torch.long)\n\n\npredicate = lambda matching_count: matching_count &gt;= 5\nindices_matching_5 = filter_on_matching_count(predicate, ffwd_freqs, hand_rolled_coeffs, model_outputs)\nprint(f\"{len(indices_matching_5)} of {len(model_outputs)} strings\")\n\n1321 of 20000 strings\n\n\n\nindices_matching_5[:3]\n\ntensor([57, 68, 74])\n\n\n\nthresholds = [0.95, 0.94, 0.85, 0.76, 0.81, 0.89]\nq_idx_start = 57\nq_idx_end = 75\nmatching_strings = []\nfor block_idx in range(n_layer):\n    matching_strings.append(\n        get_matching_strings(\n            filter_on_prefiltered_results(\n                load_prefiltered=lambda q_idx: torch.load(prefiltered_filename(q_idx, block_idx)),\n                q_idx_start=q_idx_start,\n                q_idx_end=q_idx_end,\n                filter_fn=lambda values: values &gt; thresholds[block_idx],\n            ),\n            strings10,\n        )\n    )\n\n\nq_idx=57\nprint_results(q_idx=q_idx-q_idx_start, query_string=strings20k[q_idx], matching_strings=matching_strings)\n\nQuery string: And only l\n     hat only l |      hat only l |      hat only l |      h always l |      hat only l |      ear: the l\n     eby they l |      nobility l |      eby they l |      hat only l |      eby they l |      h always l\n     nobility l |      friendly l |      nobility l |      eby they l |      nobility l |      f more str\n     tly they l |       as many l |      friendly l |      nobility l |      tly they l |      e strong l\n      till my l |      quiously l |      Ere they l |       do very l |      and none l |       all the l\n    er:\\nThey l |      our holy l |      d he say l |      friendly l |       till my l |      ale 't a l\n     yet they l |      s kindly l |       as many l |      Ere they l |      at lives l |      hat only l\n      if they l |      s sickly l |      , worthy l |      find him l |       do very l |     ing\\nLike l\n     her they l |     e\\nBy any l |      quiously l |      rd still l |      her they l |     s--\\nFor, l\n     friendly l |       ghastly l |      our holy l |      quiously l |       divines l |      teed the l\n     Ere they l |     y;\\nDelay l |      ter many l |      our holy l |      friendly l |      Not rash l\n     d he say l |       Stanley l |      s kindly l |      ter many l |      shall my l |      h you do l\n      as many l |      h gently l |      s sickly l |      me still l |     rity,\\nOr l |      eby they l\n     quiously l |      t basely l |       ghastly l |      s kindly l |      Ere they l |     all,\\nAnd l\n     our holy l |      , fairly l |      , mighty l |      al heavy l |      he other l |     rs,\\nThat l\n     ul, they l |       worldly l |      all they l |      s sickly l |      find him l |      find you l\n     ter many l |      o lately l |      may they l |      is grace l |      s in him l |      arties str\n      you may l |      Our holy l |     y;\\nDelay l |       ghastly l |      shall be l |      in their l\n     er on my l |      e wistly l |      To worry l |      all they l |      ads them l |      nobility l\n     s kindly l |      im, only l |       she may l |      may they l |      tricians l |     uth,\\nAnd l\n     s sickly l |     \\nMy only l |       Stanley l |      To worry l |      ath more l |       pick my l\n     ar, they l |      or stony l |      h gently l |       she may l |      A mother l |      tly they l\n    e\\nBy any l |     t\\nfairly l |      ut empty l |      d soever l |      rd still l |      etition gr\n      ghastly l |      e deadly l |      t mighty l |      d nature l |      quiously l |      ld power l\n     all they l |      Thursday l |      t basely l |      ns on me l |      orth thy l |      nd their v\n     may they l |       my only l |       majesty l |       Stanley l |      our holy l |      have the l\n    y;\\nDelay l |      t vainly l |      he weary l |      h gently l |      ase thee l |      se three l\n      she may l |      untimely l |      , fairly l |      ay never l |      e father l |      l ever str\n      Stanley l |      r kingly l |       worldly l |      ut empty l |      ter many l |      e he was l\n     h gently l |      ling any l |      o lately l |      t mighty l |      me still l |      ch in my l\n     steel my l |      , if any l |      ughs may l |      d always l |      overeign l |      and none l\n     t basely l |      For many l |      Our holy l |      t basely l |      s kindly l |      r all or l\n     hy glory l |      ould say l |      y greedy l |     th\\nI spy l |      al heavy l |      bless my l\n     , fairly l |      e kingly l |      e wistly l |       majesty l |      hen this l |     \\nIndeed, l\n      worldly l |      iciously l |      im, only l |      he weary l |      s sickly l |       till my l\n     o lately l |      a goodly l |     \\nMy only l |      , fairly l |      all this l |      ady that l\n     Our holy l |       no lady l |      or stony l |       worldly l |      me lives l |       to save l\n     y greedy l |     e\\nA lady l |     t\\nfairly l |      o lately l |      or other l |      n truth, l\n     e wistly l |      directly l |       and may l |      ughs may l |     s,\\nLives l |     from\\nhim l\n    KE:\\nThey l |      And only l |      e deadly l |      serve me l |       ghastly l |      r alone, l\n     as\\nthey l |       hastily l |      Thursday l |      Our holy l |      all they l |      od sweet l\n     im, only l |      oolishly l |       my only l |      y greedy l |      not live l |      ears you l\n      as they l |      l gladly l |      t vainly l |     an!\\nLove l |      To worry l |     ,\\nThat's l\n    \\nMy only l |      I dearly l |      untimely l |      e wistly l |      d pierce l |      he south l\n     hen they l |      ard, thy l |       of many l |       another l |      th still l |      d do the l\n     or stony l |       'if any l |      r kingly l |      im, only l |      d nature l |      thy grim l\n     e, on my l |      e surely l |       man may l |      everence l |      en times l |      ushions, l\n    t\\nfairly l |                 |      For many l |      ow since l |      ns on me l |     s,\\nTheir v\n      and may l |                 |      r safety l |     \\nMy only l |      h gently l |      bt--that l\n     e deadly l |                 |      ould say l |      hen they l |      ut empty l |      ighs bad l\n      tell my l |                 |      wick may l |      or stony l |      d vigour l |      olloa me l\n     Thursday l |                 |      this way l |      th heavy l |      eive thy l |      tterers, l\n     not very l |                 |      s pretty l |      ll never l |      me argue l |      n steel gr\n     lord! my l |                 |      As every l |       me bury l |      o virtue l |      loved my l\n      my only l |                 |      e kingly l |     t\\nfairly l |      n things l |     eg\\nOf my l\n     s in any l |                 |      iciously l |       strange l |      ich live l |      sometime l\n     t vainly l |                 |      iscovery l |      e deadly l |      t basely l |      hould be l\n     untimely l |                 |       no lady l |      ows very l |     th\\nI spy l |      the wolf l\n     ng Henry l |                 |      directly l |      Tis very l |       majesty l |      hat baes l\n      of many l |                 |      ere they l |      Thursday l |      hallenge l |      at lives l\n     r kingly l |                 |      And only l |      r bid me l |      onally I l |       do very l\n     ling any l |                 |       I carry l |      th merry l |      , fairly l |      yet they l\n     , if any l |                 |      life may l |      not very l |      ed toads l |      caps and l\n     For many l |                 |      e we may l |       my only l |       worldly l |      ke faces l\n     at Henry l |                 |       hastily l |     nswer\\nme l |      o lately l |       take my l\n     ur Henry l |                 |      oolishly l |      h angels l |      and thus l |      as noble l\n     or Henry l |                 |      l gladly l |      and true l |      ill time l |      l make a l\n     ould say l |                 |      I dearly l |      t vainly l |      ughs may l |       ladies, l\n     uld they l |                 |      ommodity l |      untimely l |      Our holy l |     nate\\nhas l\n     f all my l |                 |      e surely l |       of many l |      t living l |      ore this l\n     e kingly l |                 |                 |      se heavy l |      ful ages l |      d him he l\n     iciously l |                 |                 |      r kingly l |      d hither l |      arm doth l\n     a goodly l |                 |                 |      ave thee l |       thither l |       I could l\n     entle my l |                 |                 |      er heavy l |      y greedy l |       rapture l\n      all, my l |                 |                 |      's a day l |      e wistly l |       richest l\n      no lady l |                 |                 |      For many l |      ll still l |      er'd up, l\n    e\\nA lady l |                 |                 |      this way l |       pain is l |      With the l\n     directly l |                 |                 |      s pretty l |       another l |      ake I as l\n     And only l |                 |                 |      As every l |      im, only l |       saw the l\n     o, on my l |                 |                 |      uld they l |      e ladies l |      ho ne'er l\n     re; they l |                 |                 |      e kingly l |      everence l |      hey have l\n     life may l |                 |                 |       love my l |      en maids l |      her they l\n      hastily l |                 |                 |      e pretty l |      ow since l |      lessness l\n     r in any l |                 |                 |      iciously l |     \\nMy only l |      ad their l\n     oolishly l |                 |                 |     d me\\nCry l |      hen they l |      or their l\n     l gladly l |                 |                 |      iscovery l |      or stony l |      self the l\n     I dearly l |                 |                 |       my life l |      at dares l |      sul, and l\n     d all my l |                 |                 |       no lady l |      el and I l |       honours l\n     u all my l |                 |                 |      I little l |       thee my l |       all his l\n     n all my l |                 |                 |      directly l |      th heavy l |      bristled l\n     learn my l |                 |                 |      ere they l |     t\\nfairly l |     t,\\nAnd str\n      'if any l |                 |                 |      y of him l |      ivelling l |      he waxed l\n     e surely l |                 |                 |      And only l |      ink true l |     since\\nHe l\n     , he may l |                 |                 |      e we may l |     ,\\nDoting l |      For this l\n                |                 |                 |       hastily l |      e deadly l |      Corioli, l\n                |                 |                 |      oolishly l |      ows very l |      ; then str\n                |                 |                 |      his will l |      Tis very l |      o'er the l\n                |                 |                 |      t severe l |      ery very l |      at,\\nAnd l\n                |                 |                 |      l gladly l |       villain l |      e covets l\n                |                 |                 |      I dearly l |     \\nA thing l |     still\\nMy l\n                |                 |                 |      nd other l |      r bid me l |      ve their v\n                |                 |                 |      ommodity l |      th merry l |       divines l\n                |                 |                 |     \\nanother l |      not very l |      t indeed l\n                |                 |                 |      e surely l |      shalt be l |      me would l\n                |                 |                 |       lend me l |       my only l |      gs, some l\n                |                 |                 |      ipp'd me l |      h angels l |      friendly l\n                |                 |                 |      aught me l |      and true l |     ink\\nThat h\n                |                 |                 |      , he may l |      t vainly l |     ke\\nTheir l\n                |                 |                 |                 |      om there l |       consul: l\n                |                 |                 |                 |      untimely l |       we read l\n                |                 |                 |                 |      ows here l |      re worn, l\n                |                 |                 |                 |       of many l |      t Antium l\n                |                 |                 |                 |      aves thy l |     ow\\nAnd str\n                |                 |                 |                 |      r kingly l |      r'd rub, l\n                |                 |                 |                 |       neither l |      ow, as I l\n                |                 |                 |                 |      ave thee l |      ed many, l\n                |                 |                 |                 |      ck rages l |     ber,\\nWho l\n                |                 |                 |                 |      er heavy l |      shall my l\n                |                 |                 |                 |      d rather l |      idnight sl\n                |                 |                 |                 |      For many l |      angerous l\n                |                 |                 |                 |      ou still l |      us their v\n                |                 |                 |                 |      t hinder l |      an their v\n                |                 |                 |                 |      ne thing l |     s\\nWhat's l\n                |                 |                 |                 |      s pretty l |       will be l\n                |                 |                 |                 |      uld they l |      s spoken l\n                |                 |                 |                 |      t in men l |       be, was l\n                |                 |                 |                 |      e kingly l |     us,\\nWhom l\n                |                 |                 |                 |      e pretty l |      d so are l\n                |                 |                 |                 |      iciously l |     UTUS:\\nOr l\n                |                 |                 |                 |     d me\\nCry l |     rity,\\nOr l\n                |                 |                 |                 |       no lady l |      r let us l\n                |                 |                 |                 |      I little l |      hat seem l\n                |                 |                 |                 |     e\\nA lady l |      have but l\n                |                 |                 |                 |      directly l |      resisted l\n                |                 |                 |                 |      ere they l |      ribunes' l\n                |                 |                 |                 |      y of him l |       what is l\n                |                 |                 |                 |      e afresh l |      n he did l\n                |                 |                 |                 |      d living l |     late\\nTie l\n                |                 |                 |                 |      old wife l |      n bolted l\n                |                 |                 |                 |      And only l |      striving l\n                |                 |                 |                 |       these I l |      Ere they l\n                |                 |                 |                 |      at maids l |      heart as l\n                |                 |                 |                 |     tape,\\nOr l |      ain that l\n                |                 |                 |                 |      ncertain l |       policy, l\n                |                 |                 |                 |      d then I l |      he other l\n                |                 |                 |                 |      life may l |      of their l\n                |                 |                 |                 |      too sore l |       but the l\n                |                 |                 |                 |      The very l |      having str\n                |                 |                 |                 |       to life l |     ant\\nMore l\n                |                 |                 |                 |       hastily l |      t babies l\n                |                 |                 |                 |      oolishly l |      rough my l\n                |                 |                 |                 |      his will l |      up, bend l\n                |                 |                 |                 |      t severe l |      nk their l\n                |                 |                 |                 |      emselves l |      ht and str\n                |                 |                 |                 |      l gladly l |      nt, then l\n                |                 |                 |                 |      I dearly l |      choler str\n                |                 |                 |                 |      he angry l |      re which l\n                |                 |                 |                 |      nd women l |      o suffer l\n                |                 |                 |                 |      ieve thy l |       to move l\n                |                 |                 |                 |      d all my l |      eaks not l\n                |                 |                 |                 |      no other l |      find him l\n                |                 |                 |                 |     nds\\nRage l |     , in\\nThy l\n                |                 |                 |                 |      nd other l |      Opposing l\n                |                 |                 |                 |      n all my l |      s with str\n                |                 |                 |                 |      ommodity l |      s in him l\n                |                 |                 |                 |     \\nanother l |      ostile str\n                |                 |                 |                 |      t late I l |      mine own l\n                |                 |                 |                 |      e surely l |      n most str\n                |                 |                 |                 |       lend me l |      ilence str\n                |                 |                 |                 |      ything I l |      shall be l\n                |                 |                 |                 |      ipp'd me l |      hen I am l\n                |                 |                 |                 |      t I more l |     man,\\nAnd l\n                |                 |                 |                 |      nowing I l |      ncient str\n                |                 |                 |                 |      take her l |      ite your l\n                |                 |                 |                 |      t rather l |      m that str\n                |                 |                 |                 |                 |     n--\\nThis l\n                |                 |                 |                 |                 |     \\nOf what l\n                |                 |                 |                 |                 |      ling and l\n                |                 |                 |                 |                 |      d when I l\n                |                 |                 |                 |                 |      n Rome str\n                |                 |                 |                 |                 |      Aufidius l\n                |                 |                 |                 |                 |      , and my l\n                |                 |                 |                 |                 |      s ever I l\n                |                 |                 |                 |                 |      aten him l\n                |                 |                 |                 |                 |      bing the l\n                |                 |                 |                 |                 |       save my l\n                |                 |                 |                 |                 |     rawn,\\nOr l\n                |                 |                 |                 |                 |      ng their l\n                |                 |                 |                 |                 |     have\\nThe l\n                |                 |                 |                 |                 |     ched\\nhim l\n                |                 |                 |                 |                 |      him, and l\n                |                 |                 |                 |                 |      burrows, l\n                |                 |                 |                 |                 |      pe their l\n                |                 |                 |                 |                 |      poplexy, l\n                |                 |                 |                 |                 |      hey then l\n                |                 |                 |                 |                 |      tering str\n                |                 |                 |                 |                 |       kind of l\n                |                 |                 |                 |                 |     anus\\nHad l\n                |                 |                 |                 |                 |       all our l\n                |                 |                 |                 |                 |      ord that v\n                |                 |                 |                 |                 |      ufidius, l\n                |                 |                 |                 |                 |      ul army, l\n                |                 |                 |                 |                 |     ook\\nWhat l\n                |                 |                 |                 |                 |      the city l\n                |                 |                 |                 |                 |      ads them l\n                |                 |                 |                 |                 |      d you'll l\n                |                 |                 |                 |                 |      n show'd l\n                |                 |                 |                 |                 |      olicy, str\n                |                 |                 |                 |                 |      masters, l\n                |                 |                 |                 |                 |      tricians l\n                |                 |                 |                 |                 |      h he was l\n                |                 |                 |                 |                 |      n it was l\n                |                 |                 |                 |                 |      d he say l\n                |                 |                 |                 |                 |      bite his l\n                |                 |                 |                 |                 |      ou guard l\n                |                 |                 |                 |                 |      e, it is l\n                |                 |                 |                 |                 |      al is my l\n                |                 |                 |                 |                 |      ust have l\n                |                 |                 |                 |                 |       as many l\n                |                 |                 |                 |                 |      been his l\n                |                 |                 |                 |                 |      ath more l\n                |                 |                 |                 |                 |      ity, and l\n                |                 |                 |                 |                 |      is, who, l\n                |                 |                 |                 |                 |      emission l\n                |                 |                 |                 |                 |      t, for I l\n                |                 |                 |                 |                 |      Volscian l\n                |                 |                 |                 |                 |      d. Their l\n                |                 |                 |                 |                 |      hose old l\n                |                 |                 |                 |                 |       my true l\n                |                 |                 |                 |                 |      now this l\n                |                 |                 |                 |                 |      fe, this l\n                |                 |                 |                 |                 |      than all l\n                |                 |                 |                 |                 |      e fine str\n                |                 |                 |                 |                 |      h more str\n                |                 |                 |                 |                 |      The gods l\n                |                 |                 |                 |                 |     ene\\nThey l\n                |                 |                 |                 |                 |      A mother l\n                |                 |                 |                 |                 |       granted l\n                |                 |                 |                 |                 |      hope the l\n                |                 |                 |                 |                 |     he\\nmoves l\n                |                 |                 |                 |                 |       this is l\n                |                 |                 |                 |                 |      ave your l\n                |                 |                 |                 |                 |      ews; the l\n                |                 |                 |                 |                 |      ver yet gr\n                |                 |                 |                 |                 |      have you l\n                |                 |                 |                 |                 |      meet the l\n                |                 |                 |                 |                 |       sea and l\n                |                 |                 |                 |                 |      ess, the l\n                |                 |                 |                 |                 |      which he l\n                |                 |                 |                 |                 |      lost\\nBy l\n                |                 |                 |                 |                 |      cheap as l\n                |                 |                 |                 |                 |      lood and l\n                |                 |                 |                 |                 |       enter'd l\n                |                 |                 |                 |                 |       passage l\n                |                 |                 |                 |                 |      solution l\n                |                 |                 |                 |                 |      sureless l\n                |                 |                 |                 |                 |      my grave l\n                |                 |                 |                 |                 |       cur the l\n                |                 |                 |                 |                 |      rust the l\n                |                 |                 |                 |                 |     e,\\nThat, l\n                |                 |                 |                 |                 |      o use my l\n                |                 |                 |                 |                 |      uds that l\n                |                 |                 |                 |                 |     r\\nTo the l\n                |                 |                 |                 |                 |      and want l\n                |                 |                 |                 |                 |      s have I l\n                |                 |                 |                 |                 |      phecies, l\n                |                 |                 |                 |                 |      ucks the l\n                |                 |                 |                 |                 |      and such l\n                |                 |                 |                 |                 |      lain his l\n                |                 |                 |                 |                 |     n\\nWell str\n                |                 |                 |                 |                 |      A cherry l\n                |                 |                 |                 |                 |      ath your l\n                |                 |                 |                 |                 |      vil diet l\n                |                 |                 |                 |                 |     rcy,\\nAnd l\n                |                 |                 |                 |                 |      rd still l\n                |                 |                 |                 |                 |      nourable l\n                |                 |                 |                 |                 |      quiously l\n                |                 |                 |                 |                 |     d!\\nBe it l\n                |                 |                 |                 |                 |      hear the l\n                |                 |                 |                 |                 |      ows that l\n                |                 |                 |                 |                 |      orth thy l\n                |                 |                 |                 |                 |      ood that l\n                |                 |                 |                 |                 |      ve wife, l\n                |                 |                 |                 |                 |      our holy l\n                |                 |                 |                 |                 |      whiles I l\n                |                 |                 |                 |                 |      ack, and l\n                |                 |                 |                 |                 |      htning str\n                |                 |                 |                 |                 |       patient l\n                |                 |                 |                 |                 |      evilish sl\n                |                 |                 |                 |                 |      oat thou l\n                |                 |                 |                 |                 |     e,\\nwhich l\n                |                 |                 |                 |                 |      m till I l\n                |                 |                 |                 |                 |      eath thy l\n                |                 |                 |                 |                 |      ves that l\n                |                 |                 |                 |                 |       father, l\n                |                 |                 |                 |                 |      ld never l\n                |                 |                 |                 |                 |      , here I l\n                |                 |                 |                 |                 |     som.\\nAnd l\n                |                 |                 |                 |                 |      deadly str\n                |                 |                 |                 |                 |      kill thy l\n                |                 |                 |                 |                 |      ar truer l\n                |                 |                 |                 |                 |      ase thee l\n                |                 |                 |                 |                 |      keep her l\n                |                 |                 |                 |                 |      sembling l\n                |                 |                 |                 |                 |      ith some l\n                |                 |                 |                 |                 |      n return l\n                |                 |                 |                 |                 |      ng to my l\n                |                 |                 |                 |                 |      harm but l\n                |                 |                 |                 |                 |      f such a l\n                |                 |                 |                 |                 |     ETH:\\nThe l\n                |                 |                 |                 |                 |     ife,\\nAnd l\n                |                 |                 |                 |                 |      endment, l\n                |                 |                 |                 |                 |      m and my l\n                |                 |                 |                 |                 |      ern, and l\n                |                 |                 |                 |                 |      race but l\n                |                 |                 |                 |                 |      lain man l\n                |                 |                 |                 |                 |      astings' l\n                |                 |                 |                 |                 |     ein,\\nAnd l\n                |                 |                 |                 |                 |      e flint, l\n                |                 |                 |                 |                 |      pitiful, l\n                |                 |                 |                 |                 |      ame, and l\n                |                 |                 |                 |                 |      then our l\n                |                 |                 |                 |                 |      not that l\n                |                 |                 |                 |                 |      before I l\n                |                 |                 |                 |                 |      e father l\n                |                 |                 |                 |                 |      youth by l\n                |                 |                 |                 |                 |      untimely v\n                |                 |                 |                 |                 |      y glory, l\n                |                 |                 |                 |                 |      ter many l\n                |                 |                 |                 |                 |       you may l\n                |                 |                 |                 |                 |      ave any gr\n                |                 |                 |                 |                 |     thee,\\nO, l\n                |                 |                 |                 |                 |      ile thou l\n                |                 |                 |                 |                 |      ; she is l\n                |                 |                 |                 |                 |      h blood, l\n                |                 |                 |                 |                 |      outrage, l\n                |                 |                 |                 |                 |      me still l\n                |                 |                 |                 |                 |       sign of l\n                |                 |                 |                 |                 |     broach\\nI l\n                |                 |                 |                 |                 |      ed, have l\n                |                 |                 |                 |                 |      siness str\n                |                 |                 |                 |                 |     lling,\\nStr\n                |                 |                 |                 |                 |      of eyes, r\n                |                 |                 |                 |                 |      nes that l\n                |                 |                 |                 |                 |      ould not l\n                |                 |                 |                 |                 |      ream was l\n                |                 |                 |                 |                 |      'd after l\n                |                 |                 |                 |                 |      A shadow l\n                |                 |                 |                 |                 |      ides and l\n                |                 |                 |                 |                 |      er on my l\n                |                 |                 |                 |                 |       but thy l\n                |                 |                 |                 |                 |      en their v\n                |                 |                 |                 |                 |      part and l\n                |                 |                 |                 |                 |      reak his l\n                |                 |                 |                 |                 |      dreadful l\n                |                 |                 |                 |                 |      rect nor l\n                |                 |                 |                 |                 |      r, and I l\n                |                 |                 |                 |                 |     ther,\\nHe l\n                |                 |                 |                 |                 |      he would l\n                |                 |                 |                 |                 |      ow fain, l\n                |                 |                 |                 |                 |      s united l\n                |                 |                 |                 |                 |      ear your l\n                |                 |                 |                 |                 |      wear the l\n                |                 |                 |                 |                 |       perfect l\n                |                 |                 |                 |                 |     r,\\nWife, l\n                |                 |                 |                 |                 |      astings, l\n                |                 |                 |                 |                 |      gs, love l\n                |                 |                 |                 |                 |      hou this l\n                |                 |                 |                 |                 |       duteous l\n                |                 |                 |                 |                 |      overeign l\n                |                 |                 |                 |                 |      od all str\n                |                 |                 |                 |                 |       offer'd l\n                |                 |                 |                 |                 |      oble and l\n                |                 |                 |                 |                 |      and less l\n                |                 |                 |                 |                 |      ighness gr\n                |                 |                 |                 |                 |      spake of l\n                |                 |                 |                 |                 |       we both l\n                |                 |                 |                 |                 |      w he did l\n                |                 |                 |                 |                 |      y do you l\n                |                 |                 |                 |                 |      e that's l\n                |                 |                 |                 |                 |      ing doth l\n                |                 |                 |                 |                 |      you will l\n                |                 |                 |                 |                 |     g's;\\nOr, l\n                |                 |                 |                 |                 |     ath,\\nAnd l\n                |                 |                 |                 |                 |      lived by l\n                |                 |                 |                 |                 |     ,\\nWhich gr\n                |                 |                 |                 |                 |      children l\n                |                 |                 |                 |                 |      ress was l\n                |                 |                 |                 |                 |      w-dolour l\n                |                 |                 |                 |                 |      our dear l\n                |                 |                 |                 |                 |      s kindly l\n                |                 |                 |                 |                 |      al heavy l\n                |                 |                 |                 |                 |      my lord, l\n                |                 |                 |                 |                 |      apparent l\n                |                 |                 |                 |                 |      e that str\n                |                 |                 |                 |                 |     usin,\\nI, l\n                |                 |                 |                 |                 |      hen this l\n                |                 |                 |                 |                 |      s sickly l\n                |                 |                 |                 |                 |      en great l\n                |                 |                 |                 |                 |      doth not l\n                |                 |                 |                 |                 |     man\\nThat l\n                |                 |                 |                 |                 |      ar, they l\n                |                 |                 |                 |                 |      wn since l\n                |                 |                 |                 |                 |       but yet l\n                |                 |                 |                 |                 |       husband l\n                |                 |                 |                 |                 |      lost his l\n                |                 |                 |                 |                 |      gain and l\n                |                 |                 |                 |                 |     leen;\\nOr l\n                |                 |                 |                 |                 |     k,\\nWould l\n                |                 |                 |                 |                 |      sweating l\n                |                 |                 |                 |                 |      all this l\n                |                 |                 |                 |                 |      h should l\n                |                 |                 |                 |                 |      me lives l\n                |                 |                 |                 |                 |     g.\\nThus, l\n                |                 |                 |                 |                 |      s valour l\n                |                 |                 |                 |                 |      my dread l\n                |                 |                 |                 |                 |       dagger, l\n                |                 |                 |                 |                 |       weapon, l\n                |                 |                 |                 |                 |      hat I am l\n                |                 |                 |                 |                 |      rd, this l\n                |                 |                 |                 |                 |     tend\\nAs cl\n                |                 |                 |                 |                 |      rrow are l\n                |                 |                 |                 |                 |     do:\\nAnd, l\n                |                 |                 |                 |                 |     s hate\\nI l\n                |                 |                 |                 |                 |      ared and l\n                |                 |                 |                 |                 |       hold my l\n                |                 |                 |                 |                 |      -day the l\n                |                 |                 |                 |                 |       priest, l\n                |                 |                 |                 |                 |     GS:\\n'Tis l\n                |                 |                 |                 |                 |      atcliff, l\n                |                 |                 |                 |                 |       and for l\n                |                 |                 |                 |                 |      tch; the l\n                |                 |                 |                 |                 |      take our l\n                |                 |                 |                 |                 |      nows the l\n                |                 |                 |                 |                 |      ave been l\n                |                 |                 |                 |                 |     der;\\nHis l\n                |                 |                 |                 |                 |      ell, and l\n                |                 |                 |                 |                 |      en I was l\n                |                 |                 |                 |                 |       he will l\n                |                 |                 |                 |                 |     t,\\nShall l\n                |                 |                 |                 |                 |      re is my l\n                |                 |                 |                 |                 |      is grace l\n                |                 |                 |                 |                 |      or other l\n                |                 |                 |                 |                 |      hide his l\n                |                 |                 |                 |                 |      t in his l\n                |                 |                 |                 |                 |      e tender l\n                |                 |                 |                 |                 |      arm\\nIs, l\n                |                 |                 |                 |                 |      harlot str\n                |                 |                 |                 |                 |      st, that l\n                |                 |                 |                 |                 |     curse\\nIs l\n                |                 |                 |                 |                 |     s,\\nLives l\n                |                 |                 |                 |                 |      peak and l\n                |                 |                 |                 |                 |       ghastly l\n                |                 |                 |                 |                 |      service, l\n                |                 |                 |                 |                 |      o dear I l\n                |                 |                 |                 |                 |      hat ever l\n                |                 |                 |                 |                 |     \\nI never l\n                |                 |                 |                 |                 |       hateful l\n                |                 |                 |                 |                 |      here his l\n                |                 |                 |                 |                 |      control, l\n                |                 |                 |                 |                 |      d in his l\n                |                 |                 |                 |                 |       nothing l\n                |                 |                 |                 |                 |      y mother l\n                |                 |                 |                 |                 |       full as l\n                |                 |                 |                 |                 |      ve hours l\n                |                 |                 |                 |                 |      that did l\n                |                 |                 |                 |                 |      her, and l\n                |                 |                 |                 |                 |     ,\\nAt the l\n                |                 |                 |                 |                 |      ause and l\n                |                 |                 |                 |                 |      and your l\n                |                 |                 |                 |                 |      ads; the l\n                |                 |                 |                 |                 |      lcome my l\n                |                 |                 |                 |                 |      hristian l\n                |                 |                 |                 |                 |     rth,\\nThe l\n                |                 |                 |                 |                 |     tute,\\nOr l\n                |                 |                 |                 |                 |      faithful l\n                |                 |                 |                 |                 |      ncur the l\n                |                 |                 |                 |                 |      On him I l\n                |                 |                 |                 |                 |      r mother l\n                |                 |                 |                 |                 |      sion and l\n                |                 |                 |                 |                 |       sparing l\n                |                 |                 |                 |                 |       and the l\n                |                 |                 |                 |                 |      roffer'd l\n                |                 |                 |                 |                 |      nt their l\n                |                 |                 |                 |                 |      dure the l\n                |                 |                 |                 |                 |      here the l\n                |                 |                 |                 |                 |     .\\nMaster l\n                |                 |                 |                 |                 |      mean the l\n                |                 |                 |                 |                 |      xt their l\n                |                 |                 |                 |                 |      reverend l\n                |                 |                 |                 |                 |      , cut my l\n                |                 |                 |                 |                 |     eas,\\nAnd l\n                |                 |                 |                 |                 |      all have l\n                |                 |                 |                 |                 |      Anointed l\n                |                 |                 |                 |                 |      h deadly v\n                |                 |                 |                 |                 |       wed'st, l\n                |                 |                 |                 |                 |      kest thy l\n                |                 |                 |                 |                 |      all they l\n                |                 |                 |                 |                 |     M:\\nStill l\n                |                 |                 |                 |                 |      may they l\n                |                 |                 |                 |                 |      y loving l\n                |                 |                 |                 |                 |      renowned l\n                |                 |                 |                 |                 |      l should l\n                |                 |                 |                 |                 |      me\\nThat l\n                |                 |                 |                 |                 |      sick and l\n                |                 |                 |                 |                 |      ise, and l\n                |                 |                 |                 |                 |     mind\\nThe l\n                |                 |                 |                 |                 |      Stanley, l\n                |                 |                 |                 |                 |      not live l\n                |                 |                 |                 |                 |      se that, l\n                |                 |                 |                 |                 |      yet this l\n                |                 |                 |                 |                 |     ion\\nWept l\n                |                 |                 |                 |                 |     s:\\nTheir l\n                |                 |                 |                 |                 |      r pillow l\n                |                 |                 |                 |                 |      and so I l\n                |                 |                 |                 |                 |      at knot, l\n                |                 |                 |                 |                 |     nting\\nIs l\n                |                 |                 |                 |                 |      y have I l\n                |                 |                 |                 |                 |      ht, dead l\n                |                 |                 |                 |                 |      r mortal l\n                |                 |                 |                 |                 |      s due by l\n                |                 |                 |                 |                 |     ory,\\nAnd l\n                |                 |                 |                 |                 |      To worry l\n                |                 |                 |                 |                 |      ambs and l\n                |                 |                 |                 |                 |      Thy womb l\n                |                 |                 |                 |                 |      on of my l\n                |                 |                 |                 |                 |      hard yet l\n                |                 |                 |                 |                 |       bond of l\n                |                 |                 |                 |                 |      at I may l\n                |                 |                 |                 |                 |     out,\\nAnd l\n                |                 |                 |                 |                 |     eck,\\nAnd l\n                |                 |                 |                 |                 |      ring thy l\n                |                 |                 |                 |                 |      d pierce l\n                |                 |                 |                 |                 |      er words l\n                |                 |                 |                 |                 |     nce?\\nAnd l\n                |                 |                 |                 |                 |      inted: str\n                |                 |                 |                 |                 |      nd never l\n                |                 |                 |                 |                 |      rves thy l\n                |                 |                 |                 |                 |      yet much l\n                |                 |                 |                 |                 |      it their l\n                |                 |                 |                 |                 |       she may l\n                |                 |                 |                 |                 |      save her l\n                |                 |                 |                 |                 |      to their l\n                |                 |                 |                 |                 |      a fairer l\n                |                 |                 |                 |                 |      d soever l\n                |                 |                 |                 |                 |      ls of my l\n                |                 |                 |                 |                 |      e brief, l\n                |                 |                 |                 |                 |     ess\\nLast l\n                |                 |                 |                 |                 |      dst thou l\n                |                 |                 |                 |                 |      ilt thou l\n                |                 |                 |                 |                 |      g bought l\n                |                 |                 |                 |                 |       name is l\n                |                 |                 |                 |                 |      s little l\n                |                 |                 |                 |                 |       you bid l\n                |                 |                 |                 |                 |     age.\\nThe l\n                |                 |                 |                 |                 |       by that l\n                |                 |                 |                 |                 |     see:\\nThe l\n                |                 |                 |                 |                 |     come\\nAnd l\n                |                 |                 |                 |                 |       and her l\n                |                 |                 |                 |                 |      th still l\n                |                 |                 |                 |                 |     \\nBut how l\n                |                 |                 |                 |                 |      e 'ever' l\n                |                 |                 |                 |                 |      d nature l\n                |                 |                 |                 |                 |       Richard l\n                |                 |                 |                 |                 |       subject l\n                |                 |                 |                 |                 |      subject, l\n                |                 |                 |                 |                 |      n that str\n                |                 |                 |                 |                 |      knightly v\n                |                 |                 |                 |                 |       parents l\n                |                 |                 |                 |                 |      vereign, l\n                |                 |                 |                 |                 |       bid him l\n                |                 |                 |                 |                 |      m levy str\n                |                 |                 |                 |                 |      ty power l\n                |                 |                 |                 |                 |       won and l\n                |                 |                 |                 |                 |      rm blood l\n                |                 |                 |                 |                 |      en times l\n                |                 |                 |                 |                 |       than my l\n                |                 |                 |                 |                 |      e will I l\n                |                 |                 |                 |                 |      wer of str\n                |                 |                 |                 |                 |     ay,\\nFor, l\n                |                 |                 |                 |                 |      mit each l\n                |                 |                 |                 |                 |      regiment l\n                |                 |                 |                 |                 |      y armour l\n                |                 |                 |                 |                 |      nrising, l\n                |                 |                 |                 |                 |      bloody str\n                |                 |                 |                 |                 |      ell: the l\n                |                 |                 |                 |                 |       vows of l\n                |                 |                 |                 |                 |      Which so l\n                |                 |                 |                 |                 |       give us l\n                |                 |                 |                 |                 |     ap,\\nLest l\n                |                 |                 |                 |                 |      ht, kind l\n                |                 |                 |                 |                 |      me!\\nThe l\n                |                 |                 |                 |                 |     \\nRichard l\n                |                 |                 |                 |                 |      creature l\n                |                 |                 |                 |                 |      he early v\n                |                 |                 |                 |                 |      oof, and l\n                |                 |                 |                 |                 |      y mercy, l\n                |                 |                 |                 |                 |     men,\\nThe l\n                |                 |                 |                 |                 |     empt\\nThe l\n                |                 |                 |                 |                 |      rown and l\n                |                 |                 |                 |                 |      ns on me l\n                |                 |                 |                 |                 |      e battle l\n                |                 |                 |                 |                 |      e day is l\n                |                 |                 |                 |                 |      e set my l\n                |                 |                 |                 |                 |      re, this l\n                |                 |                 |                 |                 |       Stanley l\n                |                 |                 |                 |                 |     her!\\nAnd l\n                |                 |                 |                 |                 |      ste this l\n                |                 |                 |                 |                 |      his fair l\n                |                 |                 |                 |                 |      d, peace l\n                |                 |                 |                 |                 |      may long l\n                |                 |                 |                 |                 |      t loving l\n                |                 |                 |                 |                 |     lty,\\nAnd l\n                |                 |                 |                 |                 |      an to my l\n                |                 |                 |                 |                 |      ean time l\n                |                 |                 |                 |                 |      efend my l\n                |                 |                 |                 |                 |       doth he l\n                |                 |                 |                 |                 |     ing,\\nAnd l\n                |                 |                 |                 |                 |      ead have l\n                |                 |                 |                 |                 |      h gently l\n                |                 |                 |                 |                 |      in'd for l\n                |                 |                 |                 |                 |       his bad l\n                |                 |                 |                 |                 |      hrough str\n                |                 |                 |                 |                 |       or this l\n                |                 |                 |                 |                 |      at, thou l\n                |                 |                 |                 |                 |      own that l\n                |                 |                 |                 |                 |      ut ere I l\n                |                 |                 |                 |                 |      d uncle, l\n                |                 |                 |                 |                 |      ath that l\n                |                 |                 |                 |                 |      ear dear l\n                |                 |                 |                 |                 |      t gilded l\n                |                 |                 |                 |                 |      ur is my l\n                |                 |                 |                 |                 |       dear my l\n                |                 |                 |                 |                 |      e honour l\n                |                 |                 |                 |                 |      n that I l\n                |                 |                 |                 |                 |      ords and l\n                |                 |                 |                 |                 |      rrection l\n                |                 |                 |                 |                 |      s summer l\n                |                 |                 |                 |                 |      ugh thou l\n                |                 |                 |                 |                 |     \\nIn some l\n                |                 |                 |                 |                 |      hine own l\n                |                 |                 |                 |                 |      ay never l\n                |                 |                 |                 |                 |       end her l\n                |                 |                 |                 |                 |      ut empty l\n                |                 |                 |                 |                 |     die:\\nThe l\n                |                 |                 |                 |                 |      The last l\n                |                 |                 |                 |                 |      nightly cl\n                |                 |                 |                 |                 |      ouch the l\n                |                 |                 |                 |                 |      marshal, l\n                |                 |                 |                 |                 |      at vow a l\n                |                 |                 |                 |                 |     eave\\nAnd l\n                |                 |                 |                 |                 |      take his l\n                |                 |                 |                 |                 |     ath,\\nBut l\n                |                 |                 |                 |                 |      aintiest l\n                |                 |                 |                 |                 |      d vigour l\n                |                 |                 |                 |                 |      steel my l\n                |                 |                 |                 |                 |      Be swift l\n                |                 |                 |                 |                 |     ed,\\nFall l\n                |                 |                 |                 |                 |      iant and l\n                |                 |                 |                 |                 |       cast my l\n                |                 |                 |                 |                 |     t,\\nThere l\n                |                 |                 |                 |                 |      t mighty l\n                |                 |                 |                 |                 |      eive thy l\n                |                 |                 |                 |                 |      ear this l\n                |                 |                 |                 |                 |     ay,\\nAnd gr\n                |                 |                 |                 |                 |       pain of l\n                |                 |                 |                 |                 |      dateless l\n                |                 |                 |                 |                 |     nds.\\nThe l\n                |                 |                 |                 |                 |      e I have l\n                |                 |                 |                 |                 |     harp,\\nOr l\n                |                 |                 |                 |                 |      eeth and l\n                |                 |                 |                 |                 |      or never l\n                |                 |                 |                 |                 |     ile\\nThis l\n                |                 |                 |                 |                 |      rom this l\n                |                 |                 |                 |                 |       book of l\n                |                 |                 |                 |                 |      g a time l\n                |                 |                 |                 |                 |      s in one l\n                |                 |                 |                 |                 |     rd!\\nFour l\n                |                 |                 |                 |                 |      thank my l\n                |                 |                 |                 |                 |      il-dried l\n                |                 |                 |                 |                 |      bewasted l\n                |                 |                 |                 |                 |      eath not l\n                |                 |                 |                 |                 |      me argue l\n                |                 |                 |                 |                 |      e my own l\n                |                 |                 |                 |                 |     \\nAlas, I l\n                |                 |                 |                 |                 |      as too str\n                |                 |                 |                 |                 |      o remain l\n                |                 |                 |                 |                 |      and will l\n                |                 |                 |                 |                 |      s that I l\n                |                 |                 |                 |                 |      o virtue l\n                |                 |                 |                 |                 |      tes, but l\n                |                 |                 |                 |                 |       there I l\n                |                 |                 |                 |                 |      ll' have l\n                |                 |                 |                 |                 |       further l\n                |                 |                 |                 |                 |      ighness' l\n                |                 |                 |                 |                 |     ourt\\nAnd l\n                |                 |                 |                 |                 |       liberal l\n                |                 |                 |                 |                 |     ely!\\nThe l\n                |                 |                 |                 |                 |      ntlemen, l\n                |                 |                 |                 |                 |      eathe my l\n                |                 |                 |                 |                 |      f, nor str\n                |                 |                 |                 |                 |      ttention l\n                |                 |                 |                 |                 |      t say is l\n                |                 |                 |                 |                 |      an their l\n                |                 |                 |                 |                 |     ,\\nAs the l\n                |                 |                 |                 |                 |      n things l\n                |                 |                 |                 |                 |      chard my l\n                |                 |                 |                 |                 |      ath thou l\n                |                 |                 |                 |                 |       showers l\n                |                 |                 |                 |                 |      ers last l\n                |                 |                 |                 |                 |      en, this l\n                |                 |                 |                 |                 |       envy of l\n                |                 |                 |                 |                 |       happier l\n                |                 |                 |                 |                 |     on,\\nThis l\n                |                 |                 |                 |                 |       with my l\n                |                 |                 |                 |                 |      g breeds l\n                |                 |                 |                 |                 |      eanness, l\n                |                 |                 |                 |                 |      ose that l\n                |                 |                 |                 |                 |      than thy l\n                |                 |                 |                 |                 |      uld have l\n                |                 |                 |                 |                 |      let this l\n                |                 |                 |                 |                 |       land by l\n                |                 |                 |                 |                 |      but this l\n                |                 |                 |                 |                 |       lunatic l\n                |                 |                 |                 |                 |      dness be l\n                |                 |                 |                 |                 |      ive that l\n                |                 |                 |                 |                 |     ;\\nWords, l\n                |                 |                 |                 |                 |     s,\\nWhich l\n                |                 |                 |                 |                 |      ich live l\n                |                 |                 |                 |                 |      as never l\n                |                 |                 |                 |                 |       even so l\n                |                 |                 |                 |                 |      sue\\nHis l\n                |                 |                 |                 |                 |       and his l\n                |                 |                 |                 |                 |      d always l\n                |                 |                 |                 |                 |      eclining l\n                |                 |                 |                 |                 |      t basely l\n                |                 |                 |                 |                 |      nd quite l\n                |                 |                 |                 |                 |     ng!\\nBut, l\n                |                 |                 |                 |                 |      yet we str\n                |                 |                 |                 |                 |     th\\nI spy l\n                |                 |                 |                 |                 |      chbishop l\n                |                 |                 |                 |                 |       majesty l\n                |                 |                 |                 |                 |      ay aside l\n                |                 |                 |                 |                 |      ch shows l\n                |                 |                 |                 |                 |     ;\\nWhich, l\n                |                 |                 |                 |                 |     e,\\nWho str\n                |                 |                 |                 |                 |      bands of l\n                |                 |                 |                 |                 |      lse hope l\n                |                 |                 |                 |                 |       are his l\n                |                 |                 |                 |                 |      make him l\n                |                 |                 |                 |                 |      ere am I l\n                |                 |                 |                 |                 |      s woeful l\n                |                 |                 |                 |                 |      thing is l\n                |                 |                 |                 |                 |      udgement l\n                |                 |                 |                 |                 |      o joy is l\n                |                 |                 |                 |                 |      he weary l\n                |                 |                 |                 |                 |       to have l\n                |                 |                 |                 |                 |      life did l\n                |                 |                 |                 |                 |      thy true l\n                |                 |                 |                 |                 |      love and l\n                |                 |                 |                 |                 |      unts our l\n                |                 |                 |                 |                 |      orbidden l\n                |                 |                 |                 |                 |       king is l\n                |                 |                 |                 |                 |      nd in my l\n                |                 |                 |                 |                 |      s uncle, l\n                |                 |                 |                 |                 |      o sue my l\n                |                 |                 |                 |                 |      d yet my l\n                |                 |                 |                 |                 |      hallenge l\n                |                 |                 |                 |                 |      onally I l\n                |                 |                 |                 |                 |     ongs\\nAnd l\n                |                 |                 |                 |                 |       all ill l\n                |                 |                 |                 |                 |     arth\\nAnd l\n                |                 |                 |                 |                 |      Rich men l\n                |                 |                 |                 |                 |      ance and l\n                |                 |                 |                 |                 |      hy glory l\n                |                 |                 |                 |                 |      imprese, l\n                |                 |                 |                 |                 |      s and my l\n                |                 |                 |                 |                 |      , fairly l\n                |                 |                 |                 |                 |     nse;\\nBut l\n                |                 |                 |                 |                 |      ed toads l\n                |                 |                 |                 |                 |      uration, l\n                |                 |                 |                 |                 |     \\nGrows str\n                |                 |                 |                 |                 |      ong and gr\n                |                 |                 |                 |                 |      be, that l\n                |                 |                 |                 |                 |      ghts the l\n                |                 |                 |                 |                 |      arts his l\n                |                 |                 |                 |                 |      etide my l\n                |                 |                 |                 |                 |       worldly l\n                |                 |                 |                 |                 |       kingdom l\n                |                 |                 |                 |                 |      And what l\n                |                 |                 |                 |                 |      bove his l\n                |                 |                 |                 |                 |      beadsmen l\n                |                 |                 |                 |                 |     ound\\nAnd l\n                |                 |                 |                 |                 |      lie full l\n                |                 |                 |                 |                 |       Bristol l\n                |                 |                 |                 |                 |      bout our l\n                |                 |                 |                 |                 |      th bread l\n                |                 |                 |                 |                 |      akness str\n                |                 |                 |                 |                 |      him\\nAnd l\n                |                 |                 |                 |                 |      ough thy l\n                |                 |                 |                 |                 |      ch didst l\n                |                 |                 |                 |                 |      o lately l\n                |                 |                 |                 |                 |      thin the l\n                |                 |                 |                 |                 |     al'd\\nAnd l\n                |                 |                 |                 |                 |     ower\\nAnd l\n                |                 |                 |                 |                 |      sh green l\n                |                 |                 |                 |                 |      looks he l\n                |                 |                 |                 |                 |      eagle's, l\n                |                 |                 |                 |                 |      and thus l\n                |                 |                 |                 |                 |      self thy l\n                |                 |                 |                 |                 |     ot,\\nThat l\n                |                 |                 |                 |                 |       every str\n                |                 |                 |                 |                 |       upon my l\n                |                 |                 |                 |                 |      crown he l\n                |                 |                 |                 |                 |      rbid our l\n                |                 |                 |                 |                 |      ill time l\n                |                 |                 |                 |                 |     ne,\\nThat l\n                |                 |                 |                 |                 |      rief, or l\n                |                 |                 |                 |                 |     s\\nAnd my l\n                |                 |                 |                 |                 |      A little l\n                |                 |                 |                 |                 |      evolting l\n                |                 |                 |                 |                 |       and you l\n                |                 |                 |                 |                 |      u make a l\n                |                 |                 |                 |                 |      mounting l\n                |                 |                 |                 |                 |       fondly, l\n                |                 |                 |                 |                 |       knee be l\n                |                 |                 |                 |                 |      edoubted l\n                |                 |                 |                 |                 |      ow their l\n                |                 |                 |                 |                 |     ,\\nWhich, l\n                |                 |                 |                 |                 |      hou, and l\n                |                 |                 |                 |                 |     ys,\\nThat l\n                |                 |                 |                 |                 |     ale\\nKeep l\n                |                 |                 |                 |                 |      preading l\n                |                 |                 |                 |                 |      ght have l\n                |                 |                 |                 |                 |      ughs may l\n                |                 |                 |                 |                 |      And am I l\n                |                 |                 |                 |                 |      serve me l\n                |                 |                 |                 |                 |      t my sad l\n                |                 |                 |                 |                 |     \\nShould gr\n                |                 |                 |                 |                 |      rth, and l\n                |                 |                 |                 |                 |      lk, that v\n                |                 |                 |                 |                 |      est this l\n                |                 |                 |                 |                 |      anderous l\n                |                 |                 |                 |                 |      that thy v\n                |                 |                 |                 |                 |       coward, l\n                |                 |                 |                 |                 |     oy!\\nThat l\n                |                 |                 |                 |                 |      ie shall l\n                |                 |                 |                 |                 |      and that l\n                |                 |                 |                 |                 |      t lie do l\n                |                 |                 |                 |                 |      athe, or l\n                |                 |                 |                 |                 |     ies,\\nAnd l\n                |                 |                 |                 |                 |      ies, and l\n                |                 |                 |                 |                 |      ely as I l\n                |                 |                 |                 |                 |      And long l\n                |                 |                 |                 |                 |      own him, l\n                |                 |                 |                 |                 |      and this l\n                |                 |                 |                 |                 |      sist it, l\n                |                 |                 |                 |                 |     ove,\\nAnd l\n                |                 |                 |                 |                 |      d little l\n                |                 |                 |                 |                 |      yet have l\n                |                 |                 |                 |                 |       bend my l\n                |                 |                 |                 |                 |      e sorrow l\n                |                 |                 |                 |                 |      en crown l\n                |                 |                 |                 |                 |       care is l\n                |                 |                 |                 |                 |      nothing gr\n                |                 |                 |                 |                 |      tand and l\n                |                 |                 |                 |                 |      hither str\n                |                 |                 |                 |                 |     ce\\nThat, l\n                |                 |                 |                 |                 |      eing so gr\n                |                 |                 |                 |                 |      ondemned l\n                |                 |                 |                 |                 |      grief be l\n                |                 |                 |                 |                 |       sudden: l\n                |                 |                 |                 |                 |      Our holy l\n                |                 |                 |                 |                 |     art?\\nThe l\n                |                 |                 |                 |                 |      thy last l\n                |                 |                 |                 |                 |      t living l\n                |                 |                 |                 |                 |      olks and l\n                |                 |                 |                 |                 |      ful ages l\n                |                 |                 |                 |                 |     one.\\nThe l\n                |                 |                 |                 |                 |      d hither l\n                |                 |                 |                 |                 |      ere some l\n                |                 |                 |                 |                 |      love but l\n                |                 |                 |                 |                 |       thither l\n                |                 |                 |                 |                 |      g sorrow l\n                |                 |                 |                 |                 |      the rest l\n                |                 |                 |                 |                 |      re did I l\n                |                 |                 |                 |                 |      y greedy l\n                |                 |                 |                 |                 |      eheaded, l\n                |                 |                 |                 |                 |      ed actor l\n                |                 |                 |                 |                 |       that is l\n                |                 |                 |                 |                 |     ruth\\nAnd l\n                |                 |                 |                 |                 |     w\\nThat str\n                |                 |                 |                 |                 |      he green l\n                |                 |                 |                 |                 |      I had as l\n                |                 |                 |                 |                 |      nd yet I l\n                |                 |                 |                 |                 |       see him l\n                |                 |                 |                 |                 |      strained l\n                |                 |                 |                 |                 |      orse the l\n                |                 |                 |                 |                 |      ares and l\n                |                 |                 |                 |                 |      ves, and l\n                |                 |                 |                 |                 |      y knees gr\n                |                 |                 |                 |                 |      ity him, l\n                |                 |                 |                 |                 |      inous, str\n                |                 |                 |                 |                 |      n this str\n                |                 |                 |                 |                 |      y shamed l\n                |                 |                 |                 |                 |      ishonour l\n                |                 |                 |                 |                 |      e in his l\n                |                 |                 |                 |                 |       traitor l\n                |                 |                 |                 |                 |     nd;\\nThis l\n                |                 |                 |                 |                 |     an!\\nLove l\n                |                 |                 |                 |                 |     \\nNo word l\n                |                 |                 |                 |                 |      -hearted l\n                |                 |                 |                 |                 |      e wistly l\n                |                 |                 |                 |                 |      ple this l\n                |                 |                 |                 |                 |       humours l\n                |                 |                 |                 |                 |      ured the l\n                |                 |                 |                 |                 |     e,\\nAnd str\n                |                 |                 |                 |                 |       finger, l\n                |                 |                 |                 |                 |      sfortune l\n                |                 |                 |                 |                 |      e gotten l\n                |                 |                 |                 |                 |     leave\\nTo l\n                |                 |                 |                 |                 |       burthen l\n                |                 |                 |                 |                 |     ll.\\nThat h\n                |                 |                 |                 |                 |      ng's own l\n                |                 |                 |                 |                 |      hat this d\n                |                 |                 |                 |                 |      ork, the l\n                |                 |                 |                 |                 |      Carlisle l\n                |                 |                 |                 |                 |       joy thy l\n                |                 |                 |                 |                 |      eathless l\n                |                 |                 |                 |                 |      urderer, l\n                |                 |                 |                 |                 |       day nor l\n                |                 |                 |                 |                 |      hile you l\n                |                 |                 |                 |                 |      take the l\n                |                 |                 |                 |                 |       by, and l\n                |                 |                 |                 |                 |      ve me my l\n                |                 |                 |                 |                 |      ds more cl\n                |                 |                 |                 |                 |      windows, l\n                |                 |                 |                 |                 |      ut new str\n                |                 |                 |                 |                 |      urs seem l\n                |                 |                 |                 |                 |       sadness l\n                |                 |                 |                 |                 |      as, that l\n                |                 |                 |                 |                 |      brawling l\n                |                 |                 |                 |                 |     \\nO heavy l\n                |                 |                 |                 |                 |     is!\\nThis l\n                |                 |                 |                 |                 |       such is l\n                |                 |                 |                 |                 |      ne: this l\n                |                 |                 |                 |                 |      dd more gr\n                |                 |                 |                 |                 |      osed you l\n                |                 |                 |                 |                 |      s fair I l\n                |                 |                 |                 |                 |     'd,\\nFrom l\n                |                 |                 |                 |                 |       bow she l\n                |                 |                 |                 |                 |      ll still l\n                |                 |                 |                 |                 |     vow\\nDo I l\n                |                 |                 |                 |                 |      ead that l\n                |                 |                 |                 |                 |      eyesight l\n                |                 |                 |                 |                 |       hopeful l\n                |                 |                 |                 |                 |      uch as I l\n                |                 |                 |                 |                 |      k heaven l\n                |                 |                 |                 |                 |      rt as do l\n                |                 |                 |                 |                 |      heel\\nOf l\n                |                 |                 |                 |                 |     see,\\nAnd l\n                |                 |                 |                 |                 |       pain is l\n                |                 |                 |                 |                 |      know the l\n                |                 |                 |                 |                 |      ers; the l\n                |                 |                 |                 |                 |      l scales l\n                |                 |                 |                 |                 |      had then l\n                |                 |                 |                 |                 |     wall;\\nMy l\n                |                 |                 |                 |                 |      I should l\n                |                 |                 |                 |                 |      oose but l\n                |                 |                 |                 |                 |      t should l\n                |                 |                 |                 |                 |       can you l\n                |                 |                 |                 |                 |       married l\n                |                 |                 |                 |                 |       another l\n                |                 |                 |                 |                 |      r volume l\n                |                 |                 |                 |                 |       unbound l\n                |                 |                 |                 |                 |      im, only l\n                |                 |                 |                 |                 |      The fish l\n                |                 |                 |                 |                 |      in gold cl\n                |                 |                 |                 |                 |      d clasps l\n                |                 |                 |                 |                 |       looking l\n                |                 |                 |                 |                 |      d bow of l\n                |                 |                 |                 |                 |      ring the l\n                |                 |                 |                 |                 |      e ladies l\n                |                 |                 |                 |                 |      bear the l\n                |                 |                 |                 |                 |     e:\\nUnder l\n                |                 |                 |                 |                 |      u burden l\n                |                 |                 |                 |                 |      t pricks l\n                |                 |                 |                 |                 |     e;\\nPrick l\n                |                 |                 |                 |                 |       wantons l\n                |                 |                 |                 |                 |      der, and l\n                |                 |                 |                 |                 |      everence l\n                |                 |                 |                 |                 |      aste our l\n                |                 |                 |                 |                 |      in vain, l\n                |                 |                 |                 |                 |      rs often l\n                |                 |                 |                 |                 |       as they l\n                |                 |                 |                 |                 |       made of l\n                |                 |                 |                 |                 |      spiders' l\n                |                 |                 |                 |                 |      one, the l\n                |                 |                 |                 |                 |       a round l\n                |                 |                 |                 |                 |       or old gr\n                |                 |                 |                 |                 |     \\nThrough l\n                |                 |                 |                 |                 |     ht,\\nO'er l\n                |                 |                 |                 |                 |      s, who str\n                |                 |                 |                 |                 |     es,\\nO'er l\n                |                 |                 |                 |                 |      ladies ' l\n                |                 |                 |                 |                 |      en maids l\n                |                 |                 |                 |                 |      them and l\n                |                 |                 |                 |                 |      despised l\n                |                 |                 |                 |                 |      upboard, l\n                |                 |                 |                 |                 |      e porter l\n                |                 |                 |                 |                 |      e longer l\n                |                 |                 |                 |                 |      ow since l\n                |                 |                 |                 |                 |     et:\\nBy'r l\n                |                 |                 |                 |                 |      s yonder l\n                |                 |                 |                 |                 |      my heart l\n                |                 |                 |                 |                 |      he, that v\n                |                 |                 |                 |                 |      tle coz, l\n                |                 |                 |                 |                 |      ears him l\n                |                 |                 |                 |                 |      t saints l\n                |                 |                 |                 |                 |      pilgrim, l\n                |                 |                 |                 |                 |      nt thou, l\n                |                 |                 |                 |                 |       have my l\n                |                 |                 |                 |                 |      on then, l\n                |                 |                 |                 |                 |      it waxes l\n                |                 |                 |                 |                 |      grave is l\n                |                 |                 |                 |                 |     \\nMy only l\n                |                 |                 |                 |                 |      t love a l\n                |                 |                 |                 |                 |       rhyme I l\n                |                 |                 |                 |                 |      eath-bed l\n                |                 |                 |                 |                 |      or which l\n                |                 |                 |                 |                 |      oved and l\n                |                 |                 |                 |                 |      charm of l\n                |                 |                 |                 |                 |      ans much l\n                |                 |                 |                 |                 |      d, on my l\n                |                 |                 |                 |                 |      way, and l\n                |                 |                 |                 |                 |      Cophetua l\n                |                 |                 |                 |                 |       scarlet l\n                |                 |                 |                 |                 |       foot, str\n                |                 |                 |                 |                 |      straight l\n                |                 |                 |                 |                 |      adjacent l\n                |                 |                 |                 |                 |       nature, l\n                |                 |                 |                 |                 |      e blind, l\n                |                 |                 |                 |                 |      hen they l\n                |                 |                 |                 |                 |      r vestal l\n                |                 |                 |                 |                 |      It is my l\n                |                 |                 |                 |                 |      it is my l\n                |                 |                 |                 |                 |      region str\n                |                 |                 |                 |                 |      ides the l\n                |                 |                 |                 |                 |      sworn my l\n                |                 |                 |                 |                 |      l me but l\n                |                 |                 |                 |                 |      h love's l\n                |                 |                 |                 |                 |      or stony l\n                |                 |                 |                 |                 |      not hold l\n                |                 |                 |                 |                 |      at dares l\n                |                 |                 |                 |                 |       swords: l\n                |                 |                 |                 |                 |      but thou l\n                |                 |                 |                 |                 |      el and I l\n                |                 |                 |                 |                 |     \\nAs that v\n                |                 |                 |                 |                 |      ost thou l\n                |                 |                 |                 |                 |       'havior l\n                |                 |                 |                 |                 |      n more str\n                |                 |                 |                 |                 |     \\nMy true l\n                |                 |                 |                 |                 |      that thy l\n                |                 |                 |                 |                 |      ve prove l\n                |                 |                 |                 |                 |      t's dear l\n                |                 |                 |                 |                 |      like the l\n                |                 |                 |                 |                 |      s bud of l\n                |                 |                 |                 |                 |      purpose, l\n                |                 |                 |                 |                 |      sea,\\nMy l\n                |                 |                 |                 |                 |      in; dear l\n                |                 |                 |                 |                 |       thee my l\n                |                 |                 |                 |                 |      uit, and l\n                |                 |                 |                 |                 |      want thy l\n                |                 |                 |                 |                 |      s toward l\n                |                 |                 |                 |                 |     oks,\\nBut l\n                |                 |                 |                 |                 |      th heavy l\n                |                 |                 |                 |                 |     oice,\\nTo l\n                |                 |                 |                 |                 |      ere Echo l\n                |                 |                 |                 |                 |      et sound l\n                |                 |                 |                 |                 |      ng how I l\n                |                 |                 |                 |                 |      it hop a l\n                |                 |                 |                 |                 |      darkness l\n                |                 |                 |                 |                 |      ace that l\n                |                 |                 |                 |                 |      rth doth l\n                |                 |                 |                 |                 |      od but str\n                |                 |                 |                 |                 |      ere care l\n                |                 |                 |                 |                 |      ll never l\n                |                 |                 |                 |                 |      y physic l\n                |                 |                 |                 |                 |      rcession l\n                |                 |                 |                 |                 |      ove then l\n                |                 |                 |                 |                 |      o season l\n                |                 |                 |                 |                 |       heaven cl\n                |                 |                 |                 |                 |       me bury l\n                |                 |                 |                 |                 |      e whom I l\n                |                 |                 |                 |                 |     ow\\nDoth gr\n                |                 |                 |                 |                 |      race and l\n                |                 |                 |                 |                 |      love for l\n                |                 |                 |                 |                 |     well\\nThy l\n                |                 |                 |                 |                 |       to pure l\n                |                 |                 |                 |                 |      swer the l\n                |                 |                 |                 |                 |      h antic, l\n                |                 |                 |                 |                 |      his roe, l\n                |                 |                 |                 |                 |      a better l\n                |                 |                 |                 |                 |     t\\nfairly l\n                |                 |                 |                 |                 |      an may str\n                |                 |                 |                 |                 |      , that str\n                |                 |                 |                 |                 |      ivelling l\n                |                 |                 |                 |                 |       love is l\n                |                 |                 |                 |                 |      hat runs l\n                |                 |                 |                 |                 |      thy tale l\n                |                 |                 |                 |                 |       ancient l\n                |                 |                 |                 |                 |      ut first l\n                |                 |                 |                 |                 |      e should l\n                |                 |                 |                 |                 |      rds made l\n                |                 |                 |                 |                 |      , had as l\n                |                 |                 |                 |                 |      , she is l\n                |                 |                 |                 |                 |      ows over l\n                |                 |                 |                 |                 |      ves draw l\n                |                 |                 |                 |                 |       pale as l\n                |                 |                 |                 |                 |     delay\\nIs l\n                |                 |                 |                 |                 |       says my l\n                |                 |                 |                 |                 |      ve says, l\n                |                 |                 |                 |                 |      mph die, l\n                |                 |                 |                 |                 |     honey\\nIs l\n                |                 |                 |                 |                 |      ly; long l\n                |                 |                 |                 |                 |      omes the l\n                |                 |                 |                 |                 |      e heap'd l\n                |                 |                 |                 |                 |      r a hair l\n                |                 |                 |                 |                 |      s of us, l\n                |                 |                 |                 |                 |      ook, and l\n                |                 |                 |                 |                 |     hee,\\nBut l\n                |                 |                 |                 |                 |      e haste, l\n                |                 |                 |                 |                 |      spective l\n                |                 |                 |                 |                 |       hit the l\n                |                 |                 |                 |                 |      ruth, or l\n                |                 |                 |                 |                 |      kill one l\n                |                 |                 |                 |                 |      what the l\n                |                 |                 |                 |                 |     end,\\nThe l\n                |                 |                 |                 |                 |      wls doth l\n                |                 |                 |                 |                 |      ith so str\n                |                 |                 |                 |                 |      curtain, l\n                |                 |                 |                 |                 |     ack,\\nAnd l\n                |                 |                 |                 |                 |       strange l\n                |                 |                 |                 |                 |      ink true l\n                |                 |                 |                 |                 |       undone, l\n                |                 |                 |                 |                 |      s, ne'er l\n                |                 |                 |                 |                 |      y dearer l\n                |                 |                 |                 |                 |      r who is l\n                |                 |                 |                 |                 |      ravening l\n                |                 |                 |                 |                 |       poor my l\n                |                 |                 |                 |                 |     in?\\nThat v\n                |                 |                 |                 |                 |      h modern l\n                |                 |                 |                 |                 |      ault our l\n                |                 |                 |                 |                 |      side the l\n                |                 |                 |                 |                 |      dog\\nAnd l\n                |                 |                 |                 |                 |       and may l\n                |                 |                 |                 |                 |      ourtship l\n                |                 |                 |                 |                 |      liet thy l\n                |                 |                 |                 |                 |     ,\\nDoting l\n                |                 |                 |                 |                 |      e me and l\n                |                 |                 |                 |                 |      oved but l\n                |                 |                 |                 |                 |      onceal'd l\n                |                 |                 |                 |                 |      ancell'd l\n                |                 |                 |                 |                 |      e deadly l\n                |                 |                 |                 |                 |       my name l\n                |                 |                 |                 |                 |      stay thy l\n                |                 |                 |                 |                 |      too that l\n                |                 |                 |                 |                 |      ape, thy l\n                |                 |                 |                 |                 |      hape and l\n                |                 |                 |                 |                 |     too:\\nThe l\n                |                 |                 |                 |                 |      lessings l\n                |                 |                 |                 |                 |       and thy l\n                |                 |                 |                 |                 |     g is!\\nMy l\n                |                 |                 |                 |                 |      ows very l\n                |                 |                 |                 |                 |      nd; 'tis l\n                |                 |                 |                 |                 |      Tis very l\n                |                 |                 |                 |                 |      Thursday l\n                |                 |                 |                 |                 |      keep no gr\n                |                 |                 |                 |                 |      ery very l\n                |                 |                 |                 |                 |       was the l\n                |                 |                 |                 |                 |      tingale: l\n                |                 |                 |                 |                 |     reaks\\nDo l\n                |                 |                 |                 |                 |      gone and l\n                |                 |                 |                 |                 |     IET:\\nYon l\n                |                 |                 |                 |                 |     rer,\\nAnd l\n                |                 |                 |                 |                 |      e ta'en, l\n                |                 |                 |                 |                 |       say the l\n                |                 |                 |                 |                 |      lark and l\n                |                 |                 |                 |                 |      arm that v\n                |                 |                 |                 |                 |      ight and l\n                |                 |                 |                 |                 |      be wary, l\n                |                 |                 |                 |                 |       window, l\n                |                 |                 |                 |                 |       in, and l\n                |                 |                 |                 |                 |      o? love, l\n                |                 |                 |                 |                 |      eetings, l\n                |                 |                 |                 |                 |      keep him l\n                |                 |                 |                 |                 |      is it my l\n                |                 |                 |                 |                 |       feeling l\n                |                 |                 |                 |                 |      feel the l\n                |                 |                 |                 |                 |       villain l\n                |                 |                 |                 |                 |      murderer l\n                |                 |                 |                 |                 |      ate doth l\n                |                 |                 |                 |                 |      reak the l\n                |                 |                 |                 |                 |      ot nor I l\n                |                 |                 |                 |                 |      is meant l\n                |                 |                 |                 |                 |      er after l\n                |                 |                 |                 |                 |      raise my l\n                |                 |                 |                 |                 |      e have I l\n                |                 |                 |                 |                 |      alk'd of l\n                |                 |                 |                 |                 |      must be, l\n                |                 |                 |                 |                 |      u that I l\n                |                 |                 |                 |                 |     ef;\\nIt str\n                |                 |                 |                 |                 |     \\nA thing l\n                |                 |                 |                 |                 |      , bid me l\n                |                 |                 |                 |                 |      r bid me l\n                |                 |                 |                 |                 |      ow night l\n                |                 |                 |                 |                 |      hat thou l\n                |                 |                 |                 |                 |      istilled l\n                |                 |                 |                 |                 |      e day of l\n                |                 |                 |                 |                 |      borrow'd l\n                |                 |                 |                 |                 |      Capulets l\n                |                 |                 |                 |                 |      eo by my l\n                |                 |                 |                 |                 |      and that v\n                |                 |                 |                 |                 |      h! and str\n                |                 |                 |                 |                 |      th merry l\n                |                 |                 |                 |                 |      youthful l\n                |                 |                 |                 |                 |       becomed l\n                |                 |                 |                 |                 |     one,\\nAnd l\n                |                 |                 |                 |                 |      not very l\n                |                 |                 |                 |                 |       shrieks l\n                |                 |                 |                 |                 |     th,\\nThat l\n                |                 |                 |                 |                 |      ight for l\n                |                 |                 |                 |                 |      ch drier l\n                |                 |                 |                 |                 |      find out l\n                |                 |                 |                 |                 |      shalt be l\n                |                 |                 |                 |                 |      rest but l\n                |                 |                 |                 |                 |       my only l\n                |                 |                 |                 |                 |      nd these l\n                |                 |                 |                 |                 |      ips have l\n                |                 |                 |                 |                 |     d:\\nDeath l\n                |                 |                 |                 |                 |      s on her l\n                |                 |                 |                 |                 |      th Death l\n                |                 |                 |                 |                 |      here she l\n                |                 |                 |                 |                 |     die,\\nAnd l\n                |                 |                 |                 |                 |       thought l\n                |                 |                 |                 |                 |       lasting l\n                |                 |                 |                 |                 |      poor and l\n                |                 |                 |                 |                 |      ife, but l\n                |                 |                 |                 |                 |      n's cure l\n                |                 |                 |                 |                 |       eternal l\n                |                 |                 |                 |                 |      ied that l\n                |                 |                 |                 |                 |      avens do l\n                |                 |                 |                 |                 |      n will I l\n                |                 |                 |                 |                 |     nswer\\nme l\n                |                 |                 |                 |                 |      elp doth l\n                |                 |                 |                 |                 |      ord sits l\n                |                 |                 |                 |                 |      reamt my l\n                |                 |                 |                 |                 |      dead man l\n                |                 |                 |                 |                 |      hed such l\n                |                 |                 |                 |                 |      es in my l\n                |                 |                 |                 |                 |      sweet is l\n                |                 |                 |                 |                 |      When but l\n                |                 |                 |                 |                 |      bring me l\n                |                 |                 |                 |                 |       doth my l\n                |                 |                 |                 |                 |      er body sl\n                |                 |                 |                 |                 |      h angels l\n                |                 |                 |                 |                 |      her laid l\n                |                 |                 |                 |                 |      h thee str\n                |                 |                 |                 |                 |       ducats: l\n                |                 |                 |                 |                 |      That the l\n                |                 |                 |                 |                 |       bare my l\n                |                 |                 |                 |                 |     ood,\\nThe l\n                |                 |                 |                 |                 |      ew-trees l\n                |                 |                 |                 |                 |     d,\\nBeing l\n                |                 |                 |                 |                 |      and true l\n                |                 |                 |                 |                 |      ake this l\n                |                 |                 |                 |                 |      it to my l\n                |                 |                 |                 |                 |      e me the l\n                |                 |                 |                 |                 |      upon thy l\n                |                 |                 |                 |                 |      ehold my l\n                |                 |                 |                 |                 |     nt\\nAnd str\n                |                 |                 |                 |                 |      der'd my l\n                |                 |                 |                 |                 |      h which gr\n                |                 |                 |                 |                 |      nce, and l\n                |                 |                 |                 |                 |      eaven, I l\n                |                 |                 |                 |                 |       full of l\n                |                 |                 |                 |                 |     .\\nDeath, l\n                |                 |                 |                 |                 |     \\nTybalt, l\n                |                 |                 |                 |                 |      that the l\n                |                 |                 |                 |                 |      ake your l\n                |                 |                 |                 |                 |      ce! and, l\n                |                 |                 |                 |                 |      nd, that v\n                |                 |                 |                 |                 |      t vainly l\n                |                 |                 |                 |                 |      ends his l\n                |                 |                 |                 |                 |     nce!\\nThe l\n                |                 |                 |                 |                 |      all, and l\n                |                 |                 |                 |                 |      ust, and l\n                |                 |                 |                 |                 |       woes do l\n                |                 |                 |                 |                 |       O wife, l\n                |                 |                 |                 |                 |     oes,\\nAnd l\n                |                 |                 |                 |                 |      ith wild l\n                |                 |                 |                 |                 |       bore my l\n                |                 |                 |                 |                 |      urn'd my l\n                |                 |                 |                 |                 |      untimely l\n                |                 |                 |                 |                 |      t my old l\n                |                 |                 |                 |                 |      severest l\n                |                 |                 |                 |                 |     nt.\\nThis l\n                |                 |                 |                 |                 |       not and l\n                |                 |                 |                 |                 |      trew his l\n                |                 |                 |                 |                 |     CE:\\nThis l\n                |                 |                 |                 |                 |      die, and l\n                |                 |                 |                 |                 |      ourge is l\n                |                 |                 |                 |                 |     too\\nHave l\n                |                 |                 |                 |                 |      away and l\n                |                 |                 |                 |                 |      l never cl\n                |                 |                 |                 |                 |      stay and l\n                |                 |                 |                 |                 |      y lords, l\n                |                 |                 |                 |                 |      r father l\n                |                 |                 |                 |                 |      ave more l\n                |                 |                 |                 |                 |      VI:\\nThe l\n                |                 |                 |                 |                 |      rotector l\n                |                 |                 |                 |                 |      ng Henry l\n                |                 |                 |                 |                 |      ear him, l\n                |                 |                 |                 |                 |      hen am I l\n                |                 |                 |                 |                 |       of many l\n                |                 |                 |                 |                 |      me he is l\n                |                 |                 |                 |                 |       this my l\n                |                 |                 |                 |                 |     come,\\nOr l\n                |                 |                 |                 |                 |      VI:\\nAnd l\n                |                 |                 |                 |                 |      dst have l\n                |                 |                 |                 |                 |      rembling l\n                |                 |                 |                 |                 |      northern l\n                |                 |                 |                 |                 |      hus do I l\n                |                 |                 |                 |                 |      own, and l\n                |                 |                 |                 |                 |     son!\\nThe l\n                |                 |                 |                 |                 |      easons str\n                |                 |                 |                 |                 |      t on his l\n                |                 |                 |                 |                 |      ancaster l\n                |                 |                 |                 |                 |      true and l\n                |                 |                 |                 |                 |      urteous, l\n                |                 |                 |                 |                 |      , tutor, l\n                |                 |                 |                 |                 |      aves thy l\n                |                 |                 |                 |                 |      rend his l\n                |                 |                 |                 |                 |      eatening l\n                |                 |                 |                 |                 |      men, and l\n                |                 |                 |                 |                 |      e, their l\n                |                 |                 |                 |                 |      accursed l\n                |                 |                 |                 |                 |     line\\nAnd l\n                |                 |                 |                 |                 |       faciant l\n                |                 |                 |                 |                 |      s blood cl\n                |                 |                 |                 |                 |      and fly, l\n                |                 |                 |                 |                 |      wind\\nOr l\n                |                 |                 |                 |                 |      enown by l\n                |                 |                 |                 |                 |      d make a l\n                |                 |                 |                 |                 |      bootless l\n                |                 |                 |                 |                 |      ke up my l\n                |                 |                 |                 |                 |       here my l\n                |                 |                 |                 |                 |      e cony str\n                |                 |                 |                 |                 |      rk! and, l\n                |                 |                 |                 |                 |      w in his l\n                |                 |                 |                 |                 |      triumph, l\n                |                 |                 |                 |                 |      rain the l\n                |                 |                 |                 |                 |      t for my l\n                |                 |                 |                 |                 |     \\nTrimm'd l\n                |                 |                 |                 |                 |      w'd some l\n                |                 |                 |                 |                 |       but one l\n                |                 |                 |                 |                 |      amp, one l\n                |                 |                 |                 |                 |      nge, the l\n                |                 |                 |                 |                 |      se heavy l\n                |                 |                 |                 |                 |       a woful l\n                |                 |                 |                 |                 |      r and my l\n                |                 |                 |                 |                 |      d many str\n                |                 |                 |                 |                 |      ame that v\n                |                 |                 |                 |                 |      th me is l\n                |                 |                 |                 |                 |       valiant l\n                |                 |                 |                 |                 |      dash our l\n                |                 |                 |                 |                 |     ing,\\nWho l\n                |                 |                 |                 |                 |       weapons l\n                |                 |                 |                 |                 |      ldiers', l\n                |                 |                 |                 |                 |     ight,\\nOr l\n                |                 |                 |                 |                 |      , he was l\n                |                 |                 |                 |                 |      w this str\n                |                 |                 |                 |                 |     ot:\\n'Tis l\n                |                 |                 |                 |                 |      ing king l\n                |                 |                 |                 |                 |      ngst the l\n                |                 |                 |                 |                 |     :\\nThen str\n                |                 |                 |                 |                 |      arriors, l\n                |                 |                 |                 |                 |      too much l\n                |                 |                 |                 |                 |       whom do l\n                |                 |                 |                 |                 |      ear doth l\n                |                 |                 |                 |                 |      apes the l\n                |                 |                 |                 |                 |      ork doth l\n                |                 |                 |                 |                 |      s issue, l\n                |                 |                 |                 |                 |      heir own l\n                |                 |                 |                 |                 |     y\\nShould l\n                |                 |                 |                 |                 |     ult,\\nAnd l\n                |                 |                 |                 |                 |       own and l\n                |                 |                 |                 |                 |      ther had l\n                |                 |                 |                 |                 |      arn this l\n                |                 |                 |                 |                 |      r kingly l\n                |                 |                 |                 |                 |      ord, and l\n                |                 |                 |                 |                 |      how now, l\n                |                 |                 |                 |                 |      lose thy l\n                |                 |                 |                 |                 |       manhood l\n                |                 |                 |                 |                 |       neither l\n                |                 |                 |                 |                 |      oads, or l\n                |                 |                 |                 |                 |     ed,\\nAnd gr\n                |                 |                 |                 |                 |      ling any l\n                |                 |                 |                 |                 |     e;\\nFor str\n                |                 |                 |                 |                 |      en! or str\n                |                 |                 |                 |                 |      r hap is l\n                |                 |                 |                 |                 |      th hath cl\n                |                 |                 |                 |                 |      ive them l\n                |                 |                 |                 |                 |       hope of l\n                |                 |                 |                 |                 |      cute the l\n                |                 |                 |                 |                 |      le fares l\n                |                 |                 |                 |                 |       growing l\n                |                 |                 |                 |                 |      his way, l\n                |                 |                 |                 |                 |      hat way, l\n                |                 |                 |                 |                 |       man may l\n                |                 |                 |                 |                 |      , what a l\n                |                 |                 |                 |                 |      hepherds l\n                |                 |                 |                 |                 |       both my l\n                |                 |                 |                 |                 |      eived my l\n                |                 |                 |                 |                 |      hands of l\n                |                 |                 |                 |                 |     !\\nWhiles l\n                |                 |                 |                 |                 |      harmless l\n                |                 |                 |                 |                 |      nd eyes, l\n                |                 |                 |                 |                 |      , if any l\n                |                 |                 |                 |                 |       life be l\n                |                 |                 |                 |                 |      ave thee l\n                |                 |                 |                 |                 |      ose, and l\n                |                 |                 |                 |                 |      ck rages l\n                |                 |                 |                 |                 |      le swarm l\n                |                 |                 |                 |                 |      d sprung l\n                |                 |                 |                 |                 |      y, nor str\n                |                 |                 |                 |                 |      athe we, l\n                |                 |                 |                 |                 |      peaceful l\n                |                 |                 |                 |                 |     en,\\nThat l\n                |                 |                 |                 |                 |      er heavy l\n                |                 |                 |                 |                 |      y groan, l\n                |                 |                 |                 |                 |       or foe, l\n                |                 |                 |                 |                 |       that he l\n                |                 |                 |                 |                 |      when his l\n                |                 |                 |                 |                 |      tain no gr\n                |                 |                 |                 |                 |      lease my l\n                |                 |                 |                 |                 |      Warwick, l\n                |                 |                 |                 |                 |      ugh this l\n                |                 |                 |                 |                 |      shoot is l\n                |                 |                 |                 |                 |       of pure l\n                |                 |                 |                 |                 |      r is but l\n                |                 |                 |                 |                 |      , on his l\n                |                 |                 |                 |                 |      eem, and l\n                |                 |                 |                 |                 |     eld\\nThis l\n                |                 |                 |                 |                 |     ain,\\nHis l\n                |                 |                 |                 |                 |      eman did l\n                |                 |                 |                 |                 |      y should l\n                |                 |                 |                 |                 |      l, dread l\n                |                 |                 |                 |                 |      , do you l\n                |                 |                 |                 |                 |      rly as I l\n                |                 |                 |                 |                 |      stops my l\n                |                 |                 |                 |                 |     rs;\\nThat l\n                |                 |                 |                 |                 |      ean such l\n                |                 |                 |                 |                 |      l never gr\n                |                 |                 |                 |                 |      d rather l\n                |                 |                 |                 |                 |      e for my l\n                |                 |                 |                 |                 |      he widow l\n                |                 |                 |                 |                 |      's a day l\n                |                 |                 |                 |                 |      a wonder l\n                |                 |                 |                 |                 |      n time I l\n                |                 |                 |                 |                 |     me--\\nThe l\n                |                 |                 |                 |                 |      g, he'll l\n                |                 |                 |                 |                 |      nd and str\n                |                 |                 |                 |                 |      ch sweet l\n                |                 |                 |                 |                 |      her soft l\n                |                 |                 |                 |                 |      shape my l\n                |                 |                 |                 |                 |      For many l\n                |                 |                 |                 |                 |      like one l\n                |                 |                 |                 |                 |      ay and str\n                |                 |                 |                 |                 |      t which gr\n                |                 |                 |                 |                 |     ld,\\nAnd, l\n                |                 |                 |                 |                 |      sail and l\n                |                 |                 |                 |                 |      ou still l\n                |                 |                 |                 |                 |       sorrows l\n                |                 |                 |                 |                 |      anointed l\n                |                 |                 |                 |                 |      just and l\n                |                 |                 |                 |                 |     bion,\\nMy l\n                |                 |                 |                 |                 |      nfeigned l\n                |                 |                 |                 |                 |      t honest l\n                |                 |                 |                 |                 |      at Henry l\n                |                 |                 |                 |                 |      ur Henry l\n                |                 |                 |                 |                 |      inst thy l\n                |                 |                 |                 |                 |       monarch l\n                |                 |                 |                 |                 |      this his l\n                |                 |                 |                 |                 |     und,\\nThe l\n                |                 |                 |                 |                 |      id which l\n                |                 |                 |                 |                 |      enry now l\n                |                 |                 |                 |                 |      y honour l\n                |                 |                 |                 |                 |      e queen, l\n                |                 |                 |                 |                 |      e, as my l\n                |                 |                 |                 |                 |      r wanton l\n                |                 |                 |                 |                 |      an for str\n                |                 |                 |                 |                 |      or Henry l\n                |                 |                 |                 |                 |      eeds are l\n                |                 |                 |                 |                 |      ere't be l\n                |                 |                 |                 |                 |      thy firm l\n                |                 |                 |                 |                 |      constant l\n                |                 |                 |                 |                 |      r safety l\n                |                 |                 |                 |                 |      tand for l\n                |                 |                 |                 |                 |     son,\\nAnd l\n                |                 |                 |                 |                 |      have had l\n                |                 |                 |                 |                 |     g,\\nDoth cl\n                |                 |                 |                 |                 |      bey, and l\n                |                 |                 |                 |                 |      ould say l\n                |                 |                 |                 |                 |      y little l\n                |                 |                 |                 |                 |      friendly v\n                |                 |                 |                 |                 |      soldiers l\n                |                 |                 |                 |                 |      ollowers l\n                |                 |                 |                 |                 |      wick may l\n                |                 |                 |                 |                 |      t hinder l\n                |                 |                 |                 |                 |     pair\\nFor l\n                |                 |                 |                 |                 |      nd great l\n                |                 |                 |                 |                 |      this way l\n                |                 |                 |                 |                 |     :\\nMaster l\n                |                 |                 |                 |                 |     ughts\\nAt l\n                |                 |                 |                 |                 |      et their l\n                |                 |                 |                 |                 |      y living l\n                |                 |                 |                 |                 |      ne thing l\n                |                 |                 |                 |                 |      anch and l\n                |                 |                 |                 |                 |      elf will l\n                |                 |                 |                 |                 |       private l\n                |                 |                 |                 |                 |      spend my l\n                |                 |                 |                 |                 |      , though l\n                |                 |                 |                 |                 |      ogether, l\n                |                 |                 |                 |                 |      s pretty l\n                |                 |                 |                 |                 |     wn,\\n'Tis l\n                |                 |                 |                 |                 |      t danger l\n                |                 |                 |                 |                 |      As every l\n                |                 |                 |                 |                 |      nd only cl\n                |                 |                 |                 |                 |       up, and l\n                |                 |                 |                 |                 |      e grow str\n                |                 |                 |                 |                 |      speaketh l\n                |                 |                 |                 |                 |      s night, l\n                |                 |                 |                 |                 |      counsel, l\n                |                 |                 |                 |                 |     I:\\nLet's l\n                |                 |                 |                 |                 |      uld they l\n                |                 |                 |                 |                 |      when the l\n                |                 |                 |                 |                 |     amb,\\nThe l\n                |                 |                 |                 |                 |     ak.\\nAnd, l\n                |                 |                 |                 |                 |      e great-gr\n                |                 |                 |                 |                 |      e is thy l\n                |                 |                 |                 |                 |      re open, l\n                |                 |                 |                 |                 |      ld their l\n                |                 |                 |                 |                 |     ICK:\\nAnd l\n                |                 |                 |                 |                 |      blood to l\n                |                 |                 |                 |                 |      res, and l\n                |                 |                 |                 |                 |      ant of str\n                |                 |                 |                 |                 |       ramping l\n                |                 |                 |                 |                 |      f all my l\n                |                 |                 |                 |                 |     st?\\nAnd, l\n                |                 |                 |                 |                 |      glues my l\n                |                 |                 |                 |                 |       sounded l\n                |                 |                 |                 |                 |     T:\\nGreat l\n                |                 |                 |                 |                 |      il their l\n                |                 |                 |                 |                 |      g-anchor l\n                |                 |                 |                 |                 |     e\\nShould l\n                |                 |                 |                 |                 |      helm and l\n                |                 |                 |                 |                 |      speak I, l\n                |                 |                 |                 |                 |     her\\nDoth l\n                |                 |                 |                 |                 |      in thee: l\n                |                 |                 |                 |                 |      bed, and l\n                |                 |                 |                 |                 |      ought no l\n                |                 |                 |                 |                 |      d he his l\n                |                 |                 |                 |                 |      gallant, l\n                |                 |                 |                 |                 |      ntutor'd l\n                |                 |                 |                 |                 |      ould she l\n                |                 |                 |                 |                 |      nks, and l\n                |                 |                 |                 |                 |      ood' was l\n                |                 |                 |                 |                 |      ath been l\n                |                 |                 |                 |                 |      oung was l\n                |                 |                 |                 |                 |      w up his l\n                |                 |                 |                 |                 |      adst not l\n                |                 |                 |                 |                 |       aboding l\n                |                 |                 |                 |                 |      ht forth l\n                |                 |                 |                 |                 |      deformed l\n                |                 |                 |                 |                 |     ump,\\nNot l\n                |                 |                 |                 |                 |      spark of l\n                |                 |                 |                 |                 |      er pity, l\n                |                 |                 |                 |                 |      t in men l\n                |                 |                 |                 |                 |       foemen, l\n                |                 |                 |                 |                 |      e kingly l\n                |                 |                 |                 |                 |      ess, and l\n                |                 |                 |                 |                 |      ucester, l\n                |                 |                 |                 |                 |       love my l\n                |                 |                 |                 |                 |      , that I l\n                |                 |                 |                 |                 |      ness the l\n                |                 |                 |                 |                 |      f gifts, l\n                |                 |                 |                 |                 |      ue their l\n                |                 |                 |                 |                 |       time as l\n                |                 |                 |                 |                 |      en-night l\n                |                 |                 |                 |                 |      hen, and l\n                |                 |                 |                 |                 |     ind\\nWhat l\n                |                 |                 |                 |                 |      s for me l\n                |                 |                 |                 |                 |      e pretty l\n                |                 |                 |                 |                 |      s not my l\n                |                 |                 |                 |                 |       twinn'd l\n                |                 |                 |                 |                 |      ued that l\n                |                 |                 |                 |                 |      t sacred l\n                |                 |                 |                 |                 |      clusion, l\n                |                 |                 |                 |                 |       stay my l\n                |                 |                 |                 |                 |      yself my l\n                |                 |                 |                 |                 |       be full l\n                |                 |                 |                 |                 |     ord,\\nAnd l\n                |                 |                 |                 |                 |     \\nIt will l\n                |                 |                 |                 |                 |      yet stay l\n                |                 |                 |                 |                 |      h inside l\n                |                 |                 |                 |                 |       a gross l\n                |                 |                 |                 |                 |      ears her l\n                |                 |                 |                 |                 |      iciously l\n                |                 |                 |                 |                 |      mine and l\n                |                 |                 |                 |                 |      iserable l\n                |                 |                 |                 |                 |       sighted l\n                |                 |                 |                 |                 |      reof the l\n                |                 |                 |                 |                 |     d me\\nCry l\n                |                 |                 |                 |                 |      at may str\n                |                 |                 |                 |                 |     ty,\\nThat l\n                |                 |                 |                 |                 |      iscovery l\n                |                 |                 |                 |                 |      ar'st my l\n                |                 |                 |                 |                 |      ainst my l\n                |                 |                 |                 |                 |      him! and l\n                |                 |                 |                 |                 |      e'er you l\n                |                 |                 |                 |                 |      h, and str\n                |                 |                 |                 |                 |      d a like l\n                |                 |                 |                 |                 |      uishment l\n                |                 |                 |                 |                 |      is their l\n                |                 |                 |                 |                 |      entle my l\n                |                 |                 |                 |                 |       heavens l\n                |                 |                 |                 |                 |      le grief l\n                |                 |                 |                 |                 |       dare my l\n                |                 |                 |                 |                 |       my life l\n                |                 |                 |                 |                 |      where\\nI l\n                |                 |                 |                 |                 |     \\nI would l\n                |                 |                 |                 |                 |      need no gr\n                |                 |                 |                 |                 |       a truth l\n                |                 |                 |                 |                 |     ter,\\nThe l\n                |                 |                 |                 |                 |     re,\\nThat l\n                |                 |                 |                 |                 |     hence\\nBe l\n                |                 |                 |                 |                 |      a worthy l\n                |                 |                 |                 |                 |       one so gr\n                |                 |                 |                 |                 |      r tender l\n                |                 |                 |                 |                 |      usty and l\n                |                 |                 |                 |                 |      s unsafe l\n                |                 |                 |                 |                 |      -mouth'd l\n                |                 |                 |                 |                 |       no lady l\n                |                 |                 |                 |                 |      y bosom, l\n                |                 |                 |                 |                 |     lank\\nAnd l\n                |                 |                 |                 |                 |      ownright l\n                |                 |                 |                 |                 |       queen's l\n                |                 |                 |                 |                 |      at creep l\n                |                 |                 |                 |                 |      udacious l\n                |                 |                 |                 |                 |      e rein I l\n                |                 |                 |                 |                 |      gue, who l\n                |                 |                 |                 |                 |      print be l\n                |                 |                 |                 |                 |      ow in't, l\n                |                 |                 |                 |                 |     hag\\nAnd, l\n                |                 |                 |                 |                 |      , you'll l\n                |                 |                 |                 |                 |      nnatural l\n                |                 |                 |                 |                 |      eize thy l\n                |                 |                 |                 |                 |      s brat's l\n                |                 |                 |                 |                 |      pawn the l\n                |                 |                 |                 |                 |      h I have l\n                |                 |                 |                 |                 |      han this d\n                |                 |                 |                 |                 |      are both l\n                |                 |                 |                 |                 |      disloyal l\n                |                 |                 |                 |                 |      hile she l\n                |                 |                 |                 |                 |      I little l\n                |                 |                 |                 |                 |       my past l\n                |                 |                 |                 |                 |      talk for l\n                |                 |                 |                 |                 |     e\\nA lady l\n                |                 |                 |                 |                 |      ast out, l\n                |                 |                 |                 |                 |      rt of my l\n                |                 |                 |                 |                 |       barr'd, l\n                |                 |                 |                 |                 |      ength of l\n                |                 |                 |                 |                 |      my lace, l\n                |                 |                 |                 |                 |       none or l\n                |                 |                 |                 |                 |      directly l\n                |                 |                 |                 |                 |      cture or l\n                |                 |                 |                 |                 |     man:\\nThe l\n                |                 |                 |                 |                 |      f my own l\n                |                 |                 |                 |                 |     ,\\nWho is l\n                |                 |                 |                 |                 |      ere they l\n                |                 |                 |                 |                 |      Come and l\n                |                 |                 |                 |                 |      he skies l\n                |                 |                 |                 |                 |      nd: 'tis l\n                |                 |                 |                 |                 |      ke to be l\n                |                 |                 |                 |                 |      weep and l\n                |                 |                 |                 |                 |       counted l\n                |                 |                 |                 |                 |      ee by my l\n                |                 |                 |                 |                 |     l!\\nThere l\n                |                 |                 |                 |                 |       roaring l\n                |                 |                 |                 |                 |      y of him l\n                |                 |                 |                 |                 |      which is l\n                |                 |                 |                 |                 |      ears and l\n                |                 |                 |                 |                 |      'erthrow l\n                |                 |                 |                 |                 |       Leontes l\n                |                 |                 |                 |                 |      e afresh l\n                |                 |                 |                 |                 |      ed their v\n                |                 |                 |                 |                 |      t and is l\n                |                 |                 |                 |                 |     ing.\\nThe l\n                |                 |                 |                 |                 |      may have l\n                |                 |                 |                 |                 |       builds, l\n                |                 |                 |                 |                 |     o\\nlesser l\n                |                 |                 |                 |                 |       and she l\n                |                 |                 |                 |                 |      sir, the l\n                |                 |                 |                 |                 |     s he\\nhas l\n                |                 |                 |                 |                 |      where my l\n                |                 |                 |                 |                 |      land and l\n                |                 |                 |                 |                 |      d living l\n                |                 |                 |                 |                 |      had\\nbut l\n                |                 |                 |                 |                 |     \\nOr I my l\n                |                 |                 |                 |                 |     tly,\\nAnd l\n                |                 |                 |                 |                 |      old wife l\n                |                 |                 |                 |                 |      ns and str\n                |                 |                 |                 |                 |      And only l\n                |                 |                 |                 |                 |      enheads gr\n                |                 |                 |                 |                 |      ted thou l\n                |                 |                 |                 |                 |      than the l\n                |                 |                 |                 |                 |       these I l\n                |                 |                 |                 |                 |      have\\nAs l\n                |                 |                 |                 |                 |      rettiest l\n                |                 |                 |                 |                 |      low-born l\n                |                 |                 |                 |                 |      er blood l\n                |                 |                 |                 |                 |      me on, str\n                |                 |                 |                 |                 |     oose\\nWho l\n                |                 |                 |                 |                 |     icles\\nDo l\n                |                 |                 |                 |                 |      ambrics, l\n                |                 |                 |                 |                 |     ,\\nFor my l\n                |                 |                 |                 |                 |      at maids l\n                |                 |                 |                 |                 |     buy;\\nBuy l\n                |                 |                 |                 |                 |      there be l\n                |                 |                 |                 |                 |       manners l\n                |                 |                 |                 |                 |      way\\nand l\n                |                 |                 |                 |                 |       I carry l\n                |                 |                 |                 |                 |       Pedlar, l\n                |                 |                 |                 |                 |     tape,\\nOr l\n                |                 |                 |                 |                 |      pleased, l\n                |                 |                 |                 |                 |      d handed l\n                |                 |                 |                 |                 |       lack of l\n                |                 |                 |                 |                 |      ifts she l\n                |                 |                 |                 |                 |      ck'd and l\n                |                 |                 |                 |                 |      hout her l\n                |                 |                 |                 |                 |      rten thy l\n                |                 |                 |                 |                 |      se rural l\n                |                 |                 |                 |                 |      roud and l\n                |                 |                 |                 |                 |     owing\\nMy l\n                |                 |                 |                 |                 |      ty would l\n                |                 |                 |                 |                 |      t up thy l\n                |                 |                 |                 |                 |      For this d\n                |                 |                 |                 |                 |     ce,\\nOr str\n                |                 |                 |                 |                 |      , do him l\n                |                 |                 |                 |                 |       think I l\n                |                 |                 |                 |                 |      ou'll be l\n                |                 |                 |                 |                 |      urnish'd l\n                |                 |                 |                 |                 |     s\\nDo all l\n                |                 |                 |                 |                 |      , but my l\n                |                 |                 |                 |                 |     ng\\ndone, l\n                |                 |                 |                 |                 |      iers the l\n                |                 |                 |                 |                 |      e us the l\n                |                 |                 |                 |                 |      ship had l\n                |                 |                 |                 |                 |      nd-fast, l\n                |                 |                 |                 |                 |      will but l\n                |                 |                 |                 |                 |      nothing, l\n                |                 |                 |                 |                 |      consider l\n                |                 |                 |                 |                 |      ncertain l\n                |                 |                 |                 |                 |      Till his l\n                |                 |                 |                 |                 |     unsel\\nMy l\n                |                 |                 |                 |                 |     ssor\\nWas l\n                |                 |                 |                 |                 |      men will l\n                |                 |                 |                 |                 |      ith this l\n                |                 |                 |                 |                 |      d then I l\n                |                 |                 |                 |                 |      esire my l\n                |                 |                 |                 |                 |     self\\nThe l\n                |                 |                 |                 |                 |      ear them l\n                |                 |                 |                 |                 |      honour'd l\n                |                 |                 |                 |                 |      ar'd and l\n                |                 |                 |                 |                 |     te,\\nHave l\n                |                 |                 |                 |                 |      now have l\n                |                 |                 |                 |                 |       seeming l\n                |                 |                 |                 |                 |      high and l\n                |                 |                 |                 |                 |      ange our l\n                |                 |                 |                 |                 |      umbness, l\n                |                 |                 |                 |                 |      in their v\n                |                 |                 |                 |                 |      it,\\nthe l\n                |                 |                 |                 |                 |      tands by l\n                |                 |                 |                 |                 |      r, which l\n                |                 |                 |                 |                 |      ven then l\n                |                 |                 |                 |                 |     anger\\nof l\n                |                 |                 |                 |                 |      ssed and l\n                |                 |                 |                 |                 |       himself l\n                |                 |                 |                 |                 |     :\\nWe may l\n                |                 |                 |                 |                 |      ere hard l\n                |                 |                 |                 |                 |      mend thy l\n                |                 |                 |                 |                 |     never\\nMy l\n                |                 |                 |                 |                 |      life may l\n                |                 |                 |                 |                 |      her dead l\n                |                 |                 |                 |                 |       life as l\n                |                 |                 |                 |                 |     e;\\nWhich l\n                |                 |                 |                 |                 |     r\\nAs she l\n                |                 |                 |                 |                 |      ith such l\n                |                 |                 |                 |                 |      ty, warm l\n                |                 |                 |                 |                 |      Standing l\n                |                 |                 |                 |                 |      too sore l\n                |                 |                 |                 |                 |       so long l\n                |                 |                 |                 |                 |      ze on't, l\n                |                 |                 |                 |                 |      The very l\n                |                 |                 |                 |                 |     roach;\\nStr\n                |                 |                 |                 |                 |      all that l\n                |                 |                 |                 |                 |     him\\nDear l\n                |                 |                 |                 |                 |      spell is l\n                |                 |                 |                 |                 |      e magic, l\n                |                 |                 |                 |                 |       to life l\n                |                 |                 |                 |                 |      t she is l\n                |                 |                 |                 |                 |      ears she l\n                |                 |                 |                 |                 |      . Mark a l\n                |                 |                 |                 |                 |      ou gods, l\n                |                 |                 |                 |                 |      ill I am l\n                |                 |                 |                 |                 |      e we may l\n                |                 |                 |                 |                 |       hastily l\n                |                 |                 |                 |                 |      hat, the l\n                |                 |                 |                 |                 |     ble,\\nAnd l\n                |                 |                 |                 |                 |      with our l\n                |                 |                 |                 |                 |      re never l\n                |                 |                 |                 |                 |     nce\\nBut, l\n                |                 |                 |                 |                 |      self and l\n                |                 |                 |                 |                 |      , and do l\n                |                 |                 |                 |                 |      lify the l\n                |                 |                 |                 |                 |     ll\\nTheir l\n                |                 |                 |                 |                 |     ns me\\nTo l\n                |                 |                 |                 |                 |      ncludest l\n                |                 |                 |                 |                 |      ween the l\n                |                 |                 |                 |                 |       art the l\n                |                 |                 |                 |                 |      nsellors l\n                |                 |                 |                 |                 |      nciation l\n                |                 |                 |                 |                 |      command, l\n                |                 |                 |                 |                 |      ch have, l\n                |                 |                 |                 |                 |      oolishly l\n                |                 |                 |                 |                 |      ave ever l\n                |                 |                 |                 |                 |      oved the l\n                |                 |                 |                 |                 |      man of str\n                |                 |                 |                 |                 |      t biting l\n                |                 |                 |                 |                 |      'ergrown l\n                |                 |                 |                 |                 |      our more l\n                |                 |                 |                 |                 |      seem the l\n                |                 |                 |                 |                 |      s very str\n                |                 |                 |                 |                 |      ut we do l\n                |                 |                 |                 |                 |      ith full l\n                |                 |                 |                 |                 |       use and l\n                |                 |                 |                 |                 |      have for l\n                |                 |                 |                 |                 |      follows cl\n                |                 |                 |                 |                 |      seek his l\n                |                 |                 |                 |                 |       make us l\n                |                 |                 |                 |                 |     elo,\\nAnd l\n                |                 |                 |                 |                 |     rey,\\nAnd l\n                |                 |                 |                 |                 |      e most str\n                |                 |                 |                 |                 |      nfessor, l\n                |                 |                 |                 |                 |      ied, and l\n                |                 |                 |                 |                 |      his will l\n                |                 |                 |                 |                 |      ghts are l\n                |                 |                 |                 |                 |      couldst, l\n                |                 |                 |                 |                 |      one, and l\n                |                 |                 |                 |                 |      at would l\n                |                 |                 |                 |                 |      ould you l\n                |                 |                 |                 |                 |     :\\nIf the l\n                |                 |                 |                 |                 |     \\nBut the l\n                |                 |                 |                 |                 |      t severe l\n                |                 |                 |                 |                 |      ve slipt l\n                |                 |                 |                 |                 |     ELO:\\nThe l\n                |                 |                 |                 |                 |      essence, l\n                |                 |                 |                 |                 |      emselves l\n                |                 |                 |                 |                 |     w\\nThat's l\n                |                 |                 |                 |                 |      I\\nThat, l\n                |                 |                 |                 |                 |      n loving v\n                |                 |                 |                 |                 |     right\\nTo l\n                |                 |                 |                 |                 |      l gladly l\n                |                 |                 |                 |                 |      es, as I l\n                |                 |                 |                 |                 |      njurious l\n                |                 |                 |                 |                 |     udied\\nIs l\n                |                 |                 |                 |                 |      untaught l\n                |                 |                 |                 |                 |      ost just l\n                |                 |                 |                 |                 |      recorded l\n                |                 |                 |                 |                 |     ,\\nHeaven l\n                |                 |                 |                 |                 |     od,\\nBut gr\n                |                 |                 |                 |                 |      save his l\n                |                 |                 |                 |                 |      building l\n                |                 |                 |                 |                 |     s,\\nAnd str\n                |                 |                 |                 |                 |     bed\\nThat l\n                |                 |                 |                 |                 |      eem'd of l\n                |                 |                 |                 |                 |      make the l\n                |                 |                 |                 |                 |      I dearly l\n                |                 |                 |                 |                 |      destined l\n                |                 |                 |                 |                 |      e former l\n                |                 |                 |                 |                 |      ceive, I l\n                |                 |                 |                 |                 |      ther did l\n                |                 |                 |                 |                 |      ding the l\n                |                 |                 |                 |                 |      death or l\n                |                 |                 |                 |                 |      fection, l\n                |                 |                 |                 |                 |      th, find l\n                |                 |                 |                 |                 |      rlasting l\n                |                 |                 |                 |                 |       cunning l\n                |                 |                 |                 |                 |      t but my l\n                |                 |                 |                 |                 |      bite the l\n                |                 |                 |                 |                 |      d shamed l\n                |                 |                 |                 |                 |      quire is l\n                |                 |                 |                 |                 |       open my l\n                |                 |                 |                 |                 |      wronged\\nl\n                |                 |                 |                 |                 |      he angry l\n                |                 |                 |                 |                 |      ract and l\n                |                 |                 |                 |                 |     \\nit will l\n                |                 |                 |                 |                 |      this man l\n                |                 |                 |                 |                 |      nd women l\n                |                 |                 |                 |                 |      nded the l\n                |                 |                 |                 |                 |      elf, and l\n                |                 |                 |                 |                 |      ieve thy l\n                |                 |                 |                 |                 |      art thou l\n                |                 |                 |                 |                 |      tle more l\n                |                 |                 |                 |                 |      ter this d\n                |                 |                 |                 |                 |      away the l\n                |                 |                 |                 |                 |      e very str\n                |                 |                 |                 |                 |      m, and I l\n                |                 |                 |                 |                 |     h\\ndearer l\n                |                 |                 |                 |                 |       he may, l\n                |                 |                 |                 |                 |      if I may l\n                |                 |                 |                 |                 |      n do you l\n                |                 |                 |                 |                 |      they are l\n                |                 |                 |                 |                 |      ght nor gr\n                |                 |                 |                 |                 |      ing so str\n                |                 |                 |                 |                 |      s order, l\n                |                 |                 |                 |                 |       other str\n                |                 |                 |                 |                 |     ous;\\nand l\n                |                 |                 |                 |                 |       his own l\n                |                 |                 |                 |                 |      vice and l\n                |                 |                 |                 |                 |     \\nHow may l\n                |                 |                 |                 |                 |      ht shall l\n                |                 |                 |                 |                 |      arance a l\n                |                 |                 |                 |                 |      e garden l\n                |                 |                 |                 |                 |      sire the l\n                |                 |                 |                 |                 |      soft and l\n                |                 |                 |                 |                 |      s office l\n                |                 |                 |                 |                 |      ear, and l\n                |                 |                 |                 |                 |      hanging\\nl\n                |                 |                 |                 |                 |     \\nAs fast l\n                |                 |                 |                 |                 |      uiltless l\n                |                 |                 |                 |                 |      roke and l\n                |                 |                 |                 |                 |       had the l\n                |                 |                 |                 |                 |      give him l\n                |                 |                 |                 |                 |      the hour l\n                |                 |                 |                 |                 |      receives l\n                |                 |                 |                 |                 |      t killed l\n                |                 |                 |                 |                 |      ar his str\n                |                 |                 |                 |                 |       I write l\n                |                 |                 |                 |                 |      en it is l\n                |                 |                 |                 |                 |     IO:\\nThis l\n                |                 |                 |                 |                 |      , he had l\n                |                 |                 |                 |                 |      rvellous l\n                |                 |                 |                 |                 |      ave very l\n                |                 |                 |                 |                 |      how much l\n                |                 |                 |                 |                 |      r maiden l\n                |                 |                 |                 |                 |      t he had l\n                |                 |                 |                 |                 |      give the l\n                |                 |                 |                 |                 |     ds\\nWill gr\n                |                 |                 |                 |                 |      tly I am l\n                |                 |                 |                 |                 |      t speaks l\n                |                 |                 |                 |                 |     and,\\nAnd l\n                |                 |                 |                 |                 |      ly and str\n                |                 |                 |                 |                 |      it not str\n                |                 |                 |                 |                 |      ge and str\n                |                 |                 |                 |                 |     ation\\nTo l\n                |                 |                 |                 |                 |      emperate l\n                |                 |                 |                 |                 |       he been l\n                |                 |                 |                 |                 |       sick my l\n                |                 |                 |                 |                 |      d friar, l\n                |                 |                 |                 |                 |      s him my l\n                |                 |                 |                 |                 |      orth the l\n                |                 |                 |                 |                 |      ay night l\n                |                 |                 |                 |                 |      ile will l\n                |                 |                 |                 |                 |      omen are l\n                |                 |                 |                 |                 |      seek the l\n                |                 |                 |                 |                 |      ade me a l\n                |                 |                 |                 |                 |     es\\nStand l\n                |                 |                 |                 |                 |      rotest I l\n                |                 |                 |                 |                 |      uke as I l\n                |                 |                 |                 |                 |      d-pated, l\n                |                 |                 |                 |                 |      d, lying r\n                |                 |                 |                 |                 |      r grace, l\n                |                 |                 |                 |                 |     wer\\nThan l\n                |                 |                 |                 |                 |     im!\\nThat l\n                |                 |                 |                 |                 |      s better l\n                |                 |                 |                 |                 |      at which l\n                |                 |                 |                 |                 |      ste, and l\n                |                 |                 |                 |                 |       answers l\n                |                 |                 |                 |                 |      oth quit l\n                |                 |                 |                 |                 |      ach your l\n                |                 |                 |                 |                 |      d all my l\n                |                 |                 |                 |                 |      u all my l\n                |                 |                 |                 |                 |      l he did l\n                |                 |                 |                 |                 |     ood.\\nAnd l\n                |                 |                 |                 |                 |      rest thy l\n                |                 |                 |                 |                 |      h child, l\n                |                 |                 |                 |                 |      wrong'd, l\n                |                 |                 |                 |                 |     r him\\nby l\n                |                 |                 |                 |                 |      e merest l\n                |                 |                 |                 |                 |      well and l\n                |                 |                 |                 |                 |      swine he l\n                |                 |                 |                 |                 |      foul and l\n                |                 |                 |                 |                 |      that his l\n                |                 |                 |                 |                 |      a mighty l\n                |                 |                 |                 |                 |      ll suits l\n                |                 |                 |                 |                 |      l win my l\n                |                 |                 |                 |                 |      drunkard l\n                |                 |                 |                 |                 |      ith soft l\n                |                 |                 |                 |                 |      ngue and l\n                |                 |                 |                 |                 |      ein your l\n                |                 |                 |                 |                 |      ck in my l\n                |                 |                 |                 |                 |     ngs\\nthan l\n                |                 |                 |                 |                 |      my\\ntoes l\n                |                 |                 |                 |                 |      e abject l\n                |                 |                 |                 |                 |       morning l\n                |                 |                 |                 |                 |      I such a l\n                |                 |                 |                 |                 |      ough you l\n                |                 |                 |                 |                 |      d and my l\n                |                 |                 |                 |                 |      le lord, l\n                |                 |                 |                 |                 |      would be l\n                |                 |                 |                 |                 |      engthens l\n                |                 |                 |                 |                 |     side\\nand l\n                |                 |                 |                 |                 |      e'er the l\n                |                 |                 |                 |                 |      ind, and l\n                |                 |                 |                 |                 |      u. Their l\n                |                 |                 |                 |                 |      ny means l\n                |                 |                 |                 |                 |      dure her l\n                |                 |                 |                 |                 |      an could l\n                |                 |                 |                 |                 |     ble\\nThat l\n                |                 |                 |                 |                 |      sible or l\n                |                 |                 |                 |                 |      mercies, l\n                |                 |                 |                 |                 |      er coral l\n                |                 |                 |                 |                 |      r can we l\n                |                 |                 |                 |                 |      hat and cl\n                |                 |                 |                 |                 |      o well I l\n                |                 |                 |                 |                 |      Lucentio l\n                |                 |                 |                 |                 |      rentius' l\n                |                 |                 |                 |                 |      chide as l\n                |                 |                 |                 |                 |      e humour l\n                |                 |                 |                 |                 |      would do l\n                |                 |                 |                 |                 |      el of my l\n                |                 |                 |                 |                 |      ls in my l\n                |                 |                 |                 |                 |      eave and l\n                |                 |                 |                 |                 |      ng folks l\n                |                 |                 |                 |                 |       master, l\n                |                 |                 |                 |                 |      al of my l\n                |                 |                 |                 |                 |      no other l\n                |                 |                 |                 |                 |     too,\\nAnd l\n                |                 |                 |                 |                 |     :\\nO this l\n                |                 |                 |                 |                 |      vent our l\n                |                 |                 |                 |                 |       fortune l\n                |                 |                 |                 |                 |      days and l\n                |                 |                 |                 |                 |      , such a l\n                |                 |                 |                 |                 |      nk you a l\n                |                 |                 |                 |                 |      me heard l\n                |                 |                 |                 |                 |     nds\\nRage l\n                |                 |                 |                 |                 |      ondello, l\n                |                 |                 |                 |                 |      e choice l\n                |                 |                 |                 |                 |      ave that l\n                |                 |                 |                 |                 |     les;\\nAnd l\n                |                 |                 |                 |                 |     n law,\\nStr\n                |                 |                 |                 |                 |      Fellows, l\n                |                 |                 |                 |                 |      else you l\n                |                 |                 |                 |                 |      nd other l\n                |                 |                 |                 |                 |     er.\\nThis l\n                |                 |                 |                 |                 |      ughter's l\n                |                 |                 |                 |                 |      lf of my l\n                |                 |                 |                 |                 |      n all my l\n                |                 |                 |                 |                 |      ands and l\n                |                 |                 |                 |                 |     :\\nThough l\n                |                 |                 |                 |                 |      ut never l\n                |                 |                 |                 |                 |      roke the l\n                |                 |                 |                 |                 |      pillory, l\n                |                 |                 |                 |                 |      ough the l\n                |                 |                 |                 |                 |      O, how I l\n                |                 |                 |                 |                 |      oung and l\n                |                 |                 |                 |                 |      'en, and l\n                |                 |                 |                 |                 |      ian, and l\n                |                 |                 |                 |                 |      And then l\n                |                 |                 |                 |                 |       make me l\n                |                 |                 |                 |                 |      much she l\n                |                 |                 |                 |                 |      ommodity l\n                |                 |                 |                 |                 |      e day we l\n                |                 |                 |                 |                 |      ong have l\n                |                 |                 |                 |                 |      ard, thy l\n                |                 |                 |                 |                 |      d this str\n                |                 |                 |                 |                 |     es,\\nFine l\n                |                 |                 |                 |                 |      fruitful l\n                |                 |                 |                 |                 |      t now is l\n                |                 |                 |                 |                 |     st;\\nAnd, l\n                |                 |                 |                 |                 |     mes,\\nBut l\n                |                 |                 |                 |                 |      learn my l\n                |                 |                 |                 |                 |     les;\\nHis l\n                |                 |                 |                 |                 |     :\\nYou'll l\n                |                 |                 |                 |                 |      eave his l\n                |                 |                 |                 |                 |       left we l\n                |                 |                 |                 |                 |      court my l\n                |                 |                 |                 |                 |      my gamut l\n                |                 |                 |                 |                 |      hinks he l\n                |                 |                 |                 |                 |      hee that l\n                |                 |                 |                 |                 |     \\nanother l\n                |                 |                 |                 |                 |      ders and l\n                |                 |                 |                 |                 |      f sheeps l\n                |                 |                 |                 |                 |      sir, his l\n                |                 |                 |                 |                 |     arisoned\\nl\n                |                 |                 |                 |                 |      k on one l\n                |                 |                 |                 |                 |      and blue l\n                |                 |                 |                 |                 |       at more l\n                |                 |                 |                 |                 |     adua\\nOf gr\n                |                 |                 |                 |                 |      e priest l\n                |                 |                 |                 |                 |       'if any l\n                |                 |                 |                 |                 |     lf:\\n'Tis l\n                |                 |                 |                 |                 |       my very l\n                |                 |                 |                 |                 |       carpets l\n                |                 |                 |                 |                 |      th their l\n                |                 |                 |                 |                 |      eir left l\n                |                 |                 |                 |                 |      e is the l\n                |                 |                 |                 |                 |      ife that l\n                |                 |                 |                 |                 |      t late I l\n                |                 |                 |                 |                 |      will you l\n                |                 |                 |                 |                 |      he never l\n                |                 |                 |                 |                 |     rew,\\nNow l\n                |                 |                 |                 |                 |      spiteful l\n                |                 |                 |                 |                 |       hath as l\n                |                 |                 |                 |                 |       as long l\n                |                 |                 |                 |                 |      s I have l\n                |                 |                 |                 |                 |      eauteous l\n                |                 |                 |                 |                 |      e surely l\n                |                 |                 |                 |                 |      and then l\n                |                 |                 |                 |                 |       lend me l\n                |                 |                 |                 |                 |      life and l\n                |                 |                 |                 |                 |      e way, I l\n                |                 |                 |                 |                 |      iddy for l\n                |                 |                 |                 |                 |       prithee l\n                |                 |                 |                 |                 |      eef, and l\n                |                 |                 |                 |                 |      ie! 'tis l\n                |                 |                 |                 |                 |      e not, I l\n                |                 |                 |                 |                 |       tailor, l\n                |                 |                 |                 |                 |      ve? 'tis l\n                |                 |                 |                 |                 |      , carved l\n                |                 |                 |                 |                 |      lst thou l\n                |                 |                 |                 |                 |      r I said l\n                |                 |                 |                 |                 |      him this d\n                |                 |                 |                 |                 |     ere\\nDoth l\n                |                 |                 |                 |                 |     is,\\nThat l\n                |                 |                 |                 |                 |      en at my l\n                |                 |                 |                 |                 |      y father l\n                |                 |                 |                 |                 |      wink and l\n                |                 |                 |                 |                 |       but has l\n                |                 |                 |                 |                 |      then you l\n                |                 |                 |                 |                 |      ything I l\n                |                 |                 |                 |                 |      ood old gr\n                |                 |                 |                 |                 |      e, which l\n                |                 |                 |                 |                 |      d now by l\n                |                 |                 |                 |                 |      d here I l\n                |                 |                 |                 |                 |      ong as I l\n                |                 |                 |                 |                 |       the man l\n                |                 |                 |                 |                 |       sirrah, l\n                |                 |                 |                 |                 |      ipp'd me l\n                |                 |                 |                 |                 |      des, and l\n                |                 |                 |                 |                 |      nd quiet l\n                |                 |                 |                 |                 |      we their l\n                |                 |                 |                 |                 |      ound thy l\n                |                 |                 |                 |                 |      moved is l\n                |                 |                 |                 |                 |      d is thy l\n                |                 |                 |                 |                 |      ord, thy l\n                |                 |                 |                 |                 |       painful l\n                |                 |                 |                 |                 |     ands\\nBut l\n                |                 |                 |                 |                 |      r loving l\n                |                 |                 |                 |                 |      e indeed l\n                |                 |                 |                 |                 |      ays, old l\n                |                 |                 |                 |                 |       mar our l\n                |                 |                 |                 |                 |      lived so l\n                |                 |                 |                 |                 |      own doth l\n                |                 |                 |                 |                 |      ! lower, l\n                |                 |                 |                 |                 |      l and as l\n                |                 |                 |                 |                 |       ground, l\n                |                 |                 |                 |                 |     pp'd\\nAnd l\n                |                 |                 |                 |                 |      hat this l\n                |                 |                 |                 |                 |      ing thus l\n                |                 |                 |                 |                 |      e exact, l\n                |                 |                 |                 |                 |       dukedom l\n                |                 |                 |                 |                 |      ous army l\n                |                 |                 |                 |                 |      dear the l\n                |                 |                 |                 |                 |      d us but l\n                |                 |                 |                 |                 |      arments, l\n                |                 |                 |                 |                 |      nowing I l\n                |                 |                 |                 |                 |      n have I l\n                |                 |                 |                 |                 |     ;\\nWhom I l\n                |                 |                 |                 |                 |      suffer'd l\n                |                 |                 |                 |                 |      hout or gr\n                |                 |                 |                 |                 |      udge or gr\n                |                 |                 |                 |                 |      take her l\n                |                 |                 |                 |                 |      here was l\n                |                 |                 |                 |                 |     died\\nAnd l\n                |                 |                 |                 |                 |       she did l\n                |                 |                 |                 |                 |      pine and l\n                |                 |                 |                 |                 |       thyself l\n                |                 |                 |                 |                 |      e bigger l\n                |                 |                 |                 |                 |       how the l\n                |                 |                 |                 |                 |      s, bats, l\n                |                 |                 |                 |                 |      are, and l\n                |                 |                 |                 |                 |      t gabble l\n                |                 |                 |                 |                 |      aught me l\n                |                 |                 |                 |                 |      ch and str\n                |                 |                 |                 |                 |     ws\\nAnd str\n                |                 |                 |                 |                 |      he prize l\n                |                 |                 |                 |                 |      f it had l\n                |                 |                 |                 |                 |      none, or l\n                |                 |                 |                 |                 |      lush and l\n                |                 |                 |                 |                 |      he grass l\n                |                 |                 |                 |                 |      s never gr\n                |                 |                 |                 |                 |      y son is l\n                |                 |                 |                 |                 |      , he may l\n                |                 |                 |                 |                 |      alive to l\n                |                 |                 |                 |                 |      is great l\n                |                 |                 |                 |                 |      t rather l\n                |                 |                 |                 |                 |       between l\n                |                 |                 |                 |                 |      eak doth l\n                |                 |                 |                 |                 |      bound of l\n                |                 |                 |                 |                 |     IO:\\nLong l\n                |                 |                 |                 |                 |      d nimble l\n                |                 |                 |                 |                 |      inue and l\n                |                 |                 |                 |                 |      Will you l\n                |                 |                 |                 |                 |      a sleepy l\n\n\n\ndef sim_outputs(q_idx: int, ffwd_freqs: torch.Tensor, coeffs: torch.Tensor):\n    total_freqs = (ffwd_freqs * coeffs).sum(dim=0)\n    total_probs = total_freqs / total_freqs.sum(dim=-1, keepdim=True)\n    output = top_nonzero_tokens(total_probs[q_idx], encoding_helpers.tokenizer.itos)[:10]\n    return output\n\n\nmodel_outputs[57], sim_outputs(57, ffwd_freqs, hand_rolled_coeffs)\n\n([('i', 0.43703654408454895),\n  ('o', 0.2035481184720993),\n  ('a', 0.19454693794250488),\n  ('e', 0.1602260321378708),\n  ('u', 0.003970918711274862),\n  ('l', 0.00017817218031268567),\n  ('y', 0.0001514967589173466),\n  ('r', 0.00012517001596279442),\n  ('h', 5.490732655744068e-05),\n  ('w', 3.902084790752269e-05)],\n [('i', 0.3591221272945404),\n  ('o', 0.26828813552856445),\n  ('a', 0.2134469449520111),\n  ('e', 0.14724503457546234),\n  ('u', 0.011856441386044025),\n  ('y', 4.131164314458147e-05)])\n\n\n\nq_idx=68\nprint_results(q_idx=q_idx-q_idx_start, query_string=strings20k[q_idx], matching_strings=matching_strings)\n\nQuery string: ided to ex\n     Give me ex |      Give me ex |      ing; or ex |      some to ex |      some to ex |      some to ex\n     some to ex |     st;\\nThy ex |      Give me ex |      hus, to ex |      hus, to ex |      hus, to ex\n     hus, to ex |      some to ex |      some to ex |      rter to ex |      rter to ex |      rter to ex\n     rter to ex |      hus, to ex |      hus, to ex |      t deeds ex |      Will or ex |      Will or ex\n     is last ex |      rter to ex |      rter to ex |      agabond ex |      d, does ex |      Capitol ex\n     ves the ex |      is last ex |      is last ex |     \\nTo say ex |     asty\\nTo ex |      d, does ex\n     agabond ex |     t it\\nIn ex |      is rare ex |      Will or ex |     hair\\nTo ex |     asty\\nTo ex\n      a wild ex |      is rare ex |      t deeds ex |      d, does ex |      sure to ex |     hair\\nTo ex\n     Capitol ex |      t deeds ex |      present ex |      d to be ex |      are not ex |      mits no ex\n     d, does ex |      ut when ex |      agabond ex |     asty\\nTo ex |      less to ex |      sure to ex\n     al, and ex |      present ex |     \\nTo say ex |     hair\\nTo ex |      thee to ex |      are not ex\n    ce,\\nThe ex |      ves the ex |      Will or ex |      ay upon ex |     over\\nTo ex |      less to ex\n     ow this ex |      agabond ex |      Capitol ex |      sure to ex |      men\\nTo ex |      thee to ex\n     hou art ex |     \\nTo say ex |      d, does ex |      u stand ex |      ou dost ex |     over\\nTo ex\n     d to be ex |       a wild ex |      ow this ex |      ith all ex |      all not ex |      men\\nTo ex\n     y I; it ex |      Capitol ex |      hou art ex |      are not ex |      y we do ex |      ou dost ex\n      I must ex |      d, does ex |      eral is ex |      less to ex |      s it to ex |      all not ex\n    asty\\nTo ex |      al, and ex |      d to be ex |      is holy ex |     ther\\nTo ex |      y we do ex\n    hair\\nTo ex |     ce,\\nThe ex |      d three ex |      ief and ex |       not to ex |      s it to ex\n     not the ex |      ow this ex |       I must ex |      thee to ex |     \\nAnd do ex |     ther\\nTo ex\n     mits no ex |      hou art ex |     asty\\nTo ex |      nd thus ex |      stay to ex |       not to ex\n     to this ex |      eral is ex |     hair\\nTo ex |      all due ex |      uld not ex |      ple did ex\n     sure to ex |      d to be ex |      as less ex |     over\\nTo ex |     s'd,\\nTo ex |      stay to ex\n    make\\nNo ex |      y I; it ex |      nce thy ex |      men\\nTo ex |      able to ex |      uld not ex\n     u stand ex |      d three ex |      ay upon ex |      s shall ex |      ided to ex |      able to ex\n      as the ex |       I must ex |      mits no ex |      els and ex |      hing do ex |      ided to ex\n      be the ex |     asty\\nTo ex |      to this ex |      es with ex |      ible to ex |       not so ex\n      in the ex |     hair\\nTo ex |      nd deep ex |      virtues ex |       him to ex |      hing do ex\n     are not ex |      g as my ex |      ce that ex |      nd made ex |      rant to ex |      ible to ex\n     e, or I ex |      nce thy ex |      sure to ex |      ou dost ex |      ow into ex |      erty or ex\n     ur last ex |      ay upon ex |     make\\nNo ex |      to such ex |      e small ex |       him to ex\n     eath is ex |      not the ex |       thence ex |      all not ex |      will so ex |      rant to ex\n     less to ex |     \\nEre he ex |      ith all ex |      y we do ex |     ind, to\\nex |       should ex\n     hat the ex |      mits no ex |      heart's ex |      ing and ex |     sir,\\nTo ex |      ow into ex\n     could I ex |      to this ex |      come my ex |      s it to ex |                 |      will so ex\n     a close ex |      nd deep ex |      ery day ex |      at thou ex |                 |     ind, to\\nex\n     ief and ex |      ce that ex |      are not ex |     \\nFor it ex |                 |     sir,\\nTo ex\n     thee to ex |      sure to ex |      ur last ex |     ther\\nTo ex |                 |                \n     it, and ex |     make\\nNo ex |      eath is ex |       not to ex |                 |                \n     all due ex |      u stand ex |      less to ex |       devise ex |                 |                \n     ks, the ex |       as the ex |      is holy ex |      ll take ex |                 |                \n     ore the ex |       thence ex |      could I ex |      s daily ex |                 |                \n    over\\nTo ex |       be the ex |      a close ex |     \\nAnd do ex |                 |                \n      choose ex |      ith all ex |      n fiery ex |      o other ex |                 |                \n      to the ex |      heart's ex |      epts my ex |      ld find ex |                 |                \n     men\\nTo ex |      come my ex |      thee to ex |      ple did ex |                 |                \n     d these ex |       in the ex |      y son's ex |      rt thus ex |                 |                \n     els and ex |     ds,\\nYet ex |      nd thus ex |      stay to ex |                 |                \n    EO:\\nThe ex |     erer:\\nO ex |      all due ex |      uld not ex |                 |                \n     nd made ex |      ery day ex |     over\\nTo ex |     s'd,\\nTo ex |                 |                \n    th?\\nThe ex |      are not ex |       choose ex |      able to ex |                 |                \n     ou dost ex |      where I ex |       to the ex |      ided to ex |                 |                \n     ail the ex |      ake men ex |      men\\nTo ex |       not so ex |                 |                \n     all not ex |      e, or I ex |      d these ex |      hing do ex |                 |                \n     y we do ex |     k,\\nAnon ex |      ll hers ex |      y words ex |                 |                \n     omeo is ex |      ur last ex |      leaf is ex |      or thou ex |                 |                \n     s it to ex |      eath is ex |      els and ex |      ible to ex |                 |                \n     at thou ex |      less to ex |      mpering ex |      erty or ex |                 |                \n    \\nFor it ex |      hat the ex |      es with ex |       him to ex |                 |                \n    ain\\nThe ex |      is holy ex |      virtues ex |      rant to ex |                 |                \n    ther\\nTo ex |      could I ex |      nd made ex |      s least ex |                 |                \n      not to ex |      a close ex |      urteous ex |       should ex |                 |                \n      devise ex |      n fiery ex |      ou dost ex |      idst it ex |                 |                \n     ll take ex |     k,\\nThat ex |      to such ex |      ow into ex |                 |                \n    \\nAnd do ex |      epts my ex |      all not ex |       it. To ex |                 |                \n      of the ex |      ief and ex |       prince ex |      will so ex |                 |                \n    eon\\nHis ex |     rge,\\nBe ex |      y we do ex |       caught ex |                 |                \n     ple did ex |      thee to ex |      omeo is ex |      oney by ex |                 |                \n    e:\\nGood ex |      it, and ex |      world's ex |     ind, to\\nex |                 |                \n     l, as I ex |      y son's ex |      s it to ex |      ht else ex |                 |                \n     th this ex |      hall be ex |      at thou ex |      esently ex |                 |                \n     stay to ex |      he king ex |     \\nFor it ex |     sir,\\nTo ex |                 |                \n     uld not ex |      nd thus ex |     ther\\nTo ex |                 |                 |                \n    s'd,\\nTo ex |      ily new ex |       not to ex |                 |                 |                \n     able to ex |      all due ex |       devise ex |                 |                 |                \n     ided to ex |      ks, the ex |      ll take ex |                 |                 |                \n     for his ex |      ore the ex |      s daily ex |                 |                 |                \n      not so ex |     over\\nTo ex |     \\nAnd do ex |                 |                 |                \n     hing do ex |       choose ex |      ents be ex |                 |                 |                \n     or thou ex |      like an ex |      o other ex |                 |                 |                \n     ible to ex |       to the ex |       all my ex |                 |                 |                \n     d false ex |      men\\nTo ex |      d-piece ex |                 |                 |                \n    \\nLet me ex |      d these ex |      ld find ex |                 |                 |                \n     s to be ex |      s shall ex |      rk-like ex |                 |                 |                \n      him to ex |      ll hers ex |     eon\\nHis ex |                 |                 |                \n     rant to ex |      leaf is ex |      ple did ex |                 |                 |                \n     s least ex |      els and ex |      th this ex |                 |                 |                \n      should ex |      mpering ex |      rt thus ex |                 |                 |                \n     idst it ex |      es with ex |      stay to ex |                 |                 |                \n     ow into ex |     EO:\\nThe ex |      uld not ex |                 |                 |                \n      it. To ex |      virtues ex |     iece\\nOf ex |                 |                 |                \n     will so ex |      nd made ex |     s'd,\\nTo ex |                 |                 |                \n      caught ex |      urteous ex |      able to ex |                 |                 |                \n    ;\\nAnd I ex |     th?\\nThe ex |      ided to ex |                 |                 |                \n     in this ex |      ou dost ex |      arver's ex |                 |                 |                \n     Made me ex |      his leg ex |      as, for ex |                 |                 |                \n     ht else ex |      ail the ex |      for his ex |                 |                 |                \n    ion\\nAnd ex |      to such ex |       not so ex |                 |                 |                \n    sir,\\nTo ex |      th much ex |      , it is ex |                 |                 |                \n                |      all not ex |      hing do ex |                 |                 |                \n                |       prince ex |      y words ex |                 |                 |                \n                |      y we do ex |      or thou ex |                 |                 |                \n                |      ing and ex |      ible to ex |                 |                 |                \n                |      omeo is ex |      d false ex |                 |                 |                \n                |      world's ex |      no such ex |                 |                 |                \n                |      et that ex |      s to be ex |                 |                 |                \n                |      s it to ex |      erty or ex |                 |                 |                \n                |      the sun ex |       him to ex |                 |                 |                \n                |      at thou ex |      rant to ex |                 |                 |                \n                |     \\nFor it ex |      morning ex |                 |                 |                \n                |      wixt my ex |      s least ex |                 |                 |                \n                |      rate an ex |       should ex |                 |                 |                \n                |       myself ex |      passing ex |                 |                 |                \n                |      in such ex |      idst it ex |                 |                 |                \n                |     ain\\nThe ex |      ow into ex |                 |                 |                \n                |     ther\\nTo ex |       it. To ex |                 |                 |                \n                |       not to ex |     :\\nIt is ex |                 |                 |                \n                |       devise ex |      will so ex |                 |                 |                \n                |      ll take ex |       caught ex |                 |                 |                \n                |      s daily ex |      oney by ex |                 |                 |                \n                |     \\nAnd do ex |      in this ex |                 |                 |                \n                |      I am an ex |      Made me ex |                 |                 |                \n                |      ents be ex |      ht else ex |                 |                 |                \n                |       art an ex |      esently ex |                 |                 |                \n                |      o other ex |     sir,\\nTo ex |                 |                 |                \n                |       all my ex |                 |                 |                 |                \n                |      d-piece ex |                 |                 |                 |                \n                |       of the ex |                 |                 |                 |                \n                |      ld find ex |                 |                 |                 |                \n                |      rk-like ex |                 |                 |                 |                \n                |     eon\\nHis ex |                 |                 |                 |                \n                |      ple did ex |                 |                 |                 |                \n                |     e:\\nGood ex |                 |                 |                 |                \n                |       I have ex |                 |                 |                 |                \n                |      l, as I ex |                 |                 |                 |                \n                |      th this ex |                 |                 |                 |                \n                |      rt thus ex |                 |                 |                 |                \n                |      stay to ex |                 |                 |                 |                \n                |      uld not ex |                 |                 |                 |                \n                |     iece\\nOf ex |                 |                 |                 |                \n                |      make an ex |                 |                 |                 |                \n                |      made an ex |                 |                 |                 |                \n                |     s'd,\\nTo ex |                 |                 |                 |                \n                |      able to ex |                 |                 |                 |                \n                |      ided to ex |                 |                 |                 |                \n                |      arver's ex |                 |                 |                 |                \n                |       of her ex |                 |                 |                 |                \n                |      hopeful ex |                 |                 |                 |                \n                |      as, for ex |                 |                 |                 |                \n                |       him an ex |                 |                 |                 |                \n                |      for his ex |                 |                 |                 |                \n                |       not so ex |                 |                 |                 |                \n                |     udio\\nBe ex |                 |                 |                 |                \n                |      , after ex |                 |                 |                 |                \n                |      , it is ex |                 |                 |                 |                \n                |      hing do ex |                 |                 |                 |                \n                |      y words ex |                 |                 |                 |                \n                |      or thou ex |                 |                 |                 |                \n                |      ty hath ex |                 |                 |                 |                \n                |      ible to ex |                 |                 |                 |                \n                |      d false ex |                 |                 |                 |                \n                |     \\nLet me ex |                 |                 |                 |                \n                |      no such ex |                 |                 |                 |                \n                |      s to be ex |                 |                 |                 |                \n                |       him to ex |                 |                 |                 |                \n                |      rant to ex |                 |                 |                 |                \n                |      morning ex |                 |                 |                 |                \n                |      s least ex |                 |                 |                 |                \n                |       should ex |                 |                 |                 |                \n                |      passing ex |                 |                 |                 |                \n                |      idst it ex |                 |                 |                 |                \n                |      ow into ex |                 |                 |                 |                \n                |      ns have ex |                 |                 |                 |                \n                |       for my ex |                 |                 |                 |                \n                |      thyself ex |                 |                 |                 |                \n                |       it. To ex |                 |                 |                 |                \n                |     nd,\\nYet ex |                 |                 |                 |                \n                |     :\\nIt is ex |                 |                 |                 |                \n                |      will so ex |                 |                 |                 |                \n                |       caught ex |                 |                 |                 |                \n                |     ;\\nAnd I ex |                 |                 |                 |                \n                |      oney by ex |                 |                 |                 |                \n                |      in this ex |                 |                 |                 |                \n                |      Made me ex |                 |                 |                 |                \n                |      ith our ex |                 |                 |                 |                \n                |      ht else ex |                 |                 |                 |                \n                |     ion\\nAnd ex |                 |                 |                 |                \n                |     rk,\\nAll ex |                 |                 |                 |                \n                |      ut then ex |                 |                 |                 |                \n                |     sir,\\nTo ex |                 |                 |                 |                \n\n\n\nmodel_outputs[q_idx], sim_outputs(q_idx, ffwd_freqs, hand_rolled_coeffs)\n\n([('c', 0.26471608877182007),\n  ('p', 0.22802582383155823),\n  ('e', 0.22533775866031647),\n  ('t', 0.17295899987220764),\n  ('i', 0.07945876568555832),\n  ('a', 0.011221885681152344),\n  ('h', 0.008093993179500103),\n  ('o', 0.0016411948017776012),\n  ('s', 0.0014349931152537465),\n  ('f', 0.0013699519913643599)],\n [('c', 0.31808581948280334),\n  ('p', 0.24088796973228455),\n  ('e', 0.2103545218706131),\n  ('t', 0.12870146334171295),\n  ('i', 0.07957907021045685),\n  ('a', 0.014825057238340378),\n  ('h', 0.007143680471926928),\n  ('q', 0.00042247571400366724)])\n\n\n\nq_idx=74\nprint_results(q_idx=q_idx-q_idx_start, query_string=strings20k[q_idx], matching_strings=matching_strings)\n\nQuery string:  heaven;\\nT\n     battle;\\nT |      battle;\\nT |      battle;\\nT |      dearth,\\nT |       senate; t |      d rather t\n    told us;\\nT |     told us;\\nT |     told us;\\nT |     used it:\\nT |      breaths: t |      die than t\n    s great;\\nT |     s great;\\nT |     s great;\\nT |     ant eye,\\nT |      dearth,\\nT |      itizens, t\n     rushes;\\nT |      rushes;\\nT |      rushes;\\nT |      of man,\\nT |       not up, t |      d us but t\n    leed'st;\\nT |     leed'st;\\nT |     leed'st;\\nT |     oremost:\\nT |     used it:\\nT |     ely;\\nbut t\n    through;\\nT |     through;\\nT |     f it be,\\nT |      battle;\\nT |      ed head, t |      oo dear: t\n    m go on;\\nT |     m go on;\\nT |     through;\\nT |      rogues,\\nT |     ant eye,\\nT |      icts us, t\n    o sword;\\nT |     o sword;\\nT |     m go on;\\nT |     ou curs,\\nT |      r heart, t |      cularise t\n    ty flat;\\nT |     ty flat;\\nT |     o sword;\\nT |     rer, no,\\nT |     Citizen:\\nT |      ort, but t\n     or two;\\nT |      or two;\\nT |     ty flat;\\nT |      matter,\\nT |      e heart, t |      hat end: t\n    bsolute;\\nT |     bsolute;\\nT |     hey are,\\nT |     hey say,\\nT |      of man,\\nT |      ther and t\n    spirits;\\nT |     spirits;\\nT |      or two;\\nT |     hey say!\\nT |     oremost:\\nT |      surplus, t\n    ld bear;\\nT |     ld bear;\\nT |     bsolute;\\nT |     roverbs,\\nT |      battle;\\nT |      e these? T\n    remains;\\nT |     remains;\\nT |     spirits;\\nT |     ust eat,\\nT |      rogues,\\nT |       enough: w\n    ill ask;\\nT |     ill ask;\\nT |     ld bear;\\nT |     ssenger:\\nT |     hts you,\\nT |      d clubs? T\n    he gods;\\nT |     he gods;\\nT |     remains;\\nT |     told us;\\nT |      matter,\\nT |       senate; t\n     an end;\\nT |      an end;\\nT |     ee here,\\nT |      leader,\\nT |     hey say,\\nT |      n deeds. T\n    at home;\\nT |     at home;\\nT |     ill ask;\\nT |      follow:\\nT |     ang 'em!\\nT |      breaths: t\n     dwells;\\nT |      dwells;\\nT |      honour,\\nT |      nature,\\nT |     roverbs,\\nT |      will on\\nT\n    s blood;\\nT |     s blood;\\nT |     he gods;\\nT |     s state,\\nT |      e walls, t |      dearth,\\nT\n    er love;\\nT |     er love;\\nT |      an end;\\nT |     s great;\\nT |     ust eat,\\nT |      ods, not t\n     marr'd;\\nT |      marr'd;\\nT |     a lover,\\nT |     in fear,\\nT |       mouths, t |     calamity\\nT\n    o prate;\\nT |     o prate;\\nT |     at home;\\nT |     in work,\\nT |     ssenger:\\nT |      slander\\nT\n     wrecks;\\nT |      wrecks;\\nT |      dwells;\\nT |     m hence,\\nT |     told us;\\nT |       for us! T\n     of you;\\nT |      of you;\\nT |     s blood;\\nT |     than he,\\nT |      leader,\\nT |       indeed! T\n     to-day;\\nT |      to-day;\\nT |     er love;\\nT |      rushes;\\nT |     Senator:\\nT |      ish, and t\n    treason;\\nT |     treason;\\nT |      father,\\nT |     f alone,\\nT |      follow:\\nT |      r usury, t\n    ught me;\\nT |     ught me;\\nT |      marr'd;\\nT |      To him!\\nT |      nature,\\nT |      s daily, t\n     France;\\nT |      France;\\nT |     o prate;\\nT |     leed'st;\\nT |      s fault, t |     restrain\\nt\n    r grace;\\nT |     r grace;\\nT |      wrecks;\\nT |      yonder,\\nT |     s state,\\nT |       not up, t\n    d again;\\nT |     d again;\\nT |      of you;\\nT |     e leash,\\nT |       thence; t |     ill; and\\nt\n    ed were;\\nT |     ed were;\\nT |      to-day;\\nT |     ntlemen,\\nT |     s great;\\nT |      the love t\n    it them;\\nT |     it them;\\nT |     treason;\\nT |      number,\\nT |     in fear,\\nT |      venture\\nT\n    e heels;\\nT |     e heels;\\nT |     ught me;\\nT |     's work,\\nT |      my word, t |     ENENIUS:\\nT\n     pawn'd;\\nT |      pawn'd;\\nT |      France;\\nT |     ucement,\\nT |       finger, t |      e belly, t\n    remorse;\\nT |     remorse;\\nT |     r grace;\\nT |     anacles,\\nT |     in work,\\nT |     used it:\\nT\n    arriage;\\nT |     arriage;\\nT |     d again;\\nT |     l force,\\nT |     m hence,\\nT |      le body. T\n    l'd him;\\nT |     l'd him;\\nT |     ed were;\\nT |     Capitol,\\nT |     than he,\\nT |      members, t\n    d queen;\\nT |     d queen;\\nT |     it them;\\nT |     'd home,\\nT |      rushes;\\nT |     us parts\\nT\n    t I was;\\nT |     t I was;\\nT |     e heels;\\nT |     s heart,\\nT |     f geese,\\nT |     for that\\nT\n    ing woe;\\nT |     ing woe;\\nT |      pawn'd;\\nT |     meeting,\\nT |   n.\\n\\nAll:\\nT |     r? What!\\nT\n    h to me;\\nT |     h to me;\\nT |     remorse;\\nT |     on body,\\nT |     f alone,\\nT |      ed head, t\n    infancy;\\nT |     infancy;\\nT |     arriage;\\nT |     f it be,\\nT |      sounds,\\nT |     ant eye,\\nT\n    d's bed;\\nT |     d's bed;\\nT |     l'd him;\\nT |     enators:\\nT |     t Roman:\\nT |      r heart, t\n    t of it;\\nT |     t of it;\\nT |     d queen;\\nT |     itizens:\\nT |      re them, t |      the leg, t\n    le acts;\\nT |     le acts;\\nT |     t I was;\\nT |      starve,\\nT |      thy sir, t |      Fore me, t\n     mother;\\nT |      mother;\\nT |     ing woe;\\nT |     nd here,\\nT |     leed'st;\\nT |     Citizen:\\nT\n    r's bed;\\nT |     r's bed;\\nT |     h to me;\\nT |      appear,\\nT |     ou well:\\nT |      ers, and t\n    nd dead;\\nT |     nd dead;\\nT |     infancy;\\nT |     we do't,\\nT |     our own,\\nT |      ouse and t\n     honour;\\nT |      honour;\\nT |     d's bed;\\nT |     through;\\nT |      n chase, t |      e court, t\n     virtue;\\nT |      virtue;\\nT |      heaven,\\nT |     charged:\\nT |      yonder,\\nT |      e heart, t\n    eir age;\\nT |     eir age;\\nT |     t of it;\\nT |     friends,\\nT |     e leash,\\nT |     in;\\nAnd, t\n    s taken;\\nT |     s taken;\\nT |     le acts;\\nT |     r loves,\\nT |     ntlemen,\\nT |      of man,\\nT\n    's head;\\nT |     's head;\\nT |      mother;\\nT |     ings of,\\nT |      ve thus, t |      ive: and t\n    ed most;\\nT |     ed most;\\nT |     r's bed;\\nT |     us were,\\nT |      number,\\nT |      d though t\n    ur side;\\nT |     ur side;\\nT |     nd dead;\\nT |     is past,\\nT |     progeny,\\nT |      his says t\n    herself;\\nT |     herself;\\nT |      honour;\\nT |     m go on;\\nT |     's work,\\nT |      udit up, t\n    s twain;\\nT |     s twain;\\nT |      virtue;\\nT |      hazard,\\nT |     ribunes,\\nT |      e me but t\n    it true;\\nT |     it true;\\nT |     eir age;\\nT |     o sword;\\nT |     ucement,\\nT |      examine\\nT\n    oldiers;\\nT |     oldiers;\\nT |     s taken;\\nT |     m there,\\nT |     anacles,\\nT |      sels and t\n     not so;\\nT |      not so;\\nT |     's head;\\nT |      people,\\nT |      e world, t |      rightly\\nT\n    grimage;\\nT |     grimage;\\nT |     ed most;\\nT |     by plot,\\nT |     ur tent:\\nT |     nk,\\nYou, t\n    r exile;\\nT |     r exile;\\nT |     ur side;\\nT |     officer,\\nT |     l force,\\nT |      bellion, t\n     morrow;\\nT |     on thus;\\nT |     herself;\\nT |     touch'd,\\nT |     Capitol,\\nT |     oremost:\\nT\n    on thus;\\nT |     l realm;\\nT |     s twain;\\nT |     iscreet,\\nT |      I think, t |       rascal, t\n    l realm;\\nT |     d's son;\\nT |     it true;\\nT |     was law,\\nT |     IRGILIA:\\nT |      in blood t\n    d's son;\\nT |     d there;\\nT |     oldiers;\\nT |     ty flat;\\nT |      Marcius; t |      battle;\\nT\n    d there;\\nT |     he king;\\nT |      not so;\\nT |     ld ways,\\nT |     'd home,\\nT |     MARCIUS:\\nT\n    he king;\\nT |      heaven;\\nT |     grimage;\\nT |     hey are,\\nT |     s heart,\\nT |      rogues,\\nT\n     heaven;\\nT |     ommends;\\nT |     r exile;\\nT |     are not,\\nT |      my way,\\nT |     ou curs,\\nT\n    ommends;\\nT |     ed king;\\nT |      morrow;\\nT |      or two;\\nT |      him and\\nT |     hts you,\\nT\n    ed king;\\nT |     repared;\\nT |     on thus;\\nT |     an rock,\\nT |     Officer:\\nT |     rer, no,\\nT\n    repared;\\nT |     ot mend;\\nT |     l realm;\\nT |     bsolute;\\nT |      e loved, t |      Hang ye! T\n    ot mend;\\nT |      castle;\\nT |     d's son;\\nT |     er lose,\\nT |       hearts, t |      Him vile t\n     castle;\\nT |     ur eyes;\\nT |     d there;\\nT |     r worse,\\nT |     meeting,\\nT |      matter,\\nT\n    ur eyes;\\nT |     en away;\\nT |     he king;\\nT |     to them,\\nT |       elders, t |      whereof, t\n    en away;\\nT |     hing be;\\nT |      heaven;\\nT |     to lose,\\nT |     on body,\\nT |     hey say,\\nT\n    hing be;\\nT |     is land;\\nT |     ommends;\\nT |     ier, so,\\nT |      hed not, t |      ang 'em! T\n    is land;\\nT |     ed soul;\\nT |     ed king;\\nT |     e, then:\\nT |     f it be,\\nT |     hey say!\\nT\n    ed soul;\\nT |     to fear;\\nT |     repared;\\nT |     further,\\nT |      y sense; t |     ise,\\nWho t\n    to fear;\\nT |     ly part;\\nT |     ot mend;\\nT |     an give,\\nT |     stom and\\nT |      d shoes. T\n    ly part;\\nT |     t sound;\\nT |      castle;\\nT |     my back:\\nT |      to them, t |      They say t\n    t sound;\\nT |     ur land;\\nT |     ur eyes;\\nT |    \\nAEdile:\\nT |     enators:\\nT |      enough!\\nW\n    ur land;\\nT |     ine ear;\\nT |     of leaf:\\nT |     spirits;\\nT |      e skull, t |     h!\\nWould t\n    ine ear;\\nT |     t again;\\nT |     shelter,\\nT |     ld bear;\\nT |      en dews, t |     ang 'em!\\nT\n    t again;\\nT |      I king;\\nT |     another,\\nT |     ye well:\\nT |     itizens:\\nT |      hey said t\n     I king;\\nT |      a king;\\nT |     en away;\\nT |     service,\\nT |      starve,\\nT |     roverbs,\\nT\n     a king;\\nT |     le peer;\\nT |     hing be;\\nT |     remains;\\nT |     nd here,\\nT |      e walls, t\n    le peer;\\nT |     al hand;\\nT |     is land;\\nT |     e spite,\\nT |      appear,\\nT |     ust eat,\\nT\n    al hand;\\nT |     ot here;\\nT |     ed soul;\\nT |     ee here,\\nT |     we do't,\\nT |       mouths, t\n    ot here;\\nT |     anguish;\\nT |      behold,\\nT |     itories,\\nT |     through;\\nT |      hs, that t\n    anguish;\\nT |     ourteen;\\nT |     to fear;\\nT |     her had,\\nT |       consul: t |     e shreds\\nT\n    ourteen;\\nT |     en love;\\nT |     ly part;\\nT |     friends:\\nT |     charged:\\nT |     ge one--\\nT\n    en love;\\nT |     ands do;\\nT |     r it be,\\nT |     ishment,\\nT |      his hat, t |      caps\\nAs t\n    ands do;\\nT |     ontague;\\nT |     t sound;\\nT |     r pates,\\nT |     friends,\\nT |     'Sdeath!\\nT\n    ontague;\\nT |     is heir;\\nT |     ur land;\\nT |     defence,\\nT |     r loves,\\nT |      ower and t\n    is heir;\\nT |     eth not;\\nT |     ine ear;\\nT |     ismay'd:\\nT |      ervices, t |     ssenger:\\nT\n    eth not;\\nT |     it down;\\nT |     t again;\\nT |     re meat,\\nT |      ribunes; t |      is, sir, t\n    it down;\\nT |     kle-bed;\\nT |      I king;\\nT |     are his:\\nT |     ings of,\\nT |      d on 't: t\n    kle-bed;\\nT |     y enemy;\\nT |      a king;\\nT |     him too:\\nT |     us were,\\nT |      tis true t\n    y enemy;\\nT |     attempt;\\nT |     le peer;\\nT |     udgment,\\nT |     scended,\\nT |     told us;\\nT\n    attempt;\\nT |      sudden;\\nT |     al hand;\\nT |     s thine,\\nT |     is past,\\nT |      leader,\\nT\n     sudden;\\nT |     e allow;\\nT |     ot here;\\nT |     tleless,\\nT |     m go on;\\nT |      ufidius, t\n    e allow;\\nT |     e' cell;\\nT |     oo fair,\\nT |     t dined:\\nT |      hazard,\\nT |      ere half t\n    e' cell;\\nT |     doth so;\\nT |     anguish;\\nT |     eceived;\\nt |      pt them, t |       to half t\n    doth so;\\nT |      I none;\\nT |     ourteen;\\nT |     ed thee,\\nT |     sul, so,\\nT |     Senator:\\nT\n     I none;\\nT |      depend;\\nT |     d lover,\\nT |      I have,\\nT |     o sword;\\nT |      onstant. T\n     depend;\\nT |     , arise;\\nT |     en love;\\nT |     blicola,\\nT |     m there,\\nT |      Lartius, t\n    , arise;\\nT |     f a man;\\nT |     ands do;\\nT |      before:\\nT |      people,\\nT |      follow:\\nT\n    f a man;\\nT |     cherish;\\nT |     ontague;\\nT |     ill ask;\\nT |     by plot,\\nT |      ch corn; t\n    cherish;\\nT |     ly dead;\\nT |     is heir;\\nT |     's womb,\\nT |      a plot:\\nT |    \\nBRUTUS:\\nT\n    ly dead;\\nT |     ivision;\\nT |     eth not;\\nT |     nd mine,\\nT |     ter, and\\nT |      nature,\\nT\n    -morrow;\\nT |     im live;\\nT |     it down;\\nT |     certain,\\nT |     officer,\\nT |      s fault, t\n    ivision;\\nT |     mper it;\\nT |     kle-bed;\\nT |     me, son:\\nT |     touch'd,\\nT |     Marcius.\\nT\n    im live;\\nT |     nsellor;\\nT |     y enemy;\\nT |      honour,\\nT |     iscreet,\\nT |     s faults\\nT\n    mper it;\\nT |      shroud;\\nT |     attempt;\\nT |     he gods;\\nT |     was law,\\nT |      honours, t\n    nsellor;\\nT |      livest;\\nT |      sudden;\\nT |      not so,\\nT |    s:\\nTrue,\\nT |     hear\\nHow t\n     shroud;\\nT |     hy back;\\nT |     e allow;\\nT |     ue thee,\\nT |     ty flat;\\nT |     ufidius,\\nT\n     livest;\\nT |     d's law;\\nT |     e' cell;\\nT |      an end;\\nT |     ld ways,\\nT |     us,\\nThat t\n    hy back;\\nT |     ee rich;\\nT |     doth so;\\nT |     hold 's:\\nT |     hey are,\\nT |      ave been t\n    d's law;\\nT |     re gold;\\nT |      I none;\\nT |     t us go:\\nT |     are not,\\nT |     s state,\\nT\n    ee rich;\\nT |      brings;\\nT |      depend;\\nT |      do ope,\\nT |     trician:\\nT |       thence; t\n    re gold;\\nT |     of York;\\nT |     , arise;\\nT |     r house:\\nT |       forges, t |      or west: t\n     brings;\\nT |     ow seas;\\nT |     f a man;\\nT |     rt home,\\nT |      or two;\\nT |     s great;\\nT\n    of York;\\nT |      and us;\\nT |     cherish;\\nT |     evail'd,\\nT |      n death: t |     t Roman,\\nT\n    ow seas;\\nT |     e place;\\nT |     ly dead;\\nT |     d fifes,\\nT |      enemies, t |     as ready\\nT\n     and us;\\nT |     py hour;\\nT |     -morrow;\\nT |      to-day:\\nT |      is left, t |     it folly\\nT\n    e place;\\nT |     admired;\\nT |     he lark,\\nT |     pirator:\\nT |       us all, t |      s veil'd t\n    py hour;\\nT |      divine;\\nT |     ivision;\\nT |     my lord:\\nT |     an rock,\\nT |     ill when\\nT\n    admired;\\nT |     lexible;\\nT |     im live;\\nT |     ricians,\\nT |     bsolute;\\nT |     hich was\\nT\n     divine;\\nT |     ng sire;\\nT |     mper it;\\nT |     victory,\\nT |     er lose,\\nT |     'll find\\nT\n    lexible;\\nT |     y swain;\\nT |     nsellor;\\nT |     s there,\\nT |     r worse,\\nT |     r strike\\nT\n    ng sire;\\nT |     sembles;\\nT |      shroud;\\nT |     s tribe,\\nT |      h often, t |   e.\\n\\nAll:\\nT\n    y swain;\\nT |     f thine;\\nT |      livest;\\nT |     rnfully:\\nT |     to them,\\nT |      died and t\n    sembles;\\nT |     e heart;\\nT |     hy back;\\nT |     a lover,\\nT |     ier, so,\\nT |      nd fame. T\n    f thine;\\nT |     stall'd;\\nT |     d's law;\\nT |      dreams,\\nT |     e, then:\\nT |     an-child\\nt\n    e heart;\\nT |     prayers;\\nT |     ee rich;\\nT |     cherous,\\nT |      as mine, t |      dam; how t\n    stall'd;\\nT |     d shrub;\\nT |     herhood,\\nT |     r there,\\nT |      ishment, t |     OLUMNIA:\\nT\n    prayers;\\nT |     my body;\\nT |     re gold;\\nT |      livery:\\nT |      perance; t |      ear than t\n    d shrub;\\nT |     al size;\\nT |      brings;\\nT |     thee so,\\nT |     mong 's!\\nT |     :\\nMadam, t\n    my body;\\nT |     aughter;\\nT |     of York;\\nT |     at home;\\nT |     content:\\nT |       a bear, t\n    al size;\\nT |     for war;\\nT |     ow seas;\\nT |      father:\\nT |     further,\\nT |     in fear,\\nT\n    aughter;\\nT |     es well;\\nT |      and us;\\nT |     of thee,\\nT |      of that, t |      l'd hand t\n    for war;\\nT |     e to do;\\nT |     e place;\\nT |     ly load,\\nT |     an give,\\nT |      vest-man t\n    es well;\\nT |      in war;\\nT |     py hour;\\nT |     s fiend,\\nT |     my back:\\nT |     es a man\\nT\n    e to do;\\nT |     s again;\\nT |     ll here,\\nT |      dwells;\\nT |    \\nAEdile:\\nT |       trophy: t\n     in war;\\nT |     ty mind;\\nT |     admired;\\nT |     s blood;\\nT |     spirits;\\nT |      Hecuba,\\nW\n    s again;\\nT |      Icarus;\\nT |      divine;\\nT |     natural,\\nT |     ld bear;\\nT |     lovelier\\nT\n    ty mind;\\nT |      course;\\nT |     lexible;\\nT |     sonable,\\nT |     enenius,\\nT |      temning. T\n     Icarus;\\nT |     il sign;\\nT |     ng sire;\\nT |     h drops:\\nT |      ctacles; t |     knee\\nAnd t\n     course;\\nT |     n trees;\\nT |     y swain;\\nT |     rd wept,\\nT |     ye well:\\nT |      good day t\n    il sign;\\nT |     ampions;\\nT |     sembles;\\nT |      exhale,\\nT |      nd here, t |       a drum, t\n    n trees;\\nT |     t go on;\\nT |     f thine;\\nT |     he word,\\nT |      ections; t |      my word, t\n    ampions;\\nT |     husband;\\nT |     e heart;\\nT |     er love;\\nT |     is\\nhead; t |      eeth and t\n    t go on;\\nT |     nothing;\\nT |     stall'd;\\nT |     us hand,\\nT |      ischief; t |       with me t\n    husband;\\nT |     Hark ye;\\nT |     prayers;\\nT |      me too,\\nT |     service,\\nT |      hreshold t\n    nothing;\\nT |     d fools;\\nT |     d shrub;\\nT |      father,\\nT |     remains;\\nT |      ood lady t\n    Hark ye;\\nT |     ith her;\\nT |     my body;\\nT |     er eyes,\\nT |     e spite,\\nT |      pe: yet, t\n    d fools;\\nT |     bastard;\\nT |     al size;\\nT |     t royal,\\nT |      in thee, t |       finger, t\n    ith her;\\nT |      say so;\\nT |     e Lewis,\\nT |     s on me,\\nT |     ee here,\\nT |      d madam, t\n    bastard;\\nT |      enough;\\nT |     aughter;\\nT |     m worse:\\nT |      re here, t |      ith you; t\n     say so;\\nT |     arjoram;\\nT |     for war;\\nT |      so bad,\\nT |     itories,\\nT |     peak it.\\nT\n     enough;\\nT |     r issue;\\nT |     es well;\\nT |     ndition,\\nT |      evenges, t |      ling and t\n    arjoram;\\nT |     e to be;\\nT |     e to do;\\nT |     oo well:\\nT |      remote,\\nT |      ef wars. T\n    r issue;\\nT |     ou well;\\nT |      in war;\\nT |     e world,\\nT |      irectly, t |      ou well, t\n    e to be;\\nT |     he nose;\\nT |     he lamb,\\nT |      marr'd;\\nT |     vingman:\\nT |      irgilia, t\n    ou well;\\nT |     , means;\\nT |     s again;\\nT |     egiance:\\nT |       rising, t |      rum, and t\n    he nose;\\nT |     mark me;\\nT |     ty mind;\\nT |      heaven?\\nT |     her had,\\nT |     in work,\\nT\n    , means;\\nT |     h speed;\\nT |      Icarus;\\nT |     s death,\\nT |     friends:\\nT |     m hence,\\nT\n    mark me;\\nT |     t where;\\nT |      course;\\nT |     ray him,\\nT |      by this, t |     y blast.\\nT\n    h speed;\\nT |      to rot;\\nT |     il sign;\\nT |     s peace!\\nT |     ishment,\\nT |     than he,\\nT\n    t where;\\nT |     bed ice;\\nT |     n trees;\\nT |     hy soul!\\nT |     thy sir,\\nT |      her than t\n     to rot;\\nT |     n leads;\\nT |     ampions;\\nT |      devils!\\nT |     r pates,\\nT |      rushes;\\nT\n    bed ice;\\nT |     e haste;\\nT |     t go on;\\nT |     serable!\\nT |      r shame; t |     far off!\\nT\n    n leads;\\nT |     l drift;\\nT |     husband;\\nT |     e house!\\nT |     defence,\\nT |     LARTIUS:\\nT\n    e haste;\\nT |     sounded;\\nT |     nothing;\\nT |     ripture,\\nT |     ismay'd:\\nT |     e Titus:\\nT\n    l drift;\\nT |     rdon it;\\nT |     Hark ye;\\nT |     urderer:\\nT |     re meat,\\nT |      ou o'er, t\n    sounded;\\nT |     king on;\\nT |     d fools;\\nT |     o prate;\\nT |      gar eye, t |     f geese,\\nT\n    rdon it;\\nT |     py time;\\nT |     ith her;\\nT |      wrecks;\\nT |     are his:\\nT |      m slaves t\n    king on;\\nT |     ken you;\\nT |     e's ado,\\nT |     larence,\\nT |     him too:\\nT |     ives,\\nAs t\n    py time;\\nT |     ou know;\\nT |     bastard;\\nT |     ination,\\nT |     udgment,\\nT |     \\nSo, now t\n    ken you;\\nT |     ws thus;\\nT |      say so;\\nT |     w names,\\nT |     a merit,\\nT |     er:\\nSee, t\n    ou know;\\nT |     e woo'd;\\nT |     aughter,\\nT |      of law,\\nT |     s thine,\\nT |   n.\\n\\nAll:\\nT\n    ws thus;\\nT |      wooers;\\nT |      enough;\\nT |     us sins,\\nT |      nothing, t |     f alone,\\nT\n    e woo'd;\\nT |     e of me;\\nT |     arjoram;\\nT |     s hands,\\nT |     t dined:\\nT |      ands up. T\n     Bianca;\\nT |      a word;\\nT |     's heir,\\nT |     der too:\\nT |      fellow,\\nT |      s big as t\n     wooers;\\nT |      of art;\\nT |     ese are,\\nT |     crament,\\nT |      ne that, t |      a jewel. T\n    e of me;\\nT |     ng wise;\\nT |     r issue;\\nT |     ublicly,\\nT |       shield, t |      erce and t\n     a word;\\nT |     he heel;\\nT |     e to be;\\nT |     tagenet,\\nT |     eceived;\\nt |     ooks and\\nT\n     of art;\\nT |     Gregory;\\nT |     ou well;\\nT |     o blind,\\nT |     ed thee,\\nT |      sounds,\\nT\n    ng wise;\\nT |      master;\\nT |     he nose;\\nT |     er here,\\nT |      I have,\\nT |     t Roman:\\nT\n    he heel;\\nT |     ane end;\\nT |     , means;\\nT |      of you;\\nT |       heaven, t |     n:\\nAnd I t\n    Gregory;\\nT |     t-place;\\nT |      Heaven,\\nT |     termand,\\nT |      e stars; t |      e movers t\n     master;\\nT |     ncentio;\\nT |     ove her,\\nT |     t us in,\\nT |      before:\\nT |      re them, t\n    ane end;\\nT |      him to;\\nT |     mark me;\\nT |     e brief,\\nT |     ill ask;\\nT |      l makes! T\n    t-place;\\nT |     her not;\\nT |     h speed;\\nT |      have I,\\nT |      ardness: t |      To him!\\nT\n    ncentio;\\nT |     edience;\\nT |     of hell,\\nT |     ne eyes,\\nT |     's womb,\\nT |       Romans: t\n     him to;\\nT |     ow come;\\nT |     t where;\\nT |     e moans!\\nT |     nd mine,\\nT |      thy sir, t\n    her not;\\nT |     service;\\nT |      to rot;\\nT |     not she:\\nT |      his boy, t |     leed'st;\\nT\n    edience;\\nT |     al made;\\nT |     bed ice;\\nT |     ltitude,\\nT |     eat son,\\nT |      ath been t\n    ow come;\\nT |     consent;\\nT |     n leads;\\nT |     e urged:\\nT |     certain,\\nT |     ou well:\\nT\n    service;\\nT |                 |     e haste;\\nT |     kingham,\\nT |     me, son:\\nT |      s to me: t\n    al made;\\nT |                 |     l drift;\\nT |     lk'd of,\\nT |      honour,\\nT |      Misguide t\n    consent;\\nT |                 |     sounded;\\nT |     ernment,\\nT |     he gods;\\nT |     ess\\nThan t\n                |                 |     rdon it;\\nT |     to rule,\\nT |      not so,\\nT |      o, sound t\n                |                 |     king on;\\nT |     o-night:\\nT |     ue thee,\\nT |     n,\\nWhere t\n                |                 |     py time;\\nT |     isurely,\\nT |      an end;\\nT |     ve heard\\nT\n                |                 |     ken you;\\nT |     e place:\\nT |     hold 's:\\nT |     our own,\\nT\n                |                 |     ou know;\\nT |     have it:\\nT |     t us go:\\nT |     crifice.\\nT\n                |                 |     ws thus;\\nT |     s yours:\\nT |      do ope,\\nT |     ven,\\nAnd t\n                |                 |     h after,\\nT |     reasons!\\nT |      his eye; t |     OMINIUS:\\nT\n                |                 |     e woo'd;\\nT |     y heart,\\nT |      e tiger; t |     :\\nThough t\n                |                 |     a ta'en,\\nT |      impart:\\nT |     r house:\\nT |      n chase, t\n                |                 |      Bianca;\\nT |      prince,\\nT |     rt home,\\nT |      yonder,\\nT\n                |                 |      wooers;\\nT |     e Tower,\\nT |     evail'd,\\nT |     one,\\nAnd t\n                |                 |     e of me;\\nT |     e north,\\nT |     d fifes,\\nT |      pitying, t\n                |                 |      a word;\\nT |     od news,\\nT |      to-day:\\nT |     e leash,\\nT\n                |                 |     ogether,\\nT |     enemies,\\nT |     pirator:\\nT |     ve\\nWhich t\n                |                 |      of art;\\nT |     's side,\\nT |     my lord:\\nT |     ntlemen,\\nT\n                |                 |     ng wise;\\nT |     h hence,\\nT |       action: t |       plague! t\n                |                 |     he heel;\\nT |     tis now:\\nT |     ricians,\\nT |      them!--\\nT\n                |                 |     Gregory;\\nT |     suivant:\\nT |     victory,\\nT |      ls worse t\n                |                 |      master;\\nT |     we meet:\\nT |     s there,\\nT |     ich side\\nT\n                |                 |     ane end;\\nT |     oly man,\\nT |     s tribe,\\nT |     Marcius,\\nT\n                |                 |     t-place;\\nT |     ee this:\\nT |     nd Lord:\\nT |      ave shed t\n                |                 |     ncentio;\\nT |     of mine,\\nT |     rd Lord:\\nT |      ave made t\n                |                 |      him to;\\nT |      to-day;\\nT |     rnfully:\\nT |      friends, t\n                |                 |     her not;\\nT |     t Shore,\\nT |     a lover,\\nT |     tes;\\nAnd t\n                |                 |      keeper,\\nT |     be done:\\nT |      dreams,\\nT |       asking: t\n                |                 |     edience;\\nT |      to fly:\\nT |     cherous,\\nT |     of those\\nT\n                |                 |     ow come;\\nT |     traitor,\\nT |      my lord, t |     are they\\nT\n                |                 |     service;\\nT |      virtue,\\nT |     r there,\\nT |     life\\nAnd t\n                |                 |     al made;\\nT |     he case,\\nT |     he king,\\nT |     ed,\\nWave t\n                |                 |     re, sir,\\nT |     oceeded,\\nT |      livery:\\nT |      ve thus, t\n                |                 |     consent;\\nT |     treason;\\nT |     thee so,\\nT |      number,\\nT\n                |                 |                 |     ip here,\\nT |     at home;\\nT |     ,\\nThough t\n                |                 |                 |     ll post:\\nT |      father:\\nT |      rom all: t\n                |                 |                 |     hildren:\\nT |     ncaster!\\nT |      our aid: t\n                |                 |                 |      person:\\nT |     y ghost,\\nT |      none but t\n                |                 |                 |     y order,\\nT |      wretch,\\nT |     ee\\nWorse t\n                |                 |                 |     rivener:\\nT |     of thee,\\nT |     ave,\\nAnd t\n                |                 |                 |     ught me;\\nT |     ly load,\\nT |     progeny,\\nT\n                |                 |                 |      France;\\nT |     s fiend,\\nT |     's work,\\nT\n                |                 |                 |     r grace;\\nT |      dwells;\\nT |      l mingle t\n                |                 |                 |     e moved,\\nT |      d-evils, t |     ribunes,\\nT\n                |                 |                 |     d again;\\nT |      mstance, t |      ve done; t\n                |                 |                 |     is hand,\\nT |      nk thee, t |      ve been; t\n                |                 |                 |     estical,\\nT |     s blood;\\nT |     ntry:\\nHe t\n                |                 |                 |     f birth,\\nT |     omicide,\\nT |     l not be\\nT\n                |                 |                 |     l house,\\nT |     natural,\\nT |     nt\\nWorse t\n                |                 |                 |     hty sea,\\nT |     sonable,\\nT |     ucement,\\nT\n                |                 |                 |     ed were;\\nT |     h drops:\\nT |      ngs; and t\n                |                 |                 |     y on me,\\nT |     rd wept,\\nT |       silence t\n                |                 |                 |      throne,\\nT |     a child,\\nT |     ce that,\\nW\n                |                 |                 |     rselves,\\nT |     nd weep,\\nT |     ,\\nWhich, t\n                |                 |                 |     it them;\\nT |      exhale,\\nT |       modest: t\n                |                 |                 |      mother:\\nT |      sembler: t |      are, not t\n                |                 |                 |     minster,\\nT |     he word,\\nT |       me, and t\n                |                 |                 |     e heels;\\nT |     er love;\\nT |     ey smart\\nT\n                |                 |                 |     's face,\\nT |     us hand,\\nT |     :\\nShould t\n                |                 |                 |     e touch,\\nT |      me too,\\nT |      ll might t\n                |                 |                 |     equence,\\nT |      father,\\nT |     ude,\\nAnd t\n                |                 |                 |     aughter:\\nT |      r mouth, t |     , of all\\nT\n                |                 |                 |     ch upon,\\nT |     er eyes,\\nT |      e tenth, t\n                |                 |                 |      on sin:\\nT |     t royal,\\nT |     th those\\nT\n                |                 |                 |     ine ear:\\nT |     s on me,\\nT |     oothing!\\nW\n                |                 |                 |      pawn'd;\\nT |     m worse:\\nT |     \\nMy nose t\n                |                 |                 |      Exeter,\\nT |     IZABETH:\\nT |     grateful\\nT\n                |                 |                 |     er arms:\\nT |   .\\n\\nGREY:\\nT |      Like one t\n                |                 |                 |     remorse;\\nT |     dly son,\\nT |     anacles,\\nT\n                |                 |                 |     em both,\\nT |      so bad,\\nT |     nown,\\nAs t\n                |                 |                 |     arriage;\\nT |     ndition,\\nT |      s to us, t\n                |                 |                 |     y voice,\\nT |     ch thee!\\nT |      e world, t\n                |                 |                 |     ly seat!\\nT |     he king?\\nT |     ll times\\nT\n                |                 |                 |     society,\\nT |     oo well:\\nT |     ll write\\nT\n                |                 |                 |     l'd him:\\nT |     e world,\\nT |     ate,\\nFor t\n                |                 |                 |     l'd him;\\nT |      y heart, t |     IOLANUS:\\nT\n                |                 |                 |     o death:\\nT |      marr'd;\\nT |     ner;\\nBut t\n                |                 |                 |     is eyes,\\nT |     egiance:\\nT |      begg'd!\\nW\n                |                 |                 |     e blood,\\nT |      nd then, t |     ur tent:\\nT\n                |                 |                 |     ndiwork,\\nT |      heaven?\\nT |     UFIDIUS:\\nT\n                |                 |                 |     e earth,\\nT |     s death,\\nT |     l force,\\nT\n                |                 |                 |     my loss:\\nT |     ray him,\\nT |     \\nBolder, t\n                |                 |                 |     ic play,\\nT |     s peace!\\nT |     Capitol,\\nT\n                |                 |                 |     d queen;\\nT |     hy soul!\\nT |     \\nMy hate t\n                |                 |                 |     t I was;\\nT |      devils!\\nT |     ther\\nHow t\n                |                 |                 |     schance:\\nT |     vy womb!\\nT |      ld goes, t\n                |                 |                 |     ing woe;\\nT |     s loins!\\nT |     ICINIUS:\\nT\n                |                 |                 |     e right,\\nT |     me duty,\\nT |       indeed, t\n                |                 |                 |     it well,\\nT |     e house!\\nT |      old men: t\n                |                 |                 |     h to me;\\nT |     dy good,\\nT |      ne thing t\n                |                 |                 |     infancy;\\nT |     clusion,\\nT |      poor in, t\n                |                 |                 |     d's bed;\\nT |     ripture,\\nT |      violent, t\n                |                 |                 |      hearts,\\nT |     urderer:\\nT |     allaying\\nT\n                |                 |                 |     d heart,\\nT |     o prate;\\nT |      asty and t\n                |                 |                 |      heaven,\\nT |     a night,\\nT |      uses--if t\n                |                 |                 |     t of it;\\nT |      ruck me, t |     les: and\\nt\n                |                 |                 |     le acts;\\nT |      wrecks;\\nT |      men, yet t\n                |                 |                 |     ur womb,\\nT |      thought, t |     ler;\\nand t\n                |                 |                 |      mother;\\nT |     larence,\\nT |      ing both t\n                |                 |                 |     I would,\\nT |     ination,\\nT |      derstood t\n                |                 |                 |     dignity:\\nT |     w names,\\nT |      ucalion, t\n                |                 |                 |     r's bed;\\nT |      mission; t |      es,--and t\n                |                 |                 |     or thee,\\nT |      he keys, t |      rom him: t\n                |                 |                 |     nd dead;\\nT |     LARENCE:\\nT |      I think, t\n                |                 |                 |     no oath:\\nT |   ?\\n\\nBoth:\\nT |      certain, t\n                |                 |                 |      honour;\\nT |      of law,\\nT |      in which t\n                |                 |                 |      virtue;\\nT |     us sins,\\nT |      ysician: t\n                |                 |                 |     to dust,\\nT |      lt thou, t |      ic, and, t\n                |                 |                 |     eir age;\\nT |     s hands,\\nT |       writes, t\n                |                 |                 |      and me,\\nT |     der too:\\nT |      oli, and t\n                |                 |                 |     e mercy:\\nT |     crament,\\nT |      n troth, t\n                |                 |                 |     s taken;\\nT |     ublicly,\\nT |     IRGILIA:\\nT\n                |                 |                 |     from me:\\nT |      de thee, t |      eck, and t\n                |                 |                 |     's head;\\nT |     tagenet,\\nT |      edition, t\n                |                 |                 |      to him:\\nT |     th sobs,\\nT |     e.\\nHark! t\n                |                 |                 |     ed most;\\nT |     hy soul,\\nT |     :\\nDeath, t\n                |                 |                 |      wrongs:\\nT |     o blind,\\nT |      nes, and t\n                |                 |                 |     tyranny,\\nT |      heavens, t |      Marcius; t\n                |                 |                 |     ng boar,\\nT |    \\nDORSET:\\nT |     -\\nBut O, t\n                |                 |                 |      swords,\\nT |       hollow, t |     e, hail!\\nW\n                |                 |                 |     f wrath,\\nT |     er here,\\nT |     'd home,\\nT\n                |                 |                 |     isement,\\nT |      of you;\\nT |      o see me t\n                |                 |                 |     ntrymen,\\nT |     termand,\\nT |      uch eyes t\n                |                 |                 |     ur side;\\nT |     t us in,\\nT |       mothers t\n                |                 |                 |     s enemy:\\nT |   e.\\n\\nBoy:\\nT |     US:\\nNow, t\n                |                 |                 |      rescue!\\nT |   t.\\n\\nBoy:\\nT |     s heart,\\nT\n                |                 |                 |     unction,\\nT |     is dead.\\nT |     re three\\nT\n                |                 |                 |     herself;\\nT |     e brief,\\nT |     ttle and\\nT\n                |                 |                 |     izabeth,\\nT |      have I,\\nT |     ve lived\\nT\n                |                 |                 |     s again:\\nT |     y grief,\\nT |     shes\\nAnd t\n                |                 |                 |     's love,\\nT |     ne eyes,\\nT |     cy: only\\nT\n                |                 |                 |      heaven.\\nT |     e moans!\\nT |      my way,\\nT\n                |                 |                 |     screant,\\nT |     not she:\\nT |      him, and t\n                |                 |                 |     n's war,\\nT |     g peers,\\nT |      ats him: t\n                |                 |                 |     s twain;\\nT |     ltitude,\\nT |      he walls t\n                |                 |                 |     it true;\\nT |     e urged:\\nT |     amask in\\nT\n                |                 |                 |     oldiers,\\nT |     kingham,\\nT |     ill\\nLose t\n                |                 |                 |     ish eye,\\nT |     lk'd of,\\nT |     oubt not\\nT\n                |                 |                 |     descent,\\nT |     ernment,\\nT |      and, but t\n                |                 |                 |     n soars!\\nT |      counsel; t |     s, which\\nT\n                |                 |                 |     be deaf,\\nT |     to rule,\\nT |     s wounds\\nT\n                |                 |                 |     oldiers;\\nT |       I hear, t |     t rather\\nT\n                |                 |                 |     ncaster,\\nT |     o-night:\\nT |     him,\\nAnd t\n                |                 |                 |     's foot,\\nT |      d faith, t |     o better\\nT\n                |                 |                 |     g blood:\\nT |     isurely,\\nT |      e to him t\n                |                 |                 |      my age:\\nT |     r house!\\nT |      an end,\\nW\n                |                 |                 |     y shame:\\nT |     , not I,\\nT |      ld them; t\n                |                 |                 |     d spear,\\nT |      nctuary: t |     he world\\nT\n                |                 |                 |     ar lord,\\nT |     my lord,\\nT |       't; and t\n                |                 |                 |      in one:\\nT |     e place:\\nT |      easy\\nAs t\n                |                 |                 |     is done:\\nT |     have it:\\nT |     his fire\\nT\n                |                 |                 |     t's day:\\nT |     e Tower:\\nT |      ble; and t\n                |                 |                 |     xclaims,\\nT |      EDWARD:\\nT |      dumb men t\n                |                 |                 |     at womb,\\nT |     s yours:\\nT |      him and\\nT\n                |                 |                 |     ghter'd,\\nT |     reasons!\\nT |      nd maids t\n                |                 |                 |     hy life,\\nT |       mother, t |       pass'd: t\n                |                 |                 |     er thee:\\nT |     y heart,\\nT |     nded,\\nAs t\n                |                 |                 |     wn life,\\nT |      impart:\\nT |      tue, and t\n                |                 |                 |     s spear,\\nT |      prince,\\nT |     Officer:\\nT\n                |                 |                 |      not so;\\nT |     e Tower,\\nT |     :\\nThree, t\n                |                 |                 |     e there,\\nT |     e north,\\nT |     :\\nFaith, t\n                |                 |                 |     and die:\\nT |     od news,\\nT |      reat men t\n                |                 |                 |     ine arm,\\nT |     enemies,\\nT |      hem; and t\n                |                 |                 |     in arms,\\nT |     's side,\\nT |      e loved, t\n                |                 |                 |     Norfolk,\\nT |     h hence,\\nT |     not why,\\nt\n                |                 |                 |     grimage;\\nT |     tis now:\\nT |       ground: t\n                |                 |                 |     n peers,\\nT |     suivant:\\nT |      g undone t\n                |                 |                 |     ecreant,\\nT |     we meet:\\nT |      over him t\n                |                 |                 |     of life,\\nT |     oly man,\\nT |      islikes, t\n                |                 |                 |     onounce:\\nT |     ee this:\\nT |      her deed t\n                |                 |                 |     r exile;\\nT |      ispatch; t |       to have t\n                |                 |                 |      morrow;\\nT |      e haste; t |       hearts, t\n                |                 |                 |     y child,\\nT |     of mine,\\nT |     \\nmalice, t\n                |                 |                 |     y words,\\nT |      to-day;\\nT |      ake way, t\n                |                 |                 |     on thus;\\nT |     t Shore,\\nT |     sces and\\nT\n                |                 |                 |     sicians,\\nT |     be done:\\nT |     ains,\\nAs t\n                |                 |                 |     strew'd,\\nT |      he rest, t |     meeting,\\nT\n                |                 |                 |     l realm;\\nT |      to fly:\\nT |      country: t\n                |                 |                 |     re rich,\\nT |      ery nod, t |       elders, t\n                |                 |                 |     diately!\\nT |     ry side,\\nT |     o desire\\nT\n                |                 |                 |     ng past:\\nT |     traitor,\\nT |      ccesses, t\n                |                 |                 |     aradise,\\nT |      the man, t |      ere both t\n                |                 |                 |      of war,\\nT |      virtue,\\nT |      hank and t\n                |                 |                 |     r lands,\\nT |     he case,\\nT |     requital\\nT\n                |                 |                 |     England,\\nT |     oceeded,\\nT |     on body,\\nT\n                |                 |                 |     t bonds:\\nT |     treason;\\nT |      advance\\nT\n                |                 |                 |     l gaunt:\\nT |     ip here,\\nT |      t's off, t\n                |                 |                 |     ot king:\\nT |     ll post:\\nT |     ertinent\\nT\n                |                 |                 |     d's son;\\nT |     hildren:\\nT |     ent\\nThan t\n                |                 |                 |      charge,\\nT |      person:\\nT |     ople\\nBut t\n                |                 |                 |     re mild,\\nT |     y order,\\nT |     al again\\nT\n                |                 |                 |      us all,\\nT |       notice, t |      hed not, t\n                |                 |                 |     od hope:\\nT |     rivener:\\nT |     sun\\nWhen t\n                |                 |                 |     is land:\\nT |     gross'd,\\nT |     latter--\\nT\n                |                 |                 |     s worse,\\nT |     ught me;\\nT |      n's ears t\n                |                 |                 |     ordship,\\nT |     ur Lord,\\nT |      k voice: t\n                |                 |                 |     m to it,\\nT |      France;\\nT |     f it be,\\nT\n                |                 |                 |     kinsmen:\\nT |      e leads; t |     he drove\\nT\n                |                 |                 |      castle:\\nT |     r grace;\\nT |      ple made t\n                |                 |                 |     ershire:\\nT |     e moved,\\nT |     e coward\\nT\n                |                 |                 |     d there;\\nT |     d again;\\nT |      enter'd\\nT\n                |                 |                 |     our out:\\nT |       myself, t |       and by, t\n                |                 |                 |     is land,\\nT |     is hand,\\nT |      y sense; t\n                |                 |                 |     treason:\\nT |      reaties, t |     ate,\\nAnd t\n                |                 |                 |     mplices,\\nT |     estical,\\nT |      oil: and t\n                |                 |                 |     you are:\\nT |     f birth,\\nT |     er stood\\nT\n                |                 |                 |     he king;\\nT |     l house,\\nT |      pleased\\nT\n                |                 |                 |     elshman:\\nT |     's good,\\nT |      s' sake, t\n                |                 |                 |      heaven;\\nT |      erefore, t |     stom and\\nT\n                |                 |                 |     nd leap,\\nT |     hty sea,\\nT |      to them, t\n                |                 |                 |     y enjoy,\\nT |     ed were;\\nT |      did, and t\n                |                 |                 |     treated:\\nT |     y on me,\\nT |      how them t\n                |                 |                 |     ommends;\\nT |      throne,\\nT |       to you, t\n                |                 |                 |     , lords:\\nT |     rselves,\\nT |      hem: and t\n                |                 |                 |     r world,\\nT |     it them;\\nT |     enators:\\nT\n                |                 |                 |     ty hole,\\nT |      mother:\\nT |     \\nI know, t\n                |                 |                 |     ed sins,\\nT |     minster,\\nT |     zen:\\nAnd t\n                |                 |                 |     ed king;\\nT |     e heels;\\nT |     ald,\\nbut t\n                |                 |                 |     us lord,\\nT |      ed womb, t |     red: and\\nt\n                |                 |                 |     repared;\\nT |     's face,\\nT |      e skull, t\n                |                 |                 |     ot mend;\\nT |     e touch,\\nT |     uth,\\nand t\n                |                 |                 |     d decay:\\nT |     equence,\\nT |      en dews, t\n                |                 |                 |     y heart!\\nT |     aughter:\\nT |      ce sake, t\n                |                 |                 |     roperty,\\nT |     ch upon,\\nT |       matter, t\n                |                 |                 |     e scene,\\nT |      on sin:\\nT |       incline t\n                |                 |                 |     respect,\\nT |     ine ear:\\nT |       people, t\n                |                 |                 |     el want,\\nT |      pawn'd;\\nT |      her, but t\n                |                 |                 |      castle;\\nT |      eing by, t |      tongues: t\n                |                 |                 |     lishmen:\\nT |      Exeter,\\nT |     S:\\nO me, t\n                |                 |                 |     g water:\\nT |     er arms:\\nT |     \\nI would t\n                |                 |                 |     for woe,\\nT |     remorse;\\nT |      ch, sir. T\n                |                 |                 |     unbegot,\\nT |     em both,\\nT |     zen:\\nBut t\n                |                 |                 |     n peace,\\nT |     arriage;\\nT |      ave here t\n                |                 |                 |      swears,\\nT |     e crown,\\nT |      brother, t\n                |                 |                 |      we not,\\nT |      lurk'd,\\nT |      nd since t\n                |                 |                 |     e place,\\nT |     y voice,\\nT |      rfeitly; t\n                |                 |                 |     ow base,\\nT |     ly seat!\\nT |      esirers. T\n                |                 |                 |      I know,\\nT |     society,\\nT |      end; and t\n                |                 |                 |     to have,\\nT |     l'd him:\\nT |     itizens:\\nT\n                |                 |                 |     ur eyes;\\nT |     l'd him;\\nT |      starve,\\nT\n                |                 |                 |      garden,\\nT |     o death:\\nT |      an crave t\n                |                 |                 |     n grief:\\nT |     is eyes,\\nT |      woolvish t\n                |                 |                 |      sprays,\\nT |     e blood,\\nT |     nd here,\\nT\n                |                 |                 |     of leaf:\\nT |     ndiwork,\\nT |      nd Dick, t\n                |                 |                 |     shelter,\\nT |     e earth,\\nT |      appear,\\nT\n                |                 |                 |     ardener:\\nT |     g souls,\\nT |     we do't,\\nT\n                |                 |                 |     ing men,\\nT |      Edward:\\nT |     through;\\nT\n                |                 |                 |      York's,\\nT |     my loss:\\nT |      uffer'd, t\n                |                 |                 |     peaking!\\nT |     ic play,\\nT |      f wounds t\n                |                 |                 |      length,\\nT |      I prey,\\nT |       consul: t\n                |                 |                 |     f death,\\nT |     d queen;\\nT |      ion; and t\n                |                 |                 |     ympathy,\\nT |     t I was;\\nT |     charged:\\nT\n                |                 |                 |      breast,\\nT |     schance:\\nT |     summon'd\\nT\n                |                 |                 |     ble boy!\\nT |     ing woe;\\nT |      ou chose t\n                |                 |                 |     y sword,\\nT |     e right,\\nT |      en, sir: t\n                |                 |                 |     f faith,\\nT |      lourish, t |      his hat, t\n                |                 |                 |     rophesy:\\nT |     it well,\\nT |       voices: t\n                |                 |                 |     e offer,\\nT |     h to me;\\nT |     ndliness\\nT\n                |                 |                 |     another,\\nT |     infancy;\\nT |     ave said\\nT\n                |                 |                 |     the air,\\nT |     d's bed;\\nT |     re\\nWould t\n                |                 |                 |     f water:\\nT |      hearts,\\nT |     ices and\\nT\n                |                 |                 |     are won:\\nT |     d heart,\\nT |      s malice t\n                |                 |                 |     en away;\\nT |     d yours,\\nT |     irit\\nAnd t\n                |                 |                 |     hing be;\\nT |      heaven,\\nT |      article\\nT\n                |                 |                 |     is land;\\nT |     t of it;\\nT |      ve ta'en t\n                |                 |                 |     wouldst,\\nT |      -hearts; t |      dred and t\n                |                 |                 |      myself,\\nT |     ll weep:\\nT |      tly, and t\n                |                 |                 |     avy day,\\nT |     le acts;\\nT |     friends,\\nT\n                |                 |                 |     ngbroke,\\nT |     ur sons,\\nT |     re voice\\nT\n                |                 |                 |     traight,\\nT |     ur womb,\\nT |      han dogs t\n                |                 |                 |     sperity,\\nT |      mother;\\nT |     rking\\nAs t\n                |                 |                 |     ed soul;\\nT |     I would,\\nT |     r loves,\\nT\n                |                 |                 |     you all,\\nT |     gn soil,\\nT |      ervices, t\n                |                 |                 |     d tower,\\nT |     dignity:\\nT |     from you\\nT\n                |                 |                 |      behold,\\nT |      he king, t |      ribunes; t\n                |                 |                 |     il-like,\\nT |      to see:\\nT |      een, but t\n                |                 |                 |     t think,\\nT |     r's bed;\\nT |      ons, and t\n                |                 |                 |     to fear;\\nT |     or thee,\\nT |      must do\\nT\n                |                 |                 |     ly part;\\nT |      hat God, t |     he grain\\nT\n                |                 |                 |     rs next,\\nT |     nd dead;\\nT |      he began t\n                |                 |                 |      smiles,\\nT |     no oath:\\nT |     ings of,\\nT\n                |                 |                 |     atience,\\nT |      honour;\\nT |     us were,\\nT\n                |                 |                 |      events,\\nT |      virtue;\\nT |    r;\\nAnd  \\nT\n                |                 |                 |     r hands,\\nT |      by Him,\\nT |     scended,\\nT\n                |                 |                 |     ate boy,\\nT |      ich now, t |     is past,\\nT\n                |                 |                 |     majesty,\\nT |     to dust,\\nT |     m go on;\\nT\n                |                 |                 |     r it be,\\nT |      d youth, t |      hazard,\\nT\n                |                 |                 |      danger,\\nT |     eir age;\\nT |     ple;\\nAnd t\n                |                 |                 |     himself!\\nT |      , night, t |      ly 'tis, t\n                |                 |                 |     ur lies:\\nT |      and me,\\nT |      ord; and t\n                |                 |                 |      breath,\\nT |      y liege; t |     \\nSo then t\n                |                 |                 |     t sound;\\nT |      y power, t |      dy, when t\n                |                 |                 |     hee how:\\nT |     f death?\\nT |      pt them, t\n                |                 |                 |     ed lord,\\nT |     e mercy:\\nT |     sul, so,\\nT\n                |                 |                 |     ur land;\\nT |      e shore, t |     o sword;\\nT\n                |                 |                 |     ine ear;\\nT |      r'd him, t |      on most, t\n                |                 |                 |     t again;\\nT |     s taken;\\nT |     fortunes\\nT\n                |                 |                 |     ors are:\\nT |      lisbury; t |     m there,\\nT\n                |                 |                 |     r shame,\\nT |     from me:\\nT |     \\nBehold, t\n                |                 |                 |      I king;\\nT |     's head;\\nT |      people,\\nT\n                |                 |                 |      a king;\\nT |      to him:\\nT |      oble and t\n                |                 |                 |     le peer;\\nT |     ruction!\\nT |       voices, t\n                |                 |                 |     bestrid,\\nT |     ed most;\\nT |     by plot,\\nT\n                |                 |                 |     al hand;\\nT |     t;\\nThis, t |      a plot:\\nT\n                |                 |                 |     nd Kent:\\nT |      wrongs:\\nT |      rs, foes t\n                |                 |                 |      of woe,\\nT |     tyranny,\\nT |      ach way, t\n                |                 |                 |     ly Land,\\nT |     ng boar,\\nT |      or which t\n                |                 |                 |      beasts,\\nT |      swords,\\nT |     ill pass\\nT\n                |                 |                 |     naments,\\nT |     , march:\\nT |       set on. T\n                |                 |                 |     ternoon,\\nT |     ICHMOND:\\nT |     of corn!\\nT\n                |                 |                 |     is case,\\nT |      houghts, t |     ter, and\\nT\n                |                 |                 |     nd part,\\nT |     f wrath,\\nT |     r senate\\nT\n                |                 |                 |     our son:\\nT |     isement,\\nT |      with us, t\n                |                 |                 |     hy stay,\\nT |     lict me!\\nT |      wer, but t\n                |                 |                 |     ot here;\\nT |      degree,\\nT |     at\\nWhich t\n                |                 |                 |     oo fair,\\nT |     dropper,\\nT |      in words t\n                |                 |                 |     on more:\\nT |     ntrymen,\\nT |    \\nCholer!\\nW\n                |                 |                 |     anguish;\\nT |     ur side;\\nT |     s a mind\\nT\n                |                 |                 |     anguish:\\nT |       except, t |      dra here t\n                |                 |                 |     ver die,\\nT |     s enemy:\\nT |     officer,\\nT\n                |                 |                 |     ourteen;\\nT |       thrive, t |     eing but\\nT\n                |                 |                 |     ty fool,\\nT |      rescue!\\nT |     t spirit\\nT\n                |                 |                 |      I trow,\\nT |      is ours, t |     ians,\\nIf t\n                |                 |                 |     olidame,\\nT |     unction,\\nT |      ors: and t\n                |                 |                 |     t laugh,\\nT |     herself;\\nT |      blended, t\n                |                 |                 |     n brief:\\nT |     s blood,\\nT |       theirs. T\n                |                 |                 |     d lover,\\nT |     own son,\\nT |      y choose t\n                |                 |                 |     to hide:\\nT |     izabeth,\\nT |     er bench\\nT\n                |                 |                 |     en love;\\nT |     us Lord,\\nT |     ul aches\\nT\n                |                 |                 |     o rough,\\nT |     s again:\\nT |      both and t\n                |                 |                 |     hoppers,\\nT |     's love,\\nT |      counsel, t\n                |                 |                 |     r's web,\\nT |     screant,\\nT |     ve forth\\nT\n                |                 |                 |     ld grub,\\nT |     n's war,\\nT |      gh there t\n                |                 |                 |      asleep,\\nT |     s twain;\\nT |     ,\\nI say, t\n                |                 |                 |     e bodes:\\nT |     it true;\\nT |     nce, fed\\nT\n                |                 |                 |     r backs,\\nT |     oldiers,\\nT |      ier than t\n                |                 |                 |     arriage:\\nT |     ish eye,\\nT |       voices. T\n                |                 |                 |      thence,\\nT |     is good,\\nT |      assured\\nT\n                |                 |                 |     ic face,\\nT |     descent,\\nT |      ven when t\n                |                 |                 |      my kin,\\nT |     n soars!\\nT |     touch'd,\\nT\n                |                 |                 |     n spite,\\nT |     be deaf,\\nT |      t thread t\n                |                 |                 |     agement:\\nT |     oldiers;\\nT |      e gates. T\n                |                 |                 |     ands do;\\nT |     ncaster,\\nT |      or them: t\n                |                 |                 |     ontague;\\nT |     's foot,\\nT |     on\\nWhich t\n                |                 |                 |     ly hate!\\nT |     g blood:\\nT |     e digest\\nT\n                |                 |                 |     s to me,\\nT |      escribe, t |      emands.' T\n                |                 |                 |     is heir;\\nT |     F GAUNT:\\nT |     e debase\\nT\n                |                 |                 |     eth not;\\nT |      my age:\\nT |       withal! T\n                |                 |                 |     ent lie,\\nT |     y shame:\\nT |      h cause, t\n                |                 |                 |     it down;\\nT |     y grave,\\nT |       gentry, t\n                |                 |                 |     e trees,\\nT |     d spear,\\nT |     he while\\nT\n                |                 |                 |     kle-bed;\\nT |     ar lord,\\nT |      purpose. T\n                |                 |                 |     h grief,\\nT |     is done:\\nT |     iscreet,\\nT\n                |                 |                 |      speaks:\\nT |     t's day:\\nT |      ge on't, t\n                |                 |                 |     at hand,\\nT |     xclaims,\\nT |     and wish\\nT\n                |                 |                 |     y enemy;\\nT |      hat bed, t |     not lick\\nT\n                |                 |                 |     attempt;\\nT |     at womb,\\nT |     \\nMangles t\n                |                 |                 |     ir hate,\\nT |     ghter'd,\\nT |      bereaves t\n                |                 |                 |     wear'st,\\nT |     hy life,\\nT |     nswer\\nAs t\n                |                 |                 |     nt moon,\\nT |     er thee:\\nT |      ese bald t\n                |                 |                 |      sudden;\\nT |     wn life,\\nT |      pending, t\n                |                 |                 |     d night!\\nT |      s death: t |     ce fails\\nT\n                |                 |                 |     to thee,\\nT |     s spear,\\nT |     was law,\\nT\n                |                 |                 |     ourable,\\nT |     s bosom,\\nT |     eet,\\nAnd t\n                |                 |                 |     y grief:\\nT |      not so;\\nT |      at would t\n                |                 |                 |     ing eye,\\nT |     e there,\\nT |     tribunes\\nT\n                |                 |                 |     h reign:\\nT |     and die:\\nT |     ie, fie!\\nT\n                |                 |                 |     n waste,\\nT |     Marshal:\\nT |      dle, not t\n                |                 |                 |      clears,\\nT |     ine arm,\\nT |       unbuild t\n                |                 |                 |     e allow;\\nT |     in arms,\\nT |      city and t\n                |                 |                 |     ear say,\\nT |     ngerous,\\nT |      city but t\n                |                 |                 |     g hills:\\nT |     grimage;\\nT |    s:\\nTrue,\\nT\n                |                 |                 |     e about,\\nT |     s point,\\nT |     ablish'd\\nT\n                |                 |                 |     e' cell;\\nT |      my lot,\\nT |     ty flat;\\nT\n                |                 |                 |      cheeks,\\nT |     n peers,\\nT |      ech you, t\n                |                 |                 |     her way,\\nT |     ecreant,\\nT |     ld ways,\\nT\n                |                 |                 |     ppetite:\\nT |     of life,\\nT |     ie here.\\nT\n                |                 |                 |     doth so;\\nT |     onounce:\\nT |      t sword! T\n                |                 |                 |     rnament:\\nT |     r exile;\\nT |      nd, home t\n                |                 |                 |      retire:\\nT |     s light,\\nT |      ians--as t\n                |                 |                 |      I none;\\nT |      y uncle, t |     hey are,\\nT\n                |                 |                 |      devise,\\nT |      morrow;\\nT |      mans--as t\n                |                 |                 |     outrage!\\nT |     y child,\\nT |     are not,\\nT\n                |                 |                 |      houses!\\nT |     y words,\\nT |     d myself\\nT\n                |                 |                 |      depend;\\nT |     on thus;\\nT |      em; yea, t\n                |                 |                 |     k again,\\nT |     sicians,\\nT |     ear\\nWhat t\n                |                 |                 |     be gone!\\nT |     strew'd,\\nT |       little: t\n                |                 |                 |     uld end,\\nT |     s I can,\\nT |     trician:\\nT\n                |                 |                 |      abuses:\\nT |      he word, t |     s mouth:\\nW\n                |                 |                 |      steeds,\\nT |     l realm;\\nT |       forges, t\n                |                 |                 |     l night,\\nT |     re rich,\\nT |      He heard t\n                |                 |                 |     wn bold,\\nT |     diately!\\nT |     law,\\nAnd t\n                |                 |                 |     all die,\\nT |     ng past:\\nT |     ial\\nThan t\n                |                 |                 |     meo can,\\nT |     is ears?\\nT |      or two;\\nT\n                |                 |                 |     a vitae:\\nT |     'd isle,\\nT |      traitor: t\n                |                 |                 |     ishment:\\nT |     of Mars,\\nT |      ger, and t\n                |                 |                 |     ust fly:\\nT |     aradise,\\nT |      n death: t\n                |                 |                 |     losophy,\\nT |      of war,\\nT |     s forbid\\nT\n                |                 |                 |     anished,\\nT |       of men, t |     ratitude\\nT\n                |                 |                 |      do now,\\nT |     r lands,\\nT |     \\nMortal, t\n                |                 |                 |     , arise;\\nT |      ed plot, t |      enemies, t\n                |                 |                 |     hou art:\\nT |      s earth, t |      is left, t\n                |                 |                 |     ng both!\\nT |     England,\\nT |       us all, t\n                |                 |                 |     thy wit:\\nT |     y's Son,\\nT |     ne word.\\nT\n                |                 |                 |     f a man;\\nT |      r souls, t |     all find\\nT\n                |                 |                 |     cherish;\\nT |     t bonds:\\nT |      n peace, t\n                |                 |                 |     ly dead;\\nT |     l gaunt:\\nT |      ane way: t\n                |                 |                 |     ppy too:\\nT |     ot king:\\nT |      ody, and t\n                |                 |                 |     n wench,\\nT |     d's son,\\nT |     \\nOr pile t\n                |                 |                 |     hy love:\\nT |     d's son;\\nT |     an rock,\\nT\n                |                 |                 |     luckily,\\nT |     ked age,\\nT |     ck,\\nThat t\n                |                 |                 |     -morrow;\\nT |     th thee!\\nT |      vassals, t\n                |                 |                 |     el much:\\nT |       my bed, t |      created\\nT\n                |                 |                 |     ry late,\\nT |      charge,\\nT |       groats, t\n                |                 |                 |     he lark,\\nT |     re mild,\\nT |      gations, t\n                |                 |                 |     exhales,\\nT |       hereof, t |     had been\\nT\n                |                 |                 |     ivision;\\nT |     LOUGHBY:\\nT |     of anger\\nT\n                |                 |                 |     chamber:\\nT |      us all,\\nT |      erd, but t\n                |                 |                 |     im live;\\nT |       hearts: t |     but that\\nT\n                |                 |                 |     hou not:\\nT |     king so,\\nT |     bsolute;\\nT\n                |                 |                 |     'd dram,\\nT |   \\n\\nQUEEN:\\nT |     ;\\nThough t\n                |                 |                 |     mper it;\\nT |      himself, t |      hat, and t\n                |                 |                 |     ntleman,\\nT |     od hope:\\nT |     er lose,\\nT\n                |                 |                 |     ay next,\\nT |   \\n\\nGREEN:\\nT |     se,\\nThat t\n                |                 |                 |      tender,\\nT |     is land:\\nT |     S:\\nTush, t\n                |                 |                 |     ee good:\\nT |     s worse,\\nT |     r worse,\\nT\n                |                 |                 |      clouds,\\nT |     y Percy,\\nT |      r, since t\n                |                 |                 |     nothing,\\nT |     ordship,\\nT |     \\nBecause t\n                |                 |                 |     e' cell,\\nT |     m to it,\\nT |      ch words t\n                |                 |                 |     nsellor;\\nT |     kinsmen:\\nT |       tongue, t\n                |                 |                 |     arriage,\\nT |      in them, t |      llowance t\n                |                 |                 |     ouse ye:\\nT |      castle:\\nT |     th.\\nNow, t\n                |                 |                 |     em both:\\nT |       fights, t |     all\\nThan t\n                |                 |                 |     y Paris,\\nT |     ershire:\\nT |     tune and\\nT\n                |                 |                 |     thyself,\\nT |     nspurgh,\\nT |      our son, t\n                |                 |                 |     s shame,\\nT |      erkeley, t |      enators, t\n                |                 |                 |      shroud;\\nT |     d there;\\nT |      ent, but t\n                |                 |                 |     r doubt,\\nT |      emember: t |     and;\\nAnd t\n                |                 |                 |      livest;\\nT |     is land,\\nT |     h them--\\nT\n                |                 |                 |     ou dead:\\nT |      ish boy, t |      nce, and t\n                |                 |                 |      closet,\\nT |      e Gaunt, t |      ned than t\n                |                 |                 |     hat, ho!\\nT |     treason:\\nT |      h often, t\n                |                 |                 |     y veins,\\nT |     his way,\\nT |     mulberry\\nT\n                |                 |                 |     e vault,\\nT |     mplices,\\nT |     to them,\\nT\n                |                 |                 |     ry like,\\nT |      or foes, t |      y which, t\n                |                 |                 |     d night,\\nT |     he king;\\nT |      for thee t\n                |                 |                 |     son, ha!\\nT |      her day, t |      ves, but t\n                |                 |                 |     tis day:\\nT |     elshman:\\nT |     lt frame\\nT\n                |                 |                 |     warrant,\\nT |      heaven;\\nT |     o far\\nAs t\n                |                 |                 |     me wail,\\nT |     y enjoy,\\nT |     ery gulf\\nT\n                |                 |                 |      so ill,\\nT |     and war:\\nT |      ith base t\n                |                 |                 |     estival,\\nT |      unrest:\\nT |      here but t\n                |                 |                 |     r grave:\\nT |     g blood,\\nT |     to lose,\\nT\n                |                 |                 |     hy back;\\nT |     treated:\\nT |      Marcius, t\n                |                 |                 |     d's law;\\nT |     ommends;\\nT |     d it\\nAnd t\n                |                 |                 |     ee rich;\\nT |     my hand,\\nT |      he wind. T\n                |                 |                 |     herhood,\\nT |     , lords:\\nT |       son, as t\n                |                 |                 |     y moans:\\nT |      refuse,\\nT |      ses made t\n                |                 |                 |     y limbs:\\nT |      e globe, t |     ier, so,\\nT\n                |                 |                 |     ontague,\\nT |     r world,\\nT |     in voice\\nT\n                |                 |                 |      beauty:\\nT |     ty hole,\\nT |       asleep! t\n                |                 |                 |     y guide!\\nT |     ed sins,\\nT |     f knaves\\nT\n                |                 |                 |     thecary!\\nT |      s thief, t |     like his\\nT\n                |                 |                 |     on them,\\nT |     ed king;\\nT |      surcease t\n                |                 |                 |      sheath;\\nt |      s angel: t |       choice, t\n                |                 |                 |     arly up,\\nT |     us lord,\\nT |     e, then:\\nT\n                |                 |                 |      bleeds!\\nT |     ing men!\\nT |     our\\nThan t\n                |                 |                 |     a while,\\nT |     repared;\\nT |      heart as t\n                |                 |                 |     e night,\\nT |     ot mend;\\nT |     hou list\\nT\n                |                 |                 |     s words,\\nT |     d decay:\\nT |      as mine, t\n                |                 |                 |     ur hate,\\nT |     y crown:\\nT |     e strong\\nT\n                |                 |                 |     hy hand:\\nT |     y heart!\\nT |      im home, t\n                |                 |                 |     re gold;\\nT |     roperty,\\nT |     ple,\\nAnd t\n                |                 |                 |     s known,\\nT |      r souls; t |      ius, and t\n                |                 |                 |      brings;\\nT |     e scene,\\nT |     senators\\nT\n                |                 |                 |     ht blow:\\nT |     respect,\\nT |      And when t\n                |                 |                 |     im best,\\nT |     el want,\\nT |      ishment, t\n                |                 |                 |     se peer,\\nT |      castle;\\nT |      uer, and t\n                |                 |                 |     of York;\\nT |     lishmen:\\nT |      perance; t\n                |                 |                 |     train'd,\\nT |     ng drum,\\nT |      art; and t\n                |                 |                 |      lay'st,\\nT |     g water:\\nT |     \\nWith us t\n                |                 |                 |      I live,\\nT |     for woe,\\nT |       ostler, t\n                |                 |                 |     y blood,\\nT |     unbegot,\\nT |       volume. T\n                |                 |                 |     eet son:\\nT |     n peace,\\nT |      ety, and t\n                |                 |                 |     ow seas;\\nT |      swears,\\nT |     mong 's!\\nT\n                |                 |                 |     y woman,\\nT |      we not,\\nT |     content:\\nT\n                |                 |                 |      and us;\\nT |      submit?\\nT |      onsider; t\n                |                 |                 |     istrate,\\nT |     deposed?\\nT |     further,\\nT\n                |                 |                 |     e place;\\nT |      As thus, t |     US:\\nSay, t\n                |                 |                 |     py hour;\\nT |     e place,\\nT |      rge you, t\n                |                 |                 |     y death!\\nT |     ow base,\\nT |      traitor! T\n                |                 |                 |     offence,\\nT |      I know,\\nT |      eyes sat t\n                |                 |                 |     o cause!\\nT |     to have,\\nT |     ions, in\\nT\n                |                 |                 |     ir fury:\\nT |     ur eyes;\\nT |      he rock, t\n                |                 |                 |     ll here,\\nT |      garden,\\nT |      defying\\nT\n                |                 |                 |     erified,\\nT |     n grief:\\nT |      of that, t\n                |                 |                 |     admired;\\nT |     of pins,\\nT |      ronounce t\n                |                 |                 |      divine;\\nT |      sprays,\\nT |      not buy\\nT\n                |                 |                 |     minable:\\nT |     of leaf:\\nT |     an give,\\nT\n                |                 |                 |     e child,\\nT |     shelter,\\nT |     ng means\\nT\n                |                 |                 |     lexible;\\nT |     ardener:\\nT |      kes, and t\n                |                 |                 |     s tears:\\nT |     ing men,\\nT |      rofound, t\n                |                 |                 |     hem cry,\\nT |      York's,\\nT |     ase,\\nAnd t\n                |                 |                 |     f youth,\\nT |      ngbroke: t |      y loins; t\n                |                 |                 |     e field,\\nT |      schance, t |     prize\\nAs t\n                |                 |                 |      taunts,\\nT |      to this, t |     ried men\\nT\n                |                 |                 |      remain,\\nT |      length,\\nT |     er still\\nT\n                |                 |                 |     f grief:\\nT |     f death,\\nT |      For you, t\n                |                 |                 |     re told,\\nT |     ympathy,\\nT |      he city, t\n                |                 |                 |     st gasp,\\nT |      y times, t |     my back:\\nT\n                |                 |                 |     h truth,\\nT |      tzwater, t |    \\nAEdile:\\nT\n                |                 |                 |     ine day,\\nT |      breast,\\nT |     s; come.\\nT\n                |                 |                 |     of York:\\nT |     y sword,\\nT |      arewell: t\n                |                 |                 |     d by me,\\nT |     f faith,\\nT |     ere used\\nT\n                |                 |                 |     ng sire;\\nT |     ARLISLE:\\nT |     spirits;\\nT\n                |                 |                 |     e field:\\nT |     subject?\\nT |     ld bear;\\nT\n                |                 |                 |     liament,\\nT |     it, God,\\nT |     vincible\\nT\n                |                 |                 |     traught,\\nT |     rophesy:\\nT |      had been t\n                |                 |                 |     for him,\\nT |     e offer,\\nT |      ell yet. T\n                |                 |                 |     er stay:\\nT |     another,\\nT |     enenius,\\nT\n                |                 |                 |     d still,\\nT |     f water:\\nT |      tem, and t\n                |                 |                 |     n games:\\nT |     are won:\\nT |      ctacles; t\n                |                 |                 |     e alone:\\nT |     en away;\\nT |      Tis fond t\n                |                 |                 |     py life,\\nT |     hing be;\\nT |       dragon, t\n                |                 |                 |     y swain;\\nT |     is land;\\nT |      ar'd and t\n                |                 |                 |     y sheep,\\nT |      ng them, t |      thou go? T\n                |                 |                 |     in thee,\\nT |     wouldst,\\nT |     h chance\\nT\n                |                 |                 |     n, pity!\\nT |      myself,\\nT |     ee\\nWhere t\n                |                 |                 |      houses:\\nT |      f thine, t |      lt rest, t\n                |                 |                 |     sembles;\\nT |     avy day,\\nT |     ye well:\\nT\n                |                 |                 |     ud York,\\nT |     ngbroke,\\nT |      hee; and t\n                |                 |                 |     of York,\\nT |     traight,\\nT |      urfeits, t\n                |                 |                 |      flight:\\nT |     sperity,\\nT |     with one\\nT\n                |                 |                 |     's life,\\nT |     ed soul;\\nT |      in above t\n                |                 |                 |      at him,\\nT |     you all,\\nT |     further.\\nT\n                |                 |                 |     t march,\\nT |     d tower,\\nT |      one, and t\n                |                 |                 |      London,\\nT |      behold,\\nT |      ell met: t\n                |                 |                 |      Keeper:\\nT |     d stand,\\nT |      Note but t\n                |                 |                 |     re love,\\nT |     od soul,\\nT |     ome\\nThan t\n                |                 |                 |     f thine;\\nT |     , sweet,\\nT |      Nay, but t\n                |                 |                 |     om thee,\\nT |     il-like,\\nT |      bia, and t\n                |                 |                 |     r's fee:\\nT |      France:\\nT |      ood man, t\n                |                 |                 |     e heart;\\nT |      d night, t |     e:\\nCats, t\n                |                 |                 |     stall'd;\\nT |      griefs,\\nT |       as doth t\n                |                 |                 |     at else,\\nT |      ruption: t |     l exceed\\nT\n                |                 |                 |      king's,\\nT |     t think,\\nT |     my son--\\nT\n                |                 |                 |     prayers;\\nT |     to fear;\\nT |      nd here, t\n                |                 |                 |     ook him,\\nT |      he goes, t |     o do\\nBut t\n                |                 |                 |     and all,\\nT |     ly part;\\nT |      so, sir: t\n                |                 |                 |      spring,\\nT |     be gone,\\nT |   \\n\\nRoman:\\nT\n                |                 |                 |      bodies,\\nT |      theatre, t |     n state,\\nt\n                |                 |                 |     e bribe,\\nT |      smiles,\\nT |      ections; t\n                |                 |                 |     d shrub;\\nT |     atience,\\nT |      t ended, t\n                |                 |                 |     my body;\\nT |      events,\\nT |      not\\nso: t\n                |                 |                 |     al size;\\nT |      is that, t |     ceive\\nso t\n                |                 |                 |     thought!\\nT |     r hands,\\nT |      to heart t\n                |                 |                 |     ny wood,\\nT |      r there, t |      iolanus, t\n                |                 |                 |     e Lewis,\\nT |     ate boy,\\nT |      ople and t\n                |                 |                 |     suffice,\\nT |     majesty,\\nT |      or ever. T\n                |                 |                 |     t aside,\\nT |     r it be,\\nT |     it\\nsaid, t\n                |                 |                 |     y bliss,\\nT |     the key,\\nT |      rtunate, t\n                |                 |                 |      friend,\\nT |      danger,\\nT |       supper, t\n                |                 |                 |     ed king,\\nT |     himself!\\nT |     \\nstrange t\n                |                 |                 |     w bride:\\nT |     ur lies:\\nT |      yal one; t\n                |                 |                 |     loyalty,\\nT |      breath,\\nT |     ent,\\nand t\n                |                 |                 |     vocable,\\nT |      r lives, t |      hat made t\n                |                 |                 |      choice,\\nT |     t sound;\\nT |      nd drop: t\n                |                 |                 |     e aside,\\nT |     py sees,\\nT |     ot,\\nLest t\n                |                 |                 |     ne well,\\nT |      ray his; t |      O world, t\n                |                 |                 |     n brief,\\nT |     hee how:\\nT |      her, who t\n                |                 |                 |     ewarn'd:\\nT |     ed lord,\\nT |     r sleep,\\nT\n                |                 |                 |     aughter;\\nT |     ur land;\\nT |     vingman:\\nW\n                |                 |                 |     for war;\\nT |     ine ear;\\nT |      y house: t\n                |                 |                 |     lliance:\\nT |     t again;\\nT |     is\\nhead; t\n                |                 |                 |     dly vow,\\nT |     ors are:\\nT |      entrance t\n                |                 |                 |     no hour,\\nT |     r shame,\\nT |      ntleman, t\n                |                 |                 |     es well;\\nT |      I king;\\nT |      Prithee, t\n                |                 |                 |     verture,\\nT |      a king;\\nT |     s it is!\\nT\n                |                 |                 |     ry easy:\\nT |      ne eyes, t |     is!\\nThen t\n                |                 |                 |     s stand:\\nT |     le peer;\\nT |      ice than t\n                |                 |                 |      parted,\\nT |     bestrid,\\nT |      istress. T\n                |                 |                 |     bassade,\\nT |     al hand;\\nT |     \\nNot yet t\n                |                 |                 |     as king:\\nT |      e devil, t |     dost not\\nT\n                |                 |                 |     e to do;\\nT |     nd Kent:\\nT |      in sound t\n                |                 |                 |     my womb:\\nT |     t Seely,\\nT |     hy name?\\nT\n                |                 |                 |     nctuary,\\nT |      of woe,\\nT |      ; though t\n                |                 |                 |     s right:\\nT |     ly Land,\\nT |     's torn.\\nT\n                |                 |                 |     er days,\\nT |      he wall: t |      hee not: t\n                |                 |                 |     houghts,\\nT |     enheads;\\nt |     ath done\\nT\n                |                 |                 |     nd ours:\\nT |     s hinds?\\nT |      arly and t\n                |                 |                 |     rittany,\\nT |      beasts,\\nT |      ischief; t\n                |                 |                 |     r claim:\\nT |     naments,\\nT |      iolanus: t\n                |                 |                 |     of hand:\\nT |     ternoon,\\nT |     service,\\nT\n                |                 |                 |      in war;\\nT |     is case,\\nT |      gers and t\n                |                 |                 |     in Kent,\\nT |     nd part,\\nT |     re\\nWhich t\n                |                 |                 |     th thee:\\nT |     our son:\\nT |     remains;\\nT\n                |                 |                 |     h err'd:\\nT |      my own,\\nT |      f slaves t\n                |                 |                 |     he lamb,\\nT |     hy stay,\\nT |     e spite,\\nT\n                |                 |                 |     remains:\\nT |     ot here;\\nT |      ee here. T\n                |                 |                 |     am lies:\\nT |     ly poor,\\nT |      in thee, t\n                |                 |                 |     seduced,\\nT |     oo fair,\\nT |     if so be\\nT\n                |                 |                 |     ly oath:\\nT |     on more:\\nT |      and that t\n                |                 |                 |     beloved,\\nT |       sirrah, t |      t tired, t\n                |                 |                 |     e world:\\nT |      is last, t |     m\\nLonger t\n                |                 |                 |     s again;\\nT |     anguish;\\nT |      thee and t\n                |                 |                 |     it came:\\nT |     anguish:\\nT |      live but t\n                |                 |                 |     erboard,\\nT |      sisters; t |     ore\\nThan t\n                |                 |                 |     from us,\\nT |     ver die,\\nT |      ath; but t\n                |                 |                 |     s world,\\nT |     ourteen;\\nT |     ee here,\\nT\n                |                 |                 |     you had,\\nT |     ty fool,\\nT |     pt heart\\nT\n                |                 |                 |     ty mind;\\nT |      I trow,\\nT |      nce more t\n                |                 |                 |      Icarus;\\nT |     olidame,\\nT |      rm fort: t\n                |                 |                 |      course;\\nT |     t laugh,\\nT |      and me;\\nW\n                |                 |                 |     il sign;\\nT |     s grace!\\nT |      rel else t\n                |                 |                 |     n trees;\\nT |     n brief:\\nT |      ome, but t\n                |                 |                 |     's hope,\\nT |     ntleman?\\nT |      in,\\nAnd t\n                |                 |                 |     st born,\\nT |     d lover,\\nT |      re here, t\n                |                 |                 |     e heard,\\nT |     to hide:\\nT |     itories,\\nT\n                |                 |                 |     ampions;\\nT |     e glory,\\nT |     ilt have\\nT\n                |                 |                 |     ng heat,\\nT |     en love;\\nT |      evenges, t\n                |                 |                 |     brother,\\nT |     o rough,\\nT |      d, since t\n                |                 |                 |     ; but I,\\nT |     s' legs,\\nT |      remote,\\nT\n                |                 |                 |     ed lady!\\nT |     hoppers,\\nT |      s simply t\n                |                 |                 |     t go on;\\nT |     r's web,\\nT |       soldier t\n                |                 |                 |     e twice:\\nT |     ld grub,\\nT |      irectly, t\n                |                 |                 |     husband;\\nT |      asleep,\\nT |      ors, but t\n                |                 |                 |      say so,\\nT |     e bodes:\\nT |     hand and\\nt\n                |                 |                 |      centre:\\nT |     arriage:\\nT |      and sowl t\n                |                 |                 |      kernel,\\nT |      thence,\\nT |      But when t\n                |                 |                 |     ing now,\\nT |      he fire, t |     ain,\\nand t\n                |                 |                 |     egative,\\nT |     ic face,\\nT |      n blood, t\n                |                 |                 |     rs only,\\nT |      my kin,\\nT |     vingman:\\nT\n                |                 |                 |     nothing;\\nT |     n spite,\\nT |      -morrow; t\n                |                 |                 |     profits,\\nT |     agement:\\nT |      ast, and t\n                |                 |                 |     settled,\\nT |      my will, t |     d again.\\nT\n                |                 |                 |     honesty,\\nT |      indeed?\\nT |      ing, but t\n                |                 |                 |     Hark ye;\\nT |     ands do;\\nT |     increase\\nt\n                |                 |                 |      pander:\\nT |    \\nJULIET:\\nT |      children t\n                |                 |                 |     rse him:\\nT |      aughter, t |       because t\n                |                 |                 |     ld upon,\\nT |       I fear; t |     another.\\nT\n                |                 |                 |     d fools;\\nT |   \\n\\nNurse:\\nT |      lscians. T\n                |                 |                 |     ith her;\\nT |      s there, t |       rising, t\n                |                 |                 |     not see,\\nT |     ontague;\\nT |     ds\\nBlush t\n                |                 |                 |     honesty:\\nT |     ly hate!\\nT |     her had,\\nT\n                |                 |                 |     jecture,\\nT |     s to me,\\nT |      We stood t\n                |                 |                 |     e's ado,\\nT |     is heir;\\nT |     friends:\\nT\n                |                 |                 |     , madam,\\nT |      e means, t |      ive, and t\n                |                 |                 |     e child:\\nT |     eth not;\\nT |     ens:\\nNow t\n                |                 |                 |     himself,\\nT |     ent lie,\\nT |     ely time\\nT\n                |                 |                 |      of him:\\nT |      ar thee, t |      han when t\n                |                 |                 |     ngeance,\\nT |     it down;\\nT |      one sole t\n                |                 |                 |     e, alas,\\nT |     e trees,\\nT |      by this, t\n                |                 |                 |     r evils,\\nT |     kle-bed;\\nT |      Reports, t\n                |                 |                 |     bastard;\\nT |     h grief,\\nT |     ishment,\\nT\n                |                 |                 |     se, lip,\\nT |      speaks:\\nT |     can,\\nAnd t\n                |                 |                 |      valley,\\nT |     her eyes\\nT |      l chance t\n                |                 |                 |      hang'd,\\nT |      e there, t |     ome\\nThat t\n                |                 |                 |      say so;\\nT |     at hand,\\nT |      m, 'fore t\n                |                 |                 |     ot, sir:\\nT |     y enemy;\\nT |     thy sir,\\nT\n                |                 |                 |     torture,\\nT |       hither, t |      ed only, t\n                |                 |                 |      speedy,\\nT |     attempt;\\nT |     re atone\\nT\n                |                 |                 |      oracle,\\nT |      ee thee, t |      ire, and t\n                |                 |                 |     aughter,\\nT |     ir hate,\\nT |     ters and\\nT\n                |                 |                 |      enough;\\nT |     wear'st,\\nT |     r pates,\\nT\n                |                 |                 |     threats:\\nT |      he moon, t |      he leads t\n                |                 |                 |     mmodity:\\nT |     nt moon,\\nT |      ter; and t\n                |                 |                 |     y liege,\\nT |      sudden;\\nT |     nfidence\\nT\n                |                 |                 |     e alive,\\nT |     d night!\\nT |     tion and\\nT\n                |                 |                 |     st Lord:\\nT |     to thee,\\nT |     , unless\\nT\n                |                 |                 |     justice,\\nT |     ourable,\\nT |      ask it?\\nT\n                |                 |                 |      oracle:\\nT |     y grief:\\nT |      r shame; t\n                |                 |                 |     port it!\\nT |      e worse, t |      even\\nAs t\n                |                 |                 |     't much,\\nT |     s voice,\\nT |     he brand\\nT\n                |                 |                 |     h woman:\\nT |      sorrow,\\nT |      n again. T\n                |                 |                 |     science,\\nT |     ing eye,\\nT |     defence,\\nT\n                |                 |                 |     hepherd:\\nT |     h reign:\\nT |       I; and, t\n                |                 |                 |     leaving,\\nT |      is true; t |      y of us: t\n                |                 |                 |      budget,\\nT |     nded me,\\nT |     est; and\\nt\n                |                 |                 |     gh self,\\nT |      I pray,\\nT |     ismay'd:\\nT\n                |                 |                 |     I think,\\nT |     n waste,\\nT |      to have\\nT\n                |                 |                 |      he look, t |     e allow;\\nT |      ue which t\n                |                 |                 |     onstant,\\nT |     y prove,\\nT |     re meat,\\nT\n                |                 |                 |     arjoram;\\nT |      nd slow; t |      ble, and t\n                |                 |                 |     ffodils,\\nT |      sticoes; t |       person, t\n                |                 |                 |     l kinds,\\nT |      andsire, t |      or else\\nT\n                |                 |                 |      I lack,\\nT |      mongers, t |      nd so he t\n                |                 |                 |     affairs,\\nT |      is worn, t |      gar eye, t\n                |                 |                 |     es pair,\\nT |      heveril, t |     t undone\\nT\n                |                 |                 |     herself,\\nT |     natural,\\nt |     own;\\nAnd t\n                |                 |                 |     port it,\\nT |      lewoman, t |     are his:\\nT\n                |                 |                 |     e to me:\\nT |      as this, t |     him too:\\nT\n                |                 |                 |     ese are:\\nT |      ith her, t |      ers; and t\n                |                 |                 |     monarch,\\nT |     ear say,\\nT |     as hasty\\nT\n                |                 |                 |     's heir,\\nT |      eet him: t |      ish, who t\n                |                 |                 |     him too,\\nT |     g hills:\\nT |     r taints\\nT\n                |                 |                 |     plainly,\\nT |     e about,\\nT |     udgment,\\nT\n                |                 |                 |     e three,\\nT |     e' cell;\\nT |      than one t\n                |                 |                 |     et, yea,\\nT |      cheeks,\\nT |     a merit,\\nT\n                |                 |                 |      I fear:\\nT |     her way,\\nT |     s thine,\\nT\n                |                 |                 |     deliver,\\nT |     oly act,\\nT |       of all; t\n                |                 |                 |     ou down:\\nT |     ppetite:\\nT |     he coy'd\\nT\n                |                 |                 |      to you:\\nT |     doth so;\\nT |      nothing, t\n                |                 |                 |     w of me,\\nT |     rnament:\\nT |     tleless,\\nT\n                |                 |                 |     peed us!\\nT |      retire:\\nT |     or Rome,\\nT\n                |                 |                 |     are now!\\nT |      ercutio, t |      one whom t\n                |                 |                 |     ese are,\\nT |      I none;\\nT |       or two, t\n                |                 |                 |     so much,\\nT |      devise,\\nT |      nd still t\n                |                 |                 |     r issue;\\nT |     e\\nlives; t |     ild,\\nAnd t\n                |                 |                 |     y ebb'd,\\nT |      depend;\\nT |     ue,\\nMore t\n                |                 |                 |      father!\\nT |     k again,\\nT |      or Rome, t\n                |                 |                 |     e to be;\\nT |      hed boy, t |     t dined:\\nT\n                |                 |                 |     s first:\\nT |     ercutio?\\nT |      old, and t\n                |                 |                 |      beauty,\\nT |     l brawl:\\nT |      stuff'd\\nT\n                |                 |                 |     look up:\\nT |     uld end,\\nT |      hese and t\n                |                 |                 |     ntleman:\\nT |      abuses:\\nT |     er souls\\nT\n                |                 |                 |     ok upon,\\nT |      steeds,\\nT |      e fasts: t\n                |                 |                 |     l piece,\\nT |     g night,\\nT |     est,\\nAnd t\n                |                 |                 |     atience!\\nT |     l night,\\nT |     s injury\\nT\n                |                 |                 |     ly done:\\nT |     wn bold,\\nT |     iss'd me\\nT\n                |                 |                 |     ethinks,\\nT |     all die,\\nT |      country. T\n                |                 |                 |     forbear:\\nT |     meo can,\\nT |      es haste t\n                |                 |                 |     e lives,\\nT |      rt thou, t |      go back: t\n                |                 |                 |     pardons,\\nT |     me thus?\\nT |      fellow,\\nT\n                |                 |                 |    \\nAngelo,\\nT |      es shut, t |     ave been\\nT\n                |                 |                 |     Escalus,\\nT |      e earth, t |      leasing: t\n                |                 |                 |     ou well;\\nT |     ntleman!\\nT |      o lie as t\n                |                 |                 |     ir eyes:\\nT |     a vitae:\\nT |      hastely. T\n                |                 |                 |     service:\\nT |      se woes, t |      ne that, t\n                |                 |                 |     he nose;\\nT |      d lives, t |      ot pass. T\n                |                 |                 |     sabella,\\nT |      e forth, t |       shield, t\n                |                 |                 |     rioress:\\nT |     ishment:\\nT |     d\\nwomen, t\n                |                 |                 |      me ask,\\nT |     ust fly:\\nT |     eceived;\\nt\n                |                 |                 |     to jest,\\nT |      f death, t |     \\nI mean, t\n                |                 |                 |     statute,\\nT |     ofess'd,\\nT |     on thee.\\nT\n                |                 |                 |      little,\\nT |     losophy,\\nT |      no worse t\n                |                 |                 |     regnant,\\nT |      rt thee, t |     rse than\\nt\n                |                 |                 |     is jade:\\nT |     anished,\\nT |      my son!\\nt\n                |                 |                 |     , means;\\nT |      do now,\\nT |      ome, and t\n                |                 |                 |     d sword,\\nT |     , arise;\\nT |      ntrymen. T\n                |                 |                 |     h slept:\\nT |     ng both!\\nT |      ath, and t\n                |                 |                 |      Heaven,\\nT |      y birth, t |       others: t\n                |                 |                 |      itself,\\nT |      hy love, t |      breasts. T\n                |                 |                 |     er live!\\nT |     thy wit:\\nT |     , rather\\nT\n                |                 |                 |     ove her,\\nT |     f a man;\\nT |      ow much. T\n                |                 |                 |     us love,\\nT |     cherish;\\nT |     ed thee,\\nT\n                |                 |                 |     mark me;\\nT |     ly dead;\\nT |      e speak. T\n                |                 |                 |      myself:\\nT |     ppy too:\\nT |      ome: yet t\n                |                 |                 |     at once,\\nT |      o exile; t |      n scarce t\n                |                 |                 |     lls out,\\nT |     n wench,\\nT |      against\\nT\n                |                 |                 |     you are,\\nT |     hy love:\\nT |      friends\\nT\n                |                 |                 |     erweigh,\\nT |     luckily,\\nT |     nds\\nThat t\n                |                 |                 |     blushes,\\nT |     -morrow;\\nT |       indeed. T\n                |                 |                 |      mouths,\\nT |     el much:\\nT |      I have,\\nT\n                |                 |                 |     ppetite,\\nT |     ry late,\\nT |      d sourly t\n                |                 |                 |     brother:\\nT |     he lark,\\nT |      offer'd\\nT\n                |                 |                 |     luences,\\nT |     exhales,\\nT |      s, which t\n                |                 |                 |     ts bows,\\nT |      Mantua:\\nT |       accept; t\n                |                 |                 |     ee sire,\\nT |     ivision;\\nT |     him only\\nT\n                |                 |                 |     nd rich,\\nT |     chamber:\\nT |     nly\\nThat t\n                |                 |                 |     we fear,\\nT |     im live;\\nT |      oremost; t\n                |                 |                 |      leiger:\\nT |     hou not:\\nT |      st; then t\n                |                 |                 |     h speed;\\nT |     'd dram,\\nT |     her hand\\nT\n                |                 |                 |     ay live:\\nT |     mper it;\\nT |      andchild t\n                |                 |                 |     straint,\\nT |      of joy,\\nT |       heaven, t\n                |                 |                 |     ust die:\\nT |     ntleman,\\nT |     how\\nThan t\n                |                 |                 |     of hell,\\nT |      s haste; t |       cushion t\n                |                 |                 |     rginity,\\nT |     \\nEre he, t |      ion than t\n                |                 |                 |     t where;\\nT |       father; t |     ted son?\\nT\n                |                 |                 |      to rot;\\nT |      h tears; t |      e stars; t\n                |                 |                 |     bed ice;\\nT |     on, you,\\nT |      ibility, t\n                |                 |                 |     ed bawd!\\nT |      tender,\\nT |     blicola,\\nT\n                |                 |                 |     be done,\\nT |     ee good:\\nT |     e icicle\\nT\n                |                 |                 |     for sin,\\nT |      clouds,\\nT |      bleness; t\n                |                 |                 |     im hide,\\nT |     nothing,\\nT |      ur wife, t\n                |                 |                 |     e times,\\nT |     e' cell,\\nT |      before:\\nT\n                |                 |                 |     ed gate,\\nT |     nsellor;\\nT |      chanics: t\n                |                 |                 |     ger key:\\nT |      e friar, t |      ask, but t\n                |                 |                 |     n leads;\\nT |     ouse ye:\\nT |     ill ask;\\nT\n                |                 |                 |     e along,\\nT |      another, t |      request, t\n                |                 |                 |     e haste;\\nT |     em both:\\nT |      ardness: t\n                |                 |                 |      verity:\\nT |     y Paris,\\nT |      ed since t\n                |                 |                 |     e gates,\\nT |     thyself,\\nT |      y exile. T\n                |                 |                 |     nt bulk,\\nT |     s shame,\\nT |      r: since t\n                |                 |                 |     l drift;\\nT |      shroud;\\nT |      nd child t\n                |                 |                 |     sounded;\\nT |      gs that, t |      The son, t\n                |                 |                 |     rong it,\\nT |     r doubt,\\nT |      band and t\n                |                 |                 |     I speak:\\nT |      livest;\\nT |      capital: t\n                |                 |                 |     rdon it;\\nT |      y ashes, t |      e bound, t\n                |                 |                 |      hither,\\nT |      thy bed, t |     victory,\\nW\n                |                 |                 |     king on;\\nT |     ou dead:\\nT |     ust lose\\nT\n                |                 |                 |     y oaths,\\nT |      fingers: t |      alamity, t\n                |                 |                 |     per ear,\\nT |     tand up:\\nT |     ely shed\\nT\n                |                 |                 |      pardon,\\nT |      closet,\\nT |       fortune t\n                |                 |                 |     came on,\\nT |     y veins,\\nT |     une till\\nT\n                |                 |                 |     ith him!\\nT |     e vault,\\nT |     th parts\\nT\n                |                 |                 |     g death,\\nT |     ry like,\\nT |       of one, t\n                |                 |                 |      withal,\\nT |     d night,\\nT |      try than t\n                |                 |                 |     oodness:\\nT |      d years, t |      tread--\\nT\n                |                 |                 |     t scent:\\nT |      crow'd,\\nT |      st to't, t\n                |                 |                 |     hem all:\\nT |     tis day:\\nT |     's womb,\\nT\n                |                 |                 |     ith ale,\\nT |     warrant,\\nT |     nd mine,\\nT\n                |                 |                 |     e wakes,\\nT |     is rest,\\nT |      his boy, t\n                |                 |                 |     t means,\\nT |     me wail,\\nT |      ger, but t\n                |                 |                 |     py time;\\nT |      so ill,\\nT |     did tend\\nT\n                |                 |                 |      a lady:\\nT |     estival,\\nT |       Romans, t\n                |                 |                 |     trapp'd,\\nT |     r grave:\\nT |      show'd;' t\n                |                 |                 |      a lord:\\nT |      y troth, t |      all-hail t\n                |                 |                 |      malady,\\nT |     usician:\\nT |     eat son,\\nT\n                |                 |                 |      frenzy:\\nT |      in here; t |      ain, but t\n                |                 |                 |     ombardy,\\nT |     my lips,\\nT |     certain,\\nT\n                |                 |                 |     nceived,\\nT |     , stars!\\nT |      er Rome, t\n                |                 |                 |     ken you;\\nT |      emember, t |     it\\nWhich t\n                |                 |                 |     ou know;\\nT |     hy back;\\nT |      hronicle t\n                |                 |                 |     age was,\\nT |     d's law;\\nT |     me, son:\\nT\n                |                 |                 |     ontents:\\nT |     ee rich;\\nT |      honour,\\nT\n                |                 |                 |     nor had,\\nT |       poison; t |     he gods;\\nT\n                |                 |                 |     he maid:\\nT |      ing him, t |     \\nAnd yet t\n                |                 |                 |     ws thus;\\nT |     herhood,\\nT |     h a bolt\\nT\n                |                 |                 |     r mouth:\\nT |     y moans:\\nT |     t speak?\\nT\n                |                 |                 |     h after,\\nT |     o-night,\\nT |     an\\nStill t\n                |                 |                 |     y leave,\\nT |     y limbs:\\nT |      reasons. T\n                |                 |                 |      er head, t |     ontague,\\nT |       stocks. T\n                |                 |                 |      effect:\\nT |      e youth, t |      not so,\\nT\n                |                 |                 |     hearsed,\\nT |      beauty:\\nT |      est; and t\n                |                 |                 |     e woo'd;\\nT |     y guide!\\nT |     ue thee,\\nT\n                |                 |                 |     a ta'en,\\nT |     thecary!\\nT |     ee,\\nThat t\n                |                 |                 |      tongue,\\nT |      chance!\\nT |       from me t\n                |                 |                 |     o, hark:\\nT |     on them,\\nT |     ty which\\nT\n                |                 |                 |     be bold,\\nT |      dagger!\\nT |     r knees.\\nT\n                |                 |                 |     ll know,\\nT |      sheath;\\nt |     re pride\\nT\n                |                 |                 |      wooers;\\nT |      e place; t |      an end;\\nT\n                |                 |                 |     ake one,\\nT |     atchman:\\nT |     hold 's:\\nT\n                |                 |                 |     ath two,\\nT |     arly up,\\nT |     gth\\nThan t\n                |                 |                 |     n sooth:\\nT |     a while,\\nT |     t us go:\\nT\n                |                 |                 |      be wed:\\nT |      ir head, t |      Volscian t\n                |                 |                 |     ourself,\\nT |    \\nPRINCE:\\nT |     ire,\\nAnd t\n                |                 |                 |     e of me;\\nT |     e night,\\nT |       Behold, t\n                |                 |                 |     ematics,\\nT |     my cell,\\nT |      do ope,\\nT\n                |                 |                 |     request,\\nT |     s words,\\nT |      own, and t\n                |                 |                 |     creased:\\nT |     ur hate,\\nT |     al scene\\nT\n                |                 |                 |     ween us,\\nT |     hy hand:\\nT |      le thing t\n                |                 |                 |     btain'd,\\nT |     re gold;\\nT |       a grub. T\n                |                 |                 |     r winds,\\nT |     s known,\\nT |      from man t\n                |                 |                 |      a word;\\nT |      brings;\\nT |      d horse. T\n                |                 |                 |     hearing:\\nT |     ht blow:\\nT |      ine, and t\n                |                 |                 |     e, Kate,\\nT |     RICHARD:\\nT |      his eye; t\n                |                 |                 |     ry town,\\nT |     im best,\\nT |      him than t\n                |                 |                 |     flowers:\\nT |     se peer,\\nT |      e tiger; t\n                |                 |                 |     ee well,\\nT |     LIFFORD:\\nT |      r necks, t\n                |                 |                 |      regard,\\nT |    \\nEXETER:\\nT |     r house:\\nT\n                |                 |                 |     ogether,\\nT |      is soul, t |     ring, if\\nT\n                |                 |                 |     g alone,\\nT |     of York;\\nT |     rt home,\\nT\n                |                 |                 |     on oath,\\nT |       he may, t |      od news; t\n                |                 |                 |      Venice,\\nT |     train'd,\\nT |     evail'd,\\nT\n                |                 |                 |      in all:\\nT |      lay'st,\\nT |       lurk'd, t\n                |                 |                 |     harmony:\\nT |      ionally, t |     tide,\\nAs t\n                |                 |                 |     we down:\\nT |      I live,\\nT |     ark you!\\nT\n                |                 |                 |     y, pray,\\nT |     y blood,\\nT |     d fifes,\\nT\n                |                 |                 |     trument,\\nT |     eet son:\\nT |      bals and t\n                |                 |                 |      of art;\\nT |     ow seas;\\nT |       ladies. T\n                |                 |                 |     fectual,\\nT |     y woman,\\nT |      to-day:\\nT\n                |                 |                 |     is word:\\nT |      my son!\\nT |      ark, how t\n                |                 |                 |     ng wise;\\nT |      and us;\\nT |      troness, t\n                |                 |                 |     rom her:\\nT |      re heir, t |      s before t\n                |                 |                 |     h words:\\nT |     istrate,\\nT |     , hoping\\nT\n                |                 |                 |     ossible,\\nT |     e place;\\nT |       do find t\n                |                 |                 |      Gremio,\\nT |     py hour;\\nT |     pirator:\\nT\n                |                 |                 |      Minola,\\nT |      en here, t |      nce; but t\n                |                 |                 |     so loud,\\nT |     y death!\\nT |      ds; and, t\n                |                 |                 |      at hand, t |     offence,\\nT |     fore\\nBut t\n                |                 |                 |     he heel;\\nT |       weapon, t |      his; and t\n                |                 |                 |     eathing:\\nT |     ir fury:\\nT |     me pride\\nT\n                |                 |                 |     Gregory;\\nT |      e blows, t |      o myself t\n                |                 |                 |     ot awry:\\nT |     ll here,\\nT |      s wrong: t\n                |                 |                 |     isquiet:\\nT |      breathe, t |     my lord:\\nT\n                |                 |                 |     holeric,\\nT |     erified,\\nT |       he sold t\n                |                 |                 |     haggard,\\nT |     admired;\\nT |       action: t\n                |                 |                 |     's call,\\nT |      divine;\\nT |      r native t\n                |                 |                 |     bolster,\\nT |     minable:\\nT |      h slain, t\n                |                 |                 |     dow now,\\nT |     e child,\\nT |      eir base t\n                |                 |                 |      master;\\nT |     lexible;\\nT |       throats t\n                |                 |                 |     ty long,\\nT |     s tears:\\nT |     ive away\\nT\n                |                 |                 |     ourtesy,\\nT |      my soul, t |     ird part\\nT\n                |                 |                 |     tremity,\\nT |     hem cry,\\nT |     Antiates\\nT\n                |                 |                 |     ery day,\\nT |     f youth,\\nT |     ricians,\\nT\n                |                 |                 |     thimble,\\nT |     e field,\\nT |     rds;\\nBut t\n                |                 |                 |     ink for:\\nT |      That we, t |      robbery, t\n                |                 |                 |     rthwith,\\nT |     he wept,\\nT |      r city,' t\n                |                 |                 |     ane end;\\nT |      taunts,\\nT |     victory,\\nT\n                |                 |                 |     's care,\\nT |      remain,\\nT |      the god, t\n                |                 |                 |     an this,\\nT |      m hence, t |      ss liar, t\n                |                 |                 |     t dower,\\nT |     f grief:\\nT |     my heart\\nT\n                |                 |                 |     ike you:\\nT |     re told,\\nT |      r annals t\n                |                 |                 |     not mad:\\nT |     e queen,\\nT |     s there,\\nT\n                |                 |                 |     ng eyes,\\nT |     h truth,\\nT |     : peace!\\nT\n                |                 |                 |     lewoman,\\nT |     re gone,\\nT |     folds-in\\nT\n                |                 |                 |     froward,\\nT |     ine day,\\nT |     ius,\\nAnd t\n                |                 |                 |     t-place;\\nT |     of York:\\nT |     s tribe,\\nT\n                |                 |                 |     ncentio;\\nT |    \\nEDWARD:\\nT |     nd Lord:\\nT\n                |                 |                 |      him to;\\nT |     d by me,\\nT |     rd Lord:\\nT\n                |                 |                 |     is done,\\nT |     r wreck:\\nT |     er\\nWhich t\n                |                 |                 |     her not;\\nT |     y crown,\\nT |      rejoice\\nT\n                |                 |                 |     ish too:\\nT |     ng sire;\\nT |     arded\\nAs t\n                |                 |                 |     se eyes,\\nT |     e field:\\nT |       sorrow. T\n                |                 |                 |      keeper,\\nT |      re king, t |      he drum, t\n                |                 |                 |     nd land,\\nT |     liament,\\nT |     rnfully:\\nT\n                |                 |                 |     edience;\\nT |     s right,\\nT |      l pikes. T\n                |                 |                 |     compare,\\nT |      ot thee, t |     e,\\nWhich t\n                |                 |                 |     unkards:\\nT |     traught,\\nT |      e clouds t\n                |                 |                 |     g'd yet,\\nT |      crowns,\\nT |       marches t\n                |                 |                 |     ow come;\\nT |     for him,\\nT |     d steeds\\nT\n                |                 |                 |     r since,\\nT |     er stay:\\nT |      Nor made t\n                |                 |                 |     arkness,\\nT |     thyself?\\nT |     lass;\\nI, t\n                |                 |                 |     estions:\\nT |     d still,\\nT |      majesty\\nT\n                |                 |                 |      to fly,\\nT |     n games:\\nT |     ymph;\\nI, t\n                |                 |                 |     topmast,\\nT |     e alone:\\nT |      up,\\nAnd t\n                |                 |                 |     tinctly,\\nT |     py life,\\nT |     ,\\nUnless t\n                |                 |                 |      vessel,\\nT |     y swain;\\nT |     ity:\\nAnd t\n                |                 |                 |     e's hid:\\nT |     y point,\\nT |     a lover,\\nT\n                |                 |                 |     service;\\nT |     y sheep,\\nT |      dreams,\\nT\n                |                 |                 |     t first,\\nT |      onclude, t |      ence and t\n                |                 |                 |     he isle,\\nT |    \\nFather:\\nT |      alse and t\n                |                 |                 |     en done!\\nT |     in thee,\\nT |     cherous,\\nT\n                |                 |                 |     le race,\\nT |      y words, t |     e.\\nDive, t\n                |                 |                 |     rt best,\\nT |     is face,\\nT |     ed guard\\nT\n                |                 |                 |     al made;\\nT |      houses:\\nT |      my lord, t\n                |                 |                 |     n; obey:\\nT |     sembles;\\nT |     I am he.\\nT\n                |                 |                 |      I feel,\\nT |     ud York,\\nT |      highness t\n                |                 |                 |     threats,\\nT |     of York,\\nT |     she\\nThat t\n                |                 |                 |     's wife,\\nT |      flight:\\nT |       she and t\n                |                 |                 |     at loss,\\nT |     d queen,\\nT |       brother t\n                |                 |                 |     rt them:\\nT |      m Henry, t |     r there,\\nT\n                |                 |                 |     bastian,\\nT |     r house,\\nT |      Hastings t\n                |                 |                 |     undance,\\nT |     's life,\\nT |      m whence t\n                |                 |                 |     consent;\\nT |      at him,\\nT |     cure\\nBut t\n                |                 |                 |                 |     t march,\\nT |      heralds\\nT\n                |                 |                 |                 |      London,\\nT |     lds\\nThat t\n                |                 |                 |                 |      Keeper:\\nT |     he king,\\nT\n                |                 |                 |                 |     re love,\\nT |      livery:\\nT\n                |                 |                 |                 |     f thine;\\nT |     f,\\nSince t\n                |                 |                 |                 |     om thee,\\nT |      ces both t\n                |                 |                 |                 |     r's fee:\\nT |     gue;\\nAnd t\n                |                 |                 |                 |     e heart;\\nT |      ur grace t\n                |                 |                 |                 |     remorse,\\nT |      eantime, t\n                |                 |                 |                 |     stall'd;\\nT |     therhood\\nT\n                |                 |                 |                 |     at else,\\nT |     thee so,\\nT\n                |                 |                 |                 |      at love, t |      For they t\n                |                 |                 |                 |     prayers;\\nT |     at home;\\nT\n                |                 |                 |                 |     ook him,\\nT |      nt Paul, t\n                |                 |                 |                 |     and all,\\nT |      red more t\n                |                 |                 |                 |      spring,\\nT |      ther day t\n                |                 |                 |                 |      bodies,\\nT |      d for me t\n                |                 |                 |                 |     e bribe,\\nT |      father?\\nT\n                |                 |                 |                 |     d shrub;\\nT |      father:\\nT\n                |                 |                 |                 |     my body;\\nT |      re gone, t\n                |                 |                 |                 |     al size;\\nT |     y lament\\nT\n                |                 |                 |                 |     thought!\\nT |     ncaster!\\nT\n                |                 |                 |                 |       cheque, t |      invocate t\n                |                 |                 |                 |     ny wood,\\nT |     y ghost,\\nT\n                |                 |                 |                 |      d birth, t |     ne,\\nWife t\n                |                 |                 |                 |     e Lewis,\\nT |       Edward, t\n                |                 |                 |                 |      sister,\\nT |      ame hand t\n                |                 |                 |                 |     suffice,\\nT |      he blood t\n                |                 |                 |                 |    \\nOXFORD:\\nT |      p betide t\n                |                 |                 |                 |     his arm,\\nT |      wretch,\\nT\n                |                 |                 |                 |     t aside,\\nT |     of thee,\\nT\n                |                 |                 |                 |      ground,\\nT |      spiders, t\n                |                 |                 |                 |     success,\\nT |     iew;\\nAnd t\n                |                 |                 |                 |      t hence, t |      lord and t\n                |                 |                 |                 |      friend,\\nT |      ome, now t\n                |                 |                 |                 |     ed king,\\nT |     ly load,\\nT\n                |                 |                 |                 |     w bride:\\nT |     s fiend,\\nT\n                |                 |                 |                 |     Warwick,\\nT |     \\nAdvance t\n                |                 |                 |                 |     loyalty,\\nT |     \\nAvaunt, t\n                |                 |                 |                 |      but me?\\nT |     of hell!\\nT\n                |                 |                 |                 |      choice,\\nT |      His soul t\n                |                 |                 |                 |     e aside,\\nT |      ot have; t\n                |                 |                 |                 |     ne well,\\nT |      ast made t\n                |                 |                 |                 |     n brief,\\nT |     ,\\nBehold t\n                |                 |                 |                 |     ewarn'd:\\nT |      , Blush, t\n                |                 |                 |                 |      vereign; t |       exhales t\n                |                 |                 |                 |     aughter;\\nT |      dwells;\\nT\n                |                 |                 |                 |     for war;\\nT |      d, which t\n                |                 |                 |                 |     lliance:\\nT |      h, which t\n                |                 |                 |                 |     dly vow,\\nT |     uick,\\nAs t\n                |                 |                 |                 |     no hour,\\nT |      Villain, t\n                |                 |                 |                 |     es well;\\nT |      n devils t\n                |                 |                 |                 |     verture,\\nT |      d-evils, t\n                |                 |                 |                 |     ry easy:\\nT |      nce, but t\n                |                 |                 |                 |     s stand:\\nT |     man,\\nFor t\n                |                 |                 |                 |     kingdom,\\nT |      ils, but t\n                |                 |                 |                 |     as king:\\nT |      mstance, t\n                |                 |                 |                 |     e to do;\\nT |      rer than t\n                |                 |                 |                 |     my womb:\\nT |      can name t\n                |                 |                 |                 |     nctuary,\\nT |       leisure t\n                |                 |                 |                 |     s right:\\nT |      nk thee, t\n                |                 |                 |                 |     untsman:\\nT |      hy, then t\n                |                 |                 |                 |       author, t |      But dead t\n                |                 |                 |                 |     he sway,\\nT |     s blood;\\nT\n                |                 |                 |                 |     er days,\\nT |     ast,\\nBut t\n                |                 |                 |                 |      ent for, t |     DY ANNE:\\nT\n                |                 |                 |                 |     houghts,\\nT |     t me too\\nT\n                |                 |                 |                 |      s since, t |     UCESTER:\\nT\n                |                 |                 |                 |      vereign, t |      hank me, t\n                |                 |                 |                 |     nd ours:\\nT |     NNE:\\nAnd t\n                |                 |                 |                 |     rittany,\\nT |      t betide t\n                |                 |                 |                 |     r claim:\\nT |      t, madam t\n                |                 |                 |                 |     of hand:\\nT |     dy Anne,\\nT\n                |                 |                 |                 |      in war;\\nT |     omicide,\\nT\n                |                 |                 |                 |     in Kent,\\nT |      'ershade t\n                |                 |                 |                 |     th thee:\\nT |      nd death t\n                |                 |                 |                 |      revenge, t |     natural,\\nT\n                |                 |                 |                 |     h err'd:\\nT |     sonable,\\nT\n                |                 |                 |                 |     he lamb,\\nT |      He lives t\n                |                 |                 |                 |     remains:\\nT |      y sight! t\n                |                 |                 |                 |     am lies:\\nT |     E:\\nWould t\n                |                 |                 |                 |     seduced,\\nT |      silisks, t\n                |                 |                 |                 |     gle ten,\\nT |      o strike t\n                |                 |                 |                 |     hy face,\\nT |     g death.\\nT\n                |                 |                 |                 |     ly oath:\\nT |     ,\\nShamed t\n                |                 |                 |                 |     de\\nThat, t |     h drops:\\nT\n                |                 |                 |                 |     beloved,\\nT |     rd wept,\\nT\n                |                 |                 |                 |      my fall, t |      ous moan t\n                |                 |                 |                 |      se eyes, t |     a child,\\nT\n                |                 |                 |                 |     day sun,\\nT |     ath,\\nAnd t\n                |                 |                 |                 |     e world:\\nT |     nd weep,\\nT\n                |                 |                 |                 |     s again;\\nT |      that sad t\n                |                 |                 |                 |      awhile!\\nT |      exhale,\\nT\n                |                 |                 |                 |     u didst,\\nT |      and made t\n                |                 |                 |                 |     g cloud,\\nT |     o speak.\\nT\n                |                 |                 |                 |     it came:\\nT |      ul forth t\n                |                 |                 |                 |     erboard,\\nT |       adoreth t\n                |                 |                 |                 |      is moan, t |     t me on.\\nT\n                |                 |                 |                 |      he rock; t |      sembler: t\n                |                 |                 |                 |       famish; t |     R:\\nTush, t\n                |                 |                 |                 |     from us,\\nT |     he word,\\nT\n                |                 |                 |                 |      o fight; t |     er love;\\nT\n                |                 |                 |                 |     s world,\\nT |     \\nTo both t\n                |                 |                 |                 |      ke that, t |      r deaths t\n                |                 |                 |                 |      he live, t |     ER:\\nSay, t\n                |                 |                 |                 |     rderers!\\nT |      ook, how t\n                |                 |                 |                 |      s a man; t |     \\nEven so t\n                |                 |                 |                 |     you had,\\nT |     us hand,\\nT\n                |                 |                 |                 |     I guess,\\nT |      designs\\nT\n                |                 |                 |                 |      sterous; t |     s\\nTo him t\n                |                 |                 |                 |     ty mind;\\nT |       joys me t\n                |                 |                 |                 |      Icarus;\\nT |      me too,\\nT\n                |                 |                 |                 |      course;\\nT |     enitent.\\nT\n                |                 |                 |                 |     presume,\\nT |     R:\\nSirs, t\n                |                 |                 |                 |     il sign;\\nT |     NTLEMEN:\\nT\n                |                 |                 |                 |     n trees;\\nT |      -Friars; t\n                |                 |                 |                 |     's hope,\\nT |      father,\\nT\n                |                 |                 |                 |     st born,\\nT |      r mouth, t\n                |                 |                 |                 |     e heard,\\nT |     er eyes,\\nT\n                |                 |                 |                 |       reason, t |     all,\\nBut t\n                |                 |                 |                 |     r right?\\nT |     t royal,\\nT\n                |                 |                 |                 |     r pride!\\nT |     s on me,\\nT\n                |                 |                 |                 |     ampions;\\nT |     ?\\nOn me, t\n                |                 |                 |                 |      erlands; t |     ,\\nMyself t\n                |                 |                 |                 |      th them, t |     tailors,\\nT\n                |                 |                 |                 |      or thee, t |     ave;\\nAnd t\n                |                 |                 |                 |     ng heat,\\nT |      air sun, t\n                |                 |                 |                 |      burthen: t |     a glass,\\nT\n                |                 |                 |                 |      at home, t |      , madam: t\n                |                 |                 |                 |     brother,\\nT |     m worse:\\nT\n                |                 |                 |                 |      y sooth, t |     IZABETH:\\nT\n                |                 |                 |                 |     ; but I,\\nT |   .\\n\\nGREY:\\nT\n                |                 |                 |                 |      r guest, t |     dly son,\\nT\n                |                 |                 |                 |     r queen,\\nT |     r,\\nA man t\n                |                 |                 |                 |     ed lady!\\nT |     f Derby.\\nT\n                |                 |                 |                 |     t go on;\\nT |      are they t\n                |                 |                 |                 |     e twice:\\nT |      ly Paul, t\n                |                 |                 |                 |     husband;\\nT |      lightly\\nT\n                |                 |                 |                 |      say so,\\nT |      live and t\n                |                 |                 |                 |      centre:\\nT |     arm,\\nBut t\n                |                 |                 |                 |      kernel,\\nT |      s simple t\n                |                 |                 |                 |     ing now,\\nT |    \\nRIVERS:\\nT\n                |                 |                 |                 |     the arm,\\nT |      To thee, t\n                |                 |                 |                 |      millius; t |      hen done t\n                |                 |                 |                 |     egative,\\nT |      matter.\\nT\n                |                 |                 |                 |      as that, t |     y gather\\nT\n                |                 |                 |                 |       theirs, t |      ot tell: t\n                |                 |                 |                 |     rs only,\\nT |      so bad,\\nT\n                |                 |                 |                 |     nothing;\\nT |      ced, and t\n                |                 |                 |                 |     profits,\\nT |     le those\\nT\n                |                 |                 |                 |     settled,\\nT |      re, sir, t\n                |                 |                 |                 |     LIXENES:\\nT |     nts,\\nAnd t\n                |                 |                 |                 |     honesty,\\nT |      ing hand t\n                |                 |                 |                 |      n mouth, t |      se gross t\n                |                 |                 |                 |     Hark ye;\\nT |     ant-maid\\nT\n                |                 |                 |                 |      pander:\\nT |     ndition,\\nT\n                |                 |                 |                 |     rse him:\\nT |     ch thee!\\nT\n                |                 |                 |                 |     dy,' and\\nT |     he king?\\nT\n                |                 |                 |                 |     ld upon,\\nT |      dventure t\n                |                 |                 |                 |     d fools;\\nT |     oo well:\\nT\n                |                 |                 |                 |     ith her;\\nT |      er blood t\n                |                 |                 |                 |      ughters; t |      ll which t\n                |                 |                 |                 |     not see,\\nT |      so still t\n                |                 |                 |                 |     honesty:\\nT |     ARGARET:\\nW\n                |                 |                 |                 |      he loss, t |     e world,\\nT\n                |                 |                 |                 |      he gain, t |      codemon! t\n                |                 |                 |                 |     jecture,\\nT |      y heart, t\n                |                 |                 |                 |     e's ado,\\nT |     e in me.\\nT\n                |                 |                 |                 |     ray you,\\nT |      pirates, t\n                |                 |                 |                 |     e child:\\nT |     cts,\\nYet t\n                |                 |                 |                 |     it, sir:\\nT |      marr'd;\\nT\n                |                 |                 |                 |       any be, t |     nishment\\nT\n                |                 |                 |                 |     himself,\\nT |      me;\\nAnd t\n                |                 |                 |                 |      of him:\\nT |     egiance:\\nT\n                |                 |                 |                 |     ngeance,\\nT |     ee,\\nWhen t\n                |                 |                 |                 |      sorrow:\\nT |     yes,\\nAnd t\n                |                 |                 |                 |     e, alas,\\nT |      nd then, t\n                |                 |                 |                 |      as you,\\nT |       curses, t\n                |                 |                 |                 |       either, t |       is God, t\n                |                 |                 |                 |     r evils,\\nT |     abe,\\nAnd t\n                |                 |                 |                 |     bastard;\\nT |      berland, t\n                |                 |                 |                 |     se, lip,\\nT |     oat,\\nAnd t\n                |                 |                 |                 |      valley,\\nT |      heaven?\\nT\n                |                 |                 |                 |      hang'd,\\nT |     s death,\\nT\n                |                 |                 |                 |      en thou, t |      heaven?\\nW\n                |                 |                 |                 |      say so;\\nT |       clouds, t\n                |                 |                 |                 |     ot, sir:\\nT |       murder, t\n                |                 |                 |                 |     torture,\\nT |     iolence!\\nT\n                |                 |                 |                 |      do this, t |      , for me t\n                |                 |                 |                 |      d bears, t |      ghts, as t\n                |                 |                 |                 |      he isle, t |     ray him,\\nT\n                |                 |                 |                 |      ught me, t |      ave done t\n                |                 |                 |                 |      speedy,\\nT |      y charm, t\n                |                 |                 |                 |      oracle,\\nT |     ipe,\\nAnd t\n                |                 |                 |                 |     aughter,\\nT |      On thee, t\n                |                 |                 |                 |      enough;\\nT |     s peace!\\nT\n                |                 |                 |                 |     threats:\\nT |     hy soul!\\nT\n                |                 |                 |                 |     mmodity:\\nT |      rs while t\n                |                 |                 |                 |     y liege,\\nT |      devils!\\nT\n                |                 |                 |                 |     e alive,\\nT |     ing hog!\\nT\n                |                 |                 |                 |     st Lord:\\nT |     nativity\\nT\n                |                 |                 |                 |     justice,\\nT |      ture and t\n                |                 |                 |                 |      oracle:\\nT |     vy womb!\\nT\n                |                 |                 |                 |      or boys, t |     s loins!\\nT\n                |                 |                 |                 |     't much,\\nT |       honour! t\n                |                 |                 |                 |      to thee, t |     ght\\nThat t\n                |                 |                 |                 |      an stir; t |       me make t\n                |                 |                 |                 |     h woman:\\nT |      nsnareth t\n                |                 |                 |                 |     science,\\nT |      l, fool! t\n                |                 |                 |                 |     elieved,\\nt |     thyself.\\nT\n                |                 |                 |                 |      hing be, t |      ome when t\n                |                 |                 |                 |     \\nsights: t |     h for me\\nT\n                |                 |                 |                 |      ee here; t |     se,\\nLest t\n                |                 |                 |                 |     hepherd:\\nT |     ARGARET:\\nT\n                |                 |                 |                 |      h eaten: t |     me duty,\\nT\n                |                 |                 |                 |     of Time,\\nT |      ell, and t\n                |                 |                 |                 |     leaving,\\nT |     rent.\\nO, t\n                |                 |                 |                 |      nt thee: t |     serable!\\nT\n                |                 |                 |                 |      ligence, t |     ;\\nAnd if t\n                |                 |                 |                 |      budget,\\nT |      ey fall, t\n                |                 |                 |                 |      hearers, t |      hey dash t\n                |                 |                 |                 |   \\n\\nClown:\\nT |     RET:\\nAnd t\n                |                 |                 |                 |     gh self,\\nT |     f death;\\nW\n                |                 |                 |                 |     I think,\\nT |     .\\nO God, t\n                |                 |                 |                 |      he look, t |      or shame t\n                |                 |                 |                 |     onstant,\\nT |     e house!\\nT\n                |                 |                 |                 |      and not\\nT |     ood,\\nNor t\n                |                 |                 |                 |     arjoram;\\nT |     ver pass\\nT\n                |                 |                 |                 |     l kinds,\\nT |      ieve but t\n                |                 |                 |                 |     nt deed,\\nT |     sky,\\nAnd t\n                |                 |                 |                 |     es pair,\\nT |      kingham, t\n                |                 |                 |                 |     herself,\\nT |      he devil t\n                |                 |                 |                 |      garlic,\\nT |     ,\\nAnd he t\n                |                 |                 |                 |      y thing; t |       thereof t\n                |                 |                 |                 |     port it,\\nT |      her any, t\n                |                 |                 |                 |      ieve me, t |       too hot t\n                |                 |                 |                 |       handle, t |     dy good,\\nT\n                |                 |                 |                 |      rue too, t |     clusion,\\nT\n                |                 |                 |                 |     ll well,\\nT |     o brawl.\\nT\n                |                 |                 |                 |     e to me:\\nT |     \\nNamely, t\n                |                 |                 |                 |      t-herds, t |     r allies\\nT\n                |                 |                 |                 |      e-herds, t |     er.\\nNow, t\n                |                 |                 |                 |      of hair, t |      whet me\\nT\n                |                 |                 |                 |     ese are:\\nT |     rey:\\nBut t\n                |                 |                 |                 |      and men, t |     ripture,\\nT\n                |                 |                 |                 |     and all:\\nT |     vil:\\nAnd t\n                |                 |                 |                 |     monarch,\\nT |      warrant\\nT\n                |                 |                 |                 |     's heir,\\nT |      r hearts t\n                |                 |                 |                 |     is time,\\nT |     urderer:\\nT\n                |                 |                 |                 |     him too,\\nT |     o prate;\\nT\n                |                 |                 |                 |     plainly,\\nT |       heavily t\n                |                 |                 |                 |     e three,\\nT |     a night,\\nT\n                |                 |                 |                 |     et, yea,\\nT |      thoughts t\n                |                 |                 |                 |     er died,\\nT |      hatches: t\n                |                 |                 |                 |      I fear:\\nT |     ancaster\\nT\n                |                 |                 |                 |     t to me:\\nT |      ruck me, t\n                |                 |                 |                 |     deliver,\\nT |      wrecks;\\nT\n                |                 |                 |                 |     ou down:\\nT |      sand men t\n                |                 |                 |                 |     w of me,\\nT |      inhabit, t\n                |                 |                 |                 |     ce, sir,\\nT |     of death\\nT\n                |                 |                 |                 |      xchange; t |     ng bulk,\\nW\n                |                 |                 |                 |     ld thee,\\nt |     life;\\nO, t\n                |                 |                 |                 |      seeming; t |      thought, t\n                |                 |                 |                 |     te\\nalso, t |     l night.\\nT\n                |                 |                 |                 |      ith her: t |      anish'd: t\n                |                 |                 |                 |      he king: t |     larence,\\nT\n                |                 |                 |                 |      g steel; t |       Furies, t\n                |                 |                 |                 |     ese are,\\nT |      s cries, t\n                |                 |                 |                 |      his son, t |      ion made t\n                |                 |                 |                 |       of man, t |      m afraid t\n                |                 |                 |                 |      am dead; t |     hee,\\nBut t\n                |                 |                 |                 |     nt\\nthem: t |      ing, and t\n                |                 |                 |                 |     so much,\\nT |      have but t\n                |                 |                 |                 |     ng good,\\nT |     ination,\\nT\n                |                 |                 |                 |     re good,\\nT |     w names,\\nT\n                |                 |                 |                 |     r issue;\\nT |      fers but t\n                |                 |                 |                 |      ose her; t |      mission; t\n                |                 |                 |                 |     y ebb'd,\\nT |      he keys, t\n                |                 |                 |                 |      ove her, t |     y to him\\nT\n                |                 |                 |                 |      Smalus,\\nT |     him\\nThat t\n                |                 |                 |                 |     ble sir,\\nT |      So I am, t\n                |                 |                 |                 |      father!\\nT |      ucester, t\n                |                 |                 |                 |     e to be;\\nT |      rd, when t\n                |                 |                 |                 |     s first:\\nT |      reward,\\nt\n                |                 |                 |                 |      beauty,\\nT |       any man t\n                |                 |                 |                 |     look up:\\nT |      very man t\n                |                 |                 |                 |     ir\\neyes; t |      self and t\n                |                 |                 |                 |      gesture; t |      thee but t\n                |                 |                 |                 |      eholder, t |      ord, and t\n                |                 |                 |                 |     ntleman:\\nT |     LARENCE:\\nT\n                |                 |                 |                 |      iveness; t |      der, but t\n                |                 |                 |                 |      ehearse, t |   ?\\n\\nBoth:\\nT\n                |                 |                 |                 |      ms much, t |     oth:\\nTo, t\n                |                 |                 |                 |      aughter; t |     \\nTo, to, t\n                |                 |                 |                 |     \\nanswer: t |      so,\\nAnd t\n                |                 |                 |                 |     ok upon,\\nT |      not, but t\n                |                 |                 |                 |     l piece,\\nT |      my lord; t\n                |                 |                 |                 |     atience!\\nT |     d of men\\nT\n                |                 |                 |                 |     ly done:\\nT |      evidence t\n                |                 |                 |                 |     ethinks,\\nT |     onounced\\nT\n                |                 |                 |                 |     forbear:\\nT |      of law,\\nT\n                |                 |                 |                 |     e lives,\\nT |     us sins,\\nT\n                |                 |                 |                 |      in that, t |     ds on me\\nT\n                |                 |                 |                 |    \\nAngelo,\\nT |     :\\nAnd he t\n                |                 |                 |                 |     Escalus,\\nT |       vassal! t\n                |                 |                 |                 |     ou well;\\nT |     ommanded\\nT\n                |                 |                 |                 |     ir eyes:\\nT |     ded\\nThat t\n                |                 |                 |                 |     ish well\\nT |      and wilt t\n                |                 |                 |                 |      nctions: t |      lt thou, t\n                |                 |                 |                 |       hollow: t |     a man's?\\nT\n                |                 |                 |                 |      and yet, t |     s hands,\\nT\n                |                 |                 |                 |      he seat, t |      ir heads t\n                |                 |                 |                 |     service:\\nT |     rer:\\nAnd t\n                |                 |                 |                 |     he nose;\\nT |     der too:\\nT\n                |                 |                 |                 |     sabella,\\nT |     crament,\\nT\n                |                 |                 |                 |     rioress:\\nT |     us,\\nWhen t\n                |                 |                 |                 |      me ask,\\nT |     ublicly,\\nT\n                |                 |                 |                 |     to jest,\\nT |     s course\\nT\n                |                 |                 |                 |     statute,\\nT |      Who made t\n                |                 |                 |                 |      little,\\nT |      de thee, t\n                |                 |                 |                 |     ot deny,\\nT |     tagenet,\\nT\n                |                 |                 |                 |     regnant,\\nT |      's love, t\n                |                 |                 |                 |      hey are, t |      uty, and t\n                |                 |                 |                 |      ts here, t |      laughter t\n                |                 |                 |                 |       dishes; t |      im, when t\n                |                 |                 |                 |      th here, t |      his soul t\n                |                 |                 |                 |      ry well, t |      harvest. T\n                |                 |                 |                 |      ve this, t |     th sobs,\\nT\n                |                 |                 |                 |      apsters: t |     hy soul,\\nT\n                |                 |                 |                 |     is jade:\\nT |      thou yet t\n                |                 |                 |                 |     r seven,\\nt |     o blind,\\nT\n                |                 |                 |                 |     , means;\\nT |     nd,\\nThat t\n                |                 |                 |                 |     d sword,\\nT |      st thou, t\n                |                 |                 |                 |     h slept:\\nT |      heavens, t\n                |                 |                 |                 |      ey live, t |     brother!\\nT\n                |                 |                 |                 |      Heaven,\\nT |      fee, and t\n                |                 |                 |                 |      itself,\\nT |      astings, t\n                |                 |                 |                 |     er live!\\nT |     WARD IV:\\nT\n                |                 |                 |                 |     ove her,\\nT |    \\nDORSET:\\nT\n                |                 |                 |                 |      g enemy, t |      ham doth t\n                |                 |                 |                 |      o think, t |       hollow, t\n                |                 |                 |                 |     us love,\\nT |      unto me! t\n                |                 |                 |                 |     mark me;\\nT |     y heart.\\nT\n                |                 |                 |                 |      myself:\\nT |     er here,\\nT\n                |                 |                 |                 |     at once,\\nT |      is death t\n                |                 |                 |                 |     lls out,\\nT |      th to me t\n                |                 |                 |                 |     you are,\\nT |      of you;\\nT\n                |                 |                 |                 |     n it is,\\nT |     for this\\nT\n                |                 |                 |                 |     erweigh,\\nT |      ce dead? t\n                |                 |                 |                 |      mouths,\\nT |     ied,\\nAnd t\n                |                 |                 |                 |     ppetite,\\nT |     termand,\\nT\n                |                 |                 |                 |     brother:\\nT |      ot worse t\n                |                 |                 |                 |     luences,\\nT |     ove?\\nWho t\n                |                 |                 |                 |       merely, t |      d me how t\n                |                 |                 |                 |     ts bows,\\nT |      forsake\\nT\n                |                 |                 |                 |     ee sire,\\nT |      me?\\nWho t\n                |                 |                 |                 |     nd rich,\\nT |      d naked, t\n                |                 |                 |                 |     we fear,\\nT |      defaced\\nT\n                |                 |                 |                 |      leiger:\\nT |      or soul. T\n                |                 |                 |                 |     h speed;\\nT |      not\\nHow t\n                |                 |                 |                 |      medy as, t |      ale when t\n                |                 |                 |                 |      a head,\\nT |     eath?\\nO, t\n                |                 |                 |                 |     ay live:\\nT |     t us in,\\nT\n                |                 |                 |                 |     straint,\\nT |   e.\\n\\nBoy:\\nT\n                |                 |                 |                 |      brother; t |     aways\\nIf t\n                |                 |                 |                 |     ust die:\\nT |   t.\\n\\nBoy:\\nT\n                |                 |                 |                 |     of hell,\\nT |      conclude t\n                |                 |                 |                 |     rginity,\\nT |     is dead.\\nT\n                |                 |                 |                 |      in him,\\nT |      Told me, t\n                |                 |                 |                 |     t where;\\nT |     ORK:\\nOh, t\n                |                 |                 |                 |      to rot;\\nT |      yea, and t\n                |                 |                 |                 |     bed ice;\\nT |      une, and t\n                |                 |                 |                 |      be true; t |     oul,\\nAnd t\n                |                 |                 |                 |      ith him, t |     e brief,\\nT\n                |                 |                 |                 |     be done,\\nT |      in him.\\nT\n                |                 |                 |                 |     for sin,\\nT |      dow; yet t\n                |                 |                 |                 |      e woman, t |      have I,\\nT\n                |                 |                 |                 |      d sooth, t |     y grief,\\nT\n                |                 |                 |                 |      erative; t |     ne eyes,\\nT\n                |                 |                 |                 |      Angelo,\\nT |      ad I but t\n                |                 |                 |                 |     im hide,\\nT |      hey? and t\n                |                 |                 |                 |     e times,\\nT |     e moans!\\nT\n                |                 |                 |                 |     ed gate,\\nT |     not she:\\nT\n                |                 |                 |                 |     ger key:\\nT |      o do not t\n                |                 |                 |                 |     n leads;\\nT |      , on me, t\n                |                 |                 |                 |     e along,\\nT |     spleased\\nT\n                |                 |                 |                 |     e haste;\\nT |       worldly t\n                |                 |                 |                 |     ontract:\\nT |     ve cause\\nT\n                |                 |                 |                 |     Claudio:\\nT |     g peers,\\nT\n                |                 |                 |                 |     Claudio,\\nT |     r's love\\nT\n                |                 |                 |                 |     er good,\\nT |     his son.\\nT\n                |                 |                 |                 |      verity:\\nT |      th good, t\n                |                 |                 |                 |     e gates,\\nT |     d\\nHither t\n                |                 |                 |                 |      t heart; t |       London, t\n                |                 |                 |                 |     nt bulk,\\nT |     ltitude,\\nT\n                |                 |                 |                 |     l drift;\\nT |       so much t\n                |                 |                 |                 |      him so,\\nT |      how much t\n                |                 |                 |                 |     sounded;\\nT |     f us\\nAnd t\n                |                 |                 |                 |     rong it,\\nT |      firm and t\n                |                 |                 |                 |     I speak:\\nT |     e urged:\\nT\n                |                 |                 |                 |     rdon it;\\nT |     kingham,\\nT\n                |                 |                 |                 |     his all?\\nT |     mine\\nWho t\n                |                 |                 |                 |     officer!\\nT |      journeys t\n                |                 |                 |                 |      hither,\\nT |     lk'd of,\\nT\n                |                 |                 |                 |     king on;\\nT |     rection.\\nT\n                |                 |                 |                 |     y oaths,\\nT |     zen:\\nAy, t\n                |                 |                 |                 |      unjust,\\nT |     ernment,\\nT\n                |                 |                 |                 |     per ear,\\nT |      So stood t\n                |                 |                 |                 |      enanced, t |     n:\\nStood t\n                |                 |                 |                 |     ltiness,\\nT |      For then t\n                |                 |                 |                 |      pardon,\\nT |      counsel; t\n                |                 |                 |                 |     came on,\\nT |      el; then t\n                |                 |                 |                 |     ith him!\\nT |      s uncles t\n                |                 |                 |                 |     g death,\\nT |       so hath t\n                |                 |                 |                 |      withal,\\nT |     ter!\\nAnd t\n                |                 |                 |                 |     s deeds,\\nT |     to rule,\\nT\n                |                 |                 |                 |      the way: t |      es fall, t\n                |                 |                 |                 |      prison,\\nT |     at hand;\\nW\n                |                 |                 |                 |     oodness:\\nT |     nd;\\nWhen t\n                |                 |                 |                 |      ge thee, t |     :\\nTruly, t\n                |                 |                 |                 |      erriman, t |     th a man\\nT\n                |                 |                 |                 |     t scent:\\nT |       I hear, t\n                |                 |                 |                 |     hem all:\\nT |     o-night:\\nT\n                |                 |                 |                 |     ith ale,\\nT |      ext day, t\n                |                 |                 |                 |     e wakes,\\nT |      e Rivers t\n                |                 |                 |                 |      he ewer, t |      d faith, t\n                |                 |                 |                 |     t means,\\nT |     isurely,\\nT\n                |                 |                 |                 |     py time;\\nT |     a flout,\\nT\n                |                 |                 |                 |      a lady:\\nT |     :\\nMarry, t\n                |                 |                 |                 |       course; t |      so fast\\nT\n                |                 |                 |                 |      a lord:\\nT |      Grandam, t\n                |                 |                 |                 |      malady,\\nT |      ork, who t\n                |                 |                 |                 |      frenzy:\\nT |      tell who t\n                |                 |                 |                 |     ombardy,\\nT |     r house!\\nT\n                |                 |                 |                 |     nceived,\\nT |      n a map, t\n                |                 |                 |                 |     ken you;\\nT |      his life t\n                |                 |                 |                 |      ondello, t |     ,\\nFor me t\n                |                 |                 |                 |     ou know;\\nT |      r-blown, t\n                |                 |                 |                 |      toward:\\nT |      mselves, t\n                |                 |                 |                 |      ntlemen, t |       me die, t\n                |                 |                 |                 |      rtensio, t |      go;\\nAnd t\n                |                 |                 |                 |       Gremio, t |     ur grace\\nT\n                |                 |                 |                 |     age was,\\nT |      o betide t\n                |                 |                 |                 |     ontents:\\nT |       prince, t\n                |                 |                 |                 |     nor had,\\nT |     overeign\\nT\n                |                 |                 |                 |     he maid:\\nT |      les here t\n                |                 |                 |                 |       master; t |     of a man\\nT\n                |                 |                 |                 |     ws thus;\\nT |     e heart.\\nT\n                |                 |                 |                 |      se thee; t |      My lord, t\n                |                 |                 |                 |     r mouth:\\nT |     omes not\\nT\n                |                 |                 |                 |     h after,\\nT |     , not I,\\nT\n                |                 |                 |                 |      e rests, t |      nctuary: t\n                |                 |                 |                 |     y leave,\\nT |      Persuade t\n                |                 |                 |                 |      althily, t |     obdurate\\nT\n                |                 |                 |                 |      er head, t |     my lord,\\nT\n                |                 |                 |                 |      effect:\\nT |     ing him.\\nT\n                |                 |                 |                 |     hearsed,\\nT |      granted\\nT\n                |                 |                 |                 |     e woo'd;\\nT |     ace,\\nAnd t\n                |                 |                 |                 |     a ta'en,\\nT |     e place:\\nT\n                |                 |                 |                 |      tongue,\\nT |      it;\\nAnd t\n                |                 |                 |                 |     be bold,\\nT |     have it:\\nT\n                |                 |                 |                 |     ll know,\\nT |     t:\\nThen, t\n                |                 |                 |                 |      wooers;\\nT |      m thence t\n                |                 |                 |                 |     ake one,\\nT |     e Tower:\\nT\n                |                 |                 |                 |     ath two,\\nT |      ar build t\n                |                 |                 |                 |     n sooth:\\nT |     es long.\\nT\n                |                 |                 |                 |      be wed:\\nT |      EDWARD:\\nT\n                |                 |                 |                 |     ourself,\\nT |      in fame, t\n                |                 |                 |                 |     e of me;\\nT |     s yours:\\nT\n                |                 |                 |                 |     na, sir,\\nT |     n growth\\nT\n                |                 |                 |                 |     ematics,\\nT |     ORK:\\nAnd t\n                |                 |                 |                 |      ur turn, t |   .\\n\\nYORK:\\nT\n                |                 |                 |                 |      myself,\\nt |      d uncle, t\n                |                 |                 |                 |     scholar,\\nt |     YORK:\\nO, t\n                |                 |                 |                 |     ine own,\\nT |      I would, t\n                |                 |                 |                 |     request,\\nT |      ou mean, t\n                |                 |                 |                 |     me, sir,\\nT |       me, not t\n                |                 |                 |                 |     creased:\\nT |      ape,\\nHe t\n                |                 |                 |                 |     ween us,\\nT |     reasons!\\nT\n                |                 |                 |                 |     btain'd,\\nT |       mother, t\n                |                 |                 |                 |     r winds,\\nT |     D:\\nAn if t\n                |                 |                 |                 |      ake not, t |     y heart,\\nT\n                |                 |                 |                 |      a word;\\nT |     KINGHAM:\\nT\n                |                 |                 |                 |     hearing:\\nT |     Catesby.\\nT\n                |                 |                 |                 |     e, Kate,\\nT |      s deeply t\n                |                 |                 |                 |     ry town,\\nT |      impart:\\nT\n                |                 |                 |                 |      is then, t |     the way;\\nW\n                |                 |                 |                 |      here is, t |      so loves t\n                |                 |                 |                 |     flowers:\\nT |      prince,\\nT\n                |                 |                 |                 |     ee well,\\nT |     M:\\nWell, t\n                |                 |                 |                 |      regard,\\nT |      more but t\n                |                 |                 |                 |     ogether,\\nT |      ff sound t\n                |                 |                 |                 |     g alone,\\nT |     e Tower,\\nT\n                |                 |                 |                 |     on oath,\\nT |      William: t\n                |                 |                 |                 |      Venice,\\nT |     ersaries\\nT\n                |                 |                 |                 |      in all:\\nT |      y Place, t\n                |                 |                 |                 |      galleys: t |      betimes, t\n                |                 |                 |                 |     harmony:\\nT |     NGS:\\nAnd t\n                |                 |                 |                 |     e wrong,\\nT |     ger:\\nAnd t\n                |                 |                 |                 |     we down:\\nT |     eld;\\nAnd t\n                |                 |                 |                 |     y, pray,\\nT |       and him t\n                |                 |                 |                 |     trument,\\nT |     e other.\\nT\n                |                 |                 |                 |      of art;\\nT |     e north,\\nT\n                |                 |                 |                 |     fectual,\\nT |      eed that t\n                |                 |                 |                 |     is word:\\nT |     ligence.\\nT\n                |                 |                 |                 |     ng wise;\\nT |      so fond\\nT\n                |                 |                 |                 |      e chine; t |     slumbers\\nT\n                |                 |                 |                 |     my word,\\nT |      ill both t\n                |                 |                 |                 |     rom her:\\nT |      all see, t\n                |                 |                 |                 |      en thus; t |      nd hopes t\n                |                 |                 |                 |     h words:\\nT |     eof:\\nAnd t\n                |                 |                 |                 |     ossible,\\nT |     od news,\\nT\n                |                 |                 |                 |      ethinks, t |     ws,\\nThat t\n                |                 |                 |                 |      Gremio,\\nT |     enemies,\\nT\n                |                 |                 |                 |      Minola,\\nT |     es:\\nBut, t\n                |                 |                 |                 |     so loud,\\nT |     's side,\\nT\n                |                 |                 |                 |     e it up,\\nT |      t do it, t\n                |                 |                 |                 |     y groom,\\nT |     h hence,\\nT\n                |                 |                 |                 |       Grumio, t |     ce,\\nThat t\n                |                 |                 |                 |      s swept; t |      that yet t\n                |                 |                 |                 |      r horse; t |     are dear\\nT\n                |                 |                 |                 |     he heel;\\nT |      hard and t\n                |                 |                 |                 |     eathing:\\nT |     CATESBY:\\nT\n                |                 |                 |                 |     Gregory;\\nT |      us to me t\n                |                 |                 |                 |     ot awry:\\nT |     tis now:\\nT\n                |                 |                 |                 |     isquiet:\\nT |      you, but t\n                |                 |                 |                 |     holeric,\\nT |     STANLEY:\\nT\n                |                 |                 |                 |     haggard,\\nT |      et, when t\n                |                 |                 |                 |     bolster,\\nT |     ure,\\nAnd t\n                |                 |                 |                 |     dow now,\\nT |      how soon t\n                |                 |                 |                 |      master;\\nT |     'ercast.\\nT\n                |                 |                 |                 |     ty long,\\nT |     my lord?\\nT\n                |                 |                 |                 |     ourtesy,\\nT |     ir heads\\nT\n                |                 |                 |                 |     tremity,\\nT |     suivant:\\nT\n                |                 |                 |                 |     ery day,\\nT |     we meet:\\nT\n                |                 |                 |                 |      hy then, t |     hyself--\\nT\n                |                 |                 |                 |     g slave,\\nT |      This day t\n                |                 |                 |                 |      of you,\\nT |      hold it, t\n                |                 |                 |                 |       bigger: t |       fellow: t\n                |                 |                 |                 |     thimble,\\nT |     M:\\nWhat, t\n                |                 |                 |                 |     on thee,\\nt |      Pomfret, t\n                |                 |                 |                 |    \\nTailor:\\nT |       do need t\n                |                 |                 |                 |     ink for:\\nT |     oly man,\\nT\n                |                 |                 |                 |     omorrow:\\nT |     ee this:\\nT\n                |                 |                 |                 |     rthwith,\\nT |      ispatch; t\n                |                 |                 |                 |     ane end;\\nT |     \\nRichard t\n                |                 |                 |                 |     's care,\\nT |      ss blood t\n                |                 |                 |                 |     an this,\\nT |     ber, God\\nT\n                |                 |                 |                 |     t dower,\\nT |      hich, as t\n                |                 |                 |                 |     ike you:\\nT |      e haste; t\n                |                 |                 |                 |      d there, t |     ace:\\nAnd t\n                |                 |                 |                 |      is this, t |      at once: t\n                |                 |                 |                 |     \\nchurch; t |      met\\nIs, t\n                |                 |                 |                 |      hy ways; t |      OF ELY:\\nT\n                |                 |                 |                 |      man mad, t |      -morrow, t\n                |                 |                 |                 |     not mad:\\nT |     of mine,\\nT\n                |                 |                 |                 |     ng eyes,\\nT |       of his, t\n                |                 |                 |                 |     istress,\\nT |      nd finds t\n                |                 |                 |                 |     lewoman,\\nT |      ul as he t\n                |                 |                 |                 |      truchio, t |     triumph.\\nT\n                |                 |                 |                 |     froward,\\nT |      d smooth t\n                |                 |                 |                 |      at home; t |      to-day;\\nT\n                |                 |                 |                 |     t-place;\\nT |      you all, t\n                |                 |                 |                 |    \\nPedant:\\nT |      aft, and t\n                |                 |                 |                 |     ncentio;\\nT |     ASTINGS:\\nT\n                |                 |                 |                 |      Tranio,\\nT |      up:\\nAnd t\n                |                 |                 |                 |      him to;\\nT |      's wife, t\n                |                 |                 |                 |     is done,\\nT |     t Shore,\\nT\n                |                 |                 |                 |   \\n\\nWidow:\\nT |     rumpet--\\nT\n                |                 |                 |                 |     her not;\\nT |     be done:\\nT\n                |                 |                 |                 |      hat not, t |      he rest, t\n                |                 |                 |                 |     to sigh,\\nT |      to fly:\\nT\n                |                 |                 |                 |     ish too:\\nT |     y:\\nThree t\n                |                 |                 |                 |     se eyes,\\nT |     ies,\\nHow t\n                |                 |                 |                 |      hy king, t |      he longs t\n                |                 |                 |                 |      keeper,\\nT |      ery nod, t\n                |                 |                 |                 |      hy head, t |     my head.\\nT\n                |                 |                 |                 |     nd land,\\nT |     ord,\\nAnd t\n                |                 |                 |                 |     edience;\\nT |     ry side,\\nT\n                |                 |                 |                 |      e wager, t |      ny time, t\n                |                 |                 |                 |     unkards:\\nT |      d mayor, t\n                |                 |                 |                 |     g'd yet,\\nT |      patient, t\n                |                 |                 |                 |     ow'd and\\nT |     traitor,\\nT\n                |                 |                 |                 |      ear one, t |      the man, t\n                |                 |                 |                 |     ow come;\\nT |     creature\\nT\n                |                 |                 |                 |     r since,\\nT |     recorded\\nT\n                |                 |                 |                 |     y study,\\nT |      virtue,\\nT\n                |                 |                 |                 |      his ear; t |       it you, t\n                |                 |                 |                 |      memory,\\nT |     il-house\\nT\n                |                 |                 |                 |      e event; t |     R:\\nWhat, t\n                |                 |                 |                 |      ich was, t |      s rashly t\n                |                 |                 |                 |     oist us,\\nT |     ath,\\nBut t\n                |                 |                 |                 |     estions:\\nT |     he case,\\nT\n                |                 |                 |                 |      to fly,\\nT |     oceeded,\\nT\n                |                 |                 |                 |   \\n\\nARIEL:\\nT |      eak, and t\n                |                 |                 |                 |     topmast,\\nT |     treason;\\nT\n                |                 |                 |                 |     tinctly,\\nT |     TER:\\nAnd t\n                |                 |                 |                 |      htnings, t |     ip here,\\nT\n                |                 |                 |                 |      vessel,\\nT |     kingham.\\nT\n                |                 |                 |                 |      moothes, t |     ll post:\\nT\n                |                 |                 |                 |     e's hid:\\nT |     hildren:\\nT\n                |                 |                 |                 |     service;\\nT |      person:\\nT\n                |                 |                 |                 |      rd thee, t |      em, when t\n                |                 |                 |                 |      u earth, t |     e,\\nFound t\n                |                 |                 |                 |      be sure, t |     her:\\nBut t\n                |                 |                 |                 |      on thee; t |       go: and t\n                |                 |                 |                 |     t first,\\nT |      ll I in, t\n                |                 |                 |                 |     he isle,\\nT |     y order,\\nT\n                |                 |                 |                 |      wn cell, t |     ght;\\nAnd t\n                |                 |                 |                 |     le race,\\nT |       notice, t\n                |                 |                 |                 |     rt best,\\nT |     rivener:\\nT\n                |                 |                 |                 |     s wreck,\\nT |     gross'd,\\nT\n                |                 |                 |                 |     al made;\\nT |     ught me;\\nT\n                |                 |                 |                 |      u drink; t |      od world t\n                |                 |                 |                 |     n; obey:\\nT |     o gross,\\nT\n                |                 |                 |                 |      I feel,\\nT |     ur Lord,\\nT\n                |                 |                 |                 |     threats,\\nT |      France;\\nT\n                |                 |                 |                 |     re, sir,\\nT |      r father t\n                |                 |                 |                 |     's wife,\\nT |      help me, t\n                |                 |                 |                 |     rt them:\\nT |      wer was, t\n                |                 |                 |                 |     bastian,\\nT |     ecorder.\\nT\n                |                 |                 |                 |     undance,\\nT |      us saith t\n                |                 |                 |                 |     rn, sir,\\nT |      he duke, t\n                |                 |                 |                 |     consent;\\nT |     rd!'\\nAnd t\n                |                 |                 |                 |                 |      nay, and t\n                |                 |                 |                 |                 |      e leads; t\n                |                 |                 |                 |                 |     r grace;\\nT\n                |                 |                 |                 |                 |     e moved,\\nT\n                |                 |                 |                 |                 |      Catesby, t\n                |                 |                 |                 |                 |     d again;\\nT\n                |                 |                 |                 |                 |       myself, t\n                |                 |                 |                 |                 |      leeping, t\n                |                 |                 |                 |                 |      praying, t\n                |                 |                 |                 |                 |      d, would t\n                |                 |                 |                 |                 |     s prince\\nT\n                |                 |                 |                 |                 |       himself t\n                |                 |                 |                 |                 |      pect me, t\n                |                 |                 |                 |                 |     is hand,\\nT\n                |                 |                 |                 |                 |      ble ears t\n                |                 |                 |                 |                 |      offence\\nT\n                |                 |                 |                 |                 |      reaties, t\n                |                 |                 |                 |                 |      me seat, t\n                |                 |                 |                 |                 |     estical,\\nT\n                |                 |                 |                 |                 |     f birth,\\nT\n                |                 |                 |                 |                 |     l house,\\nT\n                |                 |                 |                 |                 |     's good,\\nT\n                |                 |                 |                 |                 |     n.\\nWhich t\n                |                 |                 |                 |                 |      om blood t\n                |                 |                 |                 |                 |      ht haply t\n                |                 |                 |                 |                 |     ly think\\nT\n                |                 |                 |                 |                 |      yielded\\nT\n                |                 |                 |                 |                 |     n me;\\nIf t\n                |                 |                 |                 |                 |     e to me.\\nT\n                |                 |                 |                 |                 |     friends.\\nT\n                |                 |                 |                 |                 |      erefore, t\n                |                 |                 |                 |                 |     rst,\\nAnd t\n                |                 |                 |                 |                 |     way,\\nAnd t\n                |                 |                 |                 |                 |     hty sea,\\nT\n                |                 |                 |                 |                 |      thank'd, t\n                |                 |                 |                 |                 |     ed were;\\nT\n                |                 |                 |                 |                 |     y on me,\\nT\n                |                 |                 |                 |                 |     ace;\\nBut t\n                |                 |                 |                 |                 |     etroth'd\\nT\n                |                 |                 |                 |                 |      France.\\nT\n                |                 |                 |                 |                 |     thoughts\\nT\n                |                 |                 |                 |                 |      everence t\n                |                 |                 |                 |                 |      tongue.\\nT\n                |                 |                 |                 |                 |      s us and t\n                |                 |                 |                 |                 |     hal,\\nYet t\n                |                 |                 |                 |                 |      ty lord, t\n                |                 |                 |                 |                 |     l,\\nLoath t\n                |                 |                 |                 |                 |      throne,\\nT\n                |                 |                 |                 |                 |     my back,\\nT\n                |                 |                 |                 |                 |       farther t\n                |                 |                 |                 |                 |     rselves,\\nT\n                |                 |                 |                 |                 |      ratulate t\n                |                 |                 |                 |                 |       sister, t\n                |                 |                 |                 |                 |      How doth t\n                |                 |                 |                 |                 |     it them;\\nT\n                |                 |                 |                 |                 |      mother:\\nT\n                |                 |                 |                 |                 |     lame\\nAnd t\n                |                 |                 |                 |                 |     minster,\\nT\n                |                 |                 |                 |                 |     r,\\nThere t\n                |                 |                 |                 |                 |       sunder, t\n                |                 |                 |                 |                 |     e heels;\\nT\n                |                 |                 |                 |                 |      increase t\n                |                 |                 |                 |                 |     , madam.\\nT\n                |                 |                 |                 |                 |      ed womb, t\n                |                 |                 |                 |                 |      t steel, t\n                |                 |                 |                 |                 |     band\\nAnd t\n                |                 |                 |                 |                 |      nt which t\n                |                 |                 |                 |                 |     's face,\\nT\n                |                 |                 |                 |                 |      nd, when t\n                |                 |                 |                 |                 |      thee\\nAs t\n                |                 |                 |                 |                 |      arewell, t\n                |                 |                 |                 |                 |      or soul, t\n                |                 |                 |                 |                 |       stones, t\n                |                 |                 |                 |                 |     hy hand.\\nT\n                |                 |                 |                 |                 |     vice\\nAnd t\n                |                 |                 |                 |                 |     e touch,\\nT\n                |                 |                 |                 |                 |      d lives: t\n                |                 |                 |                 |                 |     equence,\\nT\n                |                 |                 |                 |                 |     \\nCousin, t\n                |                 |                 |                 |                 |     ARD III:\\nT\n                |                 |                 |                 |                 |      ut, tut, t\n                |                 |                 |                 |                 |      all ice, t\n                |                 |                 |                 |                 |     e for me\\nT\n                |                 |                 |                 |                 |     ld\\nWould t\n                |                 |                 |                 |                 |      o doubt, t\n                |                 |                 |                 |                 |      hither.\\nT\n                |                 |                 |                 |                 |      s beyond t\n                |                 |                 |                 |                 |     t abroad\\nT\n                |                 |                 |                 |                 |     aughter:\\nT\n                |                 |                 |                 |                 |     ch upon,\\nT\n                |                 |                 |                 |                 |      on sin:\\nT\n                |                 |                 |                 |                 |     al upon:\\nT\n                |                 |                 |                 |                 |     ine ear:\\nT\n                |                 |                 |                 |                 |      my mind\\nT\n                |                 |                 |                 |                 |      pawn'd;\\nT\n                |                 |                 |                 |                 |      ford and t\n                |                 |                 |                 |                 |     oveables\\nT\n                |                 |                 |                 |                 |     \\nLetters t\n                |                 |                 |                 |                 |      eing by, t\n                |                 |                 |                 |                 |      Exeter,\\nT\n                |                 |                 |                 |                 |      how'd me t\n                |                 |                 |                 |                 |      hus bold t\n                |                 |                 |                 |                 |       a Jack, t\n                |                 |                 |                 |                 |     ut, tut,\\nT\n                |                 |                 |                 |                 |    \\nTYRREL:\\nT\n                |                 |                 |                 |                 |     is done.\\nT\n                |                 |                 |                 |                 |     massacre\\nT\n                |                 |                 |                 |                 |      ever yet t\n                |                 |                 |                 |                 |     d suborn\\nT\n                |                 |                 |                 |                 |      Although t\n                |                 |                 |                 |                 |     '\\n'Thus, t\n                |                 |                 |                 |                 |     er arms:\\nT\n                |                 |                 |                 |                 |     mothered\\nT\n                |                 |                 |                 |                 |     framed.'\\nT\n                |                 |                 |                 |                 |     remorse;\\nT\n                |                 |                 |                 |                 |     em both,\\nT\n                |                 |                 |                 |                 |     per,\\nAnd t\n                |                 |                 |                 |                 |      ime, but t\n                |                 |                 |                 |                 |     ll soon.\\nT\n                |                 |                 |                 |                 |     arriage;\\nT\n                |                 |                 |                 |                 |     e crown,\\nT\n                |                 |                 |                 |                 |       or bad, t\n                |                 |                 |                 |                 |      Richmond t\n                |                 |                 |                 |                 |      beggary\\nT\n                |                 |                 |                 |                 |      ief when t\n                |                 |                 |                 |                 |      rs brave t\n                |                 |                 |                 |                 |      lurk'd,\\nT\n                |                 |                 |                 |                 |      ack, and t\n                |                 |                 |                 |                 |      er; say, t\n                |                 |                 |                 |                 |     y voice,\\nT\n                |                 |                 |                 |                 |     mbs,\\nAnd t\n                |                 |                 |                 |                 |     BETH:\\nO, t\n                |                 |                 |                 |                 |     grave\\nAs t\n                |                 |                 |                 |                 |     ly seat!\\nT\n                |                 |                 |                 |                 |      ive mine t\n                |                 |                 |                 |                 |     society,\\nT\n                |                 |                 |                 |                 |      a Harry, t\n                |                 |                 |                 |                 |     l'd him:\\nT\n                |                 |                 |                 |                 |     l'd him;\\nT\n                |                 |                 |                 |                 |      Richard, t\n                |                 |                 |                 |                 |       Richard t\n                |                 |                 |                 |                 |      too, and t\n                |                 |                 |                 |                 |       Rutland t\n                |                 |                 |                 |                 |      and too, t\n                |                 |                 |                 |                 |      ll-hound t\n                |                 |                 |                 |                 |     o death:\\nT\n                |                 |                 |                 |                 |      hat dog, t\n                |                 |                 |                 |                 |     is eyes,\\nT\n                |                 |                 |                 |                 |     e blood,\\nT\n                |                 |                 |                 |                 |     ndiwork,\\nT\n                |                 |                 |                 |                 |     e earth,\\nT\n                |                 |                 |                 |                 |     g souls,\\nT\n                |                 |                 |                 |                 |      t loose, t\n                |                 |                 |                 |                 |      ust, and t\n                |                 |                 |                 |                 |      ee, that t\n                |                 |                 |                 |                 |     ding it.\\nT\n                |                 |                 |                 |                 |      is dead, t\n                |                 |                 |                 |                 |      Edward:\\nT\n                |                 |                 |                 |                 |      rd dead, t\n                |                 |                 |                 |                 |      use both t\n                |                 |                 |                 |                 |     my loss:\\nT\n                |                 |                 |                 |                 |     ard;\\nAnd t\n                |                 |                 |                 |                 |     ic play,\\nT\n                |                 |                 |                 |                 |       factor, t\n                |                 |                 |                 |                 |     ts pray.\\nT\n                |                 |                 |                 |                 |      I prey,\\nT\n                |                 |                 |                 |                 |     me curse\\nT\n                |                 |                 |                 |                 |       spider, t\n                |                 |                 |                 |                 |     d queen;\\nT\n                |                 |                 |                 |                 |     t I was;\\nT\n                |                 |                 |                 |                 |       a-high, t\n                |                 |                 |                 |                 |     sh flag,\\nT\n                |                 |                 |                 |                 |      st, only t\n                |                 |                 |                 |                 |      ein dost t\n                |                 |                 |                 |                 |     of none.\\nT\n                |                 |                 |                 |                 |     ou wert,\\nT\n                |                 |                 |                 |                 |       torture t\n                |                 |                 |                 |                 |     hou art.\\nT\n                |                 |                 |                 |                 |     row?\\nNow t\n                |                 |                 |                 |                 |     schance:\\nT\n                |                 |                 |                 |                 |     ile,\\nAnd t\n                |                 |                 |                 |                 |     ing woe;\\nT\n                |                 |                 |                 |                 |      e scope: t\n                |                 |                 |                 |                 |     :\\nIf so, t\n                |                 |                 |                 |                 |      n, which t\n                |                 |                 |                 |                 |       wretch, t\n                |                 |                 |                 |                 |      ch, that t\n                |                 |                 |                 |                 |     e right,\\nT\n                |                 |                 |                 |                 |     own,\\nAnd t\n                |                 |                 |                 |                 |     rothers?\\nT\n                |                 |                 |                 |                 |      Tell me, t\n                |                 |                 |                 |                 |     OF YORK:\\nT\n                |                 |                 |                 |                 |      ou toad, t\n                |                 |                 |                 |                 |      lourish, t\n                |                 |                 |                 |                 |     t of war\\nT\n                |                 |                 |                 |                 |     ndition,\\nW\n                |                 |                 |                 |                 |      ly rood, t\n                |                 |                 |                 |                 |     it well,\\nT\n                |                 |                 |                 |                 |      hy birth t\n                |                 |                 |                 |                 |     h to me;\\nT\n                |                 |                 |                 |                 |     infancy;\\nT\n                |                 |                 |                 |                 |     furious,\\nT\n                |                 |                 |                 |                 |     nturous,\\nT\n                |                 |                 |                 |                 |      bloody,\\nt\n                |                 |                 |                 |                 |     ou name,\\nT\n                |                 |                 |                 |                 |      ey Hour, t\n                |                 |                 |                 |                 |     e again.\\nT\n                |                 |                 |                 |                 |      herefore t\n                |                 |                 |                 |                 |       battle, t\n                |                 |                 |                 |                 |      nd there t\n                |                 |                 |                 |                 |     .\\nBloody t\n                |                 |                 |                 |                 |      and doth t\n                |                 |                 |                 |                 |      For thee t\n                |                 |                 |                 |                 |     Richard,\\nT\n                |                 |                 |                 |                 |     ens;\\nAnd t\n                |                 |                 |                 |                 |     d's bed;\\nT\n                |                 |                 |                 |                 |      r lanced t\n                |                 |                 |                 |                 |      hearts,\\nT\n                |                 |                 |                 |                 |      No doubt t\n                |                 |                 |                 |                 |     nd blunt\\nT\n                |                 |                 |                 |                 |     d heart,\\nT\n                |                 |                 |                 |                 |     mbs.\\nBut t\n                |                 |                 |                 |                 |      ails and t\n                |                 |                 |                 |                 |     d yours,\\nT\n                |                 |                 |                 |                 |      heaven,\\nT\n                |                 |                 |                 |                 |      cover'd, t\n                |                 |                 |                 |                 |      caffold, t\n                |                 |                 |                 |                 |      d, there t\n                |                 |                 |                 |                 |     t of it;\\nT\n                |                 |                 |                 |                 |     gry soul\\nT\n                |                 |                 |                 |                 |     gs\\nWhich t\n                |                 |                 |                 |                 |      ing than t\n                |                 |                 |                 |                 |      en know, t\n                |                 |                 |                 |                 |      s mother t\n                |                 |                 |                 |                 |     \\nEven he t\n                |                 |                 |                 |                 |     H:\\nWhat, t\n                |                 |                 |                 |                 |       the man t\n                |                 |                 |                 |                 |      -hearts; t\n                |                 |                 |                 |                 |      nd York; t\n                |                 |                 |                 |                 |     ll weep:\\nT\n                |                 |                 |                 |                 |     id drain\\nT\n                |                 |                 |                 |                 |     le acts;\\nT\n                |                 |                 |                 |                 |      mock me; t\n                |                 |                 |                 |                 |     y\\nUnless t\n                |                 |                 |                 |                 |     TH:\\nNay, t\n                |                 |                 |                 |                 |     ur sons,\\nT\n                |                 |                 |                 |                 |     ur womb,\\nT\n                |                 |                 |                 |                 |      mother;\\nT\n                |                 |                 |                 |                 |     our age.\\nT\n                |                 |                 |                 |                 |     I would,\\nT\n                |                 |                 |                 |                 |     gn soil,\\nT\n                |                 |                 |                 |                 |     dignity:\\nT\n                |                 |                 |                 |                 |      he king, t\n                |                 |                 |                 |                 |      e mother t\n                |                 |                 |                 |                 |      to see:\\nT\n                |                 |                 |                 |                 |      of tears t\n                |                 |                 |                 |                 |      e again, t\n                |                 |                 |                 |                 |      her ears t\n                |                 |                 |                 |                 |      er heart t\n                |                 |                 |                 |                 |     hastised\\nT\n                |                 |                 |                 |                 |     r's bed;\\nT\n                |                 |                 |                 |                 |     or thee,\\nT\n                |                 |                 |                 |                 |      hat God, t\n                |                 |                 |                 |                 |      ds which t\n                |                 |                 |                 |                 |       plainly t\n                |                 |                 |                 |                 |      llow and t\n                |                 |                 |                 |                 |     nd dead;\\nT\n                |                 |                 |                 |                 |      , madam; t\n                |                 |                 |                 |                 |      r'd, and t\n                |                 |                 |                 |                 |     no oath:\\nT\n                |                 |                 |                 |                 |      honour;\\nT\n                |                 |                 |                 |                 |      virtue;\\nT\n                |                 |                 |                 |                 |     \\nThyself t\n                |                 |                 |                 |                 |      by Him,\\nT\n                |                 |                 |                 |                 |     lain:\\nIf t\n                |                 |                 |                 |                 |      And both t\n                |                 |                 |                 |                 |      ich now, t\n                |                 |                 |                 |                 |     to dust,\\nT\n                |                 |                 |                 |                 |     by thee.\\nT\n                |                 |                 |                 |                 |      d youth, t\n                |                 |                 |                 |                 |     eir age;\\nT\n                |                 |                 |                 |                 |       plants, t\n                |                 |                 |                 |                 |      , night, t\n                |                 |                 |                 |                 |      and me,\\nT\n                |                 |                 |                 |                 |     by this.\\nT\n                |                 |                 |                 |                 |      t myself t\n                |                 |                 |                 |                 |     ETH:\\nBut t\n                |                 |                 |                 |                 |      nt navy; t\n                |                 |                 |                 |                 |     he shore\\nT\n                |                 |                 |                 |                 |     ral;\\nAnd t\n                |                 |                 |                 |                 |      ting but t\n                |                 |                 |                 |                 |      atcliff, t\n                |                 |                 |                 |                 |     nor bad!\\nW\n                |                 |                 |                 |                 |     ut,\\nWhen t\n                |                 |                 |                 |                 |      on him!\\nW\n                |                 |                 |                 |                 |      England, t\n                |                 |                 |                 |                 |      ng dead? t\n                |                 |                 |                 |                 |     's heir?\\nT\n                |                 |                 |                 |                 |     r?\\nThen, t\n                |                 |                 |                 |                 |     n comes.\\nT\n                |                 |                 |                 |                 |      y liege; t\n                |                 |                 |                 |                 |      y power, t\n                |                 |                 |                 |                 |      r, then, t\n                |                 |                 |                 |                 |     th,\\nWhen t\n                |                 |                 |                 |                 |      ove true t\n                |                 |                 |                 |                 |      ney, and t\n                |                 |                 |                 |                 |     f death?\\nT\n                |                 |                 |                 |                 |     esty\\nIs, t\n                |                 |                 |                 |                 |     e mercy:\\nT\n                |                 |                 |                 |                 |      d to him t\n                |                 |                 |                 |                 |     rms.\\nYet t\n                |                 |                 |                 |                 |     r grace,\\nT\n                |                 |                 |                 |                 |      e shore, t\n                |                 |                 |                 |                 |     banks\\nIf t\n                |                 |                 |                 |                 |      r'd him, t\n                |                 |                 |                 |                 |     ies,\\nYet t\n                |                 |                 |                 |                 |      y liege, t\n                |                 |                 |                 |                 |     s taken;\\nT\n                |                 |                 |                 |                 |      st news: t\n                |                 |                 |                 |                 |      ngs, yet t\n                |                 |                 |                 |                 |      lisbury; t\n                |                 |                 |                 |                 |      stopher, t\n                |                 |                 |                 |                 |     from me:\\nT\n                |                 |                 |                 |                 |     's head;\\nT\n                |                 |                 |                 |                 |     id.\\nBut, t\n                |                 |                 |                 |                 |     rth:\\nAnd t\n                |                 |                 |                 |                 |      to him:\\nT\n                |                 |                 |                 |                 |     aughter.\\nT\n                |                 |                 |                 |                 |      od lord; t\n                |                 |                 |                 |                 |      nry, and t\n                |                 |                 |                 |                 |     tice,\\nIf t\n                |                 |                 |                 |                 |     ruction!\\nT\n                |                 |                 |                 |                 |     oomsday.\\nT\n                |                 |                 |                 |                 |     ed most;\\nT\n                |                 |                 |                 |                 |     t;\\nThis, t\n                |                 |                 |                 |                 |      uls' day t\n                |                 |                 |                 |                 |      wrongs:\\nT\n                |                 |                 |                 |                 |     in jest.\\nT\n                |                 |                 |                 |                 |     cked men\\nT\n                |                 |                 |                 |                 |     y head;\\n'W\n                |                 |                 |                 |                 |     tyranny,\\nT\n                |                 |                 |                 |                 |     agement.\\nT\n                |                 |                 |                 |                 |     ng boar,\\nT\n                |                 |                 |                 |                 |       bosoms, t\n                |                 |                 |                 |                 |      e bloody t\n                |                 |                 |                 |                 |      swords,\\nT\n                |                 |                 |                 |                 |      vantage. T\n                |                 |                 |                 |                 |     , march:\\nT\n                |                 |                 |                 |                 |       lighter t\n                |                 |                 |                 |                 |      Besides, t\n                |                 |                 |                 |                 |     h,\\nWhich t\n                |                 |                 |                 |                 |      , lords, t\n                |                 |                 |                 |                 |     ICHMOND:\\nT\n                |                 |                 |                 |                 |      odly day t\n                |                 |                 |                 |                 |     with me.\\nT\n                |                 |                 |                 |                 |      ur tent; t\n                |                 |                 |                 |                 |      , choose t\n                |                 |                 |                 |                 |     ATCLIFF:\\nT\n                |                 |                 |                 |                 |     :\\nThomas t\n                |                 |                 |                 |                 |      of mind, t\n                |                 |                 |                 |                 |     -in-law!\\nT\n                |                 |                 |                 |                 |      or that. T\n                |                 |                 |                 |                 |      ng seen, t\n                |                 |                 |                 |                 |      sure and t\n                |                 |                 |                 |                 |      houghts, t\n                |                 |                 |                 |                 |     f wrath,\\nT\n                |                 |                 |                 |                 |     th,\\nThat t\n                |                 |                 |                 |                 |     isement,\\nT\n                |                 |                 |                 |                 |     victory!\\nT\n                |                 |                 |                 |                 |     lict me!\\nT\n                |                 |                 |                 |                 |      myself?  t\n                |                 |                 |                 |                 |      Richard; t\n                |                 |                 |                 |                 |     s, I am:\\nT\n                |                 |                 |                 |                 |     any good\\nT\n                |                 |                 |                 |                 |      degree,\\nT\n                |                 |                 |                 |                 |      despair. T\n                |                 |                 |                 |                 |      y, since t\n                |                 |                 |                 |                 |     d threat\\nT\n                |                 |                 |                 |                 |     ock\\nHath t\n                |                 |                 |                 |                 |      Richard\\nT\n                |                 |                 |                 |                 |     dropper,\\nT\n                |                 |                 |                 |                 |     ntrymen,\\nT\n                |                 |                 |                 |                 |     \\nForbids t\n                |                 |                 |                 |                 |     ur side;\\nT\n                |                 |                 |                 |                 |       except, t\n                |                 |                 |                 |                 |      than him t\n                |                 |                 |                 |                 |      follow?  t\n                |                 |                 |                 |                 |     s enemy:\\nT\n                |                 |                 |                 |                 |     \\nFor me, t\n                |                 |                 |                 |                 |       thrive, t\n                |                 |                 |                 |                 |      rland as t\n                |                 |                 |                 |                 |     d it is.\\nT\n                |                 |                 |                 |                 |     e heaven\\nT\n                |                 |                 |                 |                 |     ain,\\nAnd t\n                |                 |                 |                 |                 |     d horse.\\nT\n                |                 |                 |                 |                 |     t horse.\\nT\n                |                 |                 |                 |                 |     vereign.\\nT\n                |                 |                 |                 |                 |     sh\\nAfter t\n                |                 |                 |                 |                 |      rescue!\\nT\n                |                 |                 |                 |                 |      is ours, t\n                |                 |                 |                 |                 |      o, here, t\n                |                 |                 |                 |                 |      k'd off, t\n                |                 |                 |                 |                 |     ll!\\nBut, t\n                |                 |                 |                 |                 |     ers fled\\nT\n                |                 |                 |                 |                 |      us:\\nAnd t\n                |                 |                 |                 |                 |     unction,\\nT\n                |                 |                 |                 |                 |      enmity!\\nW\n                |                 |                 |                 |                 |     herself;\\nT\n                |                 |                 |                 |                 |     s blood,\\nT\n                |                 |                 |                 |                 |     own son,\\nT\n                |                 |                 |                 |                 |     izabeth,\\nT\n                |                 |                 |                 |                 |     us Lord,\\nT\n                |                 |                 |                 |                 |     increase\\nT\n                |                 |                 |                 |                 |     s again:\\nT\n                |                 |                 |                 |                 |      f Gaunt, t\n                |                 |                 |                 |                 |     l,\\nWhich t\n                |                 |                 |                 |                 |     HARD II:\\nT\n                |                 |                 |                 |                 |      user and t\n                |                 |                 |                 |                 |     's love,\\nT\n                |                 |                 |                 |                 |      heaven.\\nT\n                |                 |                 |                 |                 |     screant,\\nT\n                |                 |                 |                 |                 |      e so and t\n                |                 |                 |                 |                 |       too bad t\n                |                 |                 |                 |                 |     e,\\nSince t\n                |                 |                 |                 |                 |     the sky,\\nT\n                |                 |                 |                 |                 |      ce more, t\n                |                 |                 |                 |                 |      the more t\n                |                 |                 |                 |                 |     n's war,\\nT\n                |                 |                 |                 |                 |     s twain;\\nT\n                |                 |                 |                 |                 |     boast\\nAs t\n                |                 |                 |                 |                 |     return'd\\nT\n                |                 |                 |                 |                 |       kinsman t\n                |                 |                 |                 |                 |     n:\\nWhich t\n                |                 |                 |                 |                 |       coward, t\n                |                 |                 |                 |                 |      ing here t\n                |                 |                 |                 |                 |     ength\\nAs t\n                |                 |                 |                 |                 |      's pawn, t\n                |                 |                 |                 |                 |     od else,\\nW\n                |                 |                 |                 |                 |     it true;\\nT\n                |                 |                 |                 |                 |     oldiers,\\nT\n                |                 |                 |                 |                 |     ish eye,\\nT\n                |                 |                 |                 |                 |       Mowbray t\n                |                 |                 |                 |                 |     is good,\\nT\n                |                 |                 |                 |                 |      ent soul t\n                |                 |                 |                 |                 |     f blood:\\nW\n                |                 |                 |                 |                 |     descent,\\nT\n                |                 |                 |                 |                 |     n soars!\\nT\n                |                 |                 |                 |                 |     be deaf,\\nT\n                |                 |                 |                 |                 |     rtialize\\nT\n                |                 |                 |                 |                 |     MOWBRAY:\\nT\n                |                 |                 |                 |                 |     \\nThrough t\n                |                 |                 |                 |                 |       throat, t\n                |                 |                 |                 |                 |     u liest.\\nT\n                |                 |                 |                 |                 |     oldiers;\\nT\n                |                 |                 |                 |                 |      o France t\n                |                 |                 |                 |                 |      not; but t\n                |                 |                 |                 |                 |     ncaster,\\nT\n                |                 |                 |                 |                 |      had it.\\nT\n                |                 |                 |                 |                 |     's foot,\\nT\n                |                 |                 |                 |                 |     g blood:\\nT\n                |                 |                 |                 |                 |      escribe, t\n                |                 |                 |                 |                 |      tors say t\n                |                 |                 |                 |                 |     t begun;\\nW\n                |                 |                 |                 |                 |     F GAUNT:\\nT\n                |                 |                 |                 |                 |      my age:\\nT\n                |                 |                 |                 |                 |       my son, t\n                |                 |                 |                 |                 |      Norfolk, t\n                |                 |                 |                 |                 |     F GAUNT:\\nW\n                |                 |                 |                 |                 |     \\nMy life t\n                |                 |                 |                 |                 |     y shame:\\nT\n                |                 |                 |                 |                 |      of death t\n                |                 |                 |                 |                 |     y grave,\\nT\n                |                 |                 |                 |                 |     d spear,\\nT\n                |                 |                 |                 |                 |      s spots: t\n                |                 |                 |                 |                 |     ar lord,\\nT\n                |                 |                 |                 |                 |      utation: t\n                |                 |                 |                 |                 |      in one:\\nT\n                |                 |                 |                 |                 |     is done:\\nT\n                |                 |                 |                 |                 |      sue, but t\n                |                 |                 |                 |                 |     t's day:\\nT\n                |                 |                 |                 |                 |     rbitrate\\nT\n                |                 |                 |                 |                 |     T:\\nAlas, t\n                |                 |                 |                 |                 |     xclaims,\\nT\n                |                 |                 |                 |                 |      ich made t\n                |                 |                 |                 |                 |      he fault t\n                |                 |                 |                 |                 |      heaven;\\nW\n                |                 |                 |                 |                 |      ho, when t\n                |                 |                 |                 |                 |     n earth,\\nW\n                |                 |                 |                 |                 |      s thine! t\n                |                 |                 |                 |                 |      hat bed, t\n                |                 |                 |                 |                 |     at womb,\\nT\n                |                 |                 |                 |                 |      t metal, t\n                |                 |                 |                 |                 |      f-mould, t\n                |                 |                 |                 |                 |      man; and t\n                |                 |                 |                 |                 |       in him: t\n                |                 |                 |                 |                 |       measure t\n                |                 |                 |                 |                 |     ghter'd,\\nT\n                |                 |                 |                 |                 |     hy life,\\nT\n                |                 |                 |                 |                 |     er thee:\\nT\n                |                 |                 |                 |                 |     wn life,\\nT\n                |                 |                 |                 |                 |      s death: t\n                |                 |                 |                 |                 |     \\nTo God, t\n                |                 |                 |                 |                 |     d Gaunt.\\nT\n                |                 |                 |                 |                 |      oventry, t\n                |                 |                 |                 |                 |     s spear,\\nT\n                |                 |                 |                 |                 |     s bosom,\\nT\n                |                 |                 |                 |                 |     ack,\\nAnd t\n                |                 |                 |                 |                 |      d Gaunt: t\n                |                 |                 |                 |                 |     ork.\\nLo, t\n                |                 |                 |                 |                 |      not so;\\nT\n                |                 |                 |                 |                 |      groans?\\nT\n                |                 |                 |                 |                 |     e there,\\nT\n                |                 |                 |                 |                 |     and die:\\nT\n                |                 |                 |                 |                 |      nd longs t\n                |                 |                 |                 |                 |     Marshal:\\nT\n                |                 |                 |                 |                 |      tays but t\n                |                 |                 |                 |                 |      y, then, t\n                |                 |                 |                 |                 |      proceed\\nT\n                |                 |                 |                 |                 |      name and t\n                |                 |                 |                 |                 |       say who t\n                |                 |                 |                 |                 |      what man t\n                |                 |                 |                 |                 |      hood and t\n                |                 |                 |                 |                 |      aven and t\n                |                 |                 |                 |                 |     !--\\nBoth t\n                |                 |                 |                 |                 |      alty and t\n                |                 |                 |                 |                 |     nd truth\\nT\n                |                 |                 |                 |                 |       God and t\n                |                 |                 |                 |                 |     ine arm,\\nT\n                |                 |                 |                 |                 |     h hither\\nT\n                |                 |                 |                 |                 |     in arms,\\nT\n                |                 |                 |                 |                 |     Norfolk,\\nT\n                |                 |                 |                 |                 |     ngerous,\\nT\n                |                 |                 |                 |                 |      hardy as t\n                |                 |                 |                 |                 |      two men\\nT\n                |                 |                 |                 |                 |     grimage;\\nT\n                |                 |                 |                 |                 |      d craves t\n                |                 |                 |                 |                 |      hand and t\n                |                 |                 |                 |                 |      regreet\\nT\n                |                 |                 |                 |                 |      st last, t\n                |                 |                 |                 |                 |     \\nO thou, t\n                |                 |                 |                 |                 |     y blood,\\nW\n                |                 |                 |                 |                 |     s point,\\nT\n                |                 |                 |                 |                 |      use make t\n                |                 |                 |                 |                 |      my lot,\\nT\n                |                 |                 |                 |                 |      or dies, t\n                |                 |                 |                 |                 |      es, true t\n                |                 |                 |                 |                 |     n peers,\\nT\n                |                 |                 |                 |                 |      o fight: t\n                |                 |                 |                 |                 |     e.\\nOrder t\n                |                 |                 |                 |                 |      is lance t\n                |                 |                 |                 |                 |     ecreant,\\nT\n                |                 |                 |                 |                 |       forward t\n                |                 |                 |                 |                 |     nt,\\nBoth t\n                |                 |                 |                 |                 |     d Derby,\\nT\n                |                 |                 |                 |                 |      eign and t\n                |                 |                 |                 |                 |      ding but t\n                |                 |                 |                 |                 |     :\\nSound, t\n                |                 |                 |                 |                 |     s.\\nStay, t\n                |                 |                 |                 |                 |     of life,\\nT\n                |                 |                 |                 |                 |     ons,\\nBut t\n                |                 |                 |                 |                 |      be done: t\n                |                 |                 |                 |                 |     onounce:\\nT\n                |                 |                 |                 |                 |     erminate\\nT\n                |                 |                 |                 |                 |     r exile;\\nT\n                |                 |                 |                 |                 |      maim\\nAs t\n                |                 |                 |                 |                 |     ' hands.\\nT\n                |                 |                 |                 |                 |     is hands\\nT\n                |                 |                 |                 |                 |     harmony:\\nW\n                |                 |                 |                 |                 |     a nurse,\\nT\n                |                 |                 |                 |                 |      in years t\n                |                 |                 |                 |                 |      It boots t\n                |                 |                 |                 |                 |     AY:\\nThen t\n                |                 |                 |                 |                 |     s light,\\nT\n                |                 |                 |                 |                 |      ain, and t\n                |                 |                 |                 |                 |     selves--\\nT\n                |                 |                 |                 |                 |     econcile\\nT\n                |                 |                 |                 |                 |     :\\nAnd I, t\n                |                 |                 |                 |                 |     m;\\nSince t\n                |                 |                 |                 |                 |     ot along\\nT\n                |                 |                 |                 |                 |      rt, God, t\n                |                 |                 |                 |                 |       I fear, t\n                |                 |                 |                 |                 |      d heart: t\n                |                 |                 |                 |                 |      lamp and t\n                |                 |                 |                 |                 |      y uncle, t\n                |                 |                 |                 |                 |      e, king, t\n                |                 |                 |                 |                 |       my days t\n                |                 |                 |                 |                 |      morrow;\\nT\n                |                 |                 |                 |                 |      ut dead, t\n                |                 |                 |                 |                 |     ct gave:\\nW\n                |                 |                 |                 |                 |      hou then t\n                |                 |                 |                 |                 |     y child,\\nT\n                |                 |                 |                 |                 |      ose dost t\n                |                 |                 |                 |                 |     y words,\\nT\n                |                 |                 |                 |                 |     ds,\\nThat t\n                |                 |                 |                 |                 |     ou,\\nWhen t\n                |                 |                 |                 |                 |     prodigal\\nT\n                |                 |                 |                 |                 |     NGBROKE:\\nT\n                |                 |                 |                 |                 |      vel that t\n                |                 |                 |                 |                 |     ticehood\\nT\n                |                 |                 |                 |                 |     else\\nBut t\n                |                 |                 |                 |                 |      urneyman t\n                |                 |                 |                 |                 |      havens.\\nT\n                |                 |                 |                 |                 |     on thus;\\nT\n                |                 |                 |                 |                 |     cessity.\\nT\n                |                 |                 |                 |                 |      d banish t\n                |                 |                 |                 |                 |      Woe doth t\n                |                 |                 |                 |                 |      air\\nAnd t\n                |                 |                 |                 |                 |     sicians,\\nT\n                |                 |                 |                 |                 |     strew'd,\\nT\n                |                 |                 |                 |                 |      ies, and t\n                |                 |                 |                 |                 |      to bite\\nT\n                |                 |                 |                 |                 |     \\nThe man t\n                |                 |                 |                 |                 |      ives but t\n                |                 |                 |                 |                 |      y nurse, t\n                |                 |                 |                 |                 |     s I can,\\nT\n                |                 |                 |                 |                 |      so,\\nBut t\n                |                 |                 |                 |                 |      way, and t\n                |                 |                 |                 |                 |     d,\\nWhich t\n                |                 |                 |                 |                 |      he word, t\n                |                 |                 |                 |                 |      rd, that t\n                |                 |                 |                 |                 |     me craft\\nT\n                |                 |                 |                 |                 |     ch grief\\nT\n                |                 |                 |                 |                 |      y, would t\n                |                 |                 |                 |                 |     bt,\\nWhen t\n                |                 |                 |                 |                 |      o banish t\n                |                 |                 |                 |                 |     \\nAnd had t\n                |                 |                 |                 |                 |     l realm;\\nT\n                |                 |                 |                 |                 |      to, when t\n                |                 |                 |                 |                 |     re rich,\\nT\n                |                 |                 |                 |                 |      ubscribe t\n                |                 |                 |                 |                 |     st haste\\nT\n                |                 |                 |                 |                 |     n's mind\\nT\n                |                 |                 |                 |                 |     diately!\\nT\n                |                 |                 |                 |                 |     ke coats\\nT\n                |                 |                 |                 |                 |      ng come, t\n                |                 |                 |                 |                 |     :\\nO, but t\n                |                 |                 |                 |                 |      they say t\n                |                 |                 |                 |                 |       scarce, t\n                |                 |                 |                 |                 |      k'd than t\n                |                 |                 |                 |                 |     lose,\\nAs t\n                |                 |                 |                 |                 |     ng past:\\nT\n                |                 |                 |                 |                 |       metres, t\n                |                 |                 |                 |                 |     om sound\\nT\n                |                 |                 |                 |                 |      ere doth t\n                |                 |                 |                 |                 |       be new, t\n                |                 |                 |                 |                 |     w vile--\\nT\n                |                 |                 |                 |                 |     is ears?\\nT\n                |                 |                 |                 |                 |      s breath t\n                |                 |                 |                 |                 |      'st, and t\n                |                 |                 |                 |                 |      ath wilt t\n                |                 |                 |                 |                 |       betimes t\n                |                 |                 |                 |                 |      itself.\\nT\n                |                 |                 |                 |                 |      f kings, t\n                |                 |                 |                 |                 |     'd isle,\\nT\n                |                 |                 |                 |                 |      majesty, t\n                |                 |                 |                 |                 |     of Mars,\\nT\n                |                 |                 |                 |                 |     aradise,\\nT\n                |                 |                 |                 |                 |      of war,\\nT\n                |                 |                 |                 |                 |       of men, t\n                |                 |                 |                 |                 |     r lands,\\nT\n                |                 |                 |                 |                 |      ed plot, t\n                |                 |                 |                 |                 |      s earth, t\n                |                 |                 |                 |                 |      s realm, t\n                |                 |                 |                 |                 |     England,\\nT\n                |                 |                 |                 |                 |      s nurse, t\n                |                 |                 |                 |                 |     y's Son,\\nT\n                |                 |                 |                 |                 |      r souls, t\n                |                 |                 |                 |                 |     t bonds:\\nT\n                |                 |                 |                 |                 |      h, would t\n                |                 |                 |                 |                 |     l gaunt:\\nT\n                |                 |                 |                 |                 |     oks;\\nAnd t\n                |                 |                 |                 |                 |     f:\\nSince t\n                |                 |                 |                 |                 |      at king, t\n                |                 |                 |                 |                 |      u diest, t\n                |                 |                 |                 |                 |      n myself t\n                |                 |                 |                 |                 |     ing ill.\\nT\n                |                 |                 |                 |                 |      ser than t\n                |                 |                 |                 |                 |     ick;\\nAnd t\n                |                 |                 |                 |                 |      nd thou, t\n                |                 |                 |                 |                 |      ysicians t\n                |                 |                 |                 |                 |      ger than t\n                |                 |                 |                 |                 |     a verge,\\nT\n                |                 |                 |                 |                 |      ying but t\n                |                 |                 |                 |                 |     ot king:\\nT\n                |                 |                 |                 |                 |      ondslave t\n                |                 |                 |                 |                 |      law; And t\n                |                 |                 |                 |                 |     d's son,\\nT\n                |                 |                 |                 |                 |      s tongue t\n                |                 |                 |                 |                 |     son,\\nFor t\n                |                 |                 |                 |                 |     d's son;\\nT\n                |                 |                 |                 |                 |     ess good\\nT\n                |                 |                 |                 |                 |     ood\\nThat t\n                |                 |                 |                 |                 |     ked age,\\nT\n                |                 |                 |                 |                 |     th thee!\\nT\n                |                 |                 |                 |                 |       my bed, t\n                |                 |                 |                 |                 |      ed, then t\n                |                 |                 |                 |                 |      oth hast t\n                |                 |                 |                 |                 |     is words\\nT\n                |                 |                 |                 |                 |      his;\\nAs t\n                |                 |                 |                 |                 |     rupt so!\\nT\n                |                 |                 |                 |                 |      But only t\n                |                 |                 |                 |                 |      charge,\\nT\n                |                 |                 |                 |                 |     ze to us\\nT\n                |                 |                 |                 |                 |     re mild,\\nT\n                |                 |                 |                 |                 |     ur hands\\nT\n                |                 |                 |                 |                 |     ing son?\\nT\n                |                 |                 |                 |                 |      atience, t\n                |                 |                 |                 |                 |       hereof, t\n                |                 |                 |                 |                 |     derstood\\nT\n                |                 |                 |                 |                 |      , Bushy, t\n                |                 |                 |                 |                 |      usiness. T\n                |                 |                 |                 |                 |      r queen: t\n                |                 |                 |                 |                 |     LOUGHBY:\\nT\n                |                 |                 |                 |                 |      nds that t\n                |                 |                 |                 |                 |     ng land.\\nT\n                |                 |                 |                 |                 |      us all,\\nT\n                |                 |                 |                 |                 |     RD ROSS:\\nT\n                |                 |                 |                 |                 |       hearts: t\n                |                 |                 |                 |                 |      ace than t\n                |                 |                 |                 |                 |      us share t\n                |                 |                 |                 |                 |     king so,\\nT\n                |                 |                 |                 |                 |      houghts; t\n                |                 |                 |                 |                 |     BERLAND:\\nT\n                |                 |                 |                 |                 |     ND:\\nThen t\n                |                 |                 |                 |                 |     lligence\\nT\n                |                 |                 |                 |                 |      Cobham,\\nT\n                |                 |                 |                 |                 |      l ships, t\n                |                 |                 |                 |                 |      s, three t\n                |                 |                 |                 |                 |       had ere t\n                |                 |                 |                 |                 |      his, but t\n                |                 |                 |                 |                 |     hey stay\\nT\n                |                 |                 |                 |                 |     land.\\nIf t\n                |                 |                 |                 |                 |      o horse, t\n                |                 |                 |                 |                 |      e doubts t\n                |                 |                 |                 |                 |   \\n\\nQUEEN:\\nT\n                |                 |                 |                 |                 |      g I did; t\n                |                 |                 |                 |                 |      ef, more t\n                |                 |                 |                 |                 |      himself, t\n                |                 |                 |                 |                 |      r things t\n                |                 |                 |                 |                 |      sad\\nAs, t\n                |                 |                 |                 |                 |      eversion t\n                |                 |                 |                 |                 |     od hope:\\nT\n                |                 |                 |                 |                 |      ore dost t\n                |                 |                 |                 |                 |   \\n\\nGREEN:\\nT\n                |                 |                 |                 |                 |     is land:\\nT\n                |                 |                 |                 |                 |      rue: and t\n                |                 |                 |                 |                 |     s worse,\\nT\n                |                 |                 |                 |                 |     y Percy,\\nT\n                |                 |                 |                 |                 |      We have: w\n                |                 |                 |                 |                 |     with him\\nT\n                |                 |                 |                 |                 |      , Green, t\n                |                 |                 |                 |                 |      dissolve t\n                |                 |                 |                 |                 |     nd,\\nWho, w\n                |                 |                 |                 |                 |     it will!\\nT\n                |                 |                 |                 |                 |      re fled, t\n                |                 |                 |                 |                 |       Plashy, t\n                |                 |                 |                 |                 |     d:\\nHold, t\n                |                 |                 |                 |                 |     ordship,\\nT\n                |                 |                 |                 |                 |       I came, t\n                |                 |                 |                 |                 |     m to it,\\nT\n                |                 |                 |                 |                 |     kinsmen:\\nT\n                |                 |                 |                 |                 |       defend; t\n                |                 |                 |                 |                 |      an, whom t\n                |                 |                 |                 |                 |      red bids t\n                |                 |                 |                 |                 |     too;\\nBut t\n                |                 |                 |                 |                 |   \\n\\nBUSHY:\\nT\n                |                 |                 |                 |                 |     GOT:\\nAnd t\n                |                 |                 |                 |                 |      ch fills t\n                |                 |                 |                 |                 |      in them, t\n                |                 |                 |                 |                 |      castle:\\nT\n                |                 |                 |                 |                 |       thrives t\n                |                 |                 |                 |                 |      or duke! t\n                |                 |                 |                 |                 |       fights, t\n                |                 |                 |                 |                 |     ershire:\\nT\n                |                 |                 |                 |                 |     beguiled\\nT\n                |                 |                 |                 |                 |     vel:\\nBut t\n                |                 |                 |                 |                 |     s in joy\\nT\n                |                 |                 |                 |                 |     nspurgh,\\nT\n                |                 |                 |                 |                 |      erkeley, t\n                |                 |                 |                 |                 |     d there;\\nT\n                |                 |                 |                 |                 |      emember: t\n                |                 |                 |                 |                 |      him now; t\n                |                 |                 |                 |                 |      My heart t\n                |                 |                 |                 |                 |       my hand t\n                |                 |                 |                 |                 |     Y PERCY:\\nT\n                |                 |                 |                 |                 |       thanks, t\n                |                 |                 |                 |                 |     ;\\nWhich, t\n                |                 |                 |                 |                 |      ind that t\n                |                 |                 |                 |                 |     our out:\\nT\n                |                 |                 |                 |                 |     is land,\\nT\n                |                 |                 |                 |                 |      of York, t\n                |                 |                 |                 |                 |     \\nShow me t\n                |                 |                 |                 |                 |     RK:\\nTut, t\n                |                 |                 |                 |                 |      cle; and t\n                |                 |                 |                 |                 |      red once t\n                |                 |                 |                 |                 |      ish boy, t\n                |                 |                 |                 |                 |      e Gaunt, t\n                |                 |                 |                 |                 |       Prince, t\n                |                 |                 |                 |                 |     ench,\\nO, t\n                |                 |                 |                 |                 |      y should t\n                |                 |                 |                 |                 |     treason:\\nT\n                |                 |                 |                 |                 |      live; O, t\n                |                 |                 |                 |                 |     ven away\\nT\n                |                 |                 |                 |                 |       he been t\n                |                 |                 |                 |                 |      nd chase t\n                |                 |                 |                 |                 |     old,\\nAnd t\n                |                 |                 |                 |                 |     his way,\\nT\n                |                 |                 |                 |                 |      of that\\nW\n                |                 |                 |                 |                 |      , by Him t\n                |                 |                 |                 |                 |     stle\\nAnd t\n                |                 |                 |                 |                 |      , uncle, t\n                |                 |                 |                 |                 |      with us\\nT\n                |                 |                 |                 |                 |      e, which t\n                |                 |                 |                 |                 |     mplices,\\nT\n                |                 |                 |                 |                 |      or foes, t\n                |                 |                 |                 |                 |     you are:\\nT\n                |                 |                 |                 |                 |     he king;\\nT\n                |                 |                 |                 |                 |      her day, t\n                |                 |                 |                 |                 |     elshman:\\nT\n                |                 |                 |                 |                 |     ot stay.\\nT\n                |                 |                 |                 |                 |      heaven;\\nT\n                |                 |                 |                 |                 |     nd leap,\\nT\n                |                 |                 |                 |                 |     y enjoy,\\nT\n                |                 |                 |                 |                 |     and war:\\nT\n                |                 |                 |                 |                 |       forerun t\n                |                 |                 |                 |                 |     rmament.\\nT\n                |                 |                 |                 |                 |      g storms t\n                |                 |                 |                 |                 |      unrest:\\nT\n                |                 |                 |                 |                 |       crossly t\n                |                 |                 |                 |                 |      ty; yet, t\n                |                 |                 |                 |                 |     g blood,\\nT\n                |                 |                 |                 |                 |     \\nTo show t\n                |                 |                 |                 |                 |     ntleman.\\nT\n                |                 |                 |                 |                 |     r'd over\\nT\n                |                 |                 |                 |                 |     th to me\\nT\n                |                 |                 |                 |                 |     treated:\\nT\n                |                 |                 |                 |                 |     ommends;\\nT\n                |                 |                 |                 |                 |     s, away.\\nT\n                |                 |                 |                 |                 |      our late t\n                |                 |                 |                 |                 |      for joy\\nT\n                |                 |                 |                 |                 |      o salute t\n                |                 |                 |                 |                 |     my hand,\\nT\n                |                 |                 |                 |                 |      ls wound t\n                |                 |                 |                 |                 |      nnoyance t\n                |                 |                 |                 |                 |     , lords:\\nT\n                |                 |                 |                 |                 |      my lord: t\n                |                 |                 |                 |                 |      of all.\\nT\n                |                 |                 |                 |                 |      refuse,\\nT\n                |                 |                 |                 |                 |      ngbroke, t\n                |                 |                 |                 |                 |     thou not\\nT\n                |                 |                 |                 |                 |      e globe, t\n                |                 |                 |                 |                 |      t lights t\n                |                 |                 |                 |                 |     r world,\\nT\n                |                 |                 |                 |                 |     ld,\\nThen t\n                |                 |                 |                 |                 |      He fires t\n                |                 |                 |                 |                 |     ty hole,\\nT\n                |                 |                 |                 |                 |      murders, t\n                |                 |                 |                 |                 |     ed sins,\\nT\n                |                 |                 |                 |                 |      s thief, t\n                |                 |                 |                 |                 |       throne, t\n                |                 |                 |                 |                 |     ed king;\\nT\n                |                 |                 |                 |                 |      s angel: t\n                |                 |                 |                 |                 |      l guards t\n                |                 |                 |                 |                 |     us lord,\\nT\n                |                 |                 |                 |                 |     rd,\\nThan t\n                |                 |                 |                 |                 |     urn,\\nAnd t\n                |                 |                 |                 |                 |     ing men!\\nT\n                |                 |                 |                 |                 |     \\nTo-day, t\n                |                 |                 |                 |                 |      ppy day, t\n                |                 |                 |                 |                 |      ace, and t\n                |                 |                 |                 |                 |     ed;\\nAnd, t\n                |                 |                 |                 |                 |      ch blood t\n                |                 |                 |                 |                 |      ll souls t\n                |                 |                 |                 |                 |     ?\\nAwake, t\n                |                 |                 |                 |                 |      majesty! t\n                |                 |                 |                 |                 |     repared;\\nT\n                |                 |                 |                 |                 |      erve Him t\n                |                 |                 |                 |                 |     ot mend;\\nT\n                |                 |                 |                 |                 |      ir faith t\n                |                 |                 |                 |                 |     d decay:\\nT\n                |                 |                 |                 |                 |     so arm'd\\nT\n                |                 |                 |                 |                 |     ,\\nStrive t\n                |                 |                 |                 |                 |     y crown:\\nT\n                |                 |                 |                 |                 |      es worse t\n                |                 |                 |                 |                 |      oo well, t\n                |                 |                 |                 |                 |     s Green?\\nT\n                |                 |                 |                 |                 |      prevail, t\n                |                 |                 |                 |                 |       warm'd, t\n                |                 |                 |                 |                 |     y heart!\\nT\n                |                 |                 |                 |                 |      each one t\n                |                 |                 |                 |                 |      ce worse t\n                |                 |                 |                 |                 |     s!\\nWould t\n                |                 |                 |                 |                 |     roperty,\\nT\n                |                 |                 |                 |                 |      r souls; t\n                |                 |                 |                 |                 |      h hands; t\n                |                 |                 |                 |                 |      een, and t\n                |                 |                 |                 |                 |      d bodies t\n                |                 |                 |                 |                 |     eath\\nAnd t\n                |                 |                 |                 |                 |     ound\\nAnd t\n                |                 |                 |                 |                 |      e ghosts t\n                |                 |                 |                 |                 |      ourt and t\n                |                 |                 |                 |                 |     e scene,\\nT\n                |                 |                 |                 |                 |     in\\nBores t\n                |                 |                 |                 |                 |      verence: t\n                |                 |                 |                 |                 |     respect,\\nT\n                |                 |                 |                 |                 |     el want,\\nT\n                |                 |                 |                 |                 |     to wail.\\nT\n                |                 |                 |                 |                 |     g death;\\nW\n                |                 |                 |                 |                 |     of doom.\\nT\n                |                 |                 |                 |                 |     \\nAn easy t\n                |                 |                 |                 |                 |      although t\n                |                 |                 |                 |                 |      the sky\\nT\n                |                 |                 |                 |                 |     nd small\\nT\n                |                 |                 |                 |                 |     astingly\\nT\n                |                 |                 |                 |                 |       castle: t\n                |                 |                 |                 |                 |     oe obey.\\nT\n                |                 |                 |                 |                 |     ak again\\nT\n                |                 |                 |                 |                 |     mberland\\nT\n                |                 |                 |                 |                 |      ith you, t\n                |                 |                 |                 |                 |      castle;\\nT\n                |                 |                 |                 |                 |      ars, and t\n                |                 |                 |                 |                 |      ance and t\n                |                 |                 |                 |                 |     of heart\\nT\n                |                 |                 |                 |                 |     lishmen:\\nT\n                |                 |                 |                 |                 |       crimson t\n                |                 |                 |                 |                 |     bedrench\\nT\n                |                 |                 |                 |                 |     ng drum,\\nT\n                |                 |                 |                 |                 |      er, when t\n                |                 |                 |                 |                 |     n.\\nBe he t\n                |                 |                 |                 |                 |     g water:\\nT\n                |                 |                 |                 |                 |     \\nAs doth t\n                |                 |                 |                 |                 |     he east,\\nW\n                |                 |                 |                 |                 |      lory and t\n                |                 |                 |                 |                 |     for woe,\\nT\n                |                 |                 |                 |                 |      zed; and t\n                |                 |                 |                 |                 |     we stood\\nT\n                |                 |                 |                 |                 |      how dare t\n                |                 |                 |                 |                 |     d of God\\nT\n                |                 |                 |                 |                 |     urp.\\nAnd t\n                |                 |                 |                 |                 |      nce; and t\n                |                 |                 |                 |                 |     unbegot,\\nT\n                |                 |                 |                 |                 |     head\\nAnd t\n                |                 |                 |                 |                 |     s crown.\\nT\n                |                 |                 |                 |                 |     stands--\\nT\n                |                 |                 |                 |                 |     n peace,\\nT\n                |                 |                 |                 |                 |      swears,\\nT\n                |                 |                 |                 |                 |     is heart\\nT\n                |                 |                 |                 |                 |     majesty.\\nT\n                |                 |                 |                 |                 |      we not,\\nT\n                |                 |                 |                 |                 |      orly and t\n                |                 |                 |                 |                 |      Defiance t\n                |                 |                 |                 |                 |     le words\\nT\n                |                 |                 |                 |                 |      eat both t\n                |                 |                 |                 |                 |      submit?\\nT\n                |                 |                 |                 |                 |     deposed?\\nT\n                |                 |                 |                 |                 |      art they t\n                |                 |                 |                 |                 |      Aumerle, t\n                |                 |                 |                 |                 |      ighs and t\n                |                 |                 |                 |                 |     ears?\\nAs t\n                |                 |                 |                 |                 |      As thus, t\n                |                 |                 |                 |                 |     e place,\\nT\n                |                 |                 |                 |                 |      th; and, t\n                |                 |                 |                 |                 |     h attend\\nT\n                |                 |                 |                 |                 |     ow base,\\nT\n                |                 |                 |                 |                 |      I know,\\nT\n                |                 |                 |                 |                 |      deserve: t\n                |                 |                 |                 |                 |     to have,\\nT\n                |                 |                 |                 |                 |     ur eyes;\\nT\n                |                 |                 |                 |                 |      garden,\\nT\n                |                 |                 |                 |                 |       make me t\n                |                 |                 |                 |                 |     ubs,\\nAnd t\n                |                 |                 |                 |                 |     n grief:\\nT\n                |                 |                 |                 |                 |     ause\\nBut t\n                |                 |                 |                 |                 |     of pins,\\nT\n                |                 |                 |                 |                 |      sprays,\\nT\n                |                 |                 |                 |                 |     fit suck\\nT\n                |                 |                 |                 |                 |       garden, t\n                |                 |                 |                 |                 |     eace:\\nHe t\n                |                 |                 |                 |                 |     of leaf:\\nT\n                |                 |                 |                 |                 |     shelter,\\nT\n                |                 |                 |                 |                 |     ardener:\\nT\n                |                 |                 |                 |                 |      he bark, t\n                |                 |                 |                 |                 |     ing men,\\nT\n                |                 |                 |                 |                 |      r and he t\n                |                 |                 |                 |                 |     to taste\\nT\n                |                 |                 |                 |                 |      op away, t\n                |                 |                 |                 |                 |     t:\\nWhat, t\n                |                 |                 |                 |                 |      you then t\n                |                 |                 |                 |                 |      York's,\\nT\n                |                 |                 |                 |                 |     's,\\nThat t\n                |                 |                 |                 |                 |      to death t\n                |                 |                 |                 |                 |     peaking!\\nT\n                |                 |                 |                 |                 |      ow dares t\n                |                 |                 |                 |                 |      ue sound t\n                |                 |                 |                 |                 |      ? speak, t\n                |                 |                 |                 |                 |     y have I\\nT\n                |                 |                 |                 |                 |      ngbroke: t\n                |                 |                 |                 |                 |      schance, t\n                |                 |                 |                 |                 |      Doth not t\n                |                 |                 |                 |                 |     think'st\\nT\n                |                 |                 |                 |                 |      me last, t\n                |                 |                 |                 |                 |     ies, go,\\nT\n                |                 |                 |                 |                 |      to this, t\n                |                 |                 |                 |                 |     hy mind;\\nW\n                |                 |                 |                 |                 |     erform'd\\nT\n                |                 |                 |                 |                 |   \\n\\nBAGOT:\\nT\n                |                 |                 |                 |                 |      hat dead t\n                |                 |                 |                 |                 |      length,\\nT\n                |                 |                 |                 |                 |       Calais, t\n                |                 |                 |                 |                 |      er talk, t\n                |                 |                 |                 |                 |     r refuse\\nT\n                |                 |                 |                 |                 |     us lips.\\nT\n                |                 |                 |                 |                 |      my gage, t\n                |                 |                 |                 |                 |     f death,\\nT\n                |                 |                 |                 |                 |      : I say, t\n                |                 |                 |                 |                 |      t-blood, t\n                |                 |                 |                 |                 |     too base\\nT\n                |                 |                 |                 |                 |      forbear; t\n                |                 |                 |                 |                 |     ympathy,\\nT\n                |                 |                 |                 |                 |     eath.\\nIf t\n                |                 |                 |                 |                 |      y times, t\n                |                 |                 |                 |                 |      alsehood t\n                |                 |                 |                 |                 |     AUMERLE:\\nT\n                |                 |                 |                 |                 |      tzwater, t\n                |                 |                 |                 |                 |     ust;\\nAnd t\n                |                 |                 |                 |                 |       art so, t\n                |                 |                 |                 |                 |     my gage,\\nT\n                |                 |                 |                 |                 |      From sun t\n                |                 |                 |                 |                 |       to sun: t\n                |                 |                 |                 |                 |      breast,\\nT\n                |                 |                 |                 |                 |     \\nSurrey, t\n                |                 |                 |                 |                 |     ble boy!\\nT\n                |                 |                 |                 |                 |     y sword,\\nT\n                |                 |                 |                 |                 |      iver and t\n                |                 |                 |                 |                 |      nd lies: t\n                |                 |                 |                 |                 |     f faith,\\nT\n                |                 |                 |                 |                 |     folk say\\nT\n                |                 |                 |                 |                 |     say\\nThat t\n                |                 |                 |                 |                 |      hristian t\n                |                 |                 |                 |                 |      epeal'd, t\n                |                 |                 |                 |                 |     be,\\nAnd, t\n                |                 |                 |                 |                 |     ed again\\nT\n                |                 |                 |                 |                 |     ARLISLE:\\nT\n                |                 |                 |                 |                 |     ens:\\nAnd t\n                |                 |                 |                 |                 |      aly; and t\n                |                 |                 |                 |                 |      His body t\n                |                 |                 |                 |                 |      eet soul t\n                |                 |                 |                 |                 |     l\\nAdopts t\n                |                 |                 |                 |                 |     e yields\\nT\n                |                 |                 |                 |                 |      forbid!\\nW\n                |                 |                 |                 |                 |      Richard! t\n                |                 |                 |                 |                 |      rd! then t\n                |                 |                 |                 |                 |     subject?\\nT\n                |                 |                 |                 |                 |      dged but t\n                |                 |                 |                 |                 |     it, God,\\nT\n                |                 |                 |                 |                 |       by God, t\n                |                 |                 |                 |                 |     rophesy:\\nT\n                |                 |                 |                 |                 |      l manure t\n                |                 |                 |                 |                 |      bit, and t\n                |                 |                 |                 |                 |      m safely t\n                |                 |                 |                 |                 |      learn'd\\nT\n                |                 |                 |                 |                 |      l hail!' t\n                |                 |                 |                 |                 |      him me.\\nT\n                |                 |                 |                 |                 |     ll\\nWhich t\n                |                 |                 |                 |                 |     e offer,\\nT\n                |                 |                 |                 |                 |     another,\\nT\n                |                 |                 |                 |                 |     the air,\\nT\n                |                 |                 |                 |                 |     f water:\\nT\n                |                 |                 |                 |                 |     are won:\\nT\n                |                 |                 |                 |                 |       I have, t\n                |                 |                 |                 |                 |     en away;\\nT\n                |                 |                 |                 |                 |     hing be;\\nT\n                |                 |                 |                 |                 |      ll oaths t\n                |                 |                 |                 |                 |      Make me, t\n                |                 |                 |                 |                 |     ved,\\nAnd t\n                |                 |                 |                 |                 |      pleased, t\n                |                 |                 |                 |                 |      ore, but t\n                |                 |                 |                 |                 |     is land;\\nT\n                |                 |                 |                 |                 |      ng them, t\n                |                 |                 |                 |                 |     land,\\nIf t\n                |                 |                 |                 |                 |     wouldst,\\nT\n                |                 |                 |                 |                 |     ,\\nWhilst t\n                |                 |                 |                 |                 |      myself,\\nT\n                |                 |                 |                 |                 |      r blinds t\n                |                 |                 |                 |                 |     much\\nBut t\n                |                 |                 |                 |                 |      f thine, t\n                |                 |                 |                 |                 |     avy day,\\nT\n                |                 |                 |                 |                 |     ngbroke,\\nT\n                |                 |                 |                 |                 |     traight,\\nT\n                |                 |                 |                 |                 |     :\\nFiend, t\n                |                 |                 |                 |                 |      rit, and t\n                |                 |                 |                 |                 |      ass, and t\n                |                 |                 |                 |                 |     sperity,\\nT\n                |                 |                 |                 |                 |      nt king, t\n                |                 |                 |                 |                 |     estroy'd\\nT\n                |                 |                 |                 |                 |     t again.\\nT\n                |                 |                 |                 |                 |     hin;\\nAnd t\n                |                 |                 |                 |                 |     en grief\\nT\n                |                 |                 |                 |                 |     ed soul;\\nT\n                |                 |                 |                 |                 |       bounty, t\n                |                 |                 |                 |                 |      wail but t\n                |                 |                 |                 |                 |      way\\nHow t\n                |                 |                 |                 |                 |     oon,\\nAnd t\n                |                 |                 |                 |                 |     you all,\\nT\n                |                 |                 |                 |                 |      to come; t\n                |                 |                 |                 |                 |     acrament\\nT\n                |                 |                 |                 |                 |      ll come; t\n                |                 |                 |                 |                 |     d tower,\\nT\n                |                 |                 |                 |                 |      behold,\\nT\n                |                 |                 |                 |                 |      rue-love t\n                |                 |                 |                 |                 |     ars.\\nAh, t\n                |                 |                 |                 |                 |      h, thou, t\n                |                 |                 |                 |                 |     d stand,\\nT\n                |                 |                 |                 |                 |       honour, t\n                |                 |                 |                 |                 |     od soul,\\nT\n                |                 |                 |                 |                 |       awaked, t\n                |                 |                 |                 |                 |      s us but t\n                |                 |                 |                 |                 |     , sweet,\\nT\n                |                 |                 |                 |                 |     and mind\\nT\n                |                 |                 |                 |                 |      deposed\\nT\n                |                 |                 |                 |                 |     y heart?\\nT\n                |                 |                 |                 |                 |      d wounds t\n                |                 |                 |                 |                 |     ith rage\\nT\n                |                 |                 |                 |                 |     il-like,\\nT\n                |                 |                 |                 |                 |      France:\\nT\n                |                 |                 |                 |                 |      dead and t\n                |                 |                 |                 |                 |      ven here t\n                |                 |                 |                 |                 |      ath-bed, t\n                |                 |                 |                 |                 |      d night, t\n                |                 |                 |                 |                 |      griefs,\\nT\n                |                 |                 |                 |                 |      For why, t\n                |                 |                 |                 |                 |     ack,\\nFor t\n                |                 |                 |                 |                 |      , madam, t\n                |                 |                 |                 |                 |     rewithal\\nT\n                |                 |                 |                 |                 |      ruption: t\n                |                 |                 |                 |                 |     t think,\\nT\n                |                 |                 |                 |                 |     ther way\\nT\n                |                 |                 |                 |                 |      throne.\\nT\n                |                 |                 |                 |                 |     to fear;\\nT\n                |                 |                 |                 |                 |      or both\\nT\n                |                 |                 |                 |                 |      ead, and t\n                |                 |                 |                 |                 |      an end.\\nT\n                |                 |                 |                 |                 |      me,\\nAnd t\n                |                 |                 |                 |                 |      he goes, t\n                |                 |                 |                 |                 |     \\nSo two, t\n                |                 |                 |                 |                 |      l groan, t\n                |                 |                 |                 |                 |      ding it, t\n                |                 |                 |                 |                 |     ly part;\\nT\n                |                 |                 |                 |                 |      and thus t\n                |                 |                 |                 |                 |     be gone,\\nT\n                |                 |                 |                 |                 |      , adieu; t\n                |                 |                 |                 |                 |       I said, t\n                |                 |                 |                 |                 |      and old\\nT\n                |                 |                 |                 |                 |      age, and t\n                |                 |                 |                 |                 |     gbroke!'\\nW\n                |                 |                 |                 |                 |      one side t\n                |                 |                 |                 |                 |     en:'\\nAnd t\n                |                 |                 |                 |                 |      l doing, t\n                |                 |                 |                 |                 |      theatre, t\n                |                 |                 |                 |                 |      r leaves t\n                |                 |                 |                 |                 |     rs next,\\nT\n                |                 |                 |                 |                 |      smiles,\\nT\n                |                 |                 |                 |                 |     atience,\\nT\n                |                 |                 |                 |                 |      steel'd\\nT\n                |                 |                 |                 |                 |      events,\\nT\n                |                 |                 |                 |                 |     ontents.\\nT\n                |                 |                 |                 |                 |     was;\\nBut t\n                |                 |                 |                 |                 |     lets now\\nT\n                |                 |                 |                 |                 |      is that, t\n                |                 |                 |                 |                 |      me bond, t\n                |                 |                 |                 |                 |     K:\\nBound t\n                |                 |                 |                 |                 |     h a bond\\nT\n                |                 |                 |                 |                 |     , I say.\\nT\n                |                 |                 |                 |                 |      oor boy, t\n                |                 |                 |                 |                 |      not hide t\n                |                 |                 |                 |                 |     an,\\nWilt t\n                |                 |                 |                 |                 |     r hands,\\nT\n                |                 |                 |                 |                 |      im here: t\n                |                 |                 |                 |                 |      ve done, t\n                |                 |                 |                 |                 |      hy mind; t\n                |                 |                 |                 |                 |     bed,\\nAnd t\n                |                 |                 |                 |                 |      ard, not t\n                |                 |                 |                 |                 |      fore him t\n                |                 |                 |                 |                 |       behind; t\n                |                 |                 |                 |                 |       not but t\n                |                 |                 |                 |                 |     e ground\\nT\n                |                 |                 |                 |                 |      n no man t\n                |                 |                 |                 |                 |      r there, t\n                |                 |                 |                 |                 |      en such, t\n                |                 |                 |                 |                 |     ate boy,\\nT\n                |                 |                 |                 |                 |     nce,\\nAnd t\n                |                 |                 |                 |                 |      hat said t\n                |                 |                 |                 |                 |       unhorse t\n                |                 |                 |                 |                 |      ate; yet t\n                |                 |                 |                 |                 |       cousin, t\n                |                 |                 |                 |                 |     majesty,\\nT\n                |                 |                 |                 |                 |     r it be,\\nT\n                |                 |                 |                 |                 |     the key,\\nT\n                |                 |                 |                 |                 |      ul hand; t\n                |                 |                 |                 |                 |       breath; t\n                |                 |                 |                 |                 |      danger,\\nT\n                |                 |                 |                 |                 |      ere, and t\n                |                 |                 |                 |                 |      read'st, t\n                |                 |                 |                 |                 |     ous son!\\nT\n                |                 |                 |                 |                 |      rom when t\n                |                 |                 |                 |                 |     himself!\\nT\n                |                 |                 |                 |                 |     bad,\\nAnd t\n                |                 |                 |                 |                 |     hame,\\nAs t\n                |                 |                 |                 |                 |     ur lies:\\nT\n                |                 |                 |                 |                 |      breath,\\nT\n                |                 |                 |                 |                 |      r lives, t\n                |                 |                 |                 |                 |      man, and t\n                |                 |                 |                 |                 |      ggar and t\n                |                 |                 |                 |                 |     per may.\\nT\n                |                 |                 |                 |                 |      cut off, t\n                |                 |                 |                 |                 |     t sound;\\nT\n                |                 |                 |                 |                 |       see day t\n                |                 |                 |                 |                 |     py sees,\\nT\n                |                 |                 |                 |                 |      ray his; t\n                |                 |                 |                 |                 |     hem have\\nT\n                |                 |                 |                 |                 |      cy which t\n                |                 |                 |                 |                 |     hee how:\\nT\n                |                 |                 |                 |                 |     ed lord,\\nT\n                |                 |                 |                 |                 |     ur land;\\nT\n                |                 |                 |                 |                 |     erstand.\\nT\n                |                 |                 |                 |                 |     ine ear;\\nT\n                |                 |                 |                 |                 |     t again;\\nT\n                |                 |                 |                 |                 |      -law and t\n                |                 |                 |                 |                 |     ors are:\\nT\n                |                 |                 |                 |                 |     g fear?'\\nW\n                |                 |                 |                 |                 |     Servant:\\nT\n                |                 |                 |                 |                 |     the man'\\nT\n                |                 |                 |                 |                 |       divorce t\n                |                 |                 |                 |                 |     \\nMy soul t\n                |                 |                 |                 |                 |      her; and t\n                |                 |                 |                 |                 |     hts,\\nAnd t\n                |                 |                 |                 |                 |      ese same t\n                |                 |                 |                 |                 |      ntented. T\n                |                 |                 |                 |                 |     sort,\\nAs t\n                |                 |                 |                 |                 |     word:\\nAs t\n                |                 |                 |                 |                 |      es,' and t\n                |                 |                 |                 |                 |      o thread t\n                |                 |                 |                 |                 |     's eye.'\\nT\n                |                 |                 |                 |                 |      Thoughts t\n                |                 |                 |                 |                 |      mbition, t\n                |                 |                 |                 |                 |      ers; how t\n                |                 |                 |                 |                 |     n pride.\\nT\n                |                 |                 |                 |                 |     emselves\\nT\n                |                 |                 |                 |                 |     ves\\nThat t\n                |                 |                 |                 |                 |     r shame,\\nT\n                |                 |                 |                 |                 |     he like.\\nT\n                |                 |                 |                 |                 |      I king;\\nT\n                |                 |                 |                 |                 |     ng;\\nThen t\n                |                 |                 |                 |                 |      so I am: t\n                |                 |                 |                 |                 |      a king;\\nT\n                |                 |                 |                 |                 |     y and by\\nT\n                |                 |                 |                 |                 |     is,\\nWhen t\n                |                 |                 |                 |                 |      now doth t\n                |                 |                 |                 |                 |      th sighs t\n                |                 |                 |                 |                 |     they jar\\nT\n                |                 |                 |                 |                 |      ne eyes, t\n                |                 |                 |                 |                 |      Now sir, t\n                |                 |                 |                 |                 |      he sound t\n                |                 |                 |                 |                 |      minutes, t\n                |                 |                 |                 |                 |     e clock.\\nT\n                |                 |                 |                 |                 |      p madmen t\n                |                 |                 |                 |                 |     le peer;\\nT\n                |                 |                 |                 |                 |      n groats t\n                |                 |                 |                 |                 |      omes but t\n                |                 |                 |                 |                 |      sad dog\\nT\n                |                 |                 |                 |                 |       me food t\n                |                 |                 |                 |                 |     ng,\\nWhen t\n                |                 |                 |                 |                 |      ng; who, t\n                |                 |                 |                 |                 |      streets, t\n                |                 |                 |                 |                 |     Barbary,\\nT\n                |                 |                 |                 |                 |      at horse t\n                |                 |                 |                 |                 |     bestrid,\\nT\n                |                 |                 |                 |                 |      Barbary? T\n                |                 |                 |                 |                 |      So proud t\n                |                 |                 |                 |                 |     is back!\\nT\n                |                 |                 |                 |                 |     al hand;\\nT\n                |                 |                 |                 |                 |      roud man t\n                |                 |                 |                 |                 |      ll'd and t\n                |                 |                 |                 |                 |      res not, t\n                |                 |                 |                 |                 |      ster and t\n                |                 |                 |                 |                 |      d yields t\n                |                 |                 |                 |                 |     in hell.\\nT\n                |                 |                 |                 |                 |     ing fire\\nT\n                |                 |                 |                 |                 |      my soul! t\n                |                 |                 |                 |                 |       O would t\n                |                 |                 |                 |                 |      e devil, t\n                |                 |                 |                 |                 |      le York, t\n                |                 |                 |                 |                 |     ppiness.\\nT\n                |                 |                 |                 |                 |     nd Kent:\\nT\n                |                 |                 |                 |                 |     ins;\\nAnd t\n                |                 |                 |                 |                 |     o London\\nT\n                |                 |                 |                 |                 |     t Seely,\\nT\n                |                 |                 |                 |                 |      his body t\n                |                 |                 |                 |                 |       living, t\n                |                 |                 |                 |                 |     to abide\\nT\n                |                 |                 |                 |                 |      arlisle, t\n                |                 |                 |                 |                 |       I thee: t\n                |                 |                 |                 |                 |     urdered.\\nT\n                |                 |                 |                 |                 |      nscience t\n                |                 |                 |                 |                 |      favour:\\nW\n                |                 |                 |                 |                 |      of woe,\\nT\n                |                 |                 |                 |                 |     ly Land,\\nT\n                |                 |                 |                 |                 |     ORY:\\nBut t\n                |                 |                 |                 |                 |     GREGORY:\\nT\n                |                 |                 |                 |                 |      tir; and t\n                |                 |                 |                 |                 |     o stand:\\nt\n                |                 |                 |                 |                 |      t moved, t\n                |                 |                 |                 |                 |     SAMPSON:\\nT\n                |                 |                 |                 |                 |      rue; and t\n                |                 |                 |                 |                 |      he wall: t\n                |                 |                 |                 |                 |      all, and t\n                |                 |                 |                 |                 |     SON:\\nAy, t\n                |                 |                 |                 |                 |     enheads;\\nt\n                |                 |                 |                 |                 |      u hadst, t\n                |                 |                 |                 |                 |     at them;\\nw\n                |                 |                 |                 |                 |     s hinds?\\nT\n                |                 |                 |                 |                 |      awn, and t\n                |                 |                 |                 |                 |      ues, and t\n                |                 |                 |                 |                 |     ONTAGUE:\\nT\n                |                 |                 |                 |                 |      beasts,\\nT\n                |                 |                 |                 |                 |     dy hands\\nT\n                |                 |                 |                 |                 |      prince.\\nT\n                |                 |                 |                 |                 |     naments,\\nT\n                |                 |                 |                 |                 |      h peace, t\n                |                 |                 |                 |                 |     ternoon,\\nT\n                |                 |                 |                 |                 |     is case,\\nT\n                |                 |                 |                 |                 |      defiance t\n                |                 |                 |                 |                 |     nd part,\\nT\n                |                 |                 |                 |                 |      'd forth t\n                |                 |                 |                 |                 |      abroad;\\nW\n                |                 |                 |                 |                 |     our son:\\nT\n                |                 |                 |                 |                 |      my own,\\nT\n                |                 |                 |                 |                 |      ied when t\n                |                 |                 |                 |                 |     ue--\\nBut t\n                |                 |                 |                 |                 |     hy stay,\\nT\n                |                 |                 |                 |                 |     O:\\nAlas, t\n                |                 |                 |                 |                 |      g sleep, t\n                |                 |                 |                 |                 |     t it is!\\nT\n                |                 |                 |                 |                 |       feel I, t\n                |                 |                 |                 |                 |     t,\\nWhich t\n                |                 |                 |                 |                 |      opagate, t\n                |                 |                 |                 |                 |      f thine: t\n                |                 |                 |                 |                 |      his love t\n                |                 |                 |                 |                 |     ot here;\\nT\n                |                 |                 |                 |                 |      ut sadly t\n                |                 |                 |                 |                 |      Nor bide t\n                |                 |                 |                 |                 |     ly poor,\\nT\n                |                 |                 |                 |                 |      oo fair, t\n                |                 |                 |                 |                 |     oo fair,\\nT\n                |                 |                 |                 |                 |      ive dead t\n                |                 |                 |                 |                 |     OMEO:\\nO, t\n                |                 |                 |                 |                 |     on more:\\nT\n                |                 |                 |                 |                 |      hey hide t\n                |                 |                 |                 |                 |     \\nYounger t\n                |                 |                 |                 |                 |     LET:\\nAnd t\n                |                 |                 |                 |                 |     ly made.\\nT\n                |                 |                 |                 |                 |     g voice.\\nT\n                |                 |                 |                 |                 |      ng stars t\n                |                 |                 |                 |                 |       number, t\n                |                 |                 |                 |                 |       sirrah, t\n                |                 |                 |                 |                 |      written, t\n                |                 |                 |                 |                 |      ard, and t\n                |                 |                 |                 |                 |      is last, t\n                |                 |                 |                 |                 |      cil, and t\n                |                 |                 |                 |                 |     anguish;\\nT\n                |                 |                 |                 |                 |     anguish:\\nT\n                |                 |                 |                 |                 |     eye,\\nAnd t\n                |                 |                 |                 |                 |      und more t\n                |                 |                 |                 |                 |      pp'd and t\n                |                 |                 |                 |                 |      sisters; t\n                |                 |                 |                 |                 |      ucio and t\n                |                 |                 |                 |                 |       supper; t\n                |                 |                 |                 |                 |      lsehood, t\n                |                 |                 |                 |                 |      od, then t\n                |                 |                 |                 |                 |     res;\\nAnd t\n                |                 |                 |                 |                 |     ver die,\\nT\n                |                 |                 |                 |                 |      my love! t\n                |                 |                 |                 |                 |     her maid\\nT\n                |                 |                 |                 |                 |     own,\\nBut t\n                |                 |                 |                 |                 |     CAPULET:\\nT\n                |                 |                 |                 |                 |      er'd me, t\n                |                 |                 |                 |                 |     counsel.\\nT\n                |                 |                 |                 |                 |      And yet, t\n                |                 |                 |                 |                 |     ourteen;\\nT\n                |                 |                 |                 |                 |      is since t\n                |                 |                 |                 |                 |     ty fool,\\nT\n                |                 |                 |                 |                 |      ke quoth t\n                |                 |                 |                 |                 |      I trow,\\nT\n                |                 |                 |                 |                 |      o bid me t\n                |                 |                 |                 |                 |     row:\\nAnd t\n                |                 |                 |                 |                 |     hy face?\\nT\n                |                 |                 |                 |                 |      ard when t\n                |                 |                 |                 |                 |     olidame,\\nT\n                |                 |                 |                 |                 |      ee, hold t\n                |                 |                 |                 |                 |     t laugh,\\nT\n                |                 |                 |                 |                 |     ge;\\nWilt t\n                |                 |                 |                 |                 |     s grace!\\nT\n                |                 |                 |                 |                 |      talk of. T\n                |                 |                 |                 |                 |     se years\\nT\n                |                 |                 |                 |                 |       a maid. T\n                |                 |                 |                 |                 |     n brief:\\nT\n                |                 |                 |                 |                 |     ntleman?\\nT\n                |                 |                 |                 |                 |     is eyes.\\nT\n                |                 |                 |                 |                 |      of love, t\n                |                 |                 |                 |                 |     d lover,\\nT\n                |                 |                 |                 |                 |     a cover:\\nT\n                |                 |                 |                 |                 |     to hide:\\nT\n                |                 |                 |                 |                 |      th share t\n                |                 |                 |                 |                 |     e glory,\\nT\n                |                 |                 |                 |                 |      ked for, t\n                |                 |                 |                 |                 |     st\\nhence t\n                |                 |                 |                 |                 |     \\nJuliet, t\n                |                 |                 |                 |                 |     is shaft\\nT\n                |                 |                 |                 |                 |     IO:\\nAnd, t\n                |                 |                 |                 |                 |     en love;\\nT\n                |                 |                 |                 |                 |     o rough,\\nT\n                |                 |                 |                 |                 |      oo rude, t\n                |                 |                 |                 |                 |     look on.\\nT\n                |                 |                 |                 |                 |     ERCUTIO:\\nT\n                |                 |                 |                 |                 |      e mouse, t\n                |                 |                 |                 |                 |     word:\\nIf t\n                |                 |                 |                 |                 |     EO:\\nNay, t\n                |                 |                 |                 |                 |      by day.\\nT\n                |                 |                 |                 |                 |      m things t\n                |                 |                 |                 |                 |     s' legs,\\nT\n                |                 |                 |                 |                 |     hoppers,\\nT\n                |                 |                 |                 |                 |     r's web,\\nT\n                |                 |                 |                 |                 |      's bone, t\n                |                 |                 |                 |                 |     ld grub,\\nT\n                |                 |                 |                 |                 |      ins, and t\n                |                 |                 |                 |                 |      and then t\n                |                 |                 |                 |                 |      ' knees, t\n                |                 |                 |                 |                 |     ose,\\nAnd t\n                |                 |                 |                 |                 |      asleep,\\nT\n                |                 |                 |                 |                 |     eck,\\nAnd t\n                |                 |                 |                 |                 |      eep; and t\n                |                 |                 |                 |                 |      s again. T\n                |                 |                 |                 |                 |     e bodes:\\nT\n                |                 |                 |                 |                 |     r backs,\\nT\n                |                 |                 |                 |                 |     arriage:\\nT\n                |                 |                 |                 |                 |     , peace!\\nT\n                |                 |                 |                 |                 |      ant than t\n                |                 |                 |                 |                 |      thence,\\nT\n                |                 |                 |                 |                 |     \\nI fear, t\n                |                 |                 |                 |                 |     \\nBut He, t\n                |                 |                 |                 |                 |       Potpan, t\n                |                 |                 |                 |                 |      here and t\n                |                 |                 |                 |                 |      ile, and t\n                |                 |                 |                 |                 |      er liver t\n                |                 |                 |                 |                 |      the day\\nT\n                |                 |                 |                 |                 |      ves; and t\n                |                 |                 |                 |                 |      d quench t\n                |                 |                 |                 |                 |      he fire, t\n                |                 |                 |                 |                 |      'r lady, t\n                |                 |                 |                 |                 |      ars; and t\n                |                 |                 |                 |                 |      she doth t\n                |                 |                 |                 |                 |       torches t\n                |                 |                 |                 |                 |      or earth t\n                |                 |                 |                 |                 |     s shows.\\nT\n                |                 |                 |                 |                 |     nd,\\nAnd, t\n                |                 |                 |                 |                 |    \\nTYBALT:\\nT\n                |                 |                 |                 |                 |      at dares t\n                |                 |                 |                 |                 |     ic face,\\nT\n                |                 |                 |                 |                 |      my kin,\\nT\n                |                 |                 |                 |                 |     :\\nUncle, t\n                |                 |                 |                 |                 |       villain t\n                |                 |                 |                 |                 |     n spite,\\nT\n                |                 |                 |                 |                 |     an;\\nAnd, t\n                |                 |                 |                 |                 |     agement:\\nT\n                |                 |                 |                 |                 |      my will, t\n                |                 |                 |                 |                 |      indeed?\\nT\n                |                 |                 |                 |                 |      raw: but t\n                |                 |                 |                 |                 |      our hand t\n                |                 |                 |                 |                 |     ands do;\\nT\n                |                 |                 |                 |                 |      ot move, t\n                |                 |                 |                 |                 |      I take.\\nT\n                |                 |                 |                 |                 |    \\nJULIET:\\nT\n                |                 |                 |                 |                 |      aughter, t\n                |                 |                 |                 |                 |       I fear; t\n                |                 |                 |                 |                 |       banquet t\n                |                 |                 |                 |                 |     ht.\\nMore t\n                |                 |                 |                 |                 |   \\n\\nNurse:\\nT\n                |                 |                 |                 |                 |    \\nJULIET:\\nW\n                |                 |                 |                 |                 |      s there, t\n                |                 |                 |                 |                 |     ontague;\\nT\n                |                 |                 |                 |                 |     ly hate!\\nT\n                |                 |                 |                 |                 |     s to me,\\nT\n                |                 |                 |                 |                 |      's away; t\n                |                 |                 |                 |                 |     is heir;\\nT\n                |                 |                 |                 |                 |     oks,\\nBut t\n                |                 |                 |                 |                 |      m power, t\n                |                 |                 |                 |                 |      e means, t\n                |                 |                 |                 |                 |     is here?\\nT\n                |                 |                 |                 |                 |      and find t\n                |                 |                 |                 |                 |     eth not;\\nT\n                |                 |                 |                 |                 |     high\\nAnd t\n                |                 |                 |                 |                 |     ent lie,\\nT\n                |                 |                 |                 |                 |      ar thee, t\n                |                 |                 |                 |                 |     re stand\\nT\n                |                 |                 |                 |                 |     it down;\\nT\n                |                 |                 |                 |                 |      only but t\n                |                 |                 |                 |                 |     e trees,\\nT\n                |                 |                 |                 |                 |      rs, when t\n                |                 |                 |                 |                 |      were, O, t\n                |                 |                 |                 |                 |      caetera, t\n                |                 |                 |                 |                 |     kle-bed;\\nT\n                |                 |                 |                 |                 |      in vain\\nT\n                |                 |                 |                 |                 |      at scars t\n                |                 |                 |                 |                 |     h grief,\\nT\n                |                 |                 |                 |                 |     ef,\\nThat t\n                |                 |                 |                 |                 |     love!\\nO, t\n                |                 |                 |                 |                 |      speaks:\\nT\n                |                 |                 |                 |                 |     her eyes\\nT\n                |                 |                 |                 |                 |       spheres t\n                |                 |                 |                 |                 |      e there, t\n                |                 |                 |                 |                 |     er head?\\nT\n                |                 |                 |                 |                 |      ld shame t\n                |                 |                 |                 |                 |     en\\nWould t\n                |                 |                 |                 |                 |      sing and t\n                |                 |                 |                 |                 |     hand!\\nO, t\n                |                 |                 |                 |                 |     at hand,\\nT\n                |                 |                 |                 |                 |      ht touch t\n                |                 |                 |                 |                 |       mortals t\n                |                 |                 |                 |                 |     y enemy;\\nT\n                |                 |                 |                 |                 |      thyself, t\n                |                 |                 |                 |                 |     er name!\\nW\n                |                 |                 |                 |                 |       man art t\n                |                 |                 |                 |                 |      hou that t\n                |                 |                 |                 |                 |       hither, t\n                |                 |                 |                 |                 |     erefore?\\nT\n                |                 |                 |                 |                 |     imb,\\nAnd t\n                |                 |                 |                 |                 |      ring who t\n                |                 |                 |                 |                 |      men find t\n                |                 |                 |                 |                 |     attempt;\\nT\n                |                 |                 |                 |                 |      ee thee, t\n                |                 |                 |                 |                 |      l murder t\n                |                 |                 |                 |                 |     :\\nAlack, t\n                |                 |                 |                 |                 |     eye\\nThan t\n                |                 |                 |                 |                 |     \\nAnd but t\n                |                 |                 |                 |                 |     ir hate,\\nT\n                |                 |                 |                 |                 |     s far\\nAs t\n                |                 |                 |                 |                 |      at which t\n                |                 |                 |                 |                 |     wear'st,\\nT\n                |                 |                 |                 |                 |     erjuries\\nT\n                |                 |                 |                 |                 |     omeo,\\nIf t\n                |                 |                 |                 |                 |      e an say t\n                |                 |                 |                 |                 |     ond,\\nAnd t\n                |                 |                 |                 |                 |     ght:\\nBut t\n                |                 |                 |                 |                 |     ore true\\nT\n                |                 |                 |                 |                 |     rue\\nThan t\n                |                 |                 |                 |                 |     ess,\\nBut t\n                |                 |                 |                 |                 |      passion: t\n                |                 |                 |                 |                 |     ear\\nThat t\n                |                 |                 |                 |                 |      he moon, t\n                |                 |                 |                 |                 |     nt moon,\\nT\n                |                 |                 |                 |                 |     rb,\\nLest t\n                |                 |                 |                 |                 |      oo rash, t\n                |                 |                 |                 |                 |      advised, t\n                |                 |                 |                 |                 |      sudden;\\nT\n                |                 |                 |                 |                 |     d night!\\nT\n                |                 |                 |                 |                 |     IET:\\nBut t\n                |                 |                 |                 |                 |      as deep; t\n                |                 |                 |                 |                 |     to thee,\\nT\n                |                 |                 |                 |                 |     a dream,\\nT\n                |                 |                 |                 |                 |     deed.\\nIf t\n                |                 |                 |                 |                 |     ourable,\\nT\n                |                 |                 |                 |                 |      come:--\\nT\n                |                 |                 |                 |                 |     y grief:\\nT\n                |                 |                 |                 |                 |      nd times t\n                |                 |                 |                 |                 |      e worse, t\n                |                 |                 |                 |                 |      om love, t\n                |                 |                 |                 |                 |     s voice,\\nT\n                |                 |                 |                 |                 |      e hoarse t\n                |                 |                 |                 |                 |       my soul t\n                |                 |                 |                 |                 |      and here t\n                |                 |                 |                 |                 |       forget, t\n                |                 |                 |                 |                 |      ll stay, t\n                |                 |                 |                 |                 |      home but t\n                |                 |                 |                 |                 |      sorrow,\\nT\n                |                 |                 |                 |                 |     AURENCE:\\nT\n                |                 |                 |                 |                 |     ing eye,\\nT\n                |                 |                 |                 |                 |     flowers.\\nT\n                |                 |                 |                 |                 |      ul grace t\n                |                 |                 |                 |                 |       so vile t\n                |                 |                 |                 |                 |     live\\nBut t\n                |                 |                 |                 |                 |      ull soon t\n                |                 |                 |                 |                 |      s limbs, t\n                |                 |                 |                 |                 |     h reign:\\nT\n                |                 |                 |                 |                 |     e assure\\nT\n                |                 |                 |                 |                 |       not so, t\n                |                 |                 |                 |                 |      is true; t\n                |                 |                 |                 |                 |      ame, and t\n                |                 |                 |                 |                 |      ere hast t\n                |                 |                 |                 |                 |      ou been, t\n                |                 |                 |                 |                 |     nded me,\\nT\n                |                 |                 |                 |                 |      ass; but t\n                |                 |                 |                 |                 |      I pray,\\nT\n                |                 |                 |                 |                 |     ay,\\nThat t\n                |                 |                 |                 |                 |      ne, whom t\n                |                 |                 |                 |                 |     n waste,\\nT\n                |                 |                 |                 |                 |      on love, t\n                |                 |                 |                 |                 |      doth not t\n                |                 |                 |                 |                 |     t taste!\\nT\n                |                 |                 |                 |                 |      clears,\\nT\n                |                 |                 |                 |                 |      Thou and t\n                |                 |                 |                 |                 |      ll, when t\n                |                 |                 |                 |                 |     a grave,\\nT\n                |                 |                 |                 |                 |     e allow;\\nT\n                |                 |                 |                 |                 |     y prove,\\nT\n                |                 |                 |                 |                 |      nd slow; t\n                |                 |                 |                 |                 |     TIO:\\nAh, t\n                |                 |                 |                 |                 |      d wench, t\n                |                 |                 |                 |                 |     osaline.\\nT\n                |                 |                 |                 |                 |       him so, t\n                |                 |                 |                 |                 |     \\nTybalt, t\n                |                 |                 |                 |                 |     \\nAny man t\n                |                 |                 |                 |                 |      ye; shot t\n                |                 |                 |                 |                 |      ve-song; t\n                |                 |                 |                 |                 |      st, one, t\n                |                 |                 |                 |                 |     two, and\\nt\n                |                 |                 |                 |                 |      r bosom: t\n                |                 |                 |                 |                 |     use:\\nah, t\n                |                 |                 |                 |                 |      passado! t\n                |                 |                 |                 |                 |      sticoes; t\n                |                 |                 |                 |                 |      andsire, t\n                |                 |                 |                 |                 |      e flies, t\n                |                 |                 |                 |                 |      mongers, t\n                |                 |                 |                 |                 |     ew form,\\nt\n                |                 |                 |                 |                 |     rm,\\nthat t\n                |                 |                 |                 |                 |     r\\nbones, t\n                |                 |                 |                 |                 |      on jour! t\n                |                 |                 |                 |                 |      ip, sir, t\n                |                 |                 |                 |                 |      ns a man t\n                |                 |                 |                 |                 |      Meaning, t\n                |                 |                 |                 |                 |      hy pump, t\n                |                 |                 |                 |                 |      is worn, t\n                |                 |                 |                 |                 |      ing when t\n                |                 |                 |                 |                 |      heveril, t\n                |                 |                 |                 |                 |     ch added\\nt\n                |                 |                 |                 |                 |     natural,\\nt\n                |                 |                 |                 |                 |     IO:\\nTwo, t\n                |                 |                 |                 |                 |      d Peter, t\n                |                 |                 |                 |                 |      lewoman, t\n                |                 |                 |                 |                 |     ten pie,\\nt\n                |                 |                 |                 |                 |       dinner, t\n                |                 |                 |                 |                 |      as this, t\n                |                 |                 |                 |                 |      , nurse, t\n                |                 |                 |                 |                 |       is, and t\n                |                 |                 |                 |                 |      rel, and t\n                |                 |                 |                 |                 |      o vexed, t\n                |                 |                 |                 |                 |      ng; and, t\n                |                 |                 |                 |                 |      ith her, t\n                |                 |                 |                 |                 |      ll thing t\n                |                 |                 |                 |                 |      er, sir, t\n                |                 |                 |                 |                 |     oon;\\nAnd t\n                |                 |                 |                 |                 |     r;\\nWhich t\n                |                 |                 |                 |                 |     ear say,\\nT\n                |                 |                 |                 |                 |      e Paris, t\n                |                 |                 |                 |                 |      imes and t\n                |                 |                 |                 |                 |       mocker! t\n                |                 |                 |                 |                 |      osemary, t\n                |                 |                 |                 |                 |      eet him: t\n                |                 |                 |                 |                 |     s,\\nWhich t\n                |                 |                 |                 |                 |      ide than t\n                |                 |                 |                 |                 |     g hills:\\nT\n                |                 |                 |                 |                 |     ove,\\nAnd t\n                |                 |                 |                 |                 |     hou sad?\\nT\n                |                 |                 |                 |                 |      sad, yet t\n                |                 |                 |                 |                 |      If good, t\n                |                 |                 |                 |                 |      th, when t\n                |                 |                 |                 |                 |      ay to me t\n                |                 |                 |                 |                 |      breath?\\nT\n                |                 |                 |                 |                 |      a body,\\nt\n                |                 |                 |                 |                 |     ,\\nthough t\n                |                 |                 |                 |                 |       on, yet t\n                |                 |                 |                 |                 |     e about,\\nT\n                |                 |                 |                 |                 |      t nurse, t\n                |                 |                 |                 |                 |      ow oddly t\n                |                 |                 |                 |                 |     e' cell;\\nT\n                |                 |                 |                 |                 |      cheeks,\\nT\n                |                 |                 |                 |                 |     her way,\\nT\n                |                 |                 |                 |                 |      So smile t\n                |                 |                 |                 |                 |     oly act,\\nT\n                |                 |                 |                 |                 |     e of joy\\nT\n                |                 |                 |                 |                 |      consume: t\n                |                 |                 |                 |                 |     ppetite:\\nT\n                |                 |                 |                 |                 |     doth so;\\nT\n                |                 |                 |                 |                 |      mine and t\n                |                 |                 |                 |                 |      azon it, t\n                |                 |                 |                 |                 |     rnament:\\nT\n                |                 |                 |                 |                 |     ay alone\\nT\n                |                 |                 |                 |                 |      retire:\\nT\n                |                 |                 |                 |                 |       is hot, t\n                |                 |                 |                 |                 |      For now, t\n                |                 |                 |                 |                 |     \\nNay, an t\n                |                 |                 |                 |                 |      e other. T\n                |                 |                 |                 |                 |      th a man t\n                |                 |                 |                 |                 |      s beard, t\n                |                 |                 |                 |                 |      rd, than t\n                |                 |                 |                 |                 |      ou hast: t\n                |                 |                 |                 |                 |     quarrel?\\nT\n                |                 |                 |                 |                 |       and yet t\n                |                 |                 |                 |                 |      relling: t\n                |                 |                 |                 |                 |      arrel as t\n                |                 |                 |                 |                 |      ercutio, t\n                |                 |                 |                 |                 |     rels? an\\nt\n                |                 |                 |                 |                 |      ere made t\n                |                 |                 |                 |                 |      erm than t\n                |                 |                 |                 |                 |     ing rage\\nT\n                |                 |                 |                 |                 |      I none;\\nT\n                |                 |                 |                 |                 |     LT:\\nBoy, t\n                |                 |                 |                 |                 |     injuries\\nT\n                |                 |                 |                 |                 |     ies\\nThat t\n                |                 |                 |                 |                 |      done me; t\n                |                 |                 |                 |                 |      devise,\\nT\n                |                 |                 |                 |                 |     it away.\\nT\n                |                 |                 |                 |                 |     e\\nlives; t\n                |                 |                 |                 |                 |     outrage!\\nT\n                |                 |                 |                 |                 |      ge, man; t\n                |                 |                 |                 |                 |     , a\\ncat, t\n                |                 |                 |                 |                 |      ch a man t\n                |                 |                 |                 |                 |      villain, t\n                |                 |                 |                 |                 |      houses!\\nT\n                |                 |                 |                 |                 |       soundly t\n                |                 |                 |                 |                 |      Juliet,\\nT\n                |                 |                 |                 |                 |     's dead!\\nT\n                |                 |                 |                 |                 |      depend;\\nT\n                |                 |                 |                 |                 |       Tybalt, t\n                |                 |                 |                 |                 |     k again,\\nT\n                |                 |                 |                 |                 |      hed boy, t\n                |                 |                 |                 |                 |     be gone!\\nT\n                |                 |                 |                 |                 |       amazed: t\n                |                 |                 |                 |                 |     eath,\\nIf t\n                |                 |                 |                 |                 |     ercutio?\\nT\n                |                 |                 |                 |                 |     l brawl:\\nT\n                |                 |                 |                 |                 |     g Romeo,\\nT\n                |                 |                 |                 |                 |      ince, as t\n                |                 |                 |                 |                 |      ho began t\n                |                 |                 |                 |                 |      How nice t\n                |                 |                 |                 |                 |      ace, but t\n                |                 |                 |                 |                 |       as hot, t\n                |                 |                 |                 |                 |      tio, and t\n                |                 |                 |                 |                 |     nge,\\nAnd t\n                |                 |                 |                 |                 |     and fly.\\nT\n                |                 |                 |                 |                 |     uld end,\\nT\n                |                 |                 |                 |                 |     g a fine\\nT\n                |                 |                 |                 |                 |      abuses:\\nT\n                |                 |                 |                 |                 |      s found, t\n                |                 |                 |                 |                 |      ar hence t\n                |                 |                 |                 |                 |      steeds,\\nT\n                |                 |                 |                 |                 |     g night,\\nT\n                |                 |                 |                 |                 |     l night,\\nT\n                |                 |                 |                 |                 |       mantle; t\n                |                 |                 |                 |                 |     wn bold,\\nT\n                |                 |                 |                 |                 |     all die,\\nT\n                |                 |                 |                 |                 |      so fine\\nT\n                |                 |                 |                 |                 |      it, and, t\n                |                 |                 |                 |                 |      oy'd: so t\n                |                 |                 |                 |                 |      nt child t\n                |                 |                 |                 |                 |     he cords\\nT\n                |                 |                 |                 |                 |     \\nAy, ay, t\n                |                 |                 |                 |                 |     meo can,\\nT\n                |                 |                 |                 |                 |      rt thou, t\n                |                 |                 |                 |                 |     me thus?\\nT\n                |                 |                 |                 |                 |     'I,'\\nAnd t\n                |                 |                 |                 |                 |      es shut, t\n                |                 |                 |                 |                 |     at once!\\nT\n                |                 |                 |                 |                 |      e earth, t\n                |                 |                 |                 |                 |     ere;\\nAnd t\n                |                 |                 |                 |                 |     ntleman!\\nT\n                |                 |                 |                 |                 |     er lord?\\nT\n                |                 |                 |                 |                 |      t, sound t\n                |                 |                 |                 |                 |     ll,\\nWhen t\n                |                 |                 |                 |                 |     a vitae:\\nT\n                |                 |                 |                 |                 |       griefs, t\n                |                 |                 |                 |                 |      se woes, t\n                |                 |                 |                 |                 |       ashamed t\n                |                 |                 |                 |                 |      l smooth t\n                |                 |                 |                 |                 |     \\nWhen I, t\n                |                 |                 |                 |                 |      cousin?\\nT\n                |                 |                 |                 |                 |       foolish t\n                |                 |                 |                 |                 |      d lives, t\n                |                 |                 |                 |                 |      's dead, t\n                |                 |                 |                 |                 |      ty deeds t\n                |                 |                 |                 |                 |     nished;'\\nT\n                |                 |                 |                 |                 |      nished,' t\n                |                 |                 |                 |                 |     s dead,'\\nT\n                |                 |                 |                 |                 |     nished!'\\nT\n                |                 |                 |                 |                 |     nt,\\nWhen t\n                |                 |                 |                 |                 |     ishment.\\nT\n                |                 |                 |                 |                 |      t Romeo, t\n                |                 |                 |                 |                 |     nd Romeo\\nT\n                |                 |                 |                 |                 |      e forth, t\n                |                 |                 |                 |                 |     rts,\\nAnd t\n                |                 |                 |                 |                 |      ath more t\n                |                 |                 |                 |                 |      rgatory, t\n                |                 |                 |                 |                 |     fulness!\\nT\n                |                 |                 |                 |                 |      'd aside t\n                |                 |                 |                 |                 |      rd death t\n                |                 |                 |                 |                 |     ishment:\\nT\n                |                 |                 |                 |                 |      rcy, and t\n                |                 |                 |                 |                 |      n Romeo: t\n                |                 |                 |                 |                 |      lush, as t\n                |                 |                 |                 |                 |     ust fly:\\nT\n                |                 |                 |                 |                 |      f death, t\n                |                 |                 |                 |                 |      O friar, t\n                |                 |                 |                 |                 |     ofess'd,\\nT\n                |                 |                 |                 |                 |     losophy,\\nT\n                |                 |                 |                 |                 |      rt thee, t\n                |                 |                 |                 |                 |      , though t\n                |                 |                 |                 |                 |     ENCE:\\nO, t\n                |                 |                 |                 |                 |     anished,\\nT\n                |                 |                 |                 |                 |       mightst t\n                |                 |                 |                 |                 |      u speak, t\n                |                 |                 |                 |                 |      do now,\\nT\n                |                 |                 |                 |                 |      eo, hide t\n                |                 |                 |                 |                 |      ; unless t\n                |                 |                 |                 |                 |     , arise;\\nT\n                |                 |                 |                 |                 |      Welcome, t\n                |                 |                 |                 |                 |      riar, O, t\n                |                 |                 |                 |                 |      l'd lady t\n                |                 |                 |                 |                 |      bed; and t\n                |                 |                 |                 |                 |      lls; and t\n                |                 |                 |                 |                 |     ies,\\nAnd t\n                |                 |                 |                 |                 |       her; as t\n                |                 |                 |                 |                 |      , friar, t\n                |                 |                 |                 |                 |      tell me, t\n                |                 |                 |                 |                 |     may sack\\nT\n                |                 |                 |                 |                 |     hou art:\\nT\n                |                 |                 |                 |                 |      omanish; t\n                |                 |                 |                 |                 |     ng both!\\nT\n                |                 |                 |                 |                 |      hou slay t\n                |                 |                 |                 |                 |      y birth, t\n                |                 |                 |                 |                 |      e; which t\n                |                 |                 |                 |                 |      ie, fie, t\n                |                 |                 |                 |                 |      y shape, t\n                |                 |                 |                 |                 |      hy love, t\n                |                 |                 |                 |                 |     thy wit;\\nW\n                |                 |                 |                 |                 |     thy wit:\\nT\n                |                 |                 |                 |                 |     f a man;\\nT\n                |                 |                 |                 |                 |      ve which t\n                |                 |                 |                 |                 |     cherish;\\nT\n                |                 |                 |                 |                 |      Thy wit, t\n                |                 |                 |                 |                 |      t, rouse t\n                |                 |                 |                 |                 |      ee, man! t\n                |                 |                 |                 |                 |     ly dead;\\nT\n                |                 |                 |                 |                 |       Tybalt; t\n                |                 |                 |                 |                 |     ppy too:\\nT\n                |                 |                 |                 |                 |      o exile; t\n                |                 |                 |                 |                 |     n wench,\\nT\n                |                 |                 |                 |                 |     hy love:\\nT\n                |                 |                 |                 |                 |      ke heed, t\n                |                 |                 |                 |                 |      lt live, t\n                |                 |                 |                 |                 |     joy\\nThan t\n                |                 |                 |                 |                 |     luckily,\\nT\n                |                 |                 |                 |                 |   \\n\\nPARIS:\\nT\n                |                 |                 |                 |                 |      nd early t\n                |                 |                 |                 |                 |     -morrow;\\nT\n                |                 |                 |                 |                 |       ha, ha! W\n                |                 |                 |                 |                 |      hursday, t\n                |                 |                 |                 |                 |     el much:\\nT\n                |                 |                 |                 |                 |     nds,\\nAnd t\n                |                 |                 |                 |                 |      y be it, t\n                |                 |                 |                 |                 |     ry late,\\nT\n                |                 |                 |                 |                 |     he lark,\\nT\n                |                 |                 |                 |                 |      he lark, t\n                |                 |                 |                 |                 |     \\nDo lace t\n                |                 |                 |                 |                 |     exhales,\\nT\n                |                 |                 |                 |                 |      Mantua:\\nT\n                |                 |                 |                 |                 |      tay yet; t\n                |                 |                 |                 |                 |      do beat\\nT\n                |                 |                 |                 |                 |      Some say t\n                |                 |                 |                 |                 |     ivision;\\nT\n                |                 |                 |                 |                 |       loathed t\n                |                 |                 |                 |                 |     chamber:\\nT\n                |                 |                 |                 |                 |     ortunity\\nT\n                |                 |                 |                 |                 |      s, love, t\n                |                 |                 |                 |                 |      hee, now t\n                |                 |                 |                 |                 |     MEO:\\nAnd t\n                |                 |                 |                 |                 |     ckle:\\nIf t\n                |                 |                 |                 |                 |     ith him.\\nT\n                |                 |                 |                 |                 |       I hope, t\n                |                 |                 |                 |                 |     o early?\\nW\n                |                 |                 |                 |                 |      couldst, t\n                |                 |                 |                 |                 |     im live;\\nT\n                |                 |                 |                 |                 |      l, girl, t\n                |                 |                 |                 |                 |     eath,\\nAs t\n                |                 |                 |                 |                 |     hou not:\\nT\n                |                 |                 |                 |                 |     a,\\nWhere t\n                |                 |                 |                 |                 |     'd dram,\\nT\n                |                 |                 |                 |                 |     any:\\nAnd t\n                |                 |                 |                 |                 |      h Romeo, t\n                |                 |                 |                 |                 |     mper it;\\nT\n                |                 |                 |                 |                 |      to him.\\nT\n                |                 |                 |                 |                 |      One who, t\n                |                 |                 |                 |                 |      of joy,\\nT\n                |                 |                 |                 |                 |     oy,\\nThat t\n                |                 |                 |                 |                 |     ay morn,\\nT\n                |                 |                 |                 |                 |     ntleman,\\nT\n                |                 |                 |                 |                 |      s haste; t\n                |                 |                 |                 |                 |     \\nEre he, t\n                |                 |                 |                 |                 |      ray you, t\n                |                 |                 |                 |                 |      n Paris. T\n                |                 |                 |                 |                 |       father; t\n                |                 |                 |                 |                 |      un sets, t\n                |                 |                 |                 |                 |     tle body\\nT\n                |                 |                 |                 |                 |      h tears; t\n                |                 |                 |                 |                 |      t flood; t\n                |                 |                 |                 |                 |      e winds, t\n                |                 |                 |                 |                 |      overset\\nT\n                |                 |                 |                 |                 |     T:\\nSoft! t\n                |                 |                 |                 |                 |       she is, t\n                |                 |                 |                 |                 |      ave; but t\n                |                 |                 |                 |                 |      hankful, t\n                |                 |                 |                 |                 |     ate;\\nBut t\n                |                 |                 |                 |                 |      or hate, t\n                |                 |                 |                 |                 |     on, you,\\nT\n                |                 |                 |                 |                 |     ay next,\\nT\n                |                 |                 |                 |                 |      ence but t\n                |                 |                 |                 |                 |      e scarce t\n                |                 |                 |                 |                 |      t us but t\n                |                 |                 |                 |                 |     uch,\\nAnd t\n                |                 |                 |                 |                 |      t, hour, t\n                |                 |                 |                 |                 |      r, tide, t\n                |                 |                 |                 |                 |      ff'd, as t\n                |                 |                 |                 |                 |     man;\\nAnd t\n                |                 |                 |                 |                 |      And then t\n                |                 |                 |                 |                 |      tender,\\nT\n                |                 |                 |                 |                 |      ok to't, t\n                |                 |                 |                 |                 |     to jest.\\nT\n                |                 |                 |                 |                 |     ee good:\\nT\n                |                 |                 |                 |                 |      clouds,\\nT\n                |                 |                 |                 |                 |      , alack, t\n                |                 |                 |                 |                 |     nothing,\\nT\n                |                 |                 |                 |                 |     stealth.\\nT\n                |                 |                 |                 |                 |      n, since t\n                |                 |                 |                 |                 |      ishclout t\n                |                 |                 |                 |                 |       father, t\n                |                 |                 |                 |                 |     e' cell,\\nT\n                |                 |                 |                 |                 |      sion and t\n                |                 |                 |                 |                 |      ill; and t\n                |                 |                 |                 |                 |     worn,\\nOr t\n                |                 |                 |                 |                 |      hat same t\n                |                 |                 |                 |                 |     nsellor;\\nT\n                |                 |                 |                 |                 |      e friar, t\n                |                 |                 |                 |                 |     angerous\\nT\n                |                 |                 |                 |                 |     arriage,\\nT\n                |                 |                 |                 |                 |      y to him t\n                |                 |                 |                 |                 |      am sure, t\n                |                 |                 |                 |                 |      ur back, t\n                |                 |                 |                 |                 |      ck, than t\n                |                 |                 |                 |                 |      it, more t\n                |                 |                 |                 |                 |     ouse ye:\\nT\n                |                 |                 |                 |                 |      and when t\n                |                 |                 |                 |                 |       wisdom, t\n                |                 |                 |                 |                 |      Romeo's, t\n                |                 |                 |                 |                 |      another, t\n                |                 |                 |                 |                 |     em both:\\nT\n                |                 |                 |                 |                 |      s and me t\n                |                 |                 |                 |                 |     tion.\\nAs t\n                |                 |                 |                 |                 |     y Paris,\\nT\n                |                 |                 |                 |                 |     thyself,\\nT\n                |                 |                 |                 |                 |      ke death t\n                |                 |                 |                 |                 |     s shame,\\nT\n                |                 |                 |                 |                 |     \\nAnd, if t\n                |                 |                 |                 |                 |      shroud;\\nT\n                |                 |                 |                 |                 |     ;\\nThings t\n                |                 |                 |                 |                 |      gs that, t\n                |                 |                 |                 |                 |       made me t\n                |                 |                 |                 |                 |     r doubt,\\nT\n                |                 |                 |                 |                 |     E:\\nHold, t\n                |                 |                 |                 |                 |     -morrow:\\nT\n                |                 |                 |                 |                 |      ook that t\n                |                 |                 |                 |                 |      livest;\\nT\n                |                 |                 |                 |                 |     all fade\\nT\n                |                 |                 |                 |                 |      y ashes, t\n                |                 |                 |                 |                 |     nk death\\nT\n                |                 |                 |                 |                 |     urs,\\nAnd t\n                |                 |                 |                 |                 |      thy bed, t\n                |                 |                 |                 |                 |     ou dead:\\nT\n                |                 |                 |                 |                 |      Then, as t\n                |                 |                 |                 |                 |      ee hence t\n                |                 |                 |                 |                 |     tua.\\nAnd t\n                |                 |                 |                 |                 |     r,\\nAbate t\n                |                 |                 |                 |                 |     th speed\\nT\n                |                 |                 |                 |                 |      fingers: t\n                |                 |                 |                 |                 |      Laurence t\n                |                 |                 |                 |                 |      ad on't; t\n                |                 |                 |                 |                 |     tand up:\\nT\n                |                 |                 |                 |                 |      ore God! t\n                |                 |                 |                 |                 |      closet,\\nT\n                |                 |                 |                 |                 |      hursday; t\n                |                 |                 |                 |                 |     hat, ho!\\nT\n                |                 |                 |                 |                 |     k myself\\nT\n                |                 |                 |                 |                 |      y Paris, t\n                |                 |                 |                 |                 |     t,\\nSince t\n                |                 |                 |                 |                 |     IET:\\nAy, t\n                |                 |                 |                 |                 |      orisons\\nT\n                |                 |                 |                 |                 |       heavens t\n                |                 |                 |                 |                 |       thrills t\n                |                 |                 |                 |                 |     y veins,\\nT\n                |                 |                 |                 |                 |      ied then t\n                |                 |                 |                 |                 |      ill been t\n                |                 |                 |                 |                 |      l I not, t\n                |                 |                 |                 |                 |     e vault,\\nT\n                |                 |                 |                 |                 |     ry like,\\nT\n                |                 |                 |                 |                 |     d night,\\nT\n                |                 |                 |                 |                 |      d years, t\n                |                 |                 |                 |                 |     T:\\nHold, t\n                |                 |                 |                 |                 |      crow'd,\\nT\n                |                 |                 |                 |                 |      ad, sir, t\n                |                 |                 |                 |                 |     son, ha!\\nT\n                |                 |                 |                 |                 |     tis day:\\nT\n                |                 |                 |                 |                 |     , bride!\\nW\n                |                 |                 |                 |                 |     warrant,\\nT\n                |                 |                 |                 |                 |     is rest,\\nT\n                |                 |                 |                 |                 |      l-a-day, t\n                |                 |                 |                 |                 |      Life and t\n                |                 |                 |                 |                 |      er hence t\n                |                 |                 |                 |                 |     me wail,\\nT\n                |                 |                 |                 |                 |     .\\nO son! t\n                |                 |                 |                 |                 |      hy wife. T\n                |                 |                 |                 |                 |     ful day,\\nT\n                |                 |                 |                 |                 |     al life.\\nT\n                |                 |                 |                 |                 |      so ill,\\nT\n                |                 |                 |                 |                 |      l things t\n                |                 |                 |                 |                 |     estival,\\nT\n                |                 |                 |                 |                 |      r office t\n                |                 |                 |                 |                 |     r grave:\\nT\n                |                 |                 |                 |                 |      ou know, t\n                |                 |                 |                 |                 |      y troth, t\n                |                 |                 |                 |                 |     ry dump,\\nt\n                |                 |                 |                 |                 |      ill not, t\n                |                 |                 |                 |                 |      ith, but t\n                |                 |                 |                 |                 |     usician:\\nT\n                |                 |                 |                 |                 |   \\n\\nPETER:\\nT\n                |                 |                 |                 |                 |      ng grief t\n                |                 |                 |                 |                 |     oppress,\\nT\n                |                 |                 |                 |                 |      in here; t\n                |                 |                 |                 |                 |      e dream, t\n                |                 |                 |                 |                 |     my lips,\\nT\n                |                 |                 |                 |                 |     LTHASAR:\\nT\n                |                 |                 |                 |                 |     , stars!\\nT\n                |                 |                 |                 |                 |     O:\\nTush, t\n                |                 |                 |                 |                 |      ischief, t\n                |                 |                 |                 |                 |      atter'd, t\n                |                 |                 |                 |                 |       penury, t\n                |                 |                 |                 |                 |     him.'\\nO, t\n                |                 |                 |                 |                 |     eed;\\nAnd t\n                |                 |                 |                 |                 |      emember, t\n                |                 |                 |                 |                 |      holiday, t\n                |                 |                 |                 |                 |     thecary:\\nW\n                |                 |                 |                 |                 |     r:\\nHold, t\n                |                 |                 |                 |                 |     he veins\\nT\n                |                 |                 |                 |                 |     ins\\nThat t\n                |                 |                 |                 |                 |     dead\\nAnd t\n                |                 |                 |                 |                 |      Is death t\n                |                 |                 |                 |                 |     hy back;\\nT\n                |                 |                 |                 |                 |     d's law;\\nT\n                |                 |                 |                 |                 |     ee rich;\\nT\n                |                 |                 |                 |                 |       it, and t\n                |                 |                 |                 |                 |     ld,\\nThan t\n                |                 |                 |                 |                 |      ompounds t\n                |                 |                 |                 |                 |       poison; t\n                |                 |                 |                 |                 |      with me\\nT\n                |                 |                 |                 |                 |      r order, t\n                |                 |                 |                 |                 |      ing him, t\n                |                 |                 |                 |                 |     se\\nWhere t\n                |                 |                 |                 |                 |     orth;\\nSo t\n                |                 |                 |                 |                 |       letter, t\n                |                 |                 |                 |                 |     herhood,\\nT\n                |                 |                 |                 |                 |      ort, and t\n                |                 |                 |                 |                 |      ar close t\n                |                 |                 |                 |                 |     ves,\\nBut t\n                |                 |                 |                 |                 |      tle then t\n                |                 |                 |                 |                 |     -\\nO woe! t\n                |                 |                 |                 |                 |     y moans:\\nT\n                |                 |                 |                 |                 |     nd weep.\\nT\n                |                 |                 |                 |                 |     o-night,\\nT\n                |                 |                 |                 |                 |      uies and t\n                |                 |                 |                 |                 |     n.\\nHold, t\n                |                 |                 |                 |                 |      s partly t\n                |                 |                 |                 |                 |       chiefly t\n                |                 |                 |                 |                 |      loyment: t\n                |                 |                 |                 |                 |     y limbs:\\nT\n                |                 |                 |                 |                 |      endship. T\n                |                 |                 |                 |                 |      ble maw, t\n                |                 |                 |                 |                 |     ontague,\\nT\n                |                 |                 |                 |                 |      upposed, t\n                |                 |                 |                 |                 |      eed; and t\n                |                 |                 |                 |                 |      e youth, t\n                |                 |                 |                 |                 |      eave me: t\n                |                 |                 |                 |                 |      rcy bade t\n                |                 |                 |                 |                 |     \\nO Lord, t\n                |                 |                 |                 |                 |     lain!\\nIf t\n                |                 |                 |                 |                 |     ty makes\\nT\n                |                 |                 |                 |                 |     !\\nDeath, t\n                |                 |                 |                 |                 |      beauty:\\nT\n                |                 |                 |                 |                 |     d there.\\nT\n                |                 |                 |                 |                 |      hat hand t\n                |                 |                 |                 |                 |     ous,\\nAnd t\n                |                 |                 |                 |                 |     t!\\nArms, t\n                |                 |                 |                 |                 |     y guide!\\nT\n                |                 |                 |                 |                 |     thecary!\\nT\n                |                 |                 |                 |                 |      e quick. T\n                |                 |                 |                 |                 |       graves! W\n                |                 |                 |                 |                 |     nd,\\nWhat t\n                |                 |                 |                 |                 |      is yond, t\n                |                 |                 |                 |                 |      sir; and t\n                |                 |                 |                 |                 |     E:\\nStay, t\n                |                 |                 |                 |                 |     ght,\\nAnd t\n                |                 |                 |                 |                 |     h stains\\nT\n                |                 |                 |                 |                 |     y swords\\nT\n                |                 |                 |                 |                 |      chance!\\nT\n                |                 |                 |                 |                 |      be,\\nAnd t\n                |                 |                 |                 |                 |     me away.\\nT\n                |                 |                 |                 |                 |     on them,\\nT\n                |                 |                 |                 |                 |     orative.\\nT\n                |                 |                 |                 |                 |      dagger!\\nT\n                |                 |                 |                 |                 |      sheath;\\nt\n                |                 |                 |                 |                 |   .\\n\\nPAGE:\\nT\n                |                 |                 |                 |                 |      e place; t\n                |                 |                 |                 |                 |     atchman:\\nT\n                |                 |                 |                 |                 |     lie;\\nBut t\n                |                 |                 |                 |                 |       safety, t\n                |                 |                 |                 |                 |      a friar, t\n                |                 |                 |                 |                 |     arly up,\\nT\n                |                 |                 |                 |                 |      d it be, t\n                |                 |                 |                 |                 |      bleeds!\\nT\n                |                 |                 |                 |                 |      a bell,\\nT\n                |                 |                 |                 |                 |      breath:\\nW\n                |                 |                 |                 |                 |      ook, and t\n                |                 |                 |                 |                 |     in this?\\nT\n                |                 |                 |                 |                 |     a while,\\nT\n                |                 |                 |                 |                 |       spring, t\n                |                 |                 |                 |                 |      ir head, t\n                |                 |                 |                 |                 |     ent;\\nAnd t\n                |                 |                 |                 |                 |      cted, as t\n                |                 |                 |                 |                 |      nd, both t\n                |                 |                 |                 |                 |    \\nPRINCE:\\nT\n                |                 |                 |                 |                 |      And she, t\n                |                 |                 |                 |                 |      re dead, t\n                |                 |                 |                 |                 |      y Paris: t\n                |                 |                 |                 |                 |     herself.\\nT\n                |                 |                 |                 |                 |       her, so t\n                |                 |                 |                 |                 |     o Romeo,\\nT\n                |                 |                 |                 |                 |     e night,\\nT\n                |                 |                 |                 |                 |     ar John,\\nW\n                |                 |                 |                 |                 |      er back. T\n                |                 |                 |                 |                 |     my cell,\\nT\n                |                 |                 |                 |                 |     mely lay\\nT\n                |                 |                 |                 |                 |      aris and t\n                |                 |                 |                 |                 |     nce:\\nBut t\n                |                 |                 |                 |                 |      now; and t\n                |                 |                 |                 |                 |     ath;\\nAnd t\n                |                 |                 |                 |                 |     m Mantua\\nT\n                |                 |                 |                 |                 |      e place, t\n                |                 |                 |                 |                 |     onument.\\nT\n                |                 |                 |                 |                 |     her,\\nAnd t\n                |                 |                 |                 |                 |      's page, t\n                |                 |                 |                 |                 |     him;\\nAnd t\n                |                 |                 |                 |                 |     s words,\\nT\n                |                 |                 |                 |                 |      ary, and t\n                |                 |                 |                 |                 |     ur hate,\\nT\n                |                 |                 |                 |                 |      ds means t\n                |                 |                 |                 |                 |     hy hand:\\nT\n                |                 |                 |                 |                 |     re gold;\\nT\n                |                 |                 |                 |                 |     s known,\\nT\n                |                 |                 |                 |                 |      brings;\\nT\n                |                 |                 |                 |                 |      o hence, t\n                |                 |                 |                 |                 |      hese sad t\n                |                 |                 |                 |                 |     woe\\nThan t\n                |                 |                 |                 |                 |     ht blow:\\nT\n                |                 |                 |                 |                 |      r me and t\n                |                 |                 |                 |                 |     RICHARD:\\nT\n                |                 |                 |                 |                 |      y heaven t\n                |                 |                 |                 |                 |     r close.\\nT\n                |                 |                 |                 |                 |     ing,\\nAnd t\n                |                 |                 |                 |                 |      sist me, t\n                |                 |                 |                 |                 |      ge by me t\n                |                 |                 |                 |                 |     WARWICK:\\nT\n                |                 |                 |                 |                 |      by-words t\n                |                 |                 |                 |                 |     im best,\\nT\n                |                 |                 |                 |                 |      Warwick, t\n                |                 |                 |                 |                 |     se peer,\\nT\n                |                 |                 |                 |                 |     her.\\nAnd t\n                |                 |                 |                 |                 |     LIFFORD:\\nT\n                |                 |                 |                 |                 |     hem,\\nAnd t\n                |                 |                 |                 |                 |      s slain, t\n                |                 |                 |                 |                 |      ry means t\n                |                 |                 |                 |                 |      to use.\\nT\n                |                 |                 |                 |                 |       he made t\n                |                 |                 |                 |                 |      ance, as t\n                |                 |                 |                 |                 |    \\nEXETER:\\nT\n                |                 |                 |                 |                 |      and, and t\n                |                 |                 |                 |                 |     ter;\\nAnd t\n                |                 |                 |                 |                 |      is soul, t\n                |                 |                 |                 |                 |      thou and t\n                |                 |                 |                 |                 |     hy sons,\\nT\n                |                 |                 |                 |                 |      sman and t\n                |                 |                 |                 |                 |     re lives\\nT\n                |                 |                 |                 |                 |      tle hast t\n                |                 |                 |                 |                 |      traitor, t\n                |                 |                 |                 |                 |     e crown?\\nT\n                |                 |                 |                 |                 |     of York;\\nT\n                |                 |                 |                 |                 |      phin and t\n                |                 |                 |                 |                 |      e French t\n                |                 |                 |                 |                 |     ENRY VI:\\nT\n                |                 |                 |                 |                 |     \\nFather, t\n                |                 |                 |                 |                 |      ets, and t\n                |                 |                 |                 |                 |     :\\nPeace, t\n                |                 |                 |                 |                 |     ,\\nFor he t\n                |                 |                 |                 |                 |     \\nAy, and t\n                |                 |                 |                 |                 |       he may, t\n                |                 |                 |                 |                 |      Fourth,\\nW\n                |                 |                 |                 |                 |     train'd,\\nT\n                |                 |                 |                 |                 |     rown\\nBut t\n                |                 |                 |                 |                 |      ght, and t\n                |                 |                 |                 |                 |      lay'st,\\nT\n                |                 |                 |                 |                 |      l to him t\n                |                 |                 |                 |                 |      o me and t\n                |                 |                 |                 |                 |     irs,\\nAnd t\n                |                 |                 |                 |                 |      red both t\n                |                 |                 |                 |                 |      ionally, t\n                |                 |                 |                 |                 |      hat here t\n                |                 |                 |                 |                 |      an oath\\nT\n                |                 |                 |                 |                 |      I live,\\nT\n                |                 |                 |                 |                 |     ostility\\nT\n                |                 |                 |                 |                 |       sorrow, t\n                |                 |                 |                 |                 |     y blood,\\nT\n                |                 |                 |                 |                 |      rt-blood t\n                |                 |                 |                 |                 |      han have t\n                |                 |                 |                 |                 |     eet son:\\nT\n                |                 |                 |                 |                 |      wick and t\n                |                 |                 |                 |                 |      wretch!\\nT\n                |                 |                 |                 |                 |      t undone t\n                |                 |                 |                 |                 |      head\\nAs t\n                |                 |                 |                 |                 |     ferance.\\nT\n                |                 |                 |                 |                 |       it, but t\n                |                 |                 |                 |                 |      llor and t\n                |                 |                 |                 |                 |     ow seas;\\nT\n                |                 |                 |                 |                 |     ty finds\\nT\n                |                 |                 |                 |                 |     y woman,\\nT\n                |                 |                 |                 |                 |     act.\\nBut t\n                |                 |                 |                 |                 |     herited.\\nT\n                |                 |                 |                 |                 |       if once t\n                |                 |                 |                 |                 |      hall be, t\n                |                 |                 |                 |                 |     of York.\\nT\n                |                 |                 |                 |                 |     RET:\\nAy, t\n                |                 |                 |                 |                 |      r grace: t\n                |                 |                 |                 |                 |      my son!\\nT\n                |                 |                 |                 |                 |      Brother, t\n                |                 |                 |                 |                 |      and us;\\nT\n                |                 |                 |                 |                 |      re heir, t\n                |                 |                 |                 |                 |      nd oaths t\n                |                 |                 |                 |                 |     istrate,\\nT\n                |                 |                 |                 |                 |     e place;\\nT\n                |                 |                 |                 |                 |     ivolous.\\nT\n                |                 |                 |                 |                 |      , do but t\n                |                 |                 |                 |                 |      ite rose t\n                |                 |                 |                 |                 |     erprise.\\nT\n                |                 |                 |                 |                 |     olk,\\nAnd t\n                |                 |                 |                 |                 |      ith whom t\n                |                 |                 |                 |                 |     ore,\\nBut t\n                |                 |                 |                 |                 |      end here t\n                |                 |                 |                 |                 |     men;\\nAnd t\n                |                 |                 |                 |                 |      ham, and t\n                |                 |                 |                 |                 |      rengthen t\n                |                 |                 |                 |                 |     ves,\\nAnd t\n                |                 |                 |                 |                 |     not:\\nAnd t\n                |                 |                 |                 |                 |     py hour;\\nT\n                |                 |                 |                 |                 |      ith five t\n                |                 |                 |                 |                 |      Five men t\n                |                 |                 |                 |                 |      ! though t\n                |                 |                 |                 |                 |     nds?\\nAh, t\n                |                 |                 |                 |                 |      od saves t\n                |                 |                 |                 |                 |     ld,\\nLest t\n                |                 |                 |                 |                 |     tch\\nThat t\n                |                 |                 |                 |                 |      e comes, t\n                |                 |                 |                 |                 |     RUTLAND:\\nT\n                |                 |                 |                 |                 |      en here, t\n                |                 |                 |                 |                 |     oul;\\nAnd t\n                |                 |                 |                 |                 |     y death!\\nT\n                |                 |                 |                 |                 |     as born.\\nT\n                |                 |                 |                 |                 |     offence,\\nT\n                |                 |                 |                 |                 |     o cause!\\nT\n                |                 |                 |                 |                 |     net!\\nAnd t\n                |                 |                 |                 |                 |       weapon, t\n                |                 |                 |                 |                 |   I\\n\\nYORK:\\nT\n                |                 |                 |                 |                 |     hem:\\nBut t\n                |                 |                 |                 |                 |       I know, t\n                |                 |                 |                 |                 |     r death.\\nT\n                |                 |                 |                 |                 |     h.\\nThree t\n                |                 |                 |                 |                 |      me.\\nAnd t\n                |                 |                 |                 |                 |     ulchre!'\\nW\n                |                 |                 |                 |                 |      h, hark! t\n                |                 |                 |                 |                 |     ir fury:\\nT\n                |                 |                 |                 |                 |     ORD:\\nAy, t\n                |                 |                 |                 |                 |      shes, as t\n                |                 |                 |                 |                 |      ght when t\n                |                 |                 |                 |                 |      ng, view t\n                |                 |                 |                 |                 |      ath made t\n                |                 |                 |                 |                 |      e blows, t\n                |                 |                 |                 |                 |      s, twice t\n                |                 |                 |                 |                 |      so much\\nT\n                |                 |                 |                 |                 |     ges;\\nAnd t\n                |                 |                 |                 |                 |       strives t\n                |                 |                 |                 |                 |     \\nSo doth t\n                |                 |                 |                 |                 |     ooty;\\nSo t\n                |                 |                 |                 |                 |     ll here,\\nT\n                |                 |                 |                 |                 |      rted but t\n                |                 |                 |                 |                 |       of sons t\n                |                 |                 |                 |                 |     you now?\\nT\n                |                 |                 |                 |                 |      our boy, t\n                |                 |                 |                 |                 |     he blood\\nT\n                |                 |                 |                 |                 |       grieve, t\n                |                 |                 |                 |                 |     entrails\\nT\n                |                 |                 |                 |                 |     ;\\nAnd I, t\n                |                 |                 |                 |                 |      nd fret, t\n                |                 |                 |                 |                 |     d dance.\\nT\n                |                 |                 |                 |                 |      , I see, t\n                |                 |                 |                 |                 |     ing!\\nAy, t\n                |                 |                 |                 |                 |      is is he t\n                |                 |                 |                 |                 |     air,\\nAnd t\n                |                 |                 |                 |                 |      breathe, t\n                |                 |                 |                 |                 |      ut worse t\n                |                 |                 |                 |                 |      ons than t\n                |                 |                 |                 |                 |      mazonian t\n                |                 |                 |                 |                 |     tes!\\nBut t\n                |                 |                 |                 |                 |      d queen, t\n                |                 |                 |                 |                 |     e blush.\\nT\n                |                 |                 |                 |                 |      e whence t\n                |                 |                 |                 |                 |      to shame t\n                |                 |                 |                 |                 |     ameless.\\nT\n                |                 |                 |                 |                 |      er bears t\n                |                 |                 |                 |                 |     \\nOf both t\n                |                 |                 |                 |                 |       monarch t\n                |                 |                 |                 |                 |      it boots t\n                |                 |                 |                 |                 |     erified,\\nT\n                |                 |                 |                 |                 |      ir horse t\n                |                 |                 |                 |                 |      e knows, t\n                |                 |                 |                 |                 |      hy share t\n                |                 |                 |                 |                 |     admired;\\nT\n                |                 |                 |                 |                 |      divine;\\nT\n                |                 |                 |                 |                 |     minable:\\nT\n                |                 |                 |                 |                 |      good\\nAs t\n                |                 |                 |                 |                 |      he south t\n                |                 |                 |                 |                 |     e child,\\nT\n                |                 |                 |                 |                 |     lexible;\\nT\n                |                 |                 |                 |                 |     hy wish:\\nW\n                |                 |                 |                 |                 |       allays, t\n                |                 |                 |                 |                 |      begins.\\nT\n                |                 |                 |                 |                 |     es me so\\nT\n                |                 |                 |                 |                 |     able,\\nO, t\n                |                 |                 |                 |                 |      es more, t\n                |                 |                 |                 |                 |      re, than t\n                |                 |                 |                 |                 |     s tears:\\nT\n                |                 |                 |                 |                 |      is cloth t\n                |                 |                 |                 |                 |      my soul, t\n                |                 |                 |                 |                 |      ill shed t\n                |                 |                 |                 |                 |     s deed!'\\nT\n                |                 |                 |                 |                 |     '\\nThere, t\n                |                 |                 |                 |                 |      lifford, t\n                |                 |                 |                 |                 |      hter-man t\n                |                 |                 |                 |                 |     berland?\\nT\n                |                 |                 |                 |                 |     all,\\nAnd t\n                |                 |                 |                 |                 |     hem cry,\\nT\n                |                 |                 |                 |                 |     tes,\\nAnd t\n                |                 |                 |                 |                 |     f youth,\\nT\n                |                 |                 |                 |                 |      ee, see! t\n                |                 |                 |                 |                 |      strange, t\n                |                 |                 |                 |                 |     e field,\\nT\n                |                 |                 |                 |                 |      That we, t\n                |                 |                 |                 |                 |      r lights t\n                |                 |                 |                 |                 |      earth as t\n                |                 |                 |                 |                 |      them, as t\n                |                 |                 |                 |                 |      strokes, t\n                |                 |                 |                 |                 |     he wept,\\nT\n                |                 |                 |                 |                 |      taunts,\\nT\n                |                 |                 |                 |                 |      of York\\nT\n                |                 |                 |                 |                 |      ame; and t\n                |                 |                 |                 |                 |      remain,\\nT\n                |                 |                 |                 |                 |     pon,\\nNow t\n                |                 |                 |                 |                 |     st slain\\nT\n                |                 |                 |                 |                 |     lry;\\nAnd t\n                |                 |                 |                 |                 |      For hand t\n                |                 |                 |                 |                 |      m hence, t\n                |                 |                 |                 |                 |      quench.\\nT\n                |                 |                 |                 |                 |     f grief:\\nT\n                |                 |                 |                 |                 |      dukedom, t\n                |                 |                 |                 |                 |     re told,\\nT\n                |                 |                 |                 |                 |      ish than t\n                |                 |                 |                 |                 |      nt lord, t\n                |                 |                 |                 |                 |      ich held t\n                |                 |                 |                 |                 |      And now, t\n                |                 |                 |                 |                 |     st gasp,\\nT\n                |                 |                 |                 |                 |     vertised\\nT\n                |                 |                 |                 |                 |     rliament\\nT\n                |                 |                 |                 |                 |     n.\\nShort t\n                |                 |                 |                 |                 |     e queen,\\nT\n                |                 |                 |                 |                 |     our,\\nWho t\n                |                 |                 |                 |                 |      dge: but t\n                |                 |                 |                 |                 |     h truth,\\nT\n                |                 |                 |                 |                 |       an idle t\n                |                 |                 |                 |                 |      in vain; t\n                |                 |                 |                 |                 |      day;\\nSo t\n                |                 |                 |                 |                 |      her head t\n                |                 |                 |                 |                 |     urgundy,\\nW\n                |                 |                 |                 |                 |       ay, and t\n                |                 |                 |                 |                 |     out;\\nAnd t\n                |                 |                 |                 |                 |     \\nAnd now t\n                |                 |                 |                 |                 |     re gone,\\nT\n                |                 |                 |                 |                 |     ncaster.\\nT\n                |                 |                 |                 |                 |     housand,\\nW\n                |                 |                 |                 |                 |     ine day,\\nT\n                |                 |                 |                 |                 |     of York:\\nT\n                |                 |                 |                 |                 |     ;\\nAnd he t\n                |                 |                 |                 |                 |      ut sound t\n                |                 |                 |                 |                 |     teel,\\nAs t\n                |                 |                 |                 |                 |    \\nEDWARD:\\nT\n                |                 |                 |                 |                 |     d by me,\\nT\n                |                 |                 |                 |                 |      is brave t\n                |                 |                 |                 |                 |     r wreck:\\nT\n                |                 |                 |                 |                 |      s liege, t\n                |                 |                 |                 |                 |     d aside.\\nT\n                |                 |                 |                 |                 |     er back.\\nT\n                |                 |                 |                 |                 |     y crown,\\nT\n                |                 |                 |                 |                 |     ng sire;\\nT\n                |                 |                 |                 |                 |     ung;\\nAnd t\n                |                 |                 |                 |                 |     ecedent!\\nW\n                |                 |                 |                 |                 |      child,\\n'W\n                |                 |                 |                 |                 |     ng heart\\nT\n                |                 |                 |                 |                 |     ver hear\\nT\n                |                 |                 |                 |                 |      k! would t\n                |                 |                 |                 |                 |     igh,\\nAnd t\n                |                 |                 |                 |                 |      ighthood t\n                |                 |                 |                 |                 |      owns, as t\n                |                 |                 |                 |                 |     e field:\\nT\n                |                 |                 |                 |                 |      une too; t\n                |                 |                 |                 |                 |      ion then t\n                |                 |                 |                 |                 |       hearten t\n                |                 |                 |                 |                 |     \\nOr bide t\n                |                 |                 |                 |                 |     ar,\\nYou, t\n                |                 |                 |                 |                 |      re king, t\n                |                 |                 |                 |                 |     liament,\\nT\n                |                 |                 |                 |                 |      ther but t\n                |                 |                 |                 |                 |       manhood t\n                |                 |                 |                 |                 |     ward,\\nAs t\n                |                 |                 |                 |                 |      o limits t\n                |                 |                 |                 |                 |      hat bred t\n                |                 |                 |                 |                 |      y words; t\n                |                 |                 |                 |                 |     resolved\\nt\n                |                 |                 |                 |                 |      to-day,\\nT\n                |                 |                 |                 |                 |     WICK:\\nIf t\n                |                 |                 |                 |                 |      ou deny, t\n                |                 |                 |                 |                 |     WARD:\\nIf t\n                |                 |                 |                 |                 |     s right,\\nT\n                |                 |                 |                 |                 |      ot thee, t\n                |                 |                 |                 |                 |      l I wot, t\n                |                 |                 |                 |                 |     RET:\\nBut t\n                |                 |                 |                 |                 |      g whence t\n                |                 |                 |                 |                 |     traught,\\nT\n                |                 |                 |                 |                 |      crowns,\\nT\n                |                 |                 |                 |                 |      oman, as t\n                |                 |                 |                 |                 |      nd tamed t\n                |                 |                 |                 |                 |      ven then t\n                |                 |                 |                 |                 |     for him,\\nT\n                |                 |                 |                 |                 |      mult but t\n                |                 |                 |                 |                 |      ine made t\n                |                 |                 |                 |                 |     oot;\\nAnd t\n                |                 |                 |                 |                 |      r bathed t\n                |                 |                 |                 |                 |     er stay:\\nT\n                |                 |                 |                 |                 |       flight, t\n                |                 |                 |                 |                 |     thyself?\\nT\n                |                 |                 |                 |                 |      's blood t\n                |                 |                 |                 |                 |     d still,\\nT\n                |                 |                 |                 |                 |     t stands\\nT\n                |                 |                 |                 |                 |     rey,\\nYet t\n                |                 |                 |                 |                 |     arms:\\nI, t\n                |                 |                 |                 |                 |     with woe\\nT\n                |                 |                 |                 |                 |       pillars t\n                |                 |                 |                 |                 |     n games:\\nT\n                |                 |                 |                 |                 |     ork,\\nAnd t\n                |                 |                 |                 |                 |     e alone:\\nT\n                |                 |                 |                 |                 |     ork;\\nAnd t\n                |                 |                 |                 |                 |      d cheers t\n                |                 |                 |                 |                 |      his wolf t\n                |                 |                 |                 |                 |      ils, and t\n                |                 |                 |                 |                 |       better, t\n                |                 |                 |                 |                 |     st;\\nBoth t\n                |                 |                 |                 |                 |     me down.\\nT\n                |                 |                 |                 |                 |      od will, t\n                |                 |                 |                 |                 |     ing both\\nT\n                |                 |                 |                 |                 |     py life,\\nT\n                |                 |                 |                 |                 |     y swain;\\nT\n                |                 |                 |                 |                 |     y point,\\nT\n                |                 |                 |                 |                 |      s known, t\n                |                 |                 |                 |                 |      wn, then t\n                |                 |                 |                 |                 |      o divide t\n                |                 |                 |                 |                 |     er shade\\nT\n                |                 |                 |                 |                 |     y sheep,\\nT\n                |                 |                 |                 |                 |     d canopy\\nT\n                |                 |                 |                 |                 |     oth.\\nAnd t\n                |                 |                 |                 |                 |      onclude, t\n                |                 |                 |                 |                 |      nobody.\\nT\n                |                 |                 |                 |                 |      hom hand t\n                |                 |                 |                 |                 |      life and t\n                |                 |                 |                 |                 |     and them\\nT\n                |                 |                 |                 |                 |    \\nFather:\\nT\n                |                 |                 |                 |                 |     in thee,\\nT\n                |                 |                 |                 |                 |      y words, t\n                |                 |                 |                 |                 |      ty, God, t\n                |                 |                 |                 |                 |     ble age!\\nW\n                |                 |                 |                 |                 |     !\\nO boy, t\n                |                 |                 |                 |                 |      ief more t\n                |                 |                 |                 |                 |     n, pity!\\nT\n                |                 |                 |                 |                 |     is face,\\nT\n                |                 |                 |                 |                 |      houses:\\nT\n                |                 |                 |                 |                 |     sembles;\\nT\n                |                 |                 |                 |                 |     's death\\nT\n                |                 |                 |                 |                 |      cks; and t\n                |                 |                 |                 |                 |     \\nWhither t\n                |                 |                 |                 |                 |       I fall, t\n                |                 |                 |                 |                 |     ud York,\\nT\n                |                 |                 |                 |                 |      nats but t\n                |                 |                 |                 |                 |     o,\\nOr as t\n                |                 |                 |                 |                 |     of York,\\nT\n                |                 |                 |                 |                 |      bold but t\n                |                 |                 |                 |                 |      flight:\\nT\n                |                 |                 |                 |                 |     no pity.\\nT\n                |                 |                 |                 |                 |     d queen,\\nT\n                |                 |                 |                 |                 |      m Henry, t\n                |                 |                 |                 |                 |      n argosy t\n                |                 |                 |                 |                 |     ves.\\nBut t\n                |                 |                 |                 |                 |     pe,\\nFor, t\n                |                 |                 |                 |                 |      and, now t\n                |                 |                 |                 |                 |      s supply t\n                |                 |                 |                 |                 |      eech-owl t\n                |                 |                 |                 |                 |     r house,\\nT\n                |                 |                 |                 |                 |      ut death t\n                |                 |                 |                 |                 |      s policy t\n                |                 |                 |                 |                 |      argaret, t\n                |                 |                 |                 |                 |      ay, then t\n                |                 |                 |                 |                 |     soul,\\nIf t\n                |                 |                 |                 |                 |     's life,\\nT\n                |                 |                 |                 |                 |      at him,\\nT\n                |                 |                 |                 |                 |     t march,\\nT\n                |                 |                 |                 |                 |     h,\\nThere t\n                |                 |                 |                 |                 |      new both t\n                |                 |                 |                 |                 |      se lands t\n                |                 |                 |                 |                 |      g France t\n                |                 |                 |                 |                 |       friend, t\n                |                 |                 |                 |                 |     ot dread\\nT\n                |                 |                 |                 |                 |      r though t\n                |                 |                 |                 |                 |     ion;\\nAnd t\n                |                 |                 |                 |                 |     the sea,\\nT\n                |                 |                 |                 |                 |     CK:\\nTut, t\n                |                 |                 |                 |                 |      London,\\nT\n                |                 |                 |                 |                 |      und anon t\n                |                 |                 |                 |                 |      Keeper:\\nT\n                |                 |                 |                 |                 |      nnot be; t\n                |                 |                 |                 |                 |      ll scare t\n                |                 |                 |                 |                 |     re love,\\nT\n                |                 |                 |                 |                 |     f thine;\\nT\n                |                 |                 |                 |                 |       fill'd, t\n                |                 |                 |                 |                 |     om thee,\\nT\n                |                 |                 |                 |                 |     r's fee:\\nT\n                |                 |                 |                 |                 |      er gone, t\n                |                 |                 |                 |                 |     e heart;\\nT\n                |                 |                 |                 |                 |     remorse,\\nT\n                |                 |                 |                 |                 |     stall'd;\\nT\n                |                 |                 |                 |                 |       smooths t\n                |                 |                 |                 |                 |     at else,\\nT\n                |                 |                 |                 |                 |       be; and t\n                |                 |                 |                 |                 |      aken, as t\n                |                 |                 |                 |                 |      and less t\n                |                 |                 |                 |                 |     \\nAy, but t\n                |                 |                 |                 |                 |      ind; and t\n                |                 |                 |                 |                 |     ontented\\nT\n                |                 |                 |                 |                 |      me:\\nAnd t\n                |                 |                 |                 |                 |     ,\\nAnd as t\n                |                 |                 |                 |                 |      ou will, t\n                |                 |                 |                 |                 |      king's,\\nT\n                |                 |                 |                 |                 |     's field\\nT\n                |                 |                 |                 |                 |      is lands t\n                |                 |                 |                 |                 |     e lands;\\nW\n                |                 |                 |                 |                 |     DY GREY:\\nT\n                |                 |                 |                 |                 |      uld lose t\n                |                 |                 |                 |                 |      IV:\\nNow t\n                |                 |                 |                 |                 |       do much t\n                |                 |                 |                 |                 |      s lands, t\n                |                 |                 |                 |                 |       bind me t\n                |                 |                 |                 |                 |      command, t\n                |                 |                 |                 |                 |      at love, t\n                |                 |                 |                 |                 |     \\nMy love t\n                |                 |                 |                 |                 |     prayers;\\nT\n                |                 |                 |                 |                 |     \\nTherein t\n                |                 |                 |                 |                 |      ngs both t\n                |                 |                 |                 |                 |      ter said t\n                |                 |                 |                 |                 |     nds;\\nAnd t\n                |                 |                 |                 |                 |      that is, t\n                |                 |                 |                 |                 |     REY:\\nAnd t\n                |                 |                 |                 |                 |      mother.\\nT\n                |                 |                 |                 |                 |      dow, and t\n                |                 |                 |                 |                 |     py thing\\nT\n                |                 |                 |                 |                 |      larence, t\n                |                 |                 |                 |                 |      rothers, t\n                |                 |                 |                 |                 |     ook him,\\nT\n                |                 |                 |                 |                 |     and all,\\nT\n                |                 |                 |                 |                 |      spring,\\nT\n                |                 |                 |                 |                 |     and me--\\nT\n                |                 |                 |                 |                 |      bodies,\\nT\n                |                 |                 |                 |                 |      d chides t\n                |                 |                 |                 |                 |      ell, say t\n                |                 |                 |                 |                 |     unlikely\\nT\n                |                 |                 |                 |                 |     ely\\nThan t\n                |                 |                 |                 |                 |     e bribe,\\nT\n                |                 |                 |                 |                 |     d shrub;\\nT\n                |                 |                 |                 |                 |     my body;\\nT\n                |                 |                 |                 |                 |     al size;\\nT\n                |                 |                 |                 |                 |     thought!\\nT\n                |                 |                 |                 |                 |      me,\\nBut t\n                |                 |                 |                 |                 |       cheque, t\n                |                 |                 |                 |                 |       I live, t\n                |                 |                 |                 |                 |     ny wood,\\nT\n                |                 |                 |                 |                 |     air,\\nBut t\n                |                 |                 |                 |                 |     t out,--\\nT\n                |                 |                 |                 |                 |       sailors t\n                |                 |                 |                 |                 |      ers than t\n                |                 |                 |                 |                 |      re slily t\n                |                 |                 |                 |                 |     a crown?\\nT\n                |                 |                 |                 |                 |      d birth, t\n                |                 |                 |                 |                 |      th, that t\n                |                 |                 |                 |                 |      n awhile t\n                |                 |                 |                 |                 |      ground;\\nW\n                |                 |                 |                 |                 |     une,\\nAnd t\n                |                 |                 |                 |                 |      ret, and t\n                |                 |                 |                 |                 |     ak.\\nNow, t\n                |                 |                 |                 |                 |     e Lewis,\\nT\n                |                 |                 |                 |                 |      itle and t\n                |                 |                 |                 |                 |     ul king.\\nT\n                |                 |                 |                 |                 |     \\nAnd, as t\n                |                 |                 |                 |                 |      we stay, t\n                |                 |                 |                 |                 |     EWIS XI:\\nT\n                |                 |                 |                 |                 |       I stay, t\n                |                 |                 |                 |                 |      h boldly t\n                |                 |                 |                 |                 |      wind and t\n                |                 |                 |                 |                 |      ign, and t\n                |                 |                 |                 |                 |     ,\\nFirst, t\n                |                 |                 |                 |                 |      reetings t\n                |                 |                 |                 |                 |     son;\\nAnd t\n                |                 |                 |                 |                 |       lastly, t\n                |                 |                 |                 |                 |      dy Bona, t\n                |                 |                 |                 |                 |      sister,\\nT\n                |                 |                 |                 |                 |     lliance?\\nT\n                |                 |                 |                 |                 |     suffice,\\nT\n                |                 |                 |                 |                 |     n.\\nLook, t\n                |                 |                 |                 |                 |      , Lewis, t\n                |                 |                 |                 |                 |     urp;\\nAnd t\n                |                 |                 |                 |                 |    \\nOXFORD:\\nT\n                |                 |                 |                 |                 |     f Gaunt,\\nW\n                |                 |                 |                 |                 |      d subdue t\n                |                 |                 |                 |                 |      d, after t\n                |                 |                 |                 |                 |     lly time\\nT\n                |                 |                 |                 |                 |     ge,\\nWhom t\n                |                 |                 |                 |                 |       Oxford, t\n                |                 |                 |                 |                 |      and more t\n                |                 |                 |                 |                 |       upholds t\n                |                 |                 |                 |                 |     his arm,\\nT\n                |                 |                 |                 |                 |      The more t\n                |                 |                 |                 |                 |     t aside,\\nT\n                |                 |                 |                 |                 |      ground,\\nT\n                |                 |                 |                 |                 |      ear hath t\n                |                 |                 |                 |                 |      judgment t\n                |                 |                 |                 |                 |      jointure t\n                |                 |                 |                 |                 |      witness\\nT\n                |                 |                 |                 |                 |      alliance t\n                |                 |                 |                 |                 |     success,\\nT\n                |                 |                 |                 |                 |      my hand\\nT\n                |                 |                 |                 |                 |      t hence, t\n                |                 |                 |                 |                 |      talk and t\n                |                 |                 |                 |                 |     s behold\\nT\n                |                 |                 |                 |                 |     y bliss,\\nT\n                |                 |                 |                 |                 |      use done t\n                |                 |                 |                 |                 |     our:\\nAnd t\n                |                 |                 |                 |                 |      joy that t\n                |                 |                 |                 |                 |      friend,\\nT\n                |                 |                 |                 |                 |      rrel and t\n                |                 |                 |                 |                 |     garet's.\\nT\n                |                 |                 |                 |                 |     ost,\\nAnd t\n                |                 |                 |                 |                 |     ed king,\\nT\n                |                 |                 |                 |                 |     masquers\\nT\n                |                 |                 |                 |                 |     w bride:\\nT\n                |                 |                 |                 |                 |   .\\n\\nBONA:\\nT\n                |                 |                 |                 |                 |     ong,\\nAnd t\n                |                 |                 |                 |                 |     be long.\\nT\n                |                 |                 |                 |                 |     Warwick,\\nT\n                |                 |                 |                 |                 |       serves, t\n                |                 |                 |                 |                 |     loyalty,\\nT\n                |                 |                 |                 |                 |      ueen and t\n                |                 |                 |                 |                 |     d my joy\\nT\n                |                 |                 |                 |                 |      ree, and t\n                |                 |                 |                 |                 |     irtuous,\\nT\n                |                 |                 |                 |                 |      hy hand, t\n                |                 |                 |                 |                 |     vocable,\\nT\n                |                 |                 |                 |                 |       we now? T\n                |                 |                 |                 |                 |      one else t\n                |                 |                 |                 |                 |      but me?\\nT\n                |                 |                 |                 |                 |      he chief t\n                |                 |                 |                 |                 |      om hence t\n                |                 |                 |                 |                 |      choice,\\nT\n                |                 |                 |                 |                 |     judgment\\nT\n                |                 |                 |                 |                 |     ent\\nThat t\n                |                 |                 |                 |                 |     a cause,\\nT\n                |                 |                 |                 |                 |     ere pity\\nT\n                |                 |                 |                 |                 |     e aside,\\nT\n                |                 |                 |                 |                 |     CE:\\nThen t\n                |                 |                 |                 |                 |      opinion: t\n                |                 |                 |                 |                 |     UE:\\nYet, t\n                |                 |                 |                 |                 |      ngthen'd t\n                |                 |                 |                 |                 |      n storms t\n                |                 |                 |                 |                 |      Montague t\n                |                 |                 |                 |                 |     GUE:\\nBut t\n                |                 |                 |                 |                 |      nce than t\n                |                 |                 |                 |                 |     deserves\\nT\n                |                 |                 |                 |                 |     \\nTo have t\n                |                 |                 |                 |                 |     ne well,\\nT\n                |                 |                 |                 |                 |      brothers t\n                |                 |                 |                 |                 |     ife\\nThat t\n                |                 |                 |                 |                 |     alf;\\nAnd t\n                |                 |                 |                 |                 |      tly mind t\n                |                 |                 |                 |                 |      d meaner t\n                |                 |                 |                 |                 |      dislike, t\n                |                 |                 |                 |                 |     end,\\nAnd t\n                |                 |                 |                 |                 |      gn, whom t\n                |                 |                 |                 |                 |      ay, whom t\n                |                 |                 |                 |                 |     afe,\\nAnd t\n                |                 |                 |                 |                 |      on thee: t\n                |                 |                 |                 |                 |     n brief,\\nT\n                |                 |                 |                 |                 |       depart, t\n                |                 |                 |                 |                 |   ?\\n\\nPost:\\nT\n                |                 |                 |                 |                 |     \\nShe had t\n                |                 |                 |                 |                 |      he minds t\n                |                 |                 |                 |                 |     ewarn'd:\\nT\n                |                 |                 |                 |                 |      vereign; t\n                |                 |                 |                 |                 |     aughter;\\nT\n                |                 |                 |                 |                 |     r;\\nThat, t\n                |                 |                 |                 |                 |     for war;\\nT\n                |                 |                 |                 |                 |     lliance:\\nT\n                |                 |                 |                 |                 |      t be so, t\n                |                 |                 |                 |                 |     dly vow,\\nT\n                |                 |                 |                 |                 |     ory.\\nNow t\n                |                 |                 |                 |                 |     no hour,\\nT\n                |                 |                 |                 |                 |     es well;\\nT\n                |                 |                 |                 |                 |     owardice\\nT\n                |                 |                 |                 |                 |     verture,\\nT\n                |                 |                 |                 |                 |      rise and t\n                |                 |                 |                 |                 |      ve found t\n                |                 |                 |                 |                 |     ry easy:\\nT\n                |                 |                 |                 |                 |      od stole t\n                |                 |                 |                 |                 |      each man t\n                |                 |                 |                 |                 |     s stand:\\nT\n                |                 |                 |                 |                 |     atchman:\\nW\n                |                 |                 |                 |                 |       lie and t\n                |                 |                 |                 |                 |      is that\\nT\n                |                 |                 |                 |                 |     the king\\nT\n                |                 |                 |                 |                 |     ent,\\nBut t\n                |                 |                 |                 |                 |      parted,\\nT\n                |                 |                 |                 |                 |     bassade,\\nT\n                |                 |                 |                 |                 |     kingdom,\\nT\n                |                 |                 |                 |                 |     oo?\\nNay, t\n                |                 |                 |                 |                 |     \\nOf thee t\n                |                 |                 |                 |                 |     as king:\\nT\n                |                 |                 |                 |                 |      thou but t\n                |                 |                 |                 |                 |      you, and t\n                |                 |                 |                 |                 |      ewis and t\n                |                 |                 |                 |                 |       impose, t\n                |                 |                 |                 |                 |     ICK:\\nAy, t\n                |                 |                 |                 |                 |     e to do;\\nT\n                |                 |                 |                 |                 |     \\nNo, but t\n                |                 |                 |                 |                 |      ay lose, t\n                |                 |                 |                 |                 |     my womb:\\nT\n                |                 |                 |                 |                 |      s fruit, t\n                |                 |                 |                 |                 |     wn,\\nBut, t\n                |                 |                 |                 |                 |     nctuary,\\nT\n                |                 |                 |                 |                 |     s right:\\nT\n                |                 |                 |                 |                 |      are sure t\n                |                 |                 |                 |                 |     he park.\\nT\n                |                 |                 |                 |                 |     et means\\nT\n                |                 |                 |                 |                 |      and men\\nT\n                |                 |                 |                 |                 |     untsman:\\nT\n                |                 |                 |                 |                 |     IV:\\nNay, t\n                |                 |                 |                 |                 |      ngs, and t\n                |                 |                 |                 |                 |      s close, t\n                |                 |                 |                 |                 |       so than t\n                |                 |                 |                 |                 |      : shield t\n                |                 |                 |                 |                 |      ant, now t\n                |                 |                 |                 |                 |     eat,\\nAnd t\n                |                 |                 |                 |                 |      harmony\\nT\n                |                 |                 |                 |                 |      ter God, t\n                |                 |                 |                 |                 |       author, t\n                |                 |                 |                 |                 |     trument.\\nT\n                |                 |                 |                 |                 |     hee,\\nFor t\n                |                 |                 |                 |                 |     he sway,\\nT\n                |                 |                 |                 |                 |     \\nTo whom t\n                |                 |                 |                 |                 |     war;\\nAnd t\n                |                 |                 |                 |                 |     er days,\\nT\n                |                 |                 |                 |                 |     e shadow\\nT\n                |                 |                 |                 |                 |      nce, now t\n                |                 |                 |                 |                 |      lse? and t\n                |                 |                 |                 |                 |     no more,\\nT\n                |                 |                 |                 |                 |      ent for, t\n                |                 |                 |                 |                 |     ed;\\nFor, t\n                |                 |                 |                 |                 |      gest but t\n                |                 |                 |                 |                 |     houghts,\\nT\n                |                 |                 |                 |                 |      His hand t\n                |                 |                 |                 |                 |      s since, t\n                |                 |                 |                 |                 |     ster\\nAnd t\n                |                 |                 |                 |                 |      vereign, t\n                |                 |                 |                 |                 |      any sore t\n                |                 |                 |                 |                 |      all him, t\n                |                 |                 |                 |                 |     nd ours:\\nT\n                |                 |                 |                 |                 |      im hence t\n                |                 |                 |                 |                 |     rittany,\\nT\n                |                 |                 |                 |                 |     est,\\nYet t\n                |                 |                 |                 |                 |     ork,\\nBut t\n                |                 |                 |                 |                 |      foretold t\n                |                 |                 |                 |                 |      o summon t\n                |                 |                 |                 |                 |      And shut t\n                |                 |                 |                 |                 |   \\n\\nMayor:\\nT\n                |                 |                 |                 |                 |      uld fain t\n                |                 |                 |                 |                 |      r mayor: t\n                |                 |                 |                 |                 |      fe means t\n                |                 |                 |                 |                 |      tronger, t\n                |                 |                 |                 |                 |     r claim:\\nT\n                |                 |                 |                 |                 |     of hand:\\nT\n                |                 |                 |                 |                 |     S:\\nSound t\n                |                 |                 |                 |                 |      ery; and t\n                |                 |                 |                 |                 |      eet both t\n                |                 |                 |                 |                 |     ay,\\nAnd, t\n                |                 |                 |                 |                 |      ch amain t\n                |                 |                 |                 |                 |       quickly t\n                |                 |                 |                 |                 |      in war;\\nT\n                |                 |                 |                 |                 |       up: and t\n                |                 |                 |                 |                 |     in Kent,\\nT\n                |                 |                 |                 |                 |     th thee:\\nT\n                |                 |                 |                 |                 |     'st:\\nAnd t\n                |                 |                 |                 |                 |      n London t\n                |                 |                 |                 |                 |      r lords, t\n                |                 |                 |                 |                 |     ORD:\\nAnd t\n                |                 |                 |                 |                 |      ine ears t\n                |                 |                 |                 |                 |      revenge, t\n                |                 |                 |                 |                 |     h err'd:\\nT\n                |                 |                 |                 |                 |      ard more t\n                |                 |                 |                 |                 |     he lamb,\\nT\n                |                 |                 |                 |                 |      er cease t\n                |                 |                 |                 |                 |      ow stops t\n                |                 |                 |                 |                 |     remains:\\nT\n                |                 |                 |                 |                 |     oin,\\nAnd t\n                |                 |                 |                 |                 |     am lies:\\nT\n                |                 |                 |                 |                 |      o should t\n                |                 |                 |                 |                 |     OMERSET:\\nT\n                |                 |                 |                 |                 |      trumpet, t\n                |                 |                 |                 |                 |      ick mans t\n                |                 |                 |                 |                 |     seduced,\\nT\n                |                 |                 |                 |                 |     ent?\\nAnd t\n                |                 |                 |                 |                 |     ght:\\nAnd w\n                |                 |                 |                 |                 |      ody when t\n                |                 |                 |                 |                 |     R:\\nAlas, t\n                |                 |                 |                 |                 |     gle ten,\\nT\n                |                 |                 |                 |                 |     ce,\\nAnd, t\n                |                 |                 |                 |                 |     hy face,\\nT\n                |                 |                 |                 |                 |       a sail, t\n                |                 |                 |                 |                 |      and tide t\n                |                 |                 |                 |                 |      match'd, t\n                |                 |                 |                 |                 |      is blood t\n                |                 |                 |                 |                 |       to lime t\n                |                 |                 |                 |                 |     ly oath:\\nT\n                |                 |                 |                 |                 |     ass made\\nT\n                |                 |                 |                 |                 |     de\\nThat, t\n                |                 |                 |                 |                 |      m myself t\n                |                 |                 |                 |                 |     abroad--\\nT\n                |                 |                 |                 |                 |     hee,\\nAnd t\n                |                 |                 |                 |                 |      ore, and t\n                |                 |                 |                 |                 |     beloved,\\nT\n                |                 |                 |                 |                 |      larence; t\n                |                 |                 |                 |                 |     .\\nLords, t\n                |                 |                 |                 |                 |     foe,\\nAnd t\n                |                 |                 |                 |                 |     t shows.\\nT\n                |                 |                 |                 |                 |      my fall, t\n                |                 |                 |                 |                 |      my foe.\\nT\n                |                 |                 |                 |                 |      s yields t\n                |                 |                 |                 |                 |      se shade t\n                |                 |                 |                 |                 |     ul wind.\\nT\n                |                 |                 |                 |                 |      se eyes, t\n                |                 |                 |                 |                 |     day sun,\\nT\n                |                 |                 |                 |                 |      o search t\n                |                 |                 |                 |                 |     e world:\\nT\n                |                 |                 |                 |                 |      y manors t\n                |                 |                 |                 |                 |     s again;\\nT\n                |                 |                 |                 |                 |     ague,\\nIf t\n                |                 |                 |                 |                 |      awhile!\\nT\n                |                 |                 |                 |                 |     u didst,\\nT\n                |                 |                 |                 |                 |     ed blood\\nT\n                |                 |                 |                 |                 |     ast;\\nAnd t\n                |                 |                 |                 |                 |     a vault,\\nT\n                |                 |                 |                 |                 |      y, away, t\n                |                 |                 |                 |                 |      picious, t\n                |                 |                 |                 |                 |     g cloud,\\nT\n                |                 |                 |                 |                 |      y lords, t\n                |                 |                 |                 |                 |     it came:\\nT\n                |                 |                 |                 |                 |      s valued t\n                |                 |                 |                 |                 |      t though t\n                |                 |                 |                 |                 |     erboard,\\nT\n                |                 |                 |                 |                 |      e broke, t\n                |                 |                 |                 |                 |      is moan, t\n                |                 |                 |                 |                 |     ly mast?\\nT\n                |                 |                 |                 |                 |      ouds and t\n                |                 |                 |                 |                 |     gs?\\nAnd, t\n                |                 |                 |                 |                 |       course, t\n                |                 |                 |                 |                 |     a while!\\nT\n                |                 |                 |                 |                 |      Bestride t\n                |                 |                 |                 |                 |      he rock; t\n                |                 |                 |                 |                 |       famish; t\n                |                 |                 |                 |                 |     d death.\\nT\n                |                 |                 |                 |                 |     from us,\\nT\n                |                 |                 |                 |                 |       prince! t\n                |                 |                 |                 |                 |     ARD:\\nAnd t\n                |                 |                 |                 |                 |      o fight; t\n                |                 |                 |                 |                 |     s policy\\nT\n                |                 |                 |                 |                 |      To haste t\n                |                 |                 |                 |                 |      us fast, t\n                |                 |                 |                 |                 |     ne eyes.\\nT\n                |                 |                 |                 |                 |      the wolf t\n                |                 |                 |                 |                 |      justice: t\n                |                 |                 |                 |                 |     s world,\\nT\n                |                 |                 |                 |                 |      on made, t\n                |                 |                 |                 |                 |     el thou,\\nW\n                |                 |                 |                 |                 |     RET:\\nAh, t\n                |                 |                 |                 |                 |      e stol'n t\n                |                 |                 |                 |                 |      's sake, t\n                |                 |                 |                 |                 |     RD:\\nNay, t\n                |                 |                 |                 |                 |      r'd lad, t\n                |                 |                 |                 |                 |     rge,\\nAnd t\n                |                 |                 |                 |                 |     are:\\nAnd t\n                |                 |                 |                 |                 |      ke that, t\n                |                 |                 |                 |                 |     NCE:\\nAnd t\n                |                 |                 |                 |                 |      he live, t\n                |                 |                 |                 |                 |      e Tower, t\n                |                 |                 |                 |                 |     rderers!\\nT\n                |                 |                 |                 |                 |     lame,\\nIf t\n                |                 |                 |                 |                 |      s a man; t\n                |                 |                 |                 |                 |      's worse t\n                |                 |                 |                 |                 |      urderer, t\n                |                 |                 |                 |                 |      l speak, t\n                |                 |                 |                 |                 |     you had,\\nT\n                |                 |                 |                 |                 |      r chance t\n                |                 |                 |                 |                 |     y death:\\nW\n                |                 |                 |                 |                 |     rt thou?\\nT\n                |                 |                 |                 |                 |      or blood t\n                |                 |                 |                 |                 |      ours, as t\n                |                 |                 |                 |                 |     I guess,\\nT\n                |                 |                 |                 |                 |      sterous; t\n                |                 |                 |                 |                 |      So flies t\n                |                 |                 |                 |                 |     ty mind;\\nT\n                |                 |                 |                 |                 |      ess male t\n                |                 |                 |                 |                 |     f Crete,\\nT\n                |                 |                 |                 |                 |     te,\\nThat t\n                |                 |                 |                 |                 |      s wings, t\n                |                 |                 |                 |                 |      Icarus;\\nT\n                |                 |                 |                 |                 |      , Minos, t\n                |                 |                 |                 |                 |      course;\\nT\n                |                 |                 |                 |                 |     weet boy\\nT\n                |                 |                 |                 |                 |       thyself t\n                |                 |                 |                 |                 |       my ears t\n                |                 |                 |                 |                 |     ng,\\nWhy, t\n                |                 |                 |                 |                 |     presume,\\nT\n                |                 |                 |                 |                 |     ine.\\nAnd t\n                |                 |                 |                 |                 |      rophesy, t\n                |                 |                 |                 |                 |     st born.\\nT\n                |                 |                 |                 |                 |     il sign;\\nT\n                |                 |                 |                 |                 |     n trees;\\nT\n                |                 |                 |                 |                 |     ds sung.\\nT\n                |                 |                 |                 |                 |     's hope,\\nT\n                |                 |                 |                 |                 |     ly tree.\\nT\n                |                 |                 |                 |                 |      ead when t\n                |                 |                 |                 |                 |     st born,\\nT\n                |                 |                 |                 |                 |     e heard,\\nT\n                |                 |                 |                 |                 |       reason, t\n                |                 |                 |                 |                 |      hink ye, t\n                |                 |                 |                 |                 |     r right?\\nT\n                |                 |                 |                 |                 |      er'd and t\n                |                 |                 |                 |                 |     ignified\\nT\n                |                 |                 |                 |                 |     the dog.\\nT\n                |                 |                 |                 |                 |       my mind t\n                |                 |                 |                 |                 |     her;\\nAnd t\n                |                 |                 |                 |                 |       beware; t\n                |                 |                 |                 |                 |     ophecies\\nT\n                |                 |                 |                 |                 |     ife,\\nAnd t\n                |                 |                 |                 |                 |      enry and t\n                |                 |                 |                 |                 |      ext, and t\n                |                 |                 |                 |                 |       but bad t\n                |                 |                 |                 |                 |     room\\nAnd t\n                |                 |                 |                 |                 |     r pride!\\nT\n                |                 |                 |                 |                 |      omerset, t\n                |                 |                 |                 |                 |     ampions;\\nT\n                |                 |                 |                 |                 |     son,\\nAnd t\n                |                 |                 |                 |                 |      erlands; t\n                |                 |                 |                 |                 |      th them, t\n                |                 |                 |                 |                 |      roar'd.\\nT\n                |                 |                 |                 |                 |      or thee, t\n                |                 |                 |                 |                 |     ng heat,\\nT\n                |                 |                 |                 |                 |     at,\\nThat t\n                |                 |                 |                 |                 |     ER:\\nAnd, t\n                |                 |                 |                 |                 |      ests but t\n                |                 |                 |                 |                 |      Camillo, t\n                |                 |                 |                 |                 |       summer, t\n                |                 |                 |                 |                 |      drinks,\\nt\n                |                 |                 |                 |                 |     ce,\\nmay, t\n                |                 |                 |                 |                 |     Bohemia.\\nT\n                |                 |                 |                 |                 |     ods; and\\nt\n                |                 |                 |                 |                 |      society, t\n                |                 |                 |                 |                 |     ounters,\\nt\n                |                 |                 |                 |                 |      bassies; t\n                |                 |                 |                 |                 |     ogether,\\nt\n                |                 |                 |                 |                 |     d\\nwinds. T\n                |                 |                 |                 |                 |       physics t\n                |                 |                 |                 |                 |      s fresh: t\n                |                 |                 |                 |                 |     S:\\nWould t\n                |                 |                 |                 |                 |       no son, t\n                |                 |                 |                 |                 |      burthen: t\n                |                 |                 |                 |                 |      ebt: and t\n                |                 |                 |                 |                 |      absence; t\n                |                 |                 |                 |                 |      at home, t\n                |                 |                 |                 |                 |      ut forth t\n                |                 |                 |                 |                 |     e stay'd\\nT\n                |                 |                 |                 |                 |     brother,\\nT\n                |                 |                 |                 |                 |      y sooth, t\n                |                 |                 |                 |                 |     you, so.\\nT\n                |                 |                 |                 |                 |      o tongue t\n                |                 |                 |                 |                 |      d: which t\n                |                 |                 |                 |                 |      arge and t\n                |                 |                 |                 |                 |      trouble: t\n                |                 |                 |                 |                 |     LEONTES:\\nT\n                |                 |                 |                 |                 |      ht, sir, t\n                |                 |                 |                 |                 |       coldly. T\n                |                 |                 |                 |                 |      's well; t\n                |                 |                 |                 |                 |     ERMIONE:\\nT\n                |                 |                 |                 |                 |     dventure\\nT\n                |                 |                 |                 |                 |     ; but I,\\nT\n                |                 |                 |                 |                 |      unsphere t\n                |                 |                 |                 |                 |      r guest, t\n                |                 |                 |                 |                 |     , madam:\\nT\n                |                 |                 |                 |                 |       gaoler, t\n                |                 |                 |                 |                 |     r queen,\\nT\n                |                 |                 |                 |                 |      Two lads t\n                |                 |                 |                 |                 |     day,\\nAnd t\n                |                 |                 |                 |                 |      my lord\\nT\n                |                 |                 |                 |                 |      'd lambs t\n                |                 |                 |                 |                 |      dream'd\\nT\n                |                 |                 |                 |                 |      guilty;' t\n                |                 |                 |                 |                 |     ed lady!\\nT\n                |                 |                 |                 |                 |      ve since t\n                |                 |                 |                 |                 |     t go on;\\nT\n                |                 |                 |                 |                 |      h us and t\n                |                 |                 |                 |                 |      ault and t\n                |                 |                 |                 |                 |      dearest, t\n                |                 |                 |                 |                 |      spokest\\nT\n                |                 |                 |                 |                 |      d sour'd t\n                |                 |                 |                 |                 |      my love: t\n                |                 |                 |                 |                 |     e twice:\\nT\n                |                 |                 |                 |                 |     husband;\\nT\n                |                 |                 |                 |                 |     hy nose?\\nT\n                |                 |                 |                 |                 |      e steer, t\n                |                 |                 |                 |                 |      ifer and t\n                |                 |                 |                 |                 |      e shoots t\n                |                 |                 |                 |                 |       me: yet t\n                |                 |                 |                 |                 |      say so,\\nT\n                |                 |                 |                 |                 |      on stabs t\n                |                 |                 |                 |                 |      centre:\\nT\n                |                 |                 |                 |                 |      nothing: t\n                |                 |                 |                 |                 |      credent\\nT\n                |                 |                 |                 |                 |      ing; and t\n                |                 |                 |                 |                 |      it,\\nAnd t\n                |                 |                 |                 |                 |     my lord!\\nW\n                |                 |                 |                 |                 |     d recoil\\nT\n                |                 |                 |                 |                 |       oft do, t\n                |                 |                 |                 |                 |      kernel,\\nT\n                |                 |                 |                 |                 |       squash, t\n                |                 |                 |                 |                 |     one,\\nHow t\n                |                 |                 |                 |                 |       beneath t\n                |                 |                 |                 |                 |     ing now,\\nT\n                |                 |                 |                 |                 |      the neb, t\n                |                 |                 |                 |                 |      y, play: t\n                |                 |                 |                 |                 |     y, play.\\nT\n                |                 |                 |                 |                 |     the arm,\\nT\n                |                 |                 |                 |                 |      d wives, t\n                |                 |                 |                 |                 |       planet, t\n                |                 |                 |                 |                 |      owerful, t\n                |                 |                 |                 |                 |      ike you, t\n                |                 |                 |                 |                 |      millius; t\n                |                 |                 |                 |                 |      much ado t\n                |                 |                 |                 |                 |     eive it?\\nT\n                |                 |                 |                 |                 |     Camillo,\\nT\n                |                 |                 |                 |                 |      pate but t\n                |                 |                 |                 |                 |     Satisfy!\\nT\n                |                 |                 |                 |                 |      t things t\n                |                 |                 |                 |                 |      st-like, t\n                |                 |                 |                 |                 |     departed\\nT\n                |                 |                 |                 |                 |       upon't, t\n                |                 |                 |                 |                 |     , or,\\nIf t\n                |                 |                 |                 |                 |      hat way, t\n                |                 |                 |                 |                 |      'd home, t\n                |                 |                 |                 |                 |     awn,\\nAnd t\n                |                 |                 |                 |                 |     ree,\\nBut t\n                |                 |                 |                 |                 |      fearful\\nT\n                |                 |                 |                 |                 |       wisest: t\n                |                 |                 |                 |                 |     o,--\\nBut t\n                |                 |                 |                 |                 |      that man t\n                |                 |                 |                 |                 |     egative,\\nT\n                |                 |                 |                 |                 |      engeance t\n                |                 |                 |                 |                 |      s; which t\n                |                 |                 |                 |                 |      as that, t\n                |                 |                 |                 |                 |       theirs, t\n                |                 |                 |                 |                 |     rs only,\\nT\n                |                 |                 |                 |                 |     nothing;\\nT\n                |                 |                 |                 |                 |     ings,\\nIf t\n                |                 |                 |                 |                 |      porizer, t\n                |                 |                 |                 |                 |      bout me, t\n                |                 |                 |                 |                 |     profits,\\nT\n                |                 |                 |                 |                 |      thrifts, t\n                |                 |                 |                 |                 |     e a cup,\\nT\n                |                 |                 |                 |                 |     ng wink;\\nW\n                |                 |                 |                 |                 |      his, and t\n                |                 |                 |                 |                 |      ake that t\n                |                 |                 |                 |                 |     settled,\\nT\n                |                 |                 |                 |                 |     n, sully\\nT\n                |                 |                 |                 |                 |      s goads, t\n                |                 |                 |                 |                 |      nettles, t\n                |                 |                 |                 |                 |      ake; and t\n                |                 |                 |                 |                 |      sealing\\nT\n                |                 |                 |                 |                 |       blemish t\n                |                 |                 |                 |                 |      Do't and t\n                |                 |                 |                 |                 |      o't not, t\n                |                 |                 |                 |                 |      bedience t\n                |                 |                 |                 |                 |     have\\nAll t\n                |                 |                 |                 |                 |       so too. T\n                |                 |                 |                 |                 |      housands t\n                |                 |                 |                 |                 |      e court: t\n                |                 |                 |                 |                 |      certain\\nT\n                |                 |                 |                 |                 |     LIXENES:\\nT\n                |                 |                 |                 |                 |     breeding\\nT\n                |                 |                 |                 |                 |      changeth t\n                |                 |                 |                 |                 |     ts;\\nFor, t\n                |                 |                 |                 |                 |     g\\nMyself t\n                |                 |                 |                 |                 |     nowledge\\nT\n                |                 |                 |                 |                 |     \\nThereof t\n                |                 |                 |                 |                 |      of mine, t\n                |                 |                 |                 |                 |     d by him\\nT\n                |                 |                 |                 |                 |      ourable: t\n                |                 |                 |                 |                 |     strument\\nT\n                |                 |                 |                 |                 |      ou to't, t\n                |                 |                 |                 |                 |      st blood t\n                |                 |                 |                 |                 |     ood turn\\nT\n                |                 |                 |                 |                 |     he Best!\\nT\n                |                 |                 |                 |                 |      o, worse t\n                |                 |                 |                 |                 |     honesty,\\nT\n                |                 |                 |                 |                 |      n mouth, t\n                |                 |                 |                 |                 |      ays ago. T\n                |                 |                 |                 |                 |     ather if\\nT\n                |                 |                 |                 |                 |      command\\nT\n                |                 |                 |                 |                 |     highness\\nT\n                |                 |                 |                 |                 |      k brows, t\n                |                 |                 |                 |                 |     ady:\\nWho t\n                |                 |                 |                 |                 |     y's nose\\nT\n                |                 |                 |                 |                 |     Hark ye;\\nT\n                |                 |                 |                 |                 |      ays; and t\n                |                 |                 |                 |                 |      us,\\nAnd t\n                |                 |                 |                 |                 |     MILLIUS:\\nT\n                |                 |                 |                 |                 |      it down; t\n                |                 |                 |                 |                 |      : I eyed t\n                |                 |                 |                 |                 |      o blest! T\n                |                 |                 |                 |                 |      pander:\\nT\n                |                 |                 |                 |                 |      l's true t\n                |                 |                 |                 |                 |      trusted: t\n                |                 |                 |                 |                 |      For them t\n                |                 |                 |                 |                 |     rse him:\\nT\n                |                 |                 |                 |                 |      Has made t\n                |                 |                 |                 |                 |     ut about\\nT\n                |                 |                 |                 |                 |     dy,' and\\nT\n                |                 |                 |                 |                 |      e shrug, t\n                |                 |                 |                 |                 |      m or ha, t\n                |                 |                 |                 |                 |     y brands\\nT\n                |                 |                 |                 |                 |       shrugs, t\n                |                 |                 |                 |                 |      From him t\n                |                 |                 |                 |                 |      incipal, t\n                |                 |                 |                 |                 |     as those\\nT\n                |                 |                 |                 |                 |      owledge, t\n                |                 |                 |                 |                 |      hly then t\n                |                 |                 |                 |                 |     ld upon,\\nT\n                |                 |                 |                 |                 |      ith her! t\n                |                 |                 |                 |                 |     ilty\\nBut t\n                |                 |                 |                 |                 |      nly are; t\n                |                 |                 |                 |                 |     ns\\nWorse t\n                |                 |                 |                 |                 |     ; and so\\nT\n                |                 |                 |                 |                 |     d fools;\\nT\n                |                 |                 |                 |                 |       prison, t\n                |                 |                 |                 |                 |      ome out: t\n                |                 |                 |                 |                 |      cept it, t\n                |                 |                 |                 |                 |     ith her;\\nT\n                |                 |                 |                 |                 |     utter-on\\nT\n                |                 |                 |                 |                 |      ughters; t\n                |                 |                 |                 |                 |     five;\\nIf t\n                |                 |                 |                 |                 |      ve true, t\n                |                 |                 |                 |                 |     not see,\\nT\n                |                 |                 |                 |                 |      rations: t\n                |                 |                 |                 |                 |      b myself t\n                |                 |                 |                 |                 |      elf than t\n                |                 |                 |                 |                 |     e withal\\nT\n                |                 |                 |                 |                 |      no grave t\n                |                 |                 |                 |                 |     honesty:\\nT\n                |                 |                 |                 |                 |       advice: t\n                |                 |                 |                 |                 |      he loss, t\n                |                 |                 |                 |                 |      he gain, t\n                |                 |                 |                 |                 |     t,\\nAdded t\n                |                 |                 |                 |                 |     jecture,\\nT\n                |                 |                 |                 |                 |      Delphos, t\n                |                 |                 |                 |                 |     e oracle\\nT\n                |                 |                 |                 |                 |     ed,\\nLest t\n                |                 |                 |                 |                 |     PAULINA:\\nT\n                |                 |                 |                 |                 |     e's ado,\\nT\n                |                 |                 |                 |                 |     ray you,\\nT\n                |                 |                 |                 |                 |     , madam,\\nT\n                |                 |                 |                 |                 |      to live: t\n                |                 |                 |                 |                 |      e shall: t\n                |                 |                 |                 |                 |     anger be\\nT\n                |                 |                 |                 |                 |      he dares t\n                |                 |                 |                 |                 |     e child:\\nT\n                |                 |                 |                 |                 |      evident\\nT\n                |                 |                 |                 |                 |     ladyship\\nT\n                |                 |                 |                 |                 |     \\nWho but t\n                |                 |                 |                 |                 |     it, sir:\\nT\n                |                 |                 |                 |                 |     party to\\nT\n                |                 |                 |                 |                 |       any be, t\n                |                 |                 |                 |                 |     weakness\\nT\n                |                 |                 |                 |                 |     ness. If\\nT\n                |                 |                 |                 |                 |      How does t\n                |                 |                 |                 |                 |     vant:\\nHe t\n                |                 |                 |                 |                 |      droop'd, t\n                |                 |                 |                 |                 |     himself,\\nT\n                |                 |                 |                 |                 |      of him:\\nT\n                |                 |                 |                 |                 |     ngeance,\\nT\n                |                 |                 |                 |                 |      sorrow:\\nT\n                |                 |                 |                 |                 |     e, alas,\\nT\n                |                 |                 |                 |                 |     as,\\nThan t\n                |                 |                 |                 |                 |     TIGONUS:\\nT\n                |                 |                 |                 |                 |      as you,\\nT\n                |                 |                 |                 |                 |       either, t\n                |                 |                 |                 |                 |      lor, yet t\n                |                 |                 |                 |                 |     r evils,\\nT\n                |                 |                 |                 |                 |     I\\nA man, t\n                |                 |                 |                 |                 |      akes but t\n                |                 |                 |                 |                 |       errand. T\n                |                 |                 |                 |                 |     s honest\\nT\n                |                 |                 |                 |                 |     rant,\\nAs t\n                |                 |                 |                 |                 |     bastard.\\nT\n                |                 |                 |                 |                 |       dotard! t\n                |                 |                 |                 |                 |      et here. T\n                |                 |                 |                 |                 |     bastard;\\nT\n                |                 |                 |                 |                 |      you did; t\n                |                 |                 |                 |                 |     , for he\\nT\n                |                 |                 |                 |                 |       betrays t\n                |                 |                 |                 |                 |     \\nFor, as t\n                |                 |                 |                 |                 |      aits me! T\n                |                 |                 |                 |                 |       little, t\n                |                 |                 |                 |                 |     se, lip,\\nT\n                |                 |                 |                 |                 |      ad, nay, t\n                |                 |                 |                 |                 |      valley,\\nT\n                |                 |                 |                 |                 |      , lozel, t\n                |                 |                 |                 |                 |      hang'd,\\nT\n                |                 |                 |                 |                 |     husbands\\nT\n                |                 |                 |                 |                 |     ant;\\nBut t\n                |                 |                 |                 |                 |     cusation\\nT\n                |                 |                 |                 |                 |       spirit! W\n                |                 |                 |                 |                 |     ds?\\nYou, t\n                |                 |                 |                 |                 |     S:\\nThou, t\n                |                 |                 |                 |                 |      en thou, t\n                |                 |                 |                 |                 |      o'er it, t\n                |                 |                 |                 |                 |      say so;\\nT\n                |                 |                 |                 |                 |     ot, sir:\\nT\n                |                 |                 |                 |                 |      to come, t\n                |                 |                 |                 |                 |     be\\nDeath t\n                |                 |                 |                 |                 |      self but t\n                |                 |                 |                 |                 |     thee,\\nAs t\n                |                 |                 |                 |                 |      iege-man t\n                |                 |                 |                 |                 |      n to us, t\n                |                 |                 |                 |                 |      e mercy, t\n                |                 |                 |                 |                 |      eril and t\n                |                 |                 |                 |                 |     torture,\\nT\n                |                 |                 |                 |                 |     re,\\nThat t\n                |                 |                 |                 |                 |       end it. T\n                |                 |                 |                 |                 |      do this, t\n                |                 |                 |                 |                 |     d ravens\\nT\n                |                 |                 |                 |                 |      d bears, t\n                |                 |                 |                 |                 |      ou, sir, t\n                |                 |                 |                 |                 |     ree days\\nT\n                |                 |                 |                 |                 |     oretells\\nT\n                |                 |                 |                 |                 |      session, t\n                |                 |                 |                 |                 |       burthen t\n                |                 |                 |                 |                 |     EOMENES:\\nT\n                |                 |                 |                 |                 |      elicate, t\n                |                 |                 |                 |                 |      he isle, t\n                |                 |                 |                 |                 |     rpassing\\nT\n                |                 |                 |                 |                 |      ught me, t\n                |                 |                 |                 |                 |      hem, and t\n                |                 |                 |                 |                 |       of all, t\n                |                 |                 |                 |                 |     urst\\nAnd t\n                |                 |                 |                 |                 |     y sense.\\nT\n                |                 |                 |                 |                 |      speedy,\\nT\n                |                 |                 |                 |                 |      he best! T\n                |                 |                 |                 |                 |   .\\n\\nDION:\\nT\n                |                 |                 |                 |                 |      oracle,\\nT\n                |                 |                 |                 |                 |      essions, t\n                |                 |                 |                 |                 |      r heart: t\n                |                 |                 |                 |                 |     ty tried\\nT\n                |                 |                 |                 |                 |      lush and t\n                |                 |                 |                 |                 |      pattern, t\n                |                 |                 |                 |                 |     aughter,\\nT\n                |                 |                 |                 |                 |     standing\\nT\n                |                 |                 |                 |                 |      And only t\n                |                 |                 |                 |                 |     t beyond\\nT\n                |                 |                 |                 |                 |      or will\\nT\n                |                 |                 |                 |                 |     eard yet\\nT\n                |                 |                 |                 |                 |      mpudence t\n                |                 |                 |                 |                 |     they did\\nT\n                |                 |                 |                 |                 |     did\\nThan t\n                |                 |                 |                 |                 |      enough;\\nT\n                |                 |                 |                 |                 |       you and t\n                |                 |                 |                 |                 |     , freely\\nT\n                |                 |                 |                 |                 |       tastes; t\n                |                 |                 |                 |                 |     d\\nFor me t\n                |                 |                 |                 |                 |      r court, t\n                |                 |                 |                 |                 |      the gods t\n                |                 |                 |                 |                 |      derta'en t\n                |                 |                 |                 |                 |     shame,--\\nT\n                |                 |                 |                 |                 |     h:\\nWhich t\n                |                 |                 |                 |                 |      rns more t\n                |                 |                 |                 |                 |     ; for as\\nT\n                |                 |                 |                 |                 |       it,--so t\n                |                 |                 |                 |                 |     threats:\\nT\n                |                 |                 |                 |                 |      I seek.\\nT\n                |                 |                 |                 |                 |     mmodity:\\nT\n                |                 |                 |                 |                 |     t hatred\\nT\n                |                 |                 |                 |                 |     h 'longs\\nT\n                |                 |                 |                 |                 |     ied\\nHere t\n                |                 |                 |                 |                 |     y liege,\\nT\n                |                 |                 |                 |                 |     e alive,\\nT\n                |                 |                 |                 |                 |       to die? T\n                |                 |                 |                 |                 |     st Lord:\\nT\n                |                 |                 |                 |                 |      er just: t\n                |                 |                 |                 |                 |      s trial! t\n                |                 |                 |                 |                 |     justice,\\nT\n                |                 |                 |                 |                 |      t, since t\n                |                 |                 |                 |                 |      oracle:\\nT\n                |                 |                 |                 |                 |      proceed: t\n                |                 |                 |                 |                 |     port it!\\nT\n                |                 |                 |                 |                 |      gry; and t\n                |                 |                 |                 |                 |      o bloody t\n                |                 |                 |                 |                 |      ghts and t\n                |                 |                 |                 |                 |     one,\\nBut t\n                |                 |                 |                 |                 |      eat, and t\n                |                 |                 |                 |                 |      o richer t\n                |                 |                 |                 |                 |      orments, t\n                |                 |                 |                 |                 |      t worst? T\n                |                 |                 |                 |                 |     \\nFancies t\n                |                 |                 |                 |                 |      or boys, t\n                |                 |                 |                 |                 |      nine, O, t\n                |                 |                 |                 |                 |     done\\nAnd t\n                |                 |                 |                 |                 |     s of it.\\nT\n                |                 |                 |                 |                 |     't much,\\nT\n                |                 |                 |                 |                 |     daughter\\nT\n                |                 |                 |                 |                 |      to thee, t\n                |                 |                 |                 |                 |      r one so t\n                |                 |                 |                 |                 |      ous dam: t\n                |                 |                 |                 |                 |      e queen, t\n                |                 |                 |                 |                 |      heavier\\nT\n                |                 |                 |                 |                 |      an stir; t\n                |                 |                 |                 |                 |     nd knees\\nT\n                |                 |                 |                 |                 |      nd years t\n                |                 |                 |                 |                 |     the gods\\nT\n                |                 |                 |                 |                 |      touch'd\\nT\n                |                 |                 |                 |                 |      unish'd, t\n                |                 |                 |                 |                 |     h woman:\\nT\n                |                 |                 |                 |                 |      ost too: t\n                |                 |                 |                 |                 |     h better\\nT\n                |                 |                 |                 |                 |     ter\\nThan t\n                |                 |                 |                 |                 |     em shall\\nT\n                |                 |                 |                 |                 |      lie, and t\n                |                 |                 |                 |                 |      ars shed t\n                |                 |                 |                 |                 |      hip hath t\n                |                 |                 |                 |                 |     h'd upon\\nT\n                |                 |                 |                 |                 |      ll time: t\n                |                 |                 |                 |                 |     imly\\nAnd t\n                |                 |                 |                 |                 |     science,\\nT\n                |                 |                 |                 |                 |     at heart\\nT\n                |                 |                 |                 |                 |     elieved,\\nt\n                |                 |                 |                 |                 |      hing be, t\n                |                 |                 |                 |                 |       waking. T\n                |                 |                 |                 |                 |      e I lay; t\n                |                 |                 |                 |                 |       spouts: t\n                |                 |                 |                 |                 |     Bohemia,\\nT\n                |                 |                 |                 |                 |      o would, t\n                |                 |                 |                 |                 |     ee well!\\nT\n                |                 |                 |                 |                 |      aracter: t\n                |                 |                 |                 |                 |      th breed t\n                |                 |                 |                 |                 |      t thine. T\n                |                 |                 |                 |                 |      exposed\\nT\n                |                 |                 |                 |                 |     arewell!\\nT\n                |                 |                 |                 |                 |      nd more: t\n                |                 |                 |                 |                 |     clamour!\\nW\n                |                 |                 |                 |                 |       aboard! T\n                |                 |                 |                 |                 |     teen and\\nt\n                |                 |                 |                 |                 |      any but\\nt\n                |                 |                 |                 |                 |      weather? T\n                |                 |                 |                 |                 |     ner find\\nt\n                |                 |                 |                 |                 |     ind\\nthan t\n                |                 |                 |                 |                 |      'scape:\\nt\n                |                 |                 |                 |                 |       'scape. T\n                |                 |                 |                 |                 |      or-work: t\n                |                 |                 |                 |                 |     his\\nthan t\n                |                 |                 |                 |                 |      s you'ld t\n                |                 |                 |                 |                 |      ead. And t\n                |                 |                 |                 |                 |      service, t\n                |                 |                 |                 |                 |       see how t\n                |                 |                 |                 |                 |      he ship, t\n                |                 |                 |                 |                 |      rst, how t\n                |                 |                 |                 |                 |      red, and t\n                |                 |                 |                 |                 |       and how t\n                |                 |                 |                 |                 |     ared\\nand t\n                |                 |                 |                 |                 |     \\nsights: t\n                |                 |                 |                 |                 |      been by, t\n                |                 |                 |                 |                 |      ip side, t\n                |                 |                 |                 |                 |      ped her: t\n                |                 |                 |                 |                 |      thyself: t\n                |                 |                 |                 |                 |      ee here; t\n                |                 |                 |                 |                 |      take up, t\n                |                 |                 |                 |                 |      fairies. T\n                |                 |                 |                 |                 |     hepherd:\\nT\n                |                 |                 |                 |                 |      e, home, t\n                |                 |                 |                 |                 |      boy; and t\n                |                 |                 |                 |                 |     ood\\nboy, t\n                |                 |                 |                 |                 |      h eaten: t\n                |                 |                 |                 |                 |      se some, t\n                |                 |                 |                 |                 |       joy and t\n                |                 |                 |                 |                 |      and bad, t\n                |                 |                 |                 |                 |     ror,\\nNow t\n                |                 |                 |                 |                 |     of Time,\\nT\n                |                 |                 |                 |                 |      passage, t\n                |                 |                 |                 |                 |     ke stale\\nT\n                |                 |                 |                 |                 |     leaving,\\nT\n                |                 |                 |                 |                 |     grieving\\nT\n                |                 |                 |                 |                 |      ctators, t\n                |                 |                 |                 |                 |      ver, yet t\n                |                 |                 |                 |                 |       me now: t\n                |                 |                 |                 |                 |      had thee t\n                |                 |                 |                 |                 |      hee than t\n                |                 |                 |                 |                 |      han thus t\n                |                 |                 |                 |                 |      nt thee: t\n                |                 |                 |                 |                 |      her stay t\n                |                 |                 |                 |                 |       cannot, t\n                |                 |                 |                 |                 |     \\ntherein t\n                |                 |                 |                 |                 |      unhappy, t\n                |                 |                 |                 |                 |      racious, t\n                |                 |                 |                 |                 |      us, than t\n                |                 |                 |                 |                 |      ligence, t\n                |                 |                 |                 |                 |      hey say, t\n                |                 |                 |                 |                 |      d beyond t\n                |                 |                 |                 |                 |      re note: t\n                |                 |                 |                 |                 |      ded more t\n                |                 |                 |                 |                 |      I\\nfear, t\n                |                 |                 |                 |                 |      thither. T\n                |                 |                 |                 |                 |      h heigh! t\n                |                 |                 |                 |                 |     le,\\nWhy, t\n                |                 |                 |                 |                 |     's pale.\\nT\n                |                 |                 |                 |                 |      a king.\\nT\n                |                 |                 |                 |                 |      rk, that t\n                |                 |                 |                 |                 |     my dear?\\nT\n                |                 |                 |                 |                 |     ight.\\nIf t\n                |                 |                 |                 |                 |      budget,\\nT\n                |                 |                 |                 |                 |      ts; when t\n                |                 |                 |                 |                 |      g feast? T\n                |                 |                 |                 |                 |      four and t\n                |                 |                 |                 |                 |      hearers, t\n                |                 |                 |                 |                 |      nes; but t\n                |                 |                 |                 |                 |     ags; and\\nt\n                |                 |                 |                 |                 |      or soul! t\n                |                 |                 |                 |                 |     :\\nO sir, t\n                |                 |                 |                 |                 |     ore\\nthan t\n                |                 |                 |                 |                 |      ood sir, t\n                |                 |                 |                 |                 |     ray you;\\nt\n                |                 |                 |                 |                 |      ow, sir, t\n                |                 |                 |                 |                 |      uld say; t\n                |                 |                 |                 |                 |      -bearer; t\n                |                 |                 |                 |                 |      bailiff; t\n                |                 |                 |                 |                 |      of heart t\n                |                 |                 |                 |                 |      way; and t\n                |                 |                 |                 |                 |   \\n\\nClown:\\nT\n                |                 |                 |                 |                 |      make not t\n                |                 |                 |                 |                 |       jog on, t\n                |                 |                 |                 |                 |      Your sad t\n                |                 |                 |                 |                 |     LORIZEL:\\nT\n                |                 |                 |                 |                 |      s front. T\n                |                 |                 |                 |                 |       pardon, t\n                |                 |                 |                 |                 |     gh self,\\nT\n                |                 |                 |                 |                 |      olly and t\n                |                 |                 |                 |                 |     ld blush\\nT\n                |                 |                 |                 |                 |     I think,\\nT\n                |                 |                 |                 |                 |     u cause!\\nT\n                |                 |                 |                 |                 |     e!\\nTo me t\n                |                 |                 |                 |                 |      he look, t\n                |                 |                 |                 |                 |      jollity. T\n                |                 |                 |                 |                 |      The gods t\n                |                 |                 |                 |                 |     ve taken\\nT\n                |                 |                 |                 |                 |      ellow'd; t\n                |                 |                 |                 |                 |      ted; and t\n                |                 |                 |                 |                 |      eem now. T\n                |                 |                 |                 |                 |     rken not\\nT\n                |                 |                 |                 |                 |     onstant,\\nT\n                |                 |                 |                 |                 |     ny thing\\nT\n                |                 |                 |                 |                 |      bour and t\n                |                 |                 |                 |                 |      and not\\nT\n                |                 |                 |                 |                 |     you, bid\\nT\n                |                 |                 |                 |                 |       winter, t\n                |                 |                 |                 |                 |      it said\\nT\n                |                 |                 |                 |                 |      re makes t\n                |                 |                 |                 |                 |      say adds t\n                |                 |                 |                 |                 |     s an art\\nT\n                |                 |                 |                 |                 |      er scion t\n                |                 |                 |                 |                 |      er race: t\n                |                 |                 |                 |                 |     her, but\\nT\n                |                 |                 |                 |                 |      in earth t\n                |                 |                 |                 |                 |     uld wish\\nT\n                |                 |                 |                 |                 |     arjoram;\\nT\n                |                 |                 |                 |                 |      arigold, t\n                |                 |                 |                 |                 |      weeping: t\n                |                 |                 |                 |                 |      so lean, t\n                |                 |                 |                 |                 |      ough and t\n                |                 |                 |                 |                 |      ers now, t\n                |                 |                 |                 |                 |     ffodils,\\nT\n                |                 |                 |                 |                 |      res, and t\n                |                 |                 |                 |                 |     rimroses\\nT\n                |                 |                 |                 |                 |     lips and\\nT\n                |                 |                 |                 |                 |     l kinds,\\nT\n                |                 |                 |                 |                 |      I lack,\\nT\n                |                 |                 |                 |                 |      for love t\n                |                 |                 |                 |                 |     affairs,\\nT\n                |                 |                 |                 |                 |      the sea, t\n                |                 |                 |                 |                 |      hing but t\n                |                 |                 |                 |                 |     nt deed,\\nT\n                |                 |                 |                 |                 |      rge: but t\n                |                 |                 |                 |                 |     uth,\\nAnd t\n                |                 |                 |                 |                 |      h fairly t\n                |                 |                 |                 |                 |      purpose\\nT\n                |                 |                 |                 |                 |     es pair,\\nT\n                |                 |                 |                 |                 |      ver mean t\n                |                 |                 |                 |                 |     herself,\\nT\n                |                 |                 |                 |                 |     omething\\nT\n                |                 |                 |                 |                 |      garlic,\\nT\n                |                 |                 |                 |                 |      think so t\n                |                 |                 |                 |                 |      es: and, t\n                |                 |                 |                 |                 |      y thing; t\n                |                 |                 |                 |                 |     port it,\\nT\n                |                 |                 |                 |                 |      ieve me, t\n                |                 |                 |                 |                 |      nts more t\n                |                 |                 |                 |                 |       handle, t\n                |                 |                 |                 |                 |     o chants\\nt\n                |                 |                 |                 |                 |      pedlars, t\n                |                 |                 |                 |                 |      n you'ld t\n                |                 |                 |                 |                 |       my lads t\n                |                 |                 |                 |                 |      rom head t\n                |                 |                 |                 |                 |      h Mopsa, t\n                |                 |                 |                 |                 |      ast; but t\n                |                 |                 |                 |                 |      ln-hole, t\n                |                 |                 |                 |                 |      ed, sir, t\n                |                 |                 |                 |                 |      abroad;\\nt\n                |                 |                 |                 |                 |      oves men t\n                |                 |                 |                 |                 |      ou, man, t\n                |                 |                 |                 |                 |     eads and\\nt\n                |                 |                 |                 |                 |      it true, t\n                |                 |                 |                 |                 |      ballads; w\n                |                 |                 |                 |                 |       a fish, t\n                |                 |                 |                 |                 |      ved her: t\n                |                 |                 |                 |                 |      rue too, t\n                |                 |                 |                 |                 |     TOLYCUS:\\nT\n                |                 |                 |                 |                 |       a man:' t\n                |                 |                 |                 |                 |       a part, t\n                |                 |                 |                 |                 |     ll well,\\nT\n                |                 |                 |                 |                 |    \\nDORCAS:\\nT\n                |                 |                 |                 |                 |   \\n\\nMOPSA:\\nT\n                |                 |                 |                 |                 |     e to me:\\nT\n                |                 |                 |                 |                 |      medler.\\nT\n                |                 |                 |                 |                 |     \\nMaster, t\n                |                 |                 |                 |                 |      carters, t\n                |                 |                 |                 |                 |     epherds,\\nt\n                |                 |                 |                 |                 |      t-herds, t\n                |                 |                 |                 |                 |      e-herds, t\n                |                 |                 |                 |                 |     ave made\\nt\n                |                 |                 |                 |                 |      of hair, t\n                |                 |                 |                 |                 |      ce which t\n                |                 |                 |                 |                 |      n't; but t\n                |                 |                 |                 |                 |      has been t\n                |                 |                 |                 |                 |      g: since t\n                |                 |                 |                 |                 |      mple and t\n                |                 |                 |                 |                 |      hat does t\n                |                 |                 |                 |                 |     ansack'd\\nT\n                |                 |                 |                 |                 |     ese are:\\nT\n                |                 |                 |                 |                 |     out:\\nBut t\n                |                 |                 |                 |                 |     NES:\\nAnd t\n                |                 |                 |                 |                 |      and men, t\n                |                 |                 |                 |                 |     and all:\\nT\n                |                 |                 |                 |                 |     monarch,\\nT\n                |                 |                 |                 |                 |     IZEL:\\nO, t\n                |                 |                 |                 |                 |      us 'fore t\n                |                 |                 |                 |                 |     h indeed\\nT\n                |                 |                 |                 |                 |     d reason\\nT\n                |                 |                 |                 |                 |      ot call; t\n                |                 |                 |                 |                 |      wledged: t\n                |                 |                 |                 |                 |     's heir,\\nT\n                |                 |                 |                 |                 |     ir,\\nThat t\n                |                 |                 |                 |                 |      ep-hook! T\n                |                 |                 |                 |                 |      eek. And t\n                |                 |                 |                 |                 |      ely than t\n                |                 |                 |                 |                 |     igh\\nThat t\n                |                 |                 |                 |                 |      e court. T\n                |                 |                 |                 |                 |     is time,\\nT\n                |                 |                 |                 |                 |     him too,\\nT\n                |                 |                 |                 |                 |      nceforth t\n                |                 |                 |                 |                 |     rth thou\\nT\n                |                 |                 |                 |                 |       latches t\n                |                 |                 |                 |                 |     plainly,\\nT\n                |                 |                 |                 |                 |      ke care: t\n                |                 |                 |                 |                 |      Nor dare t\n                |                 |                 |                 |                 |      ourscore t\n                |                 |                 |                 |                 |     e three,\\nT\n                |                 |                 |                 |                 |     et, yea,\\nT\n                |                 |                 |                 |                 |     er died,\\nT\n                |                 |                 |                 |                 |      I fear:\\nT\n                |                 |                 |                 |                 |     r:\\nThen, t\n                |                 |                 |                 |                 |     last\\nBut t\n                |                 |                 |                 |                 |     l but by\\nT\n                |                 |                 |                 |                 |      ith; and t\n                |                 |                 |                 |                 |      my oath\\nT\n                |                 |                 |                 |                 |      beloved: t\n                |                 |                 |                 |                 |      fortune\\nT\n                |                 |                 |                 |                 |      to come. T\n                |                 |                 |                 |                 |      Purchase t\n                |                 |                 |                 |                 |     ilia\\nAnd t\n                |                 |                 |                 |                 |      h thirst t\n                |                 |                 |                 |                 |     his care\\nT\n                |                 |                 |                 |                 |     king\\nAnd t\n                |                 |                 |                 |                 |     , I see,\\nT\n                |                 |                 |                 |                 |      junction t\n                |                 |                 |                 |                 |      r strive t\n                |                 |                 |                 |                 |     llo,\\nMay t\n                |                 |                 |                 |                 |     be done?\\nT\n                |                 |                 |                 |                 |     s guilty\\nT\n                |                 |                 |                 |                 |      hen list t\n                |                 |                 |                 |                 |     t to me:\\nT\n                |                 |                 |                 |                 |     lia,\\nAnd t\n                |                 |                 |                 |                 |      indness; t\n                |                 |                 |                 |                 |      and bids t\n                |                 |                 |                 |                 |     r father\\nT\n                |                 |                 |                 |                 |       him and t\n                |                 |                 |                 |                 |     ts. Sir,\\nT\n                |                 |                 |                 |                 |     deliver,\\nT\n                |                 |                 |                 |                 |     ou down:\\nT\n                |                 |                 |                 |                 |      ust say; t\n                |                 |                 |                 |                 |     eive\\nBut t\n                |                 |                 |                 |                 |      to you:\\nT\n                |                 |                 |                 |                 |     romising\\nT\n                |                 |                 |                 |                 |     urselves\\nT\n                |                 |                 |                 |                 |      se heart t\n                |                 |                 |                 |                 |      you so?\\nT\n                |                 |                 |                 |                 |     !\\nBut O, t\n                |                 |                 |                 |                 |     w of me,\\nT\n                |                 |                 |                 |                 |      my care\\nT\n                |                 |                 |                 |                 |     ed as if\\nT\n                |                 |                 |                 |                 |     ce, sir,\\nT\n                |                 |                 |                 |                 |       brooch, t\n                |                 |                 |                 |                 |     ,\\nknife, t\n                |                 |                 |                 |                 |     rn-ring,\\nt\n                |                 |                 |                 |                 |      fasting: t\n                |                 |                 |                 |                 |      t I saw, t\n                |                 |                 |                 |                 |      s' song, t\n                |                 |                 |                 |                 |      had both t\n                |                 |                 |                 |                 |      hter and t\n                |                 |                 |                 |                 |     ZEL:\\nAnd t\n                |                 |                 |                 |                 |      xchange; t\n                |                 |                 |                 |                 |       discase t\n                |                 |                 |                 |                 |      ntleman: t\n                |                 |                 |                 |                 |      : though t\n                |                 |                 |                 |                 |      yet hold t\n                |                 |                 |                 |                 |     ld thee,\\nt\n                |                 |                 |                 |                 |      ispatch: t\n                |                 |                 |                 |                 |       covert: t\n                |                 |                 |                 |                 |     disliken\\nT\n                |                 |                 |                 |                 |      seeming; t\n                |                 |                 |                 |                 |     peed us!\\nT\n                |                 |                 |                 |                 |      hear it: t\n                |                 |                 |                 |                 |     te\\nalso, t\n                |                 |                 |                 |                 |      man doth t\n                |                 |                 |                 |                 |      ange had t\n                |                 |                 |                 |                 |      tempore. T\n                |                 |                 |                 |                 |      it;\\nand t\n                |                 |                 |                 |                 |     are now!\\nT\n                |                 |                 |                 |                 |       way but t\n                |                 |                 |                 |                 |      out her, t\n                |                 |                 |                 |                 |      ith her: t\n                |                 |                 |                 |                 |      r to me, t\n                |                 |                 |                 |                 |     had been\\nt\n                |                 |                 |                 |                 |      he king: t\n                |                 |                 |                 |                 |      th whom, t\n                |                 |                 |                 |                 |       fardel, t\n                |                 |                 |                 |                 |      men, and t\n                |                 |                 |                 |                 |      g steel; t\n                |                 |                 |                 |                 |     herefore\\nt\n                |                 |                 |                 |                 |      ontempt? T\n                |                 |                 |                 |                 |      ate hast t\n                |                 |                 |                 |                 |     ese are,\\nT\n                |                 |                 |                 |                 |     rd:\\nSir, t\n                |                 |                 |                 |                 |      know but t\n                |                 |                 |                 |                 |      serious, t\n                |                 |                 |                 |                 |      his son, t\n                |                 |                 |                 |                 |      ll have, t\n                |                 |                 |                 |                 |       of man, t\n                |                 |                 |                 |                 |      ter; but t\n                |                 |                 |                 |                 |       germane t\n                |                 |                 |                 |                 |      to\\nhim, t\n                |                 |                 |                 |                 |      n: which t\n                |                 |                 |                 |                 |      -tender, t\n                |                 |                 |                 |                 |      ned; but t\n                |                 |                 |                 |                 |      too few, t\n                |                 |                 |                 |                 |      d alive; t\n                |                 |                 |                 |                 |      am dead; t\n                |                 |                 |                 |                 |      nfusion; t\n                |                 |                 |                 |                 |      ck-wall, t\n                |                 |                 |                 |                 |      iled at, t\n                |                 |                 |                 |                 |      capital? T\n                |                 |                 |                 |                 |     \\naboard, t\n                |                 |                 |                 |                 |      old; and t\n                |                 |                 |                 |                 |      o moles, t\n                |                 |                 |                 |                 |      to shore t\n                |                 |                 |                 |                 |      gain and t\n                |                 |                 |                 |                 |       belongs t\n                |                 |                 |                 |                 |      gs to't. T\n                |                 |                 |                 |                 |     nt\\nthem: t\n                |                 |                 |                 |                 |      han done t\n                |                 |                 |                 |                 |     think of\\nT\n                |                 |                 |                 |                 |     so much,\\nT\n                |                 |                 |                 |                 |     A:\\nTrue, t\n                |                 |                 |                 |                 |     ng good,\\nT\n                |                 |                 |                 |                 |     \\nSorely, t\n                |                 |                 |                 |                 |      d things t\n                |                 |                 |                 |                 |     ore holy\\nT\n                |                 |                 |                 |                 |     oly\\nThan t\n                |                 |                 |                 |                 |     re good,\\nT\n                |                 |                 |                 |                 |      ulfill'd t\n                |                 |                 |                 |                 |      d? which t\n                |                 |                 |                 |                 |     r issue;\\nT\n                |                 |                 |                 |                 |      nour, O, t\n                |                 |                 |                 |                 |      h wives; t\n                |                 |                 |                 |                 |      eye, and t\n                |                 |                 |                 |                 |      ose her; t\n                |                 |                 |                 |                 |       shriek, t\n                |                 |                 |                 |                 |       me; and t\n                |                 |                 |                 |                 |      -give me t\n                |                 |                 |                 |                 |     take joy\\nT\n                |                 |                 |                 |                 |     ess, she\\nT\n                |                 |                 |                 |                 |       sudden, t\n                |                 |                 |                 |                 |     few,\\nAnd t\n                |                 |                 |                 |                 |     man:\\nAy, t\n                |                 |                 |                 |                 |     y ebb'd,\\nT\n                |                 |                 |                 |                 |     ardon,--\\nT\n                |                 |                 |                 |                 |      r tongue t\n                |                 |                 |                 |                 |      gue too. T\n                |                 |                 |                 |                 |     ntleman:\\nW\n                |                 |                 |                 |                 |      ove her, t\n                |                 |                 |                 |                 |      an; men, t\n                |                 |                 |                 |                 |      is lord: t\n                |                 |                 |                 |                 |      ain when t\n                |                 |                 |                 |                 |       reason. T\n                |                 |                 |                 |                 |      ost true t\n                |                 |                 |                 |                 |      re I but t\n                |                 |                 |                 |                 |      ery air, t\n                |                 |                 |                 |                 |       couple, t\n                |                 |                 |                 |                 |     th\\nMight t\n                |                 |                 |                 |                 |       do: and t\n                |                 |                 |                 |                 |     r, whom,\\nT\n                |                 |                 |                 |                 |      so--more t\n                |                 |                 |                 |                 |      ntleman! t\n                |                 |                 |                 |                 |     Neptune,\\nT\n                |                 |                 |                 |                 |      Smalus,\\nT\n                |                 |                 |                 |                 |     cross'd,\\nT\n                |                 |                 |                 |                 |      ia bend, t\n                |                 |                 |                 |                 |     ble sir,\\nT\n                |                 |                 |                 |                 |      message. T\n                |                 |                 |                 |                 |      o quake: t\n                |                 |                 |                 |                 |      y kneel, t\n                |                 |                 |                 |                 |      father!\\nT\n                |                 |                 |                 |                 |     e to be;\\nT\n                |                 |                 |                 |                 |     s first:\\nT\n                |                 |                 |                 |                 |      beauty,\\nT\n                |                 |                 |                 |                 |     look up:\\nT\n                |                 |                 |                 |                 |      to time\\nT\n                |                 |                 |                 |                 |     ch gazes\\nT\n                |                 |                 |                 |                 |      ard him; t\n                |                 |                 |                 |                 |      l, heard t\n                |                 |                 |                 |                 |      ess; but t\n                |                 |                 |                 |                 |      iration: t\n                |                 |                 |                 |                 |     ir\\neyes; t\n                |                 |                 |                 |                 |      gesture; t\n                |                 |                 |                 |                 |      ooked as t\n                |                 |                 |                 |                 |      hem; but t\n                |                 |                 |                 |                 |      eholder, t\n                |                 |                 |                 |                 |     ws more.\\nT\n                |                 |                 |                 |                 |      onfires: t\n                |                 |                 |                 |                 |      lfilled; t\n                |                 |                 |                 |                 |      ld tale, t\n                |                 |                 |                 |                 |      mstance: t\n                |                 |                 |                 |                 |     you\\nsee, t\n                |                 |                 |                 |                 |       proofs. T\n                |                 |                 |                 |                 |     k of it,\\nt\n                |                 |                 |                 |                 |      it which t\n                |                 |                 |                 |                 |      aracter, t\n                |                 |                 |                 |                 |     ntleman:\\nT\n                |                 |                 |                 |                 |      oken of. T\n                |                 |                 |                 |                 |      h manner t\n                |                 |                 |                 |                 |      n tears. T\n                |                 |                 |                 |                 |      ng ready t\n                |                 |                 |                 |                 |      ries 'O, t\n                |                 |                 |                 |                 |      mother,\\nt\n                |                 |                 |                 |                 |      iveness; t\n                |                 |                 |                 |                 |      -in-law; t\n                |                 |                 |                 |                 |      tigonus, t\n                |                 |                 |                 |                 |      ehearse, t\n                |                 |                 |                 |                 |       a bear: t\n                |                 |                 |                 |                 |      ms much, t\n                |                 |                 |                 |                 |      herd: so t\n                |                 |                 |                 |                 |       all and t\n                |                 |                 |                 |                 |      aughter; t\n                |                 |                 |                 |                 |      seen 't, t\n                |                 |                 |                 |                 |     man:\\nNo: t\n                |                 |                 |                 |                 |     \\nanswer: t\n                |                 |                 |                 |                 |     er\\nsince t\n                |                 |                 |                 |                 |      e thence t\n                |                 |                 |                 |                 |      that has t\n                |                 |                 |                 |                 |       prince: t\n                |                 |                 |                 |                 |     r,\\nso he t\n                |                 |                 |                 |                 |       he then t\n                |                 |                 |                 |                 |      tinuing, t\n                |                 |                 |                 |                 |      ren, but t\n                |                 |                 |                 |                 |      with me\\nt\n                |                 |                 |                 |                 |      not and\\nt\n                |                 |                 |                 |                 |       do, and t\n                |                 |                 |                 |                 |     ther and\\nt\n                |                 |                 |                 |                 |      ept, and t\n                |                 |                 |                 |                 |     man-like\\nt\n                |                 |                 |                 |                 |      ve, son, t\n                |                 |                 |                 |                 |      ship and t\n                |                 |                 |                 |                 |     ands and\\nt\n                |                 |                 |                 |                 |     and\\nthat t\n                |                 |                 |                 |                 |      so, sir, t\n                |                 |                 |                 |                 |       fellow, t\n                |                 |                 |                 |                 |      Paulina, t\n                |                 |                 |                 |                 |     ok upon,\\nT\n                |                 |                 |                 |                 |      th done; t\n                |                 |                 |                 |                 |      r stone, t\n                |                 |                 |                 |                 |     y indeed\\nT\n                |                 |                 |                 |                 |       rather, t\n                |                 |                 |                 |                 |     l piece,\\nT\n                |                 |                 |                 |                 |      stition, t\n                |                 |                 |                 |                 |      neel and t\n                |                 |                 |                 |                 |      r queen, t\n                |                 |                 |                 |                 |     atience!\\nT\n                |                 |                 |                 |                 |      y fix'd, t\n                |                 |                 |                 |                 |     ge\\nWould t\n                |                 |                 |                 |                 |      ead, but t\n                |                 |                 |                 |                 |      hed? and t\n                |                 |                 |                 |                 |     ly done:\\nT\n                |                 |                 |                 |                 |     \\nMake me t\n                |                 |                 |                 |                 |     ethinks,\\nT\n                |                 |                 |                 |                 |     forbear:\\nT\n                |                 |                 |                 |                 |      and; but t\n                |                 |                 |                 |                 |      as easy\\nT\n                |                 |                 |                 |                 |      r faith. T\n                |                 |                 |                 |                 |     ill;\\nOn: t\n                |                 |                 |                 |                 |      Bequeath t\n                |                 |                 |                 |                 |     warm!\\nIf t\n                |                 |                 |                 |                 |      e it but t\n                |                 |                 |                 |                 |     e lives,\\nT\n                |                 |                 |                 |                 |      lessing. T\n                |                 |                 |                 |                 |     ow found\\nT\n                |                 |                 |                 |                 |      ina that t\n                |                 |                 |                 |                 |     d\\nMyself t\n                |                 |                 |                 |                 |      My mate, t\n                |                 |                 |                 |                 |     Paulina!\\nT\n                |                 |                 |                 |                 |       a wife: t\n                |                 |                 |                 |                 |      by vows. T\n                |                 |                 |                 |                 |     llo,\\nAnd t\n                |                 |                 |                 |                 |     pardons,\\nT\n                |                 |                 |                 |                 |      spicion. T\n                |                 |                 |                 |                 |      h-plight t\n                |                 |                 |                 |                 |      em in me t\n                |                 |                 |                 |                 |      in that, t\n                |                 |                 |                 |                 |      ive you: t\n                |                 |                 |                 |                 |     ins,\\nBut t\n                |                 |                 |                 |                 |      em work. T\n                |                 |                 |                 |                 |     ched any\\nT\n                |                 |                 |                 |                 |      emember. T\n                |                 |                 |                 |                 |    \\nAngelo,\\nT\n                |                 |                 |                 |                 |     fe,\\nThat t\n                |                 |                 |                 |                 |      ver doth t\n                |                 |                 |                 |                 |       unfold. T\n                |                 |                 |                 |                 |      virtues, t\n                |                 |                 |                 |                 |     ch'd\\nBut t\n                |                 |                 |                 |                 |     er lends\\nT\n                |                 |                 |                 |                 |     \\nHerself t\n                |                 |                 |                 |                 |     or,\\nBoth t\n                |                 |                 |                 |                 |     se;\\nHold t\n                |                 |                 |                 |                 |     Escalus,\\nT\n                |                 |                 |                 |                 |     condary.\\nT\n                |                 |                 |                 |                 |     evasion:\\nW\n                |                 |                 |                 |                 |       to you; t\n                |                 |                 |                 |                 |      you,\\nAs t\n                |                 |                 |                 |                 |     ou well;\\nT\n                |                 |                 |                 |                 |       qualify t\n                |                 |                 |                 |                 |      laws\\nAs t\n                |                 |                 |                 |                 |     ir eyes:\\nT\n                |                 |                 |                 |                 |    \\nANGELO:\\nT\n                |                 |                 |                 |                 |     cerns me\\nT\n                |                 |                 |                 |                 |       pirate, t\n                |                 |                 |                 |                 |      nctions: t\n                |                 |                 |                 |                 |      o steal. T\n                |                 |                 |                 |                 |      o relish t\n                |                 |                 |                 |                 |      example, t\n                |                 |                 |                 |                 |     n:\\nWell, t\n                |                 |                 |                 |                 |      rant; as t\n                |                 |                 |                 |                 |     \\nvelvet. T\n                |                 |                 |                 |                 |     man:\\nAnd t\n                |                 |                 |                 |                 |       velvet: t\n                |                 |                 |                 |                 |       velvet; t\n                |                 |                 |                 |                 |      iled, as t\n                |                 |                 |                 |                 |     an:\\nYes, t\n                |                 |                 |                 |                 |      To three t\n                |                 |                 |                 |                 |       me; but t\n                |                 |                 |                 |                 |     s\\nthings t\n                |                 |                 |                 |                 |       hollow: t\n                |                 |                 |                 |                 |      rth five t\n                |                 |                 |                 |                 |      ry, sir, t\n                |                 |                 |                 |                 |      his head t\n                |                 |                 |                 |                 |     VERDONE:\\nT\n                |                 |                 |                 |                 |    \\nPOMPEY:\\nT\n                |                 |                 |                 |                 |      or seed: t\n                |                 |                 |                 |                 |     too,\\nbut t\n                |                 |                 |                 |                 |      clients: t\n                |                 |                 |                 |                 |      , Thomas t\n                |                 |                 |                 |                 |      son; and t\n                |                 |                 |                 |                 |       show me t\n                |                 |                 |                 |                 |     CLAUDIO:\\nT\n                |                 |                 |                 |                 |      and yet, t\n                |                 |                 |                 |                 |     eedom\\nas t\n                |                 |                 |                 |                 |      What but t\n                |                 |                 |                 |                 |      d order: t\n                |                 |                 |                 |                 |      had made t\n                |                 |                 |                 |                 |      chances\\nT\n                |                 |                 |                 |                 |      haracter t\n                |                 |                 |                 |                 |      so.\\nAnd t\n                |                 |                 |                 |                 |      he seat, t\n                |                 |                 |                 |                 |       emmence t\n                |                 |                 |                 |                 |     \\nSo long t\n                |                 |                 |                 |                 |      houlders t\n                |                 |                 |                 |                 |     service:\\nT\n                |                 |                 |                 |                 |     nter\\nAnd t\n                |                 |                 |                 |                 |      y voice, t\n                |                 |                 |                 |                 |      led than t\n                |                 |                 |                 |                 |      ravell'd t\n                |                 |                 |                 |                 |     ng laws.\\nT\n                |                 |                 |                 |                 |      a cave,\\nT\n                |                 |                 |                 |                 |     ch,\\nOnly t\n                |                 |                 |                 |                 |      liction, t\n                |                 |                 |                 |                 |     he nose;\\nT\n                |                 |                 |                 |                 |       unloose t\n                |                 |                 |                 |                 |     e seem'd\\nT\n                |                 |                 |                 |                 |      do fear, t\n                |                 |                 |                 |                 |      ishment. T\n                |                 |                 |                 |                 |       people: t\n                |                 |                 |                 |                 |     u;\\nOnly, t\n                |                 |                 |                 |                 |     LA:\\nYes, t\n                |                 |                 |                 |                 |      terhood, t\n                |                 |                 |                 |                 |     sabella,\\nT\n                |                 |                 |                 |                 |     rioress:\\nT\n                |                 |                 |                 |                 |      lace and t\n                |                 |                 |                 |                 |      me ask,\\nT\n                |                 |                 |                 |                 |      th maids t\n                |                 |                 |                 |                 |      wing and t\n                |                 |                 |                 |                 |     to jest,\\nT\n                |                 |                 |                 |                 |     rit,\\nAnd t\n                |                 |                 |                 |                 |     aced:\\nAs t\n                |                 |                 |                 |                 |     e point.\\nT\n                |                 |                 |                 |                 |     er feels\\nT\n                |                 |                 |                 |                 |     statute,\\nT\n                |                 |                 |                 |                 |     r prayer\\nT\n                |                 |                 |                 |                 |      elo: and t\n                |                 |                 |                 |                 |       us lose t\n                |                 |                 |                 |                 |      s freely t\n                |                 |                 |                 |                 |     heirs\\nAs t\n                |                 |                 |                 |                 |     \\nAs they t\n                |                 |                 |                 |                 |      e shape, t\n                |                 |                 |                 |                 |      little,\\nT\n                |                 |                 |                 |                 |      h. Alas, t\n                |                 |                 |                 |                 |     hing,\\nOr t\n                |                 |                 |                 |                 |     \\nAnother t\n                |                 |                 |                 |                 |     ot deny,\\nT\n                |                 |                 |                 |                 |      him they t\n                |                 |                 |                 |                 |      pen made t\n                |                 |                 |                 |                 |     the laws\\nT\n                |                 |                 |                 |                 |     aws\\nThat t\n                |                 |                 |                 |                 |     regnant,\\nT\n                |                 |                 |                 |                 |      toop and t\n                |                 |                 |                 |                 |      t rather t\n                |                 |                 |                 |                 |      villains t\n                |                 |                 |                 |                 |      hey are, t\n                |                 |                 |                 |                 |     ESCALUS:\\nT\n                |                 |                 |                 |                 |      as\\nshe, t\n                |                 |                 |                 |                 |      ts here, t\n                |                 |                 |                 |                 |       had but t\n                |                 |                 |                 |                 |       dishes; t\n                |                 |                 |                 |                 |      ght: but t\n                |                 |                 |                 |                 |      s I say, t\n                |                 |                 |                 |                 |      ving but t\n                |                 |                 |                 |                 |      th here, t\n                |                 |                 |                 |                 |      embered, t\n                |                 |                 |                 |                 |      , unless t\n                |                 |                 |                 |                 |      ry well, t\n                |                 |                 |                 |                 |      us fool: t\n                |                 |                 |                 |                 |      ing done t\n                |                 |                 |                 |                 |     \\nVarlet, t\n                |                 |                 |                 |                 |      u liest; t\n                |                 |                 |                 |                 |      ve this, t\n                |                 |                 |                 |                 |     him\\nthat t\n                |                 |                 |                 |                 |      u seest, t\n                |                 |                 |                 |                 |      nue now, t\n                |                 |                 |                 |                 |       varlet; t\n                |                 |                 |                 |                 |     POMPHEY:\\nT\n                |                 |                 |                 |                 |      apsters: t\n                |                 |                 |                 |                 |      u hither t\n                |                 |                 |                 |                 |      you;\\nso t\n                |                 |                 |                 |                 |      opinion, t\n                |                 |                 |                 |                 |     rabs and\\nt\n                |                 |                 |                 |                 |     is jade:\\nT\n                |                 |                 |                 |                 |       chosen, t\n                |                 |                 |                 |                 |     r seven,\\nt\n                |                 |                 |                 |                 |      o'clock, t\n                |                 |                 |                 |                 |     dio;\\nBut t\n                |                 |                 |                 |                 |       itself, t\n                |                 |                 |                 |                 |     ; and he\\nT\n                |                 |                 |                 |                 |     aid,\\nAnd t\n                |                 |                 |                 |                 |     , means;\\nT\n                |                 |                 |                 |                 |     SABELLA:\\nT\n                |                 |                 |                 |                 |     d sword,\\nT\n                |                 |                 |                 |                 |     ;\\nAnd He t\n                |                 |                 |                 |                 |      at might t\n                |                 |                 |                 |                 |     offence?\\nT\n                |                 |                 |                 |                 |      en dead, t\n                |                 |                 |                 |                 |     h slept:\\nT\n                |                 |                 |                 |                 |     evil,\\nIf t\n                |                 |                 |                 |                 |      that did t\n                |                 |                 |                 |                 |      a glass, t\n                |                 |                 |                 |                 |      ey live, t\n                |                 |                 |                 |                 |      her dies t\n                |                 |                 |                 |                 |     \\nAnd he, t\n                |                 |                 |                 |                 |     xcellent\\nT\n                |                 |                 |                 |                 |      Heaven,\\nT\n                |                 |                 |                 |                 |     rled oak\\nT\n                |                 |                 |                 |                 |     oak\\nThan t\n                |                 |                 |                 |                 |       more o, t\n                |                 |                 |                 |                 |      thority, t\n                |                 |                 |                 |                 |      itself,\\nT\n                |                 |                 |                 |                 |      prayers\\nT\n                |                 |                 |                 |                 |     dedicate\\nT\n                |                 |                 |                 |                 |     or mine?\\nT\n                |                 |                 |                 |                 |     ur sense\\nT\n                |                 |                 |                 |                 |      ur evils t\n                |                 |                 |                 |                 |     e things\\nT\n                |                 |                 |                 |                 |     er live!\\nT\n                |                 |                 |                 |                 |     ove her,\\nT\n                |                 |                 |                 |                 |      g enemy, t\n                |                 |                 |                 |                 |      y, that, t\n                |                 |                 |                 |                 |     ad us on\\nT\n                |                 |                 |                 |                 |     on right\\nT\n                |                 |                 |                 |                 |      them and t\n                |                 |                 |                 |                 |       crimes, t\n                |                 |                 |                 |                 |      o think, t\n                |                 |                 |                 |                 |      he woman t\n                |                 |                 |                 |                 |     NCENTIO:\\nT\n                |                 |                 |                 |                 |     pent,\\nAs t\n                |                 |                 |                 |                 |     vil,\\nAnd t\n                |                 |                 |                 |                 |     us love,\\nT\n                |                 |                 |                 |                 |     and pray\\nT\n                |                 |                 |                 |                 |      ception. T\n                |                 |                 |                 |                 |      hy case, t\n                |                 |                 |                 |                 |     y habit,\\nW\n                |                 |                 |                 |                 |      ools and t\n                |                 |                 |                 |                 |      ! Blood, t\n                |                 |                 |                 |                 |      even so\\nT\n                |                 |                 |                 |                 |      me\\nThan t\n                |                 |                 |                 |                 |     o fitted\\nT\n                |                 |                 |                 |                 |      Ha! fie, t\n                |                 |                 |                 |                 |     ed means\\nT\n                |                 |                 |                 |                 |     e:\\nMight t\n                |                 |                 |                 |                 |     suit,\\nIf t\n                |                 |                 |                 |                 |     n prayer\\nT\n                |                 |                 |                 |                 |      ily; and t\n                |                 |                 |                 |                 |      m wishes t\n                |                 |                 |                 |                 |       it doth t\n                |                 |                 |                 |                 |     s louder\\nT\n                |                 |                 |                 |                 |     mark me;\\nT\n                |                 |                 |                 |                 |      law; and t\n                |                 |                 |                 |                 |      him, but t\n                |                 |                 |                 |                 |     our body\\nT\n                |                 |                 |                 |                 |      myself:\\nT\n                |                 |                 |                 |                 |      p myself t\n                |                 |                 |                 |                 |      eath, as t\n                |                 |                 |                 |                 |     at once,\\nT\n                |                 |                 |                 |                 |     ce,\\nThan t\n                |                 |                 |                 |                 |      cruel as t\n                |                 |                 |                 |                 |     sentence\\nT\n                |                 |                 |                 |                 |       of late t\n                |                 |                 |                 |                 |     lls out,\\nT\n                |                 |                 |                 |                 |      ven! men t\n                |                 |                 |                 |                 |      are made t\n                |                 |                 |                 |                 |     stronger\\nT\n                |                 |                 |                 |                 |     you are,\\nT\n                |                 |                 |                 |                 |     n it is,\\nT\n                |                 |                 |                 |                 |      What man t\n                |                 |                 |                 |                 |      'd name, t\n                |                 |                 |                 |                 |     erweigh,\\nT\n                |                 |                 |                 |                 |     blushes,\\nT\n                |                 |                 |                 |                 |      mouths,\\nT\n                |                 |                 |                 |                 |     ppetite,\\nT\n                |                 |                 |                 |                 |     brother:\\nT\n                |                 |                 |                 |                 |      honour.\\nT\n                |                 |                 |                 |                 |      ty heads t\n                |                 |                 |                 |                 |     llution.\\nT\n                |                 |                 |                 |                 |      his mind t\n                |                 |                 |                 |                 |       do lose t\n                |                 |                 |                 |                 |      a thing\\nT\n                |                 |                 |                 |                 |     luences,\\nT\n                |                 |                 |                 |                 |       merely, t\n                |                 |                 |                 |                 |     \\nFor him t\n                |                 |                 |                 |                 |      m still. T\n                |                 |                 |                 |                 |      aseness. T\n                |                 |                 |                 |                 |      soft and t\n                |                 |                 |                 |                 |      or worm. T\n                |                 |                 |                 |                 |     eep,\\nAnd t\n                |                 |                 |                 |                 |      no more. T\n                |                 |                 |                 |                 |     d grains\\nT\n                |                 |                 |                 |                 |      t, still t\n                |                 |                 |                 |                 |      rget'st. T\n                |                 |                 |                 |                 |     s,\\nAfter t\n                |                 |                 |                 |                 |      rt rich, t\n                |                 |                 |                 |                 |     ts bows,\\nT\n                |                 |                 |                 |                 |       unloads t\n                |                 |                 |                 |                 |     ee sire,\\nT\n                |                 |                 |                 |                 |      Do curse t\n                |                 |                 |                 |                 |      igo, and t\n                |                 |                 |                 |                 |       sooner. T\n                |                 |                 |                 |                 |     nd rich,\\nT\n                |                 |                 |                 |                 |      in this\\nT\n                |                 |                 |                 |                 |     we fear,\\nT\n                |                 |                 |                 |                 |     ank you.\\nT\n                |                 |                 |                 |                 |      leiger:\\nT\n                |                 |                 |                 |                 |     h speed;\\nT\n                |                 |                 |                 |                 |      medy as, t\n                |                 |                 |                 |                 |      a head,\\nT\n                |                 |                 |                 |                 |     ay live:\\nT\n                |                 |                 |                 |                 |      lore it, t\n                |                 |                 |                 |                 |     straint,\\nT\n                |                 |                 |                 |                 |     hou die?\\nT\n                |                 |                 |                 |                 |       beetle, t\n                |                 |                 |                 |                 |     s shame?\\nT\n                |                 |                 |                 |                 |      brother; t\n                |                 |                 |                 |                 |     ust die:\\nT\n                |                 |                 |                 |                 |      liances. T\n                |                 |                 |                 |                 |      con doth t\n                |                 |                 |                 |                 |     of hell,\\nT\n                |                 |                 |                 |                 |     rginity,\\nT\n                |                 |                 |                 |                 |     \\nOr else t\n                |                 |                 |                 |                 |      ur death t\n                |                 |                 |                 |                 |      in him,\\nT\n                |                 |                 |                 |                 |     im,\\nThat t\n                |                 |                 |                 |                 |      him bite t\n                |                 |                 |                 |                 |     t where;\\nT\n                |                 |                 |                 |                 |      to rot;\\nT\n                |                 |                 |                 |                 |      lod; and t\n                |                 |                 |                 |                 |     d spirit\\nT\n                |                 |                 |                 |                 |     bed ice;\\nT\n                |                 |                 |                 |                 |     nd about\\nT\n                |                 |                 |                 |                 |      be worse t\n                |                 |                 |                 |                 |      ncertain t\n                |                 |                 |                 |                 |     orrible!\\nT\n                |                 |                 |                 |                 |     dly life\\nT\n                |                 |                 |                 |                 |     paradise\\nT\n                |                 |                 |                 |                 |     d so far\\nT\n                |                 |                 |                 |                 |       incest, t\n                |                 |                 |                 |                 |      s blood. T\n                |                 |                 |                 |                 |      ith you: t\n                |                 |                 |                 |                 |     r\\nvirtue t\n                |                 |                 |                 |                 |      be true; t\n                |                 |                 |                 |                 |      allible: t\n                |                 |                 |                 |                 |      The hand t\n                |                 |                 |                 |                 |     ou good:\\nt\n                |                 |                 |                 |                 |     er\\nfair. T\n                |                 |                 |                 |                 |     and, but\\nt\n                |                 |                 |                 |                 |      ute, and t\n                |                 |                 |                 |                 |      he made\\nt\n                |                 |                 |                 |                 |      ou only. T\n                |                 |                 |                 |                 |      visings: t\n                |                 |                 |                 |                 |      Mariana, t\n                |                 |                 |                 |                 |     en\\nwhich t\n                |                 |                 |                 |                 |      lewoman: t\n                |                 |                 |                 |                 |      ith him, t\n                |                 |                 |                 |                 |      husband, t\n                |                 |                 |                 |                 |      in death t\n                |                 |                 |                 |                 |      is life, t\n                |                 |                 |                 |                 |      eal: and t\n                |                 |                 |                 |                 |      indness, t\n                |                 |                 |                 |                 |      , first, t\n                |                 |                 |                 |                 |      be long; t\n                |                 |                 |                 |                 |       it; and t\n                |                 |                 |                 |                 |     enience.\\nT\n                |                 |                 |                 |                 |      tainted, t\n                |                 |                 |                 |                 |      ged, and t\n                |                 |                 |                 |                 |       scaled. T\n                |                 |                 |                 |                 |      you may, t\n                |                 |                 |                 |                 |       Luke's: t\n                |                 |                 |                 |                 |       Angelo, t\n                |                 |                 |                 |                 |      usuries, t\n                |                 |                 |                 |                 |      ins too, t\n                |                 |                 |                 |                 |      signify, t\n                |                 |                 |                 |                 |     ed bawd!\\nT\n                |                 |                 |                 |                 |     be done,\\nT\n                |                 |                 |                 |                 |      hy means t\n                |                 |                 |                 |                 |     for sin,\\nT\n                |                 |                 |                 |                 |      ove his. T\n                |                 |                 |                 |                 |      warning: t\n                |                 |                 |                 |                 |      e woman, t\n                |                 |                 |                 |                 |       or how? T\n                |                 |                 |                 |                 |     O:\\nStill t\n                |                 |                 |                 |                 |      hus, and t\n                |                 |                 |                 |                 |       morsel, t\n                |                 |                 |                 |                 |       Pompey, t\n                |                 |                 |                 |                 |      bail me, t\n                |                 |                 |                 |                 |      e is he, t\n                |                 |                 |                 |                 |      d sooth, t\n                |                 |                 |                 |                 |     ut\\ndown. T\n                |                 |                 |                 |                 |     it\\ntrue, t\n                |                 |                 |                 |                 |      be made, t\n                |                 |                 |                 |                 |      m; some, t\n                |                 |                 |                 |                 |      led ice; t\n                |                 |                 |                 |                 |      erative; t\n                |                 |                 |                 |                 |      n! Would t\n                |                 |                 |                 |                 |      ice, and t\n                |                 |                 |                 |                 |      er heard t\n                |                 |                 |                 |                 |      ck-dish: t\n                |                 |                 |                 |                 |     unk too;\\nt\n                |                 |                 |                 |                 |      erstand, t\n                |                 |                 |                 |                 |     staking:\\nt\n                |                 |                 |                 |                 |     soldier.\\nT\n                |                 |                 |                 |                 |      d first: t\n                |                 |                 |                 |                 |      d again: t\n                |                 |                 |                 |                 |      cherous. T\n                |                 |                 |                 |                 |     !\\nMarry, t\n                |                 |                 |                 |                 |       for me. T\n                |                 |                 |                 |                 |       beggar, t\n                |                 |                 |                 |                 |      uble and t\n                |                 |                 |                 |                 |      me kind! T\n                |                 |                 |                 |                 |      ase you, t\n                |                 |                 |                 |                 |      country, t\n                |                 |                 |                 |                 |      one, but t\n                |                 |                 |                 |                 |      oodness, t\n                |                 |                 |                 |                 |      rtaking. T\n                |                 |                 |                 |                 |     s scarce\\nt\n                |                 |                 |                 |                 |      e world. T\n                |                 |                 |                 |                 |      r merry, t\n                |                 |                 |                 |                 |     e framed\\nt\n                |                 |                 |                 |                 |      ion, and t\n                |                 |                 |                 |                 |       severe, t\n                |                 |                 |                 |                 |     s paying\\nT\n                |                 |                 |                 |                 |     g.\\nShame t\n                |                 |                 |                 |                 |      liking!\\nT\n                |                 |                 |                 |                 |     g!\\nTwice t\n                |                 |                 |                 |                 |      Angelo,\\nT\n                |                 |                 |                 |                 |     im hide,\\nT\n                |                 |                 |                 |                 |     e times,\\nT\n                |                 |                 |                 |                 |      nd haste t\n                |                 |                 |                 |                 |      is good; t\n                |                 |                 |                 |                 |      sed here t\n                |                 |                 |                 |                 |     k'd;\\nAnd t\n                |                 |                 |                 |                 |     ed gate,\\nT\n                |                 |                 |                 |                 |     ger key:\\nT\n                |                 |                 |                 |                 |     n leads;\\nT\n                |                 |                 |                 |                 |      show me\\nT\n                |                 |                 |                 |                 |     ark;\\nAnd t\n                |                 |                 |                 |                 |     e along,\\nT\n                |                 |                 |                 |                 |     O:\\nTake, t\n                |                 |                 |                 |                 |      e, then, t\n                |                 |                 |                 |                 |     he hand,\\nW\n                |                 |                 |                 |                 |     e haste;\\nT\n                |                 |                 |                 |                 |       doings: t\n                |                 |                 |                 |                 |     ontract:\\nT\n                |                 |                 |                 |                 |       answer. T\n                |                 |                 |                 |                 |      bhorson, t\n                |                 |                 |                 |                 |      ave, but t\n                |                 |                 |                 |                 |      true man t\n                |                 |                 |                 |                 |     Claudio:\\nT\n                |                 |                 |                 |                 |      e, since t\n                |                 |                 |                 |                 |      ey will, t\n                |                 |                 |                 |                 |     e subdue\\nT\n                |                 |                 |                 |                 |      orrects, t\n                |                 |                 |                 |                 |     ous;\\nBut t\n                |                 |                 |                 |                 |     ey come.\\nT\n                |                 |                 |                 |                 |     dom when\\nT\n                |                 |                 |                 |                 |      t noise? T\n                |                 |                 |                 |                 |     th haste\\nT\n                |                 |                 |                 |                 |      t wounds t\n                |                 |                 |                 |                 |     Provost:\\nT\n                |                 |                 |                 |                 |     ontrary.\\nT\n                |                 |                 |                 |                 |      is fact, t\n                |                 |                 |                 |                 |      im anon. T\n                |                 |                 |                 |                 |      ced him. T\n                |                 |                 |                 |                 |      penalty, t\n                |                 |                 |                 |                 |      audio's, t\n                |                 |                 |                 |                 |       may add t\n                |                 |                 |                 |                 |      is, more t\n                |                 |                 |                 |                 |      fearful, t\n                |                 |                 |                 |                 |      I meant, t\n                |                 |                 |                 |                 |      not; and t\n                |                 |                 |                 |                 |       strange t\n                |                 |                 |                 |                 |     be here.\\nT\n                |                 |                 |                 |                 |      ; for he t\n                |                 |                 |                 |                 |      t. Look, t\n                |                 |                 |                 |                 |     asy\\nwhen t\n                |                 |                 |                 |                 |      zed; but t\n                |                 |                 |                 |                 |      : marry, t\n                |                 |                 |                 |                 |     ll dead.\\nT\n                |                 |                 |                 |                 |      ree-pile t\n                |                 |                 |                 |                 |     \\nbeggar. T\n                |                 |                 |                 |                 |      od, sir, t\n                |                 |                 |                 |                 |     BHORSON:\\nT\n                |                 |                 |                 |                 |      ake, and t\n                |                 |                 |                 |                 |      ook you, t\n                |                 |                 |                 |                 |      est now, t\n                |                 |                 |                 |                 |      his day, t\n                |                 |                 |                 |                 |      ust: and t\n                |                 |                 |                 |                 |     Claudio,\\nT\n                |                 |                 |                 |                 |     greeting\\nT\n                |                 |                 |                 |                 |     ngelo,--\\nT\n                |                 |                 |                 |                 |     ome,\\nAnd t\n                |                 |                 |                 |                 |     am bound\\nT\n                |                 |                 |                 |                 |     l desire\\nT\n                |                 |                 |                 |                 |     h things\\nT\n                |                 |                 |                 |                 |     er good,\\nT\n                |                 |                 |                 |                 |      Hath yet t\n                |                 |                 |                 |                 |      verity:\\nT\n                |                 |                 |                 |                 |     e gates,\\nT\n                |                 |                 |                 |                 |     s,\\nThere t\n                |                 |                 |                 |                 |      ood path t\n                |                 |                 |                 |                 |     u\\nBefore t\n                |                 |                 |                 |                 |      uke, and t\n                |                 |                 |                 |                 |      t heart; t\n                |                 |                 |                 |                 |      ne heart t\n                |                 |                 |                 |                 |       so red: t\n                |                 |                 |                 |                 |      rts; but t\n                |                 |                 |                 |                 |     :\\nFriar, t\n                |                 |                 |                 |                 |       woodman t\n                |                 |                 |                 |                 |      man than t\n                |                 |                 |                 |                 |     IO:\\nNay, t\n                |                 |                 |                 |                 |      if bawdy t\n                |                 |                 |                 |                 |      ntering, t\n                |                 |                 |                 |                 |     justice,\\nt\n                |                 |                 |                 |                 |      or that: t\n                |                 |                 |                 |                 |      nts, and t\n                |                 |                 |                 |                 |     d night.\\nT\n                |                 |                 |                 |                 |      And dull t\n                |                 |                 |                 |                 |     enforced\\nT\n                |                 |                 |                 |                 |      ight she t\n                |                 |                 |                 |                 |     nt bulk,\\nT\n                |                 |                 |                 |                 |      ome have t\n                |                 |                 |                 |                 |     ur plot.\\nT\n                |                 |                 |                 |                 |     l drift;\\nT\n                |                 |                 |                 |                 |     use,\\nAnd t\n                |                 |                 |                 |                 |      Varrius; t\n                |                 |                 |                 |                 |      ll walk. T\n                |                 |                 |                 |                 |      uth; but t\n                |                 |                 |                 |                 |      him so,\\nT\n                |                 |                 |                 |                 |      He says, t\n                |                 |                 |                 |                 |      ass you. T\n                |                 |                 |                 |                 |     sounded;\\nT\n                |                 |                 |                 |                 |      ntering: t\n                |                 |                 |                 |                 |      justice, t\n                |                 |                 |                 |                 |     rong it,\\nT\n                |                 |                 |                 |                 |      ect see, t\n                |                 |                 |                 |                 |     \\nFavours t\n                |                 |                 |                 |                 |     r object\\nT\n                |                 |                 |                 |                 |     I speak:\\nT\n                |                 |                 |                 |                 |     strange?\\nT\n                |                 |                 |                 |                 |     elo\\nThan t\n                |                 |                 |                 |                 |      thee, as t\n                |                 |                 |                 |                 |     elievest\\nT\n                |                 |                 |                 |                 |     ld,\\nThat t\n                |                 |                 |                 |                 |      But one, t\n                |                 |                 |                 |                 |      haracts, t\n                |                 |                 |                 |                 |      And hide t\n                |                 |                 |                 |                 |     Lucio\\nAs t\n                |                 |                 |                 |                 |     \\nAs then t\n                |                 |                 |                 |                 |      you now, t\n                |                 |                 |                 |                 |      ourself; t\n                |                 |                 |                 |                 |     he wrong\\nT\n                |                 |                 |                 |                 |     rdon it;\\nT\n                |                 |                 |                 |                 |      d again. T\n                |                 |                 |                 |                 |      n brief, t\n                |                 |                 |                 |                 |      nd shame t\n                |                 |                 |                 |                 |     ste body\\nT\n                |                 |                 |                 |                 |     ELLA:\\nO, t\n                |                 |                 |                 |                 |     e advice\\nT\n                |                 |                 |                 |                 |     his all?\\nT\n                |                 |                 |                 |                 |     e,\\nAs I, t\n                |                 |                 |                 |                 |     officer!\\nT\n                |                 |                 |                 |                 |      near us? T\n                |                 |                 |                 |                 |     ike!\\nAnd t\n                |                 |                 |                 |                 |      dge that t\n                |                 |                 |                 |                 |      hither,\\nT\n                |                 |                 |                 |                 |     s woman.\\nT\n                |                 |                 |                 |                 |       justify t\n                |                 |                 |                 |                 |      A widow, t\n                |                 |                 |                 |                 |     \\nSilence t\n                |                 |                 |                 |                 |      e, would t\n                |                 |                 |                 |                 |      she more t\n                |                 |                 |                 |                 |      unmask.\\nT\n                |                 |                 |                 |                 |      at face, t\n                |                 |                 |                 |                 |      ich once t\n                |                 |                 |                 |                 |     king on;\\nT\n                |                 |                 |                 |                 |      n thine; t\n                |                 |                 |                 |                 |     the body\\nT\n                |                 |                 |                 |                 |     ody\\nThat t\n                |                 |                 |                 |                 |      d supply t\n                |                 |                 |                 |                 |      rs since t\n                |                 |                 |                 |                 |     ince,\\nAs t\n                |                 |                 |                 |                 |      ruth and t\n                |                 |                 |                 |                 |      ut smile t\n                |                 |                 |                 |                 |     leasure.\\nT\n                |                 |                 |                 |                 |      iar, and t\n                |                 |                 |                 |                 |      's gone, t\n                |                 |                 |                 |                 |     y oaths,\\nT\n                |                 |                 |                 |                 |     d credit\\nT\n                |                 |                 |                 |                 |     nd pains\\nT\n                |                 |                 |                 |                 |     derived.\\nT\n                |                 |                 |                 |                 |      ide here t\n                |                 |                 |                 |                 |      o darkly t\n                |                 |                 |                 |                 |      u to him t\n                |                 |                 |                 |                 |     ke gone?\\nT\n                |                 |                 |                 |                 |      one too. T\n                |                 |                 |                 |                 |      unjust,\\nT\n                |                 |                 |                 |                 |     st,\\nThus t\n                |                 |                 |                 |                 |       rascal; t\n                |                 |                 |                 |                 |     per ear,\\nT\n                |                 |                 |                 |                 |      ain? and t\n                |                 |                 |                 |                 |     from him\\nT\n                |                 |                 |                 |                 |     justice?\\nT\n                |                 |                 |                 |                 |      m hence; t\n                |                 |                 |                 |                 |       so hot; t\n                |                 |                 |                 |                 |       stretch t\n                |                 |                 |                 |                 |     d bubble\\nT\n                |                 |                 |                 |                 |      enanced, t\n                |                 |                 |                 |                 |     \\nSlander t\n                |                 |                 |                 |                 |     an hour!\\nW\n                |                 |                 |                 |                 |      ve worse t\n                |                 |                 |                 |                 |     ltiness,\\nT\n                |                 |                 |                 |                 |       passes. T\n                |                 |                 |                 |                 |      pardon,\\nT\n                |                 |                 |                 |                 |     came on,\\nT\n                |                 |                 |                 |                 |     ith him!\\nT\n                |                 |                 |                 |                 |     g death,\\nT\n                |                 |                 |                 |                 |     th,\\nThan t\n                |                 |                 |                 |                 |      ch lives t\n                |                 |                 |                 |                 |     e-breach\\nT\n                |                 |                 |                 |                 |      life,--\\nT\n                |                 |                 |                 |                 |     MEASURE.\\nT\n                |                 |                 |                 |                 |       stoop'd t\n                |                 |                 |                 |                 |      withal,\\nT\n                |                 |                 |                 |                 |       Isabel, t\n                |                 |                 |                 |                 |     eak,\\nAnd t\n                |                 |                 |                 |                 |     eak all.\\nT\n                |                 |                 |                 |                 |      I partly t\n                |                 |                 |                 |                 |     s deeds,\\nT\n                |                 |                 |                 |                 |      the way: t\n                |                 |                 |                 |                 |      prison,\\nT\n                |                 |                 |                 |                 |     nt heart\\nT\n                |                 |                 |                 |                 |     \\nSirrah, t\n                |                 |                 |                 |                 |     rn soul.\\nT\n                |                 |                 |                 |                 |      cording. T\n                |                 |                 |                 |                 |      eave him t\n                |                 |                 |                 |                 |      rry her: t\n                |                 |                 |                 |                 |     rry her.\\nT\n                |                 |                 |                 |                 |      ive; and t\n                |                 |                 |                 |                 |      orfeits. T\n                |                 |                 |                 |                 |      Claudio, t\n                |                 |                 |                 |                 |      virtue.\\nT\n                |                 |                 |                 |                 |     oodness:\\nT\n                |                 |                 |                 |                 |     atulate.\\nT\n                |                 |                 |                 |                 |     audio's:\\nT\n                |                 |                 |                 |                 |       behind, t\n                |                 |                 |                 |                 |      baggage: t\n                |                 |                 |                 |                 |     nqueror.\\nT\n                |                 |                 |                 |                 |   h.\\n\\nSLY:\\nT\n                |                 |                 |                 |                 |      ge thee, t\n                |                 |                 |                 |                 |      erriman, t\n                |                 |                 |                 |                 |      nd twice t\n                |                 |                 |                 |                 |     t scent:\\nT\n                |                 |                 |                 |                 |   .\\n\\nLord:\\nT\n                |                 |                 |                 |                 |     hem all:\\nT\n                |                 |                 |                 |                 |     ith ale,\\nT\n                |                 |                 |                 |                 |     s fancy.\\nT\n                |                 |                 |                 |                 |     cy.\\nThen t\n                |                 |                 |                 |                 |     e wakes,\\nT\n                |                 |                 |                 |                 |      he ewer, t\n                |                 |                 |                 |                 |     rse,\\nAnd t\n                |                 |                 |                 |                 |     ty lord.\\nT\n                |                 |                 |                 |                 |      ntly and t\n                |                 |                 |                 |                 |     t means,\\nT\n                |                 |                 |                 |                 |      journey, t\n                |                 |                 |                 |                 |      players\\nT\n                |                 |                 |                 |                 |      y heart. T\n                |                 |                 |                 |                 |      t, sure, t\n                |                 |                 |                 |                 |      ry true: t\n                |                 |                 |                 |                 |     py time;\\nT\n                |                 |                 |                 |                 |     me much.\\nT\n                |                 |                 |                 |                 |      a lady:\\nT\n                |                 |                 |                 |                 |     eisance.\\nT\n                |                 |                 |                 |                 |     ve?'\\nAnd t\n                |                 |                 |                 |                 |      cements, t\n                |                 |                 |                 |                 |      him shed t\n                |                 |                 |                 |                 |     verjoy'd\\nT\n                |                 |                 |                 |                 |     n's gift\\nT\n                |                 |                 |                 |                 |     ter\\nWhen t\n                |                 |                 |                 |                 |      o homage t\n                |                 |                 |                 |                 |      re shoes t\n                |                 |                 |                 |                 |      en cease t\n                |                 |                 |                 |                 |     nour!\\nO, t\n                |                 |                 |                 |                 |       Hacket, t\n                |                 |                 |                 |                 |     vant:\\nO, t\n                |                 |                 |                 |                 |      sh hence t\n                |                 |                 |                 |                 |     ays,\\nAnd t\n                |                 |                 |                 |                 |     trapp'd,\\nT\n                |                 |                 |                 |                 |      hawking? t\n                |                 |                 |                 |                 |     ou hunt?\\nT\n                |                 |                 |                 |                 |       course; t\n                |                 |                 |                 |                 |      her legs t\n                |                 |                 |                 |                 |      lood and t\n                |                 |                 |                 |                 |      a lord:\\nT\n                |                 |                 |                 |                 |     ant:\\nAnd t\n                |                 |                 |                 |                 |      eel soft t\n                |                 |                 |                 |                 |     ored!\\nO, t\n                |                 |                 |                 |                 |     you are!\\nT\n                |                 |                 |                 |                 |   t.\\n\\nSLY:\\nT\n                |                 |                 |                 |                 |     SLY:\\nAy, t\n                |                 |                 |                 |                 |     nell\\nAnd t\n                |                 |                 |                 |                 |      nk thee: t\n                |                 |                 |                 |                 |      am wife, t\n                |                 |                 |                 |                 |   .\\n\\nPage:\\nT\n                |                 |                 |                 |                 |     t of you\\nT\n                |                 |                 |                 |                 |      malady,\\nT\n                |                 |                 |                 |                 |      lesh and t\n                |                 |                 |                 |                 |      frenzy:\\nT\n                |                 |                 |                 |                 |      our mind t\n                |                 |                 |                 |                 |     UCENTIO:\\nT\n                |                 |                 |                 |                 |     re I had\\nT\n                |                 |                 |                 |                 |     ombardy,\\nT\n                |                 |                 |                 |                 |      will and t\n                |                 |                 |                 |                 |     nceived,\\nT\n                |                 |                 |                 |                 |     eds:\\nAnd t\n                |                 |                 |                 |                 |      rtue and t\n                |                 |                 |                 |                 |      ply that t\n                |                 |                 |                 |                 |     chieved.\\nT\n                |                 |                 |                 |                 |      ow plash t\n                |                 |                 |                 |                 |     o admire\\nT\n                |                 |                 |                 |                 |      o devote t\n                |                 |                 |                 |                 |      aintance t\n                |                 |                 |                 |                 |     ken you;\\nT\n                |                 |                 |                 |                 |      ondello, t\n                |                 |                 |                 |                 |     ess,\\nAnd t\n                |                 |                 |                 |                 |     ou know;\\nT\n                |                 |                 |                 |                 |     our will\\nT\n                |                 |                 |                 |                 |     hould be\\nT\n                |                 |                 |                 |                 |     :\\nAnd me t\n                |                 |                 |                 |                 |      toward:\\nT\n                |                 |                 |                 |                 |      ntlemen, t\n                |                 |                 |                 |                 |     nt.\\nSir, t\n                |                 |                 |                 |                 |      liberal\\nT\n                |                 |                 |                 |                 |      ours; as t\n                |                 |                 |                 |                 |      old you. T\n                |                 |                 |                 |                 |      I pray.\\nT\n                |                 |                 |                 |                 |     .\\nThough t\n                |                 |                 |                 |                 |     us both,\\nt\n                |                 |                 |                 |                 |      a devil. T\n                |                 |                 |                 |                 |      rtensio, t\n                |                 |                 |                 |                 |     RTENSIO:\\nT\n                |                 |                 |                 |                 |       Gremio, t\n                |                 |                 |                 |                 |     and mine\\nt\n                |                 |                 |                 |                 |      hy, man, t\n                |                 |                 |                 |                 |     m,\\nwould t\n                |                 |                 |                 |                 |      ndition, t\n                |                 |                 |                 |                 |      you say, t\n                |                 |                 |                 |                 |      e; since t\n                |                 |                 |                 |                 |     and,\\nand t\n                |                 |                 |                 |                 |       and rid t\n                |                 |                 |                 |                 |      ay, sir, t\n                |                 |                 |                 |                 |       Tranio, t\n                |                 |                 |                 |                 |     \\nI found t\n                |                 |                 |                 |                 |     age was,\\nT\n                |                 |                 |                 |                 |      forward; t\n                |                 |                 |                 |                 |     ontents:\\nT\n                |                 |                 |                 |                 |     nor had,\\nT\n                |                 |                 |                 |                 |      eve her. T\n                |                 |                 |                 |                 |     d shrewd\\nT\n                |                 |                 |                 |                 |     ewd\\nThat t\n                |                 |                 |                 |                 |     ome;\\nAnd t\n                |                 |                 |                 |                 |     he maid:\\nT\n                |                 |                 |                 |                 |       master; t\n                |                 |                 |                 |                 |     ws thus;\\nT\n                |                 |                 |                 |                 |     e\\nUncase t\n                |                 |                 |                 |                 |      se thee; t\n                |                 |                 |                 |                 |      a slave, t\n                |                 |                 |                 |                 |      io here, t\n                |                 |                 |                 |                 |     r mouth:\\nT\n                |                 |                 |                 |                 |     ONDELLO:\\nT\n                |                 |                 |                 |                 |      th, boy, t\n                |                 |                 |                 |                 |     h after,\\nT\n                |                 |                 |                 |                 |      e rests, t\n                |                 |                 |                 |                 |      execute, t\n                |                 |                 |                 |                 |     y leave,\\nT\n                |                 |                 |                 |                 |     t I see,\\nt\n                |                 |                 |                 |                 |      om would t\n                |                 |                 |                 |                 |      ancient, t\n                |                 |                 |                 |                 |     mio.\\nAnd t\n                |                 |                 |                 |                 |      oung men t\n                |                 |                 |                 |                 |      wive and t\n                |                 |                 |                 |                 |     'd wife?\\nT\n                |                 |                 |                 |                 |      ice; and t\n                |                 |                 |                 |                 |      althily, t\n                |                 |                 |                 |                 |      er head, t\n                |                 |                 |                 |                 |      ult, and t\n                |                 |                 |                 |                 |      measure\\nT\n                |                 |                 |                 |                 |      effect:\\nT\n                |                 |                 |                 |                 |      ard her, t\n                |                 |                 |                 |                 |      loud\\nAs t\n                |                 |                 |                 |                 |      der when t\n                |                 |                 |                 |                 |     with you\\nT\n                |                 |                 |                 |                 |     ble,\\nFor t\n                |                 |                 |                 |                 |     hearsed,\\nT\n                |                 |                 |                 |                 |     e woo'd;\\nT\n                |                 |                 |                 |                 |     a ta'en,\\nT\n                |                 |                 |                 |                 |     er robes\\nT\n                |                 |                 |                 |                 |      n music, t\n                |                 |                 |                 |                 |      Bianca;\\nT\n                |                 |                 |                 |                 |     lks,\\nhow t\n                |                 |                 |                 |                 |      largess. T\n                |                 |                 |                 |                 |     ul words\\nT\n                |                 |                 |                 |                 |     rtensio.\\nT\n                |                 |                 |                 |                 |      m going? T\n                |                 |                 |                 |                 |      musician t\n                |                 |                 |                 |                 |      in duty\\nT\n                |                 |                 |                 |                 |     MIO:\\nAnd t\n                |                 |                 |                 |                 |      Yea, and t\n                |                 |                 |                 |                 |     cold:\\nIf t\n                |                 |                 |                 |                 |      stomach, t\n                |                 |                 |                 |                 |      intent?\\nT\n                |                 |                 |                 |                 |      eds, and t\n                |                 |                 |                 |                 |      tongue,\\nT\n                |                 |                 |                 |                 |     's fire?\\nT\n                |                 |                 |                 |                 |     e?\\nTush, t\n                |                 |                 |                 |                 |     o, hark:\\nT\n                |                 |                 |                 |                 |     be bold,\\nT\n                |                 |                 |                 |                 |     iest way\\nT\n                |                 |                 |                 |                 |     ll know,\\nT\n                |                 |                 |                 |                 |     n,\\nDo me t\n                |                 |                 |                 |                 |      wooers;\\nT\n                |                 |                 |                 |                 |     ake one,\\nT\n                |                 |                 |                 |                 |     ath two,\\nT\n                |                 |                 |                 |                 |      ir, sir, t\n                |                 |                 |                 |                 |     n sooth:\\nT\n                |                 |                 |                 |                 |      be wed:\\nT\n                |                 |                 |                 |                 |     ourself,\\nT\n                |                 |                 |                 |                 |     e of me;\\nT\n                |                 |                 |                 |                 |      raiment, t\n                |                 |                 |                 |                 |     ell\\nWhom t\n                |                 |                 |                 |                 |      ncy more t\n                |                 |                 |                 |                 |     \\nMinion, t\n                |                 |                 |                 |                 |      be jest, t\n                |                 |                 |                 |                 |      r shame, t\n                |                 |                 |                 |                 |     ng thee?\\nW\n                |                 |                 |                 |                 |     na, sir,\\nT\n                |                 |                 |                 |                 |      r house, t\n                |                 |                 |                 |                 |     ematics,\\nT\n                |                 |                 |                 |                 |      tharina, t\n                |                 |                 |                 |                 |      ur turn, t\n                |                 |                 |                 |                 |     \\nLet us, t\n                |                 |                 |                 |                 |      ighbour, t\n                |                 |                 |                 |                 |      e of it. T\n                |                 |                 |                 |                 |      myself,\\nt\n                |                 |                 |                 |                 |     scholar,\\nt\n                |                 |                 |                 |                 |      ages, as t\n                |                 |                 |                 |                 |       so bold t\n                |                 |                 |                 |                 |      me, sir, t\n                |                 |                 |                 |                 |     ine own,\\nT\n                |                 |                 |                 |                 |      sister.\\nT\n                |                 |                 |                 |                 |     request,\\nT\n                |                 |                 |                 |                 |     st:\\nAnd, t\n                |                 |                 |                 |                 |     ent,\\nAnd t\n                |                 |                 |                 |                 |      em, then t\n                |                 |                 |                 |                 |     me, sir,\\nT\n                |                 |                 |                 |                 |     ard,\\nAnd t\n                |                 |                 |                 |                 |     creased:\\nT\n                |                 |                 |                 |                 |     ed:\\nThen t\n                |                 |                 |                 |                 |      my death t\n                |                 |                 |                 |                 |     ween us,\\nT\n                |                 |                 |                 |                 |      Ay, when t\n                |                 |                 |                 |                 |     btain'd,\\nT\n                |                 |                 |                 |                 |     HIO:\\nAy, t\n                |                 |                 |                 |                 |     r winds,\\nT\n                |                 |                 |                 |                 |      ake not, t\n                |                 |                 |                 |                 |       did but t\n                |                 |                 |                 |                 |      her hand t\n                |                 |                 |                 |                 |     ead,\\nAnd t\n                |                 |                 |                 |                 |     way;\\nAnd t\n                |                 |                 |                 |                 |     he lute;\\nW\n                |                 |                 |                 |                 |     dler\\nAnd t\n                |                 |                 |                 |                 |      uch vile t\n                |                 |                 |                 |                 |      earn and t\n                |                 |                 |                 |                 |      a word;\\nT\n                |                 |                 |                 |                 |     anks,\\nAs t\n                |                 |                 |                 |                 |     hearing:\\nT\n                |                 |                 |                 |                 |      ut Kate, t\n                |                 |                 |                 |                 |      tes, and t\n                |                 |                 |                 |                 |     e, Kate,\\nT\n                |                 |                 |                 |                 |     ry town,\\nT\n                |                 |                 |                 |                 |       of, and t\n                |                 |                 |                 |                 |      d to woo t\n                |                 |                 |                 |                 |     THARINA:\\nT\n                |                 |                 |                 |                 |      is then, t\n                |                 |                 |                 |                 |      rab; and t\n                |                 |                 |                 |                 |      here is, t\n                |                 |                 |                 |                 |     flowers:\\nT\n                |                 |                 |                 |                 |      t frown, t\n                |                 |                 |                 |                 |     alk,\\nBut t\n                |                 |                 |                 |                 |      Why does t\n                |                 |                 |                 |                 |      ee walk: t\n                |                 |                 |                 |                 |      and whom t\n                |                 |                 |                 |                 |     ate;\\nAnd t\n                |                 |                 |                 |                 |     bed:\\nAnd t\n                |                 |                 |                 |                 |     onsented\\nT\n                |                 |                 |                 |                 |       beauty, t\n                |                 |                 |                 |                 |     ee well,\\nT\n                |                 |                 |                 |                 |      regard,\\nT\n                |                 |                 |                 |                 |     ng Jack,\\nT\n                |                 |                 |                 |                 |      th oaths t\n                |                 |                 |                 |                 |      hot, but t\n                |                 |                 |                 |                 |     ogether,\\nT\n                |                 |                 |                 |                 |     g alone,\\nT\n                |                 |                 |                 |                 |     on oath,\\nT\n                |                 |                 |                 |                 |     see,\\nHow t\n                |                 |                 |                 |                 |      Venice,\\nT\n                |                 |                 |                 |                 |      ings and t\n                |                 |                 |                 |                 |     APTISTA:\\nT\n                |                 |                 |                 |                 |      aptists, t\n                |                 |                 |                 |                 |      ungling, t\n                |                 |                 |                 |                 |      aybeard, t\n                |                 |                 |                 |                 |      of both\\nT\n                |                 |                 |                 |                 |      apparel, t\n                |                 |                 |                 |                 |      keeping: t\n                |                 |                 |                 |                 |    \\nGREMIO:\\nT\n                |                 |                 |                 |                 |      in all:\\nT\n                |                 |                 |                 |                 |     n argosy\\nT\n                |                 |                 |                 |                 |     ses,\\nAnd t\n                |                 |                 |                 |                 |      galleys: t\n                |                 |                 |                 |                 |      ave, and t\n                |                 |                 |                 |                 |      y table: t\n                |                 |                 |                 |                 |     io;'\\nAnd t\n                |                 |                 |                 |                 |       pedant, t\n                |                 |                 |                 |                 |     harmony:\\nT\n                |                 |                 |                 |                 |      ous ass, t\n                |                 |                 |                 |                 |       refresh t\n                |                 |                 |                 |                 |     al pain?\\nT\n                |                 |                 |                 |                 |     e wrong,\\nT\n                |                 |                 |                 |                 |     lf.\\nAnd, t\n                |                 |                 |                 |                 |     we down:\\nT\n                |                 |                 |                 |                 |      e never: t\n                |                 |                 |                 |                 |      at,' and t\n                |                 |                 |                 |                 |      Lucentio t\n                |                 |                 |                 |                 |     \\nAll but t\n                |                 |                 |                 |                 |      my life, t\n                |                 |                 |                 |                 |      , Licio, t\n                |                 |                 |                 |                 |      masters, t\n                |                 |                 |                 |                 |     y, pray,\\nT\n                |                 |                 |                 |                 |     trument,\\nT\n                |                 |                 |                 |                 |      of art;\\nT\n                |                 |                 |                 |                 |     fectual,\\nT\n                |                 |                 |                 |                 |     ade:\\nAnd t\n                |                 |                 |                 |                 |      istress, t\n                |                 |                 |                 |                 |      looks as t\n                |                 |                 |                 |                 |     e forced\\nT\n                |                 |                 |                 |                 |      nd means t\n                |                 |                 |                 |                 |     or:\\nAnd, t\n                |                 |                 |                 |                 |     is word:\\nT\n                |                 |                 |                 |                 |     ng wise;\\nT\n                |                 |                 |                 |                 |      ot news, t\n                |                 |                 |                 |                 |      breeches t\n                |                 |                 |                 |                 |      s thrice t\n                |                 |                 |                 |                 |      of boots t\n                |                 |                 |                 |                 |      e chine; t\n                |                 |                 |                 |                 |     STA:\\nAy, t\n                |                 |                 |                 |                 |       sadder, t\n                |                 |                 |                 |                 |      ie, doff t\n                |                 |                 |                 |                 |      t, shame t\n                |                 |                 |                 |                 |      eye-sore t\n                |                 |                 |                 |                 |     NIO:\\nAnd t\n                |                 |                 |                 |                 |      nd harsh t\n                |                 |                 |                 |                 |     my word,\\nT\n                |                 |                 |                 |                 |     rom her:\\nT\n                |                 |                 |                 |                 |      ieve me: t\n                |                 |                 |                 |                 |      th, even t\n                |                 |                 |                 |                 |      en thus; t\n                |                 |                 |                 |                 |     h words:\\nT\n                |                 |                 |                 |                 |     ossible,\\nT\n                |                 |                 |                 |                 |     NIO:\\nBut t\n                |                 |                 |                 |                 |      g: which t\n                |                 |                 |                 |                 |      ethinks, t\n                |                 |                 |                 |                 |      er-reach t\n                |                 |                 |                 |                 |      Gremio,\\nT\n                |                 |                 |                 |                 |      Minola,\\nT\n                |                 |                 |                 |                 |      oom, and t\n                |                 |                 |                 |                 |      a devil, t\n                |                 |                 |                 |                 |     so loud,\\nT\n                |                 |                 |                 |                 |      -amazed, t\n                |                 |                 |                 |                 |     e it up,\\nT\n                |                 |                 |                 |                 |     st:\\n'Now t\n                |                 |                 |                 |                 |     adel\\nAnd t\n                |                 |                 |                 |                 |     ason\\nBut t\n                |                 |                 |                 |                 |     rinking.\\nT\n                |                 |                 |                 |                 |     us smack\\nT\n                |                 |                 |                 |                 |      Ay, sir, t\n                |                 |                 |                 |                 |      e ready: t\n                |                 |                 |                 |                 |     NA:\\nNay, t\n                |                 |                 |                 |                 |      row, not t\n                |                 |                 |                 |                 |      myself.\\nT\n                |                 |                 |                 |                 |     y groom,\\nT\n                |                 |                 |                 |                 |     om,\\nThat t\n                |                 |                 |                 |                 |       stands, t\n                |                 |                 |                 |                 |      t wench, t\n                |                 |                 |                 |                 |    \\nBIANCA:\\nT\n                |                 |                 |                 |                 |      o supply t\n                |                 |                 |                 |                 |      l supply t\n                |                 |                 |                 |                 |      ller man t\n                |                 |                 |                 |                 |      oubt it, t\n                |                 |                 |                 |                 |      shoulder t\n                |                 |                 |                 |                 |       ay: and t\n                |                 |                 |                 |                 |      st: but, t\n                |                 |                 |                 |                 |      Am I but t\n                |                 |                 |                 |                 |      at hand, t\n                |                 |                 |                 |                 |     on\\nfeel, t\n                |                 |                 |                 |                 |       Grumio, t\n                |                 |                 |                 |                 |      fice but t\n                |                 |                 |                 |                 |     ine; and\\nt\n                |                 |                 |                 |                 |    \\nCURTIS:\\nT\n                |                 |                 |                 |                 |      ady; and t\n                |                 |                 |                 |                 |      r ready, t\n                |                 |                 |                 |                 |      s swept; t\n                |                 |                 |                 |                 |      fustian, t\n                |                 |                 |                 |                 |       within, t\n                |                 |                 |                 |                 |     without,\\nt\n                |                 |                 |                 |                 |      irt; and t\n                |                 |                 |                 |                 |    \\nGRUMIO:\\nT\n                |                 |                 |                 |                 |      ale, not t\n                |                 |                 |                 |                 |      ale: and t\n                |                 |                 |                 |                 |     ssed me,\\nt\n                |                 |                 |                 |                 |      r horse; t\n                |                 |                 |                 |                 |      prayed,\\nt\n                |                 |                 |                 |                 |      ied, how t\n                |                 |                 |                 |                 |     \\nAy; and t\n                |                 |                 |                 |                 |      rsop and t\n                |                 |                 |                 |                 |      shed and t\n                |                 |                 |                 |                 |      t seems, t\n                |                 |                 |                 |                 |      ou;--and t\n                |                 |                 |                 |                 |      at door\\nT\n                |                 |                 |                 |                 |      grooms!\\nW\n                |                 |                 |                 |                 |     no duty?\\nW\n                |                 |                 |                 |                 |     he heel;\\nT\n                |                 |                 |                 |                 |     eathing:\\nT\n                |                 |                 |                 |                 |     Gregory;\\nT\n                |                 |                 |                 |                 |     ot awry:\\nT\n                |                 |                 |                 |                 |     hat, ho!\\nW\n                |                 |                 |                 |                 |      e, Kate, t\n                |                 |                 |                 |                 |      it not?\\nT\n                |                 |                 |                 |                 |     isquiet:\\nT\n                |                 |                 |                 |                 |     holeric,\\nT\n                |                 |                 |                 |                 |      patient; t\n                |                 |                 |                 |                 |      d rates, t\n                |                 |                 |                 |                 |      o stand, t\n                |                 |                 |                 |                 |      to look, t\n                |                 |                 |                 |                 |     pty;\\nAnd t\n                |                 |                 |                 |                 |     ged,\\nFor t\n                |                 |                 |                 |                 |     haggard,\\nT\n                |                 |                 |                 |                 |     's call,\\nT\n                |                 |                 |                 |                 |      That is, t\n                |                 |                 |                 |                 |       pillow, t\n                |                 |                 |                 |                 |     bolster,\\nT\n                |                 |                 |                 |                 |     l awake.\\nT\n                |                 |                 |                 |                 |     ess;\\nAnd t\n                |                 |                 |                 |                 |      d Licio, t\n                |                 |                 |                 |                 |      profess, t\n                |                 |                 |                 |                 |      See, how t\n                |                 |                 |                 |                 |      favours\\nT\n                |                 |                 |                 |                 |      'longeth t\n                |                 |                 |                 |                 |     dow now,\\nT\n                |                 |                 |                 |                 |      master;\\nT\n                |                 |                 |                 |                 |     er;\\nThat t\n                |                 |                 |                 |                 |     ty long,\\nT\n                |                 |                 |                 |                 |      so long\\nT\n                |                 |                 |                 |                 |      lous and t\n                |                 |                 |                 |                 |      ssurance t\n                |                 |                 |                 |                 |      ove, and t\n                |                 |                 |                 |                 |     welcome.\\nT\n                |                 |                 |                 |                 |     two:\\nBut t\n                |                 |                 |                 |                 |     n Mantua\\nT\n                |                 |                 |                 |                 |      vel, but t\n                |                 |                 |                 |                 |      ll, sir, t\n                |                 |                 |                 |                 |     ourtesy,\\nT\n                |                 |                 |                 |                 |      d, sooth t\n                |                 |                 |                 |                 |     tremity,\\nT\n                |                 |                 |                 |                 |     ake;\\nAnd t\n                |                 |                 |                 |                 |     er good.\\nT\n                |                 |                 |                 |                 |     ery day,\\nT\n                |                 |                 |                 |                 |      y wrong, t\n                |                 |                 |                 |                 |      Beggars, t\n                |                 |                 |                 |                 |     fed:\\nAnd t\n                |                 |                 |                 |                 |      hy then, t\n                |                 |                 |                 |                 |      ee gone, t\n                |                 |                 |                 |                 |     g slave,\\nT\n                |                 |                 |                 |                 |      of you,\\nT\n                |                 |                 |                 |                 |     ou,\\nThat t\n                |                 |                 |                 |                 |      re love; t\n                |                 |                 |                 |                 |      et Kate, t\n                |                 |                 |                 |                 |     f.\\nHere, t\n                |                 |                 |                 |                 |       bigger: t\n                |                 |                 |                 |                 |      have one t\n                |                 |                 |                 |                 |      's name, t\n                |                 |                 |                 |                 |      hion and t\n                |                 |                 |                 |                 |      rogance! T\n                |                 |                 |                 |                 |      u liest, t\n                |                 |                 |                 |                 |      thread,\\nt\n                |                 |                 |                 |                 |     thimble,\\nT\n                |                 |                 |                 |                 |      ou yard, t\n                |                 |                 |                 |                 |     r, nail!\\nT\n                |                 |                 |                 |                 |      ou flea, t\n                |                 |                 |                 |                 |      hou nit, t\n                |                 |                 |                 |                 |     d?\\nAway, t\n                |                 |                 |                 |                 |      hou rag, t\n                |                 |                 |                 |                 |      uantity, t\n                |                 |                 |                 |                 |      yard\\nAs t\n                |                 |                 |                 |                 |      thee, I, t\n                |                 |                 |                 |                 |      eceived; t\n                |                 |                 |                 |                 |      edle and t\n                |                 |                 |                 |                 |       not me: t\n                |                 |                 |                 |                 |      s: ergo, t\n                |                 |                 |                 |                 |       fashion t\n                |                 |                 |                 |                 |      ain; and t\n                |                 |                 |                 |                 |     on thee,\\nt\n                |                 |                 |                 |                 |    \\nTailor:\\nT\n                |                 |                 |                 |                 |      e where, t\n                |                 |                 |                 |                 |      traight: t\n                |                 |                 |                 |                 |       Grumio! t\n                |                 |                 |                 |                 |      hy life: t\n                |                 |                 |                 |                 |     \\nO, sir, t\n                |                 |                 |                 |                 |     ink for:\\nT\n                |                 |                 |                 |                 |     omorrow:\\nT\n                |                 |                 |                 |                 |     t habit.\\nW\n                |                 |                 |                 |                 |      ous than t\n                |                 |                 |                 |                 |     rthwith,\\nT\n                |                 |                 |                 |                 |     ane end;\\nT\n                |                 |                 |                 |                 |      unt, and t\n                |                 |                 |                 |                 |     ice,\\nAnd t\n                |                 |                 |                 |                 |      hee that t\n                |                 |                 |                 |                 |     et.\\nSir, t\n                |                 |                 |                 |                 |      d father t\n                |                 |                 |                 |                 |       beareth t\n                |                 |                 |                 |                 |     \\nAnd she t\n                |                 |                 |                 |                 |       to him, t\n                |                 |                 |                 |                 |     's care,\\nT\n                |                 |                 |                 |                 |      No worse t\n                |                 |                 |                 |                 |     l.\\nRight t\n                |                 |                 |                 |                 |     ons:\\nAnd t\n                |                 |                 |                 |                 |     an this,\\nT\n                |                 |                 |                 |                 |     t dower,\\nT\n                |                 |                 |                 |                 |     ike you:\\nT\n                |                 |                 |                 |                 |      lie; and t\n                |                 |                 |                 |                 |      d there, t\n                |                 |                 |                 |                 |     esently.\\nT\n                |                 |                 |                 |                 |      is this, t\n                |                 |                 |                 |                 |      igns and t\n                |                 |                 |                 |                 |     LO:\\nThen t\n                |                 |                 |                 |                 |      is safe, t\n                |                 |                 |                 |                 |      surance: t\n                |                 |                 |                 |                 |       solum:' t\n                |                 |                 |                 |                 |     \\nchurch; t\n                |                 |                 |                 |                 |     \\nLuke's, t\n                |                 |                 |                 |                 |      pleased; t\n                |                 |                 |                 |                 |      he moon! t\n                |                 |                 |                 |                 |      son, and t\n                |                 |                 |                 |                 |       journey t\n                |                 |                 |                 |                 |     not;\\nAnd t\n                |                 |                 |                 |                 |      hy ways; t\n                |                 |                 |                 |                 |      forward! t\n                |                 |                 |                 |                 |      rd! thus t\n                |                 |                 |                 |                 |     re away?\\nT\n                |                 |                 |                 |                 |      ate, and t\n                |                 |                 |                 |                 |     auty,\\nAs t\n                |                 |                 |                 |                 |      man mad, t\n                |                 |                 |                 |                 |     not mad:\\nT\n                |                 |                 |                 |                 |     ng eyes,\\nT\n                |                 |                 |                 |                 |     istress,\\nT\n                |                 |                 |                 |                 |      o Padua; t\n                |                 |                 |                 |                 |      my wife, t\n                |                 |                 |                 |                 |     lewoman,\\nT\n                |                 |                 |                 |                 |      vellers, t\n                |                 |                 |                 |                 |      truchio, t\n                |                 |                 |                 |                 |     froward,\\nT\n                |                 |                 |                 |                 |      llo: but t\n                |                 |                 |                 |                 |      at home; t\n                |                 |                 |                 |                 |     ack; and\\nt\n                |                 |                 |                 |                 |      he door, t\n                |                 |                 |                 |                 |      ars more t\n                |                 |                 |                 |                 |     t-place;\\nT\n                |                 |                 |                 |                 |      ar, sir? T\n                |                 |                 |                 |                 |    \\nPedant:\\nT\n                |                 |                 |                 |                 |       my son! T\n                |                 |                 |                 |                 |     IO:\\nThen t\n                |                 |                 |                 |                 |     ncentio;\\nT\n                |                 |                 |                 |                 |      age made t\n                |                 |                 |                 |                 |      Tranio,\\nT\n                |                 |                 |                 |                 |      him to;\\nT\n                |                 |                 |                 |                 |      's nose, t\n                |                 |                 |                 |                 |      will in, t\n                |                 |                 |                 |                 |      to sound t\n                |                 |                 |                 |                 |       follow, t\n                |                 |                 |                 |                 |      ter once t\n                |                 |                 |                 |                 |      At last, t\n                |                 |                 |                 |                 |     ree:\\nAnd t\n                |                 |                 |                 |                 |     is done,\\nT\n                |                 |                 |                 |                 |     ina,\\nAnd t\n                |                 |                 |                 |                 |   \\n\\nWidow:\\nT\n                |                 |                 |                 |                 |     idow:\\nHe t\n                |                 |                 |                 |                 |      is giddy t\n                |                 |                 |                 |                 |      ow says, t\n                |                 |                 |                 |                 |      hey butt t\n                |                 |                 |                 |                 |      hted me; t\n                |                 |                 |                 |                 |     ush;\\nAnd t\n                |                 |                 |                 |                 |      Tranio.\\nT\n                |                 |                 |                 |                 |      im'd at, t\n                |                 |                 |                 |                 |     her not;\\nT\n                |                 |                 |                 |                 |       no: and t\n                |                 |                 |                 |                 |     obedient\\nT\n                |                 |                 |                 |                 |     und,\\nBut t\n                |                 |                 |                 |                 |     er!\\nNay, t\n                |                 |                 |                 |                 |      ble, not t\n                |                 |                 |                 |                 |     cy;\\nAnd, t\n                |                 |                 |                 |                 |      hat not, t\n                |                 |                 |                 |                 |     truchio!\\nT\n                |                 |                 |                 |                 |       bauble, t\n                |                 |                 |                 |                 |     to sigh,\\nT\n                |                 |                 |                 |                 |     ish too:\\nT\n                |                 |                 |                 |                 |     se eyes,\\nT\n                |                 |                 |                 |                 |      hy lord, t\n                |                 |                 |                 |                 |      hy king, t\n                |                 |                 |                 |                 |      It blots t\n                |                 |                 |                 |                 |      seeming, t\n                |                 |                 |                 |                 |     p of it.\\nT\n                |                 |                 |                 |                 |      hy life, t\n                |                 |                 |                 |                 |      keeper,\\nT\n                |                 |                 |                 |                 |      hy head, t\n                |                 |                 |                 |                 |     his body\\nT\n                |                 |                 |                 |                 |     nd land,\\nT\n                |                 |                 |                 |                 |       storms, t\n                |                 |                 |                 |                 |      ooks and t\n                |                 |                 |                 |                 |     edience;\\nT\n                |                 |                 |                 |                 |     o simple\\nT\n                |                 |                 |                 |                 |     ay,\\nWhen t\n                |                 |                 |                 |                 |      toil and t\n                |                 |                 |                 |                 |     rld,\\nBut t\n                |                 |                 |                 |                 |     ly more,\\nT\n                |                 |                 |                 |                 |     compare,\\nT\n                |                 |                 |                 |                 |     ast are.\\nT\n                |                 |                 |                 |                 |      e wager, t\n                |                 |                 |                 |                 |      topsail. T\n                |                 |                 |                 |                 |      e. Blow, t\n                |                 |                 |                 |                 |      of king? T\n                |                 |                 |                 |                 |      od Fate, t\n                |                 |                 |                 |                 |      rowning; t\n                |                 |                 |                 |                 |      prayers, t\n                |                 |                 |                 |                 |     GONZALO:\\nT\n                |                 |                 |                 |                 |     unkards:\\nT\n                |                 |                 |                 |                 |      l--would t\n                |                 |                 |                 |                 |     drowning\\nT\n                |                 |                 |                 |                 |     g'd yet,\\nT\n                |                 |                 |                 |                 |     ay them.\\nT\n                |                 |                 |                 |                 |     tch,\\nBut t\n                |                 |                 |                 |                 |     ,\\nDashes t\n                |                 |                 |                 |                 |     ow'd and\\nT\n                |                 |                 |                 |                 |      azement: t\n                |                 |                 |                 |                 |     us heart\\nT\n                |                 |                 |                 |                 |      ear one, t\n                |                 |                 |                 |                 |     ell,\\nAnd t\n                |                 |                 |                 |                 |     comfort.\\nT\n                |                 |                 |                 |                 |      k, which t\n                |                 |                 |                 |                 |      red that t\n                |                 |                 |                 |                 |     el\\nWhich t\n                |                 |                 |                 |                 |      y, which t\n                |                 |                 |                 |                 |     ROSPERO:\\nT\n                |                 |                 |                 |                 |     ow come;\\nT\n                |                 |                 |                 |                 |      ute bids t\n                |                 |                 |                 |                 |      for then t\n                |                 |                 |                 |                 |      he image t\n                |                 |                 |                 |                 |     ssurance\\nT\n                |                 |                 |                 |                 |      men once t\n                |                 |                 |                 |                 |     time?\\nIf t\n                |                 |                 |                 |                 |     ere,\\nHow t\n                |                 |                 |                 |                 |     NDA:\\nBut t\n                |                 |                 |                 |                 |      Miranda, t\n                |                 |                 |                 |                 |     r since,\\nT\n                |                 |                 |                 |                 |      She said t\n                |                 |                 |                 |                 |      lan; and t\n                |                 |                 |                 |                 |       had we, t\n                |                 |                 |                 |                 |      e heaved t\n                |                 |                 |                 |                 |     t bleeds\\nT\n                |                 |                 |                 |                 |      oved and t\n                |                 |                 |                 |                 |     hat time\\nT\n                |                 |                 |                 |                 |      arallel; t\n                |                 |                 |                 |                 |     y study,\\nT\n                |                 |                 |                 |                 |     ther\\nAnd t\n                |                 |                 |                 |                 |      studies. T\n                |                 |                 |                 |                 |     its,\\nHow t\n                |                 |                 |                 |                 |      hem, who t\n                |                 |                 |                 |                 |      and who\\nT\n                |                 |                 |                 |                 |      his ear; t\n                |                 |                 |                 |                 |      ut on't. T\n                |                 |                 |                 |                 |     edicated\\nT\n                |                 |                 |                 |                 |      memory,\\nT\n                |                 |                 |                 |                 |     f Naples\\nT\n                |                 |                 |                 |                 |     and bend\\nT\n                |                 |                 |                 |                 |     Milan!--\\nT\n                |                 |                 |                 |                 |      e event; t\n                |                 |                 |                 |                 |      nt; then t\n                |                 |                 |                 |                 |     ll me\\nIf t\n                |                 |                 |                 |                 |     ould sin\\nT\n                |                 |                 |                 |                 |     ERO:\\nNow t\n                |                 |                 |                 |                 |     ndition.\\nT\n                |                 |                 |                 |                 |      ich was, t\n                |                 |                 |                 |                 |     arkness,\\nT\n                |                 |                 |                 |                 |     e\\nMe and t\n                |                 |                 |                 |                 |     s a hint\\nT\n                |                 |                 |                 |                 |     they not\\nT\n                |                 |                 |                 |                 |      n. Dear, t\n                |                 |                 |                 |                 |     \\nIn few, t\n                |                 |                 |                 |                 |      or mast; t\n                |                 |                 |                 |                 |      quit it: t\n                |                 |                 |                 |                 |     oist us,\\nT\n                |                 |                 |                 |                 |      d to us, t\n                |                 |                 |                 |                 |      s I then t\n                |                 |                 |                 |                 |      erve me. T\n                |                 |                 |                 |                 |      heaven,\\nW\n                |                 |                 |                 |                 |     \\nHave I, t\n                |                 |                 |                 |                 |      er, made t\n                |                 |                 |                 |                 |      ours and t\n                |                 |                 |                 |                 |     \\nHeavens t\n                |                 |                 |                 |                 |     estions:\\nT\n                |                 |                 |                 |                 |      to fly,\\nT\n                |                 |                 |                 |                 |      To swim, t\n                |                 |                 |                 |                 |   \\n\\nARIEL:\\nT\n                |                 |                 |                 |                 |      e waist, t\n                |                 |                 |                 |                 |     topmast,\\nT\n                |                 |                 |                 |                 |     tinctly,\\nT\n                |                 |                 |                 |                 |      htnings, t\n                |                 |                 |                 |                 |      spirit!\\nW\n                |                 |                 |                 |                 |      onstant, t\n                |                 |                 |                 |                 |      vessel,\\nT\n                |                 |                 |                 |                 |      with me: t\n                |                 |                 |                 |                 |      irst man t\n                |                 |                 |                 |                 |      em 'bout t\n                |                 |                 |                 |                 |     he isle.\\nT\n                |                 |                 |                 |                 |     ere once\\nT\n                |                 |                 |                 |                 |      moothes, t\n                |                 |                 |                 |                 |     e's hid:\\nT\n                |                 |                 |                 |                 |      spersed, t\n                |                 |                 |                 |                 |     :\\nAriel, t\n                |                 |                 |                 |                 |      m'd: but t\n                |                 |                 |                 |                 |      glasses. T\n                |                 |                 |                 |                 |      ere more t\n                |                 |                 |                 |                 |     service;\\nT\n                |                 |                 |                 |                 |      es, made t\n                |                 |                 |                 |                 |      mblings: t\n                |                 |                 |                 |                 |      ost, and t\n                |                 |                 |                 |                 |     lt deep,\\nT\n                |                 |                 |                 |                 |      ? speak; t\n                |                 |                 |                 |                 |     n,\\nWhich t\n                |                 |                 |                 |                 |      Argier,\\nT\n                |                 |                 |                 |                 |      she did\\nT\n                |                 |                 |                 |                 |      sailors. T\n                |                 |                 |                 |                 |     lave,\\nAs t\n                |                 |                 |                 |                 |     delicate\\nT\n                |                 |                 |                 |                 |       strike. T\n                |                 |                 |                 |                 |       so; he, t\n                |                 |                 |                 |                 |      service. T\n                |                 |                 |                 |                 |      torment\\nT\n                |                 |                 |                 |                 |      nd heard t\n                |                 |                 |                 |                 |      rd thee, t\n                |                 |                 |                 |                 |     ils till\\nT\n                |                 |                 |                 |                 |      subject\\nT\n                |                 |                 |                 |                 |      ight but t\n                |                 |                 |                 |                 |     nvisible\\nT\n                |                 |                 |                 |                 |     MIRANDA:\\nT\n                |                 |                 |                 |                 |      offices\\nT\n                |                 |                 |                 |                 |     Caliban!\\nT\n                |                 |                 |                 |                 |      u earth, t\n                |                 |                 |                 |                 |      be sure, t\n                |                 |                 |                 |                 |      ght that t\n                |                 |                 |                 |                 |      on thee; t\n                |                 |                 |                 |                 |     nch'd\\nAs t\n                |                 |                 |                 |                 |     stinging\\nT\n                |                 |                 |                 |                 |      han bees t\n                |                 |                 |                 |                 |      dinner.\\nT\n                |                 |                 |                 |                 |     r,\\nWhich t\n                |                 |                 |                 |                 |     t first,\\nT\n                |                 |                 |                 |                 |      n't, and t\n                |                 |                 |                 |                 |     h me how\\nT\n                |                 |                 |                 |                 |     he less,\\nT\n                |                 |                 |                 |                 |      ght: and t\n                |                 |                 |                 |                 |     he isle,\\nT\n                |                 |                 |                 |                 |      Sycorax, t\n                |                 |                 |                 |                 |      from me\\nT\n                |                 |                 |                 |                 |      wn cell, t\n                |                 |                 |                 |                 |      violate\\nT\n                |                 |                 |                 |                 |     en done!\\nT\n                |                 |                 |                 |                 |     led else\\nT\n                |                 |                 |                 |                 |      e speak, t\n                |                 |                 |                 |                 |     le race,\\nT\n                |                 |                 |                 |                 |      arn, had t\n                |                 |                 |                 |                 |      ved more t\n                |                 |                 |                 |                 |      o curse. T\n                |                 |                 |                 |                 |      e quick, t\n                |                 |                 |                 |                 |     rt best,\\nT\n                |                 |                 |                 |                 |     hee roar\\nT\n                |                 |                 |                 |                 |     d kiss'd\\nT\n                |                 |                 |                 |                 |      sprites, t\n                |                 |                 |                 |                 |     s wreck,\\nT\n                |                 |                 |                 |                 |      eet air: t\n                |                 |                 |                 |                 |      hom five t\n                |                 |                 |                 |                 |     al made;\\nT\n                |                 |                 |                 |                 |     RDINAND:\\nT\n                |                 |                 |                 |                 |      father.\\nT\n                |                 |                 |                 |                 |     no sound\\nT\n                |                 |                 |                 |                 |     und\\nThat t\n                |                 |                 |                 |                 |      e, such. T\n                |                 |                 |                 |                 |      th grief t\n                |                 |                 |                 |                 |       canker, t\n                |                 |                 |                 |                 |      st sure, t\n                |                 |                 |                 |                 |       am now, t\n                |                 |                 |                 |                 |      wonders\\nT\n                |                 |                 |                 |                 |     , beheld\\nT\n                |                 |                 |                 |                 |      s lords; t\n                |                 |                 |                 |                 |      ngently? T\n                |                 |                 |                 |                 |      hird man t\n                |                 |                 |                 |                 |      r I saw, t\n                |                 |                 |                 |                 |     he first\\nT\n                |                 |                 |                 |                 |     rd more.\\nT\n                |                 |                 |                 |                 |      ers; but t\n                |                 |                 |                 |                 |     hee\\nThat t\n                |                 |                 |                 |                 |      tend me: t\n                |                 |                 |                 |                 |      s a spy, t\n                |                 |                 |                 |                 |      From me, t\n                |                 |                 |                 |                 |     mple:\\nIf t\n                |                 |                 |                 |                 |      l strive t\n                |                 |                 |                 |                 |       manacle t\n                |                 |                 |                 |                 |      u drink; t\n                |                 |                 |                 |                 |     shall be\\nT\n                |                 |                 |                 |                 |      word up, t\n                |                 |                 |                 |                 |       strike, t\n                |                 |                 |                 |                 |     r! hush!\\nT\n                |                 |                 |                 |                 |     h wench!\\nT\n                |                 |                 |                 |                 |      t of men t\n                |                 |                 |                 |                 |     n; obey:\\nT\n                |                 |                 |                 |                 |      's loss, t\n                |                 |                 |                 |                 |      I feel,\\nT\n                |                 |                 |                 |                 |     threats,\\nT\n                |                 |                 |                 |                 |      ht I but t\n                |                 |                 |                 |                 |     re, sir,\\nT\n                |                 |                 |                 |                 |       speech: t\n                |                 |                 |                 |                 |     's wife,\\nT\n                |                 |                 |                 |                 |      hant and t\n                |                 |                 |                 |                 |      like us: t\n                |                 |                 |                 |                 |     BASTIAN:\\nT\n                |                 |                 |                 |                 |     N:\\nDone. T\n                |                 |                 |                 |                 |    \\nADRIAN:\\nT\n                |                 |                 |                 |                 |       subtle, t\n                |                 |                 |                 |                 |     delicate\\nt\n                |                 |                 |                 |                 |      ve means t\n                |                 |                 |                 |                 |     ALO:\\nBut t\n                |                 |                 |                 |                 |     breasted\\nT\n                |                 |                 |                 |                 |     at loss,\\nT\n                |                 |                 |                 |                 |       us, and t\n                |                 |                 |                 |                 |     ' making\\nT\n                |                 |                 |                 |                 |      ring men t\n                |                 |                 |                 |                 |     rt them:\\nT\n                |                 |                 |                 |                 |     bastian,\\nT\n                |                 |                 |                 |                 |     ness\\nAnd t\n                |                 |                 |                 |                 |      And time t\n                |                 |                 |                 |                 |      of land, t\n                |                 |                 |                 |                 |      nd women t\n                |                 |                 |                 |                 |      deavour: t\n                |                 |                 |                 |                 |     undance,\\nT\n                |                 |                 |                 |                 |     rn, sir,\\nT\n                |                 |                 |                 |                 |      no more: t\n                |                 |                 |                 |                 |     uld lift\\nt\n                |                 |                 |                 |                 |       so, and t\n                |                 |                 |                 |                 |     : I find\\nT\n                |                 |                 |                 |                 |    \\nALONSO:\\nT\n                |                 |                 |                 |                 |      nimble.\\nT\n                |                 |                 |                 |                 |     consent;\\nT\n                |                 |                 |                 |                 |      ldst be: t\n                |                 |                 |                 |                 |      uage and t\n                |                 |                 |                 |                 |     dst say?\\nT\n                |                 |                 |                 |                 |       repose, t\n                |                 |                 |                 |                 |     t\\nWhiles t\n\n\n\nmodel_outputs[q_idx], sim_outputs(q_idx, ffwd_freqs, hand_rolled_coeffs)\n\n([('h', 0.8841822147369385),\n  ('o', 0.07446363568305969),\n  ('a', 0.013583848252892494),\n  ('e', 0.012644319795072079),\n  ('i', 0.005080613307654858),\n  ('w', 0.0035871139261871576),\n  ('u', 0.0031414120458066463),\n  ('r', 0.0021735273767262697),\n  ('y', 0.0007880667108111084),\n  ('n', 4.941564111504704e-05)],\n [('h', 0.7415714859962463),\n  ('o', 0.18136689066886902),\n  ('a', 0.02116050384938717),\n  ('e', 0.020505914464592934),\n  ('i', 0.013274901546537876),\n  ('r', 0.011383971199393272),\n  ('u', 0.005586168263107538),\n  ('w', 0.0042041451670229435),\n  ('y', 0.0009459573193453252)])",
    "crumbs": [
      "analyses",
      "Widening the Space of Similar Values"
    ]
  },
  {
    "objectID": "analyses/widening_similar_space.html#worst-performing-strings",
    "href": "analyses/widening_similar_space.html#worst-performing-strings",
    "title": "Widening the Space of Similar Values",
    "section": "Worst Performing Strings",
    "text": "Worst Performing Strings\n\npredicate = lambda matching_count: matching_count == 0\nindices_matching_0 = filter_on_matching_count(predicate, ffwd_freqs, hand_rolled_coeffs, model_outputs)\nprint(f\"{len(indices_matching_0)} of {len(model_outputs)} strings\")\n\n3888 of 20000 strings\n\n\n\nindices_matching_0[:3]\n\ntensor([0, 5, 7])\n\n\n\nthresholds = [0.95, 0.94, 0.85, 0.76, 0.81, 0.89]\nq_idx_start = 0\nq_idx_end = 8\nmatching_strings = []\nfor block_idx in range(n_layer):\n    matching_strings.append(\n        get_matching_strings(\n            filter_on_prefiltered_results(\n                load_prefiltered=lambda q_idx: torch.load(prefiltered_filename(q_idx, block_idx)),\n                q_idx_start=q_idx_start,\n                q_idx_end=q_idx_end,\n                filter_fn=lambda values: values &gt; thresholds[block_idx],\n            ),\n            strings10,\n        )\n    )\n\n\nq_idx=0\nmodel_outputs[q_idx], sim_outputs(q_idx, ffwd_freqs, hand_rolled_coeffs)\n\n([('\\n', 0.5250111222267151),\n  (' ', 0.46654149889945984),\n  ('-', 0.007815942168235779),\n  (\"'\", 0.00047109558363445103),\n  ('.', 2.7687412512023002e-05),\n  (',', 1.7208614735864103e-05),\n  (':', 1.5419789633597247e-05),\n  ('?', 1.3534416211768985e-05),\n  (';', 9.159703949990217e-06),\n  ('l', 8.144122148223687e-06)],\n [(' ', 0.5287047028541565),\n  ('\\n', 0.45704200863838196),\n  ('-', 0.011670918203890324),\n  (\"'\", 0.002582360291853547)])\n\n\n\nq_idx=5\nmodel_outputs[q_idx], sim_outputs(q_idx, ffwd_freqs, hand_rolled_coeffs)\n\n([('m', 0.15091902017593384),\n  ('c', 0.11324071884155273),\n  ('s', 0.0864841490983963),\n  ('p', 0.07751188427209854),\n  ('b', 0.0703517273068428),\n  ('t', 0.06576964259147644),\n  ('d', 0.063930444419384),\n  ('w', 0.06260521709918976),\n  ('h', 0.057320378720760345),\n  ('l', 0.05529329925775528)],\n [('s', 0.10329431295394897),\n  ('c', 0.07140596210956573),\n  ('m', 0.06917507201433182),\n  ('w', 0.06861485540866852),\n  ('h', 0.06737785786390305),\n  ('b', 0.06733164936304092),\n  ('p', 0.06679156422615051),\n  ('f', 0.06560288369655609),\n  ('t', 0.0617789626121521),\n  ('d', 0.05674412101507187)])\n\n\n\nq_idx=7\nmodel_outputs[q_idx], sim_outputs(q_idx, ffwd_freqs, hand_rolled_coeffs)\n\n([('m', 0.25451651215553284),\n  ('l', 0.10360157489776611),\n  ('s', 0.09552519768476486),\n  ('f', 0.08302649855613708),\n  ('c', 0.0671275407075882),\n  ('b', 0.057088181376457214),\n  ('w', 0.04113667458295822),\n  ('g', 0.04072935879230499),\n  ('h', 0.03867478296160698),\n  ('p', 0.03566877916455269)],\n [('s', 0.10366542637348175),\n  ('t', 0.07950329780578613),\n  ('h', 0.07262012362480164),\n  ('b', 0.07083629816770554),\n  ('m', 0.06413055956363678),\n  ('w', 0.06364738941192627),\n  ('f', 0.05486258491873741),\n  ('c', 0.054300423711538315),\n  ('a', 0.050307247787714005),\n  ('d', 0.04975511506199837)])",
    "crumbs": [
      "analyses",
      "Widening the Space of Similar Values"
    ]
  },
  {
    "objectID": "analyses/widening_similar_space.html#other-statistical-measures",
    "href": "analyses/widening_similar_space.html#other-statistical-measures",
    "title": "Widening the Space of Similar Values",
    "section": "Other Statistical Measures",
    "text": "Other Statistical Measures\nThe method used to compare outputs of the model vs simulation (determine n for which the top n tokens are the same in the two outputs) is a bit simplistic. Obvious drawbacks:\n\nDoes not consider actual probabilities of the tokens: If both have the same top token but one gives it a 99% probability and the other gives it a 51% probability, that’s not the same.\nDoesn’t consider near misses. E.g. one distribution might be [(‘m’, 51%), (‘n’, 49%)] and the other might be [(‘m’, 49%), (‘n’, 51%)]. These are not the same but are in a sense fairly close.\n\nIn this section, I explore other measures. Considered KL Divergence but it doesn’t work well because the simulation distributions have a lot of zeros where the model distribution is not zero.\n\ndef get_sim_probs(ffwd_freqs: torch.Tensor, coeffs: torch.Tensor):\n    total_freqs = (ffwd_freqs * coeffs).sum(dim=0)\n    total_probs = total_freqs / total_freqs.sum(dim=-1, keepdim=True)\n\n    return total_probs\n\n\ndef get_model_probs(strings: Sequence[str], encoding_helpers: EncodingHelpers):\n    tokens = encoding_helpers.tokenize_strings(strings)\n    logits, _ = m(tokens)\n    model_output = F.softmax(logits[:, -1, :], dim=-1)\n\n    return model_output.detach()\n\n\nsim_probs = get_sim_probs(ffwd_freqs, hand_rolled_coeffs)\nsim_probs.shape\n\ntorch.Size([20000, 65])\n\n\n\nmodel_probs = get_model_probs(strings20k, encoding_helpers)\nmodel_probs.shape\n\ntorch.Size([20000, 65])\n\n\n\n# Try Hellinger Distance:\nh = ((model_probs.sqrt() - sim_probs.sqrt())**2).sum(dim=-1).sqrt() / math.sqrt(2)\nh.mean(), h.min(), h.max()\n\n(tensor(0.1677), tensor(0.0013), tensor(0.9994))\n\n\n\nknown_good_qidxs = torch.tensor([57, 68, 74], dtype=torch.long)\nknown_bad_qidxs = torch.tensor([0, 5, 7], dtype=torch.long)\n\n\nh[known_good_qidxs], h[known_bad_qidxs]\n\n(tensor([0.0731, 0.0904, 0.1372]), tensor([0.0536, 0.1858, 0.2736]))\n\n\nThis is interesting. For the bad ones, the quality tracks with my subjective evaluation (see above for outputs for these): * q_idx 0: This is actually pretty good. It just got the order of the first two tokens wrong but the model had them at pretty close to 50/50 probability. * q_idx 5: First and third tokens are swapped but the 2nd token is right. Also not terrible. * q_idx 7: This one was actually bad.\nFor the good ones: * q_idx 57 and q_idx 68 are clearly both good: top 5 tokens match and the probabilities are close. * q_idx 74 is also good but clearly worse than the other two. The top 5 tokens match but the probabilities are not as close.\nLet’s examine the distributions of the Hellinger distances.\n\n(h &lt; 0.2).sum(), (h &gt; 0.99).sum()\n\n(tensor(13779), tensor(8))\n\n\n\nsns.kdeplot(h.numpy(), fill=True)\nplt.title(\"Distribution of Hellinger Distance across 20,000 samples\")\nplt.show()\n\n\n\n\n\n\n\n\n\n# Look at some of the very worst ones:\ntorch.nonzero(h &gt; 0.99)\n\ntensor([[ 4016],\n        [ 5411],\n        [ 5583],\n        [ 8172],\n        [13046],\n        [14283],\n        [17567],\n        [17786]])\n\n\n\nq_idx=4016\nmodel_outputs[q_idx], sim_outputs(q_idx, ffwd_freqs, hand_rolled_coeffs)\n\n([('t', 0.7598904967308044),\n  ('e', 0.1240471750497818),\n  ('l', 0.08614809811115265),\n  ('o', 0.011713063344359398),\n  ('a', 0.010631212964653969),\n  ('n', 0.001669323886744678),\n  ('s', 0.0009680230286903679),\n  ('u', 0.0008741102647036314),\n  ('r', 0.0006283090333454311),\n  ('f', 0.0005197310820221901)],\n [('i', 1.0)])\n\n\n\n# Look at sim outputs for all the bad ones.\n[\n    sim_outputs(q_idx, ffwd_freqs, hand_rolled_coeffs)\n    for q_idx in torch.nonzero(h &gt; 0.99).squeeze(dim=-1)\n]\n\n[[('i', 1.0)],\n [('S', 1.0)],\n [('l', 1.0)],\n [('P', 1.0)],\n [('S', 1.0)],\n [('A', 1.0)],\n [('S', 1.0)],\n [('Z', 1.0)]]\n\n\nFor each of these, the simulation only has a single prediction. Probably because it didn’t get any similar strings to work with. Let’s check:\n\nthresholds = [0.95, 0.94, 0.85, 0.76, 0.81, 0.89]\nq_idxs = torch.nonzero(h &gt; 0.99).squeeze(dim=-1)\nmatching_strings = []\nfor block_idx in range(n_layer):\n    matching_strings.append(\n        get_matching_strings(\n            filter_across_batches(\n                get_batch=lambda batch_idx: torch.load(\n                    str(results_folder / f'cosine_sim_ffwd_out_{batch_idx:05d}.pt'),\n                    mmap=True,\n                )[block_idx, :, q_idxs],\n                n_batches=8590,\n                filter_fn=lambda batch: batch &gt; thresholds[block_idx],\n                n_queries=q_idxs.shape[0],\n            ),\n            strings10,\n        )\n    )\n\n\nfor q_idx in q_idxs:\n    print_results(q_idx=(q_idxs == q_idx).nonzero(as_tuple=True)[0], query_string=strings20k[q_idx.item()], matching_strings=matching_strings)\n    print()\n\nQuery string:  her volub\n      her volub |       her volub |       her volub |       her volub |       her volub |       her volub\n\nQuery string: o'er!\\n\\nPRO\n    her.\\n\\nPRO |     her.\\n\\nPRO |     her.\\n\\nPRO |     her.\\n\\nPRO |     her.\\n\\nPRO |     her.\\n\\nPRO\n    day!\\n\\nPRO |     day!\\n\\nPRO |     day!\\n\\nPRO |     day!\\n\\nPRO |     day!\\n\\nPRO |     day!\\n\\nPRO\n   ghts.\\n\\nPRO |    ghts.\\n\\nPRO |    ghts.\\n\\nPRO |    ghts.\\n\\nPRO |    ghts.\\n\\nPRO |    ghts.\\n\\nPRO\n   yet.'\\n\\nPRO |    yet.'\\n\\nPRO |    yet.'\\n\\nPRO |    yet.'\\n\\nPRO |    yet.'\\n\\nPRO |    yet.'\\n\\nPRO\n    can.\\n\\nPRO |     can.\\n\\nPRO |     can.\\n\\nPRO |     can.\\n\\nPRO |     can.\\n\\nPRO |     can.\\n\\nPRO\n   d me?\\n\\nPRO |    d me?\\n\\nPRO |    d me?\\n\\nPRO |    d me?\\n\\nPRO |    d me?\\n\\nPRO |    d me?\\n\\nPRO\n    not.\\n\\nPRO |     not.\\n\\nPRO |     not.\\n\\nPRO |     not.\\n\\nPRO |     not.\\n\\nPRO |     not.\\n\\nPRO\n   ther?\\n\\nPRO |    ther?\\n\\nPRO |    ther?\\n\\nPRO |    ther?\\n\\nPRO |    ther?\\n\\nPRO |    ther?\\n\\nPRO\n    did?\\n\\nPRO |     did?\\n\\nPRO |     did?\\n\\nPRO |     did?\\n\\nPRO |     did?\\n\\nPRO |     did?\\n\\nPRO\n   ther.\\n\\nPRO |    ther.\\n\\nPRO |    ther.\\n\\nPRO |    ther.\\n\\nPRO |    ther.\\n\\nPRO |    ther.\\n\\nPRO\n   ully.\\n\\nPRO |    ully.\\n\\nPRO |    ully.\\n\\nPRO |    ully.\\n\\nPRO |    ully.\\n\\nPRO |    ully.\\n\\nPRO\n   I do.\\n\\nPRO |    I do.\\n\\nPRO |    I do.\\n\\nPRO |    I do.\\n\\nPRO |    I do.\\n\\nPRO |    I do.\\n\\nPRO\n   ness.\\n\\nPRO |    ness.\\n\\nPRO |    ness.\\n\\nPRO |    ness.\\n\\nPRO |    ness.\\n\\nPRO |    ness.\\n\\nPRO\n   vens!\\n\\nPRO |    vens!\\n\\nPRO |    vens!\\n\\nPRO |    vens!\\n\\nPRO |    vens!\\n\\nPRO |    vens!\\n\\nPRO\n   sons.\\n\\nPRO |    sons.\\n\\nPRO |    sons.\\n\\nPRO |    sons.\\n\\nPRO |    sons.\\n\\nPRO |    sons.\\n\\nPRO\n   to't.\\n\\nPRO |    to't.\\n\\nPRO |    to't.\\n\\nPRO |    to't.\\n\\nPRO |    to't.\\n\\nPRO |    to't.\\n\\nPRO\n   y us?\\n\\nPRO |    y us?\\n\\nPRO |    y us?\\n\\nPRO |    y us?\\n\\nPRO |    y us?\\n\\nPRO |    y us?\\n\\nPRO\n    you!\\n\\nPRO |     you!\\n\\nPRO |     you!\\n\\nPRO |     you!\\n\\nPRO |     you!\\n\\nPRO |     you!\\n\\nPRO\n   hore?\\n\\nPRO |    hore?\\n\\nPRO |    hore?\\n\\nPRO |    hore?\\n\\nPRO |    hore?\\n\\nPRO |    hore?\\n\\nPRO\n    man!\\n\\nPRO |     man!\\n\\nPRO |     man!\\n\\nPRO |     man!\\n\\nPRO |     man!\\n\\nPRO |     man!\\n\\nPRO\n   torm?\\n\\nPRO |    torm?\\n\\nPRO |    torm?\\n\\nPRO |    torm?\\n\\nPRO |    torm?\\n\\nPRO |    torm?\\n\\nPRO\n   lity.\\n\\nPRO |    lity.\\n\\nPRO |    lity.\\n\\nPRO |    lity.\\n\\nPRO |    lity.\\n\\nPRO |    lity.\\n\\nPRO\n   hake.\\n\\nPRO |    hake.\\n\\nPRO |    hake.\\n\\nPRO |    hake.\\n\\nPRO |    hake.\\n\\nPRO |    hake.\\n\\nPRO\n   ere.'\\n\\nPRO |    ere.'\\n\\nPRO |    ere.'\\n\\nPRO |    ere.'\\n\\nPRO |    ere.'\\n\\nPRO |    ere.'\\n\\nPRO\n   ster.\\n\\nPRO |    ster.\\n\\nPRO |    ster.\\n\\nPRO |    ster.\\n\\nPRO |    ster.\\n\\nPRO |    ster.\\n\\nPRO\n   knot.\\n\\nPRO |    knot.\\n\\nPRO |    knot.\\n\\nPRO |    knot.\\n\\nPRO |    knot.\\n\\nPRO |    knot.\\n\\nPRO\n   rish.\\n\\nPRO |    rish.\\n\\nPRO |    rish.\\n\\nPRO |    rish.\\n\\nPRO |    rish.\\n\\nPRO |    rish.\\n\\nPRO\n   ason.\\n\\nPRO |    ason.\\n\\nPRO |    ason.\\n\\nPRO |    ason.\\n\\nPRO |    ason.\\n\\nPRO |    ason.\\n\\nPRO\n   d me.\\n\\nPRO |    d me.\\n\\nPRO |    d me.\\n\\nPRO |    d me.\\n\\nPRO |    d me.\\n\\nPRO |    d me.\\n\\nPRO\n   erty.\\n\\nPRO |    erty.\\n\\nPRO |    erty.\\n\\nPRO |    erty.\\n\\nPRO |    erty.\\n\\nPRO |    erty.\\n\\nPRO\n   year.\\n\\nPRO |    year.\\n\\nPRO |    year.\\n\\nPRO |    year.\\n\\nPRO |    year.\\n\\nPRO |    year.\\n\\nPRO\n  :\\nNo.\\n\\nPRO |   :\\nNo.\\n\\nPRO |   :\\nNo.\\n\\nPRO |   :\\nNo.\\n\\nPRO |   :\\nNo.\\n\\nPRO |   :\\nNo.\\n\\nPRO\n    sir.\\n\\nPRO |     sir.\\n\\nPRO |     sir.\\n\\nPRO |     sir.\\n\\nPRO |     sir.\\n\\nPRO |     sir.\\n\\nPRO\n   gier.\\n\\nPRO |    gier.\\n\\nPRO |    gier.\\n\\nPRO |    gier.\\n\\nPRO |    gier.\\n\\nPRO |    gier.\\n\\nPRO\n    son.\\n\\nPRO |     son.\\n\\nPRO |     son.\\n\\nPRO |     son.\\n\\nPRO |     son.\\n\\nPRO |     son.\\n\\nPRO\n   ntly.\\n\\nPRO |    ntly.\\n\\nPRO |    ntly.\\n\\nPRO |    ntly.\\n\\nPRO |    ntly.\\n\\nPRO |    ntly.\\n\\nPRO\n   I do?\\n\\nPRO |    I do?\\n\\nPRO |    I do?\\n\\nPRO |    I do?\\n\\nPRO |    I do?\\n\\nPRO |    I do?\\n\\nPRO\n   n me.\\n\\nPRO |    n me.\\n\\nPRO |    n me.\\n\\nPRO |    n me.\\n\\nPRO |    n me.\\n\\nPRO |    n me.\\n\\nPRO\n   k on.\\n\\nPRO |    k on.\\n\\nPRO |    k on.\\n\\nPRO |    k on.\\n\\nPRO |    k on.\\n\\nPRO |    k on.\\n\\nPRO\n   IBAN:\\n\\nPRO |    IBAN:\\n\\nPRO |    IBAN:\\n\\nPRO |    IBAN:\\n\\nPRO |    IBAN:\\n\\nPRO |    done.\\n\\nPRO\n   done.\\n\\nPRO |    done.\\n\\nPRO |    done.\\n\\nPRO |    done.\\n\\nPRO |    done.\\n\\nPRO |    o'er!\\n\\nPRO\n   o'er!\\n\\nPRO |    o'er!\\n\\nPRO |    o'er!\\n\\nPRO |    o'er!\\n\\nPRO |    o'er!\\n\\nPRO |    land.\\n\\nPRO\n   land.\\n\\nPRO |    land.\\n\\nPRO |    land.\\n\\nPRO |    land.\\n\\nPRO |    land.\\n\\nPRO |    bans.\\n\\nPRO\n   bans.\\n\\nPRO |    bans.\\n\\nPRO |    bans.\\n\\nPRO |    bans.\\n\\nPRO |    bans.\\n\\nPRO |    uage!\\n\\nPRO\n   uage!\\n\\nPRO |    uage!\\n\\nPRO |    uage!\\n\\nPRO |    uage!\\n\\nPRO |    uage!\\n\\nPRO |     him.\\n\\nPRO\n    him.\\n\\nPRO |     him.\\n\\nPRO |     him.\\n\\nPRO |     him.\\n\\nPRO |     him.\\n\\nPRO |    e me.\\n\\nPRO\n   e me.\\n\\nPRO |    e me.\\n\\nPRO |    e me.\\n\\nPRO |    e me.\\n\\nPRO |    e me.\\n\\nPRO |    irit.\\n\\nPRO\n   irit.\\n\\nPRO |    irit.\\n\\nPRO |    irit.\\n\\nPRO |    irit.\\n\\nPRO |    irit.\\n\\nPRO |    oble.\\n\\nPRO\n   oble.\\n\\nPRO |    oble.\\n\\nPRO |    oble.\\n\\nPRO |    oble.\\n\\nPRO |    oble.\\n\\nPRO |    oken.\\n\\nPRO\n   oken.\\n\\nPRO |    oken.\\n\\nPRO |    oken.\\n\\nPRO |    oken.\\n\\nPRO |    oken.\\n\\nPRO |    wain.\\n\\nPRO\n   wain.\\n\\nPRO |    wain.\\n\\nPRO |    wain.\\n\\nPRO |    wain.\\n\\nPRO |    wain.\\n\\nPRO |    ples.\\n\\nPRO\n   ples.\\n\\nPRO |    ples.\\n\\nPRO |    ples.\\n\\nPRO |    ples.\\n\\nPRO |    ples.\\n\\nPRO |    th't.\\n\\nPRO\n   th't.\\n\\nPRO |    th't.\\n\\nPRO |    th't.\\n\\nPRO |    th't.\\n\\nPRO |    th't.\\n\\nPRO |    rful.\\n\\nPRO\n   rful.\\n\\nPRO |    rful.\\n\\nPRO |    rful.\\n\\nPRO |    rful.\\n\\nPRO |    rful.\\n\\nPRO |    rety.\\n\\nPRO\n   rety.\\n\\nPRO |    rety.\\n\\nPRO |    rety.\\n\\nPRO |    rety.\\n\\nPRO |    rety.\\n\\nPRO |     man.\\n\\nPRO\n    man.\\n\\nPRO |     man.\\n\\nPRO |     man.\\n\\nPRO |     man.\\n\\nPRO |     man.\\n\\nPRO |    ison.\\n\\nPRO\n   ison.\\n\\nPRO |    ison.\\n\\nPRO |    ison.\\n\\nPRO |    ison.\\n\\nPRO |    ison.\\n\\nPRO |    able.\\n\\nPRO\n   able.\\n\\nPRO |    able.\\n\\nPRO |    able.\\n\\nPRO |    able.\\n\\nPRO |    able.\\n\\nPRO |                \n\nQuery string: uaint Arie\n     h, my Arie |      h, my Arie |      h, my Arie |      h, my Arie |      h, my Arie |      uaint Arie\n     task\\nArie |      task\\nArie |      they, Arie |      they, Arie |      they, Arie |                \n     they, Arie |      they, Arie |      uaint Arie |      uaint Arie |      uaint Arie |                \n    PERO:\\nArie |     PERO:\\nArie |                 |                 |                 |                \n     uaint Arie |      uaint Arie |                 |                 |                 |                \n\nQuery string: tly.\\n\\nPROS\n   her.\\n\\nPROS |    her.\\n\\nPROS |    her.\\n\\nPROS |    her.\\n\\nPROS |    her.\\n\\nPROS |    her.\\n\\nPROS\n   day!\\n\\nPROS |    day!\\n\\nPROS |    day!\\n\\nPROS |    day!\\n\\nPROS |    day!\\n\\nPROS |    day!\\n\\nPROS\n   hts.\\n\\nPROS |    hts.\\n\\nPROS |    hts.\\n\\nPROS |    hts.\\n\\nPROS |    hts.\\n\\nPROS |    hts.\\n\\nPROS\n   et.'\\n\\nPROS |    et.'\\n\\nPROS |    et.'\\n\\nPROS |    et.'\\n\\nPROS |    et.'\\n\\nPROS |    et.'\\n\\nPROS\n   can.\\n\\nPROS |    can.\\n\\nPROS |    can.\\n\\nPROS |    can.\\n\\nPROS |    can.\\n\\nPROS |    can.\\n\\nPROS\n    me?\\n\\nPROS |     me?\\n\\nPROS |     me?\\n\\nPROS |     me?\\n\\nPROS |     me?\\n\\nPROS |     me?\\n\\nPROS\n   not.\\n\\nPROS |    not.\\n\\nPROS |    not.\\n\\nPROS |    not.\\n\\nPROS |    not.\\n\\nPROS |    not.\\n\\nPROS\n   her?\\n\\nPROS |    her?\\n\\nPROS |    her?\\n\\nPROS |    her?\\n\\nPROS |    her?\\n\\nPROS |    her?\\n\\nPROS\n   did?\\n\\nPROS |    did?\\n\\nPROS |    did?\\n\\nPROS |    did?\\n\\nPROS |    did?\\n\\nPROS |    did?\\n\\nPROS\n   lly.\\n\\nPROS |    lly.\\n\\nPROS |    lly.\\n\\nPROS |    lly.\\n\\nPROS |    lly.\\n\\nPROS |    lly.\\n\\nPROS\n    do.\\n\\nPROS |     do.\\n\\nPROS |     do.\\n\\nPROS |     do.\\n\\nPROS |     do.\\n\\nPROS |     do.\\n\\nPROS\n   ess.\\n\\nPROS |    ess.\\n\\nPROS |    ess.\\n\\nPROS |    ess.\\n\\nPROS |    ess.\\n\\nPROS |    ess.\\n\\nPROS\n   ens!\\n\\nPROS |    ens!\\n\\nPROS |    ens!\\n\\nPROS |    ens!\\n\\nPROS |    ens!\\n\\nPROS |    ens!\\n\\nPROS\n   ons.\\n\\nPROS |    ons.\\n\\nPROS |    ons.\\n\\nPROS |    ons.\\n\\nPROS |    ons.\\n\\nPROS |    ons.\\n\\nPROS\n   o't.\\n\\nPROS |    o't.\\n\\nPROS |    o't.\\n\\nPROS |    o't.\\n\\nPROS |    o't.\\n\\nPROS |    o't.\\n\\nPROS\n    us?\\n\\nPROS |     us?\\n\\nPROS |     us?\\n\\nPROS |     us?\\n\\nPROS |     us?\\n\\nPROS |     us?\\n\\nPROS\n   you!\\n\\nPROS |    you!\\n\\nPROS |    you!\\n\\nPROS |    you!\\n\\nPROS |    you!\\n\\nPROS |    you!\\n\\nPROS\n   ore?\\n\\nPROS |    ore?\\n\\nPROS |    ore?\\n\\nPROS |    ore?\\n\\nPROS |    ore?\\n\\nPROS |    ore?\\n\\nPROS\n   man!\\n\\nPROS |    man!\\n\\nPROS |    man!\\n\\nPROS |    man!\\n\\nPROS |    man!\\n\\nPROS |    man!\\n\\nPROS\n   orm?\\n\\nPROS |    orm?\\n\\nPROS |    orm?\\n\\nPROS |    orm?\\n\\nPROS |    orm?\\n\\nPROS |    orm?\\n\\nPROS\n   ity.\\n\\nPROS |    ity.\\n\\nPROS |    ity.\\n\\nPROS |    ity.\\n\\nPROS |    ity.\\n\\nPROS |    ity.\\n\\nPROS\n   ake.\\n\\nPROS |    ake.\\n\\nPROS |    ake.\\n\\nPROS |    ake.\\n\\nPROS |    ake.\\n\\nPROS |    ake.\\n\\nPROS\n   re.'\\n\\nPROS |    re.'\\n\\nPROS |    re.'\\n\\nPROS |    re.'\\n\\nPROS |    re.'\\n\\nPROS |    re.'\\n\\nPROS\n   ter.\\n\\nPROS |    ter.\\n\\nPROS |    ter.\\n\\nPROS |    ter.\\n\\nPROS |    ter.\\n\\nPROS |    ter.\\n\\nPROS\n   ish.\\n\\nPROS |    ish.\\n\\nPROS |    ish.\\n\\nPROS |    ish.\\n\\nPROS |    ish.\\n\\nPROS |    ish.\\n\\nPROS\n   son.\\n\\nPROS |    son.\\n\\nPROS |    son.\\n\\nPROS |    son.\\n\\nPROS |    son.\\n\\nPROS |    son.\\n\\nPROS\n    me.\\n\\nPROS |     me.\\n\\nPROS |     me.\\n\\nPROS |     me.\\n\\nPROS |     me.\\n\\nPROS |     me.\\n\\nPROS\n   rty.\\n\\nPROS |    rty.\\n\\nPROS |    rty.\\n\\nPROS |    rty.\\n\\nPROS |    rty.\\n\\nPROS |    rty.\\n\\nPROS\n   ear.\\n\\nPROS |    ear.\\n\\nPROS |    ear.\\n\\nPROS |    ear.\\n\\nPROS |    ear.\\n\\nPROS |    ear.\\n\\nPROS\n  \\nNo.\\n\\nPROS |   \\nNo.\\n\\nPROS |   \\nNo.\\n\\nPROS |   \\nNo.\\n\\nPROS |   \\nNo.\\n\\nPROS |   \\nNo.\\n\\nPROS\n   sir.\\n\\nPROS |    sir.\\n\\nPROS |    sir.\\n\\nPROS |    sir.\\n\\nPROS |    sir.\\n\\nPROS |    sir.\\n\\nPROS\n   ier.\\n\\nPROS |    ier.\\n\\nPROS |    ier.\\n\\nPROS |    ier.\\n\\nPROS |    ier.\\n\\nPROS |    ier.\\n\\nPROS\n   tly.\\n\\nPROS |    tly.\\n\\nPROS |    tly.\\n\\nPROS |    tly.\\n\\nPROS |    tly.\\n\\nPROS |    tly.\\n\\nPROS\n    do?\\n\\nPROS |     do?\\n\\nPROS |     do?\\n\\nPROS |     do?\\n\\nPROS |     do?\\n\\nPROS |     do?\\n\\nPROS\n    on.\\n\\nPROS |     on.\\n\\nPROS |     on.\\n\\nPROS |     on.\\n\\nPROS |     on.\\n\\nPROS |     on.\\n\\nPROS\n   BAN:\\n\\nPROS |    BAN:\\n\\nPROS |    BAN:\\n\\nPROS |    BAN:\\n\\nPROS |    BAN:\\n\\nPROS |    BAN:\\n\\nPROS\n   one.\\n\\nPROS |    one.\\n\\nPROS |    one.\\n\\nPROS |    one.\\n\\nPROS |    one.\\n\\nPROS |    one.\\n\\nPROS\n   'er!\\n\\nPROS |    'er!\\n\\nPROS |    'er!\\n\\nPROS |    'er!\\n\\nPROS |    'er!\\n\\nPROS |    'er!\\n\\nPROS\n   and.\\n\\nPROS |    and.\\n\\nPROS |    and.\\n\\nPROS |    and.\\n\\nPROS |    and.\\n\\nPROS |    and.\\n\\nPROS\n   ans.\\n\\nPROS |    ans.\\n\\nPROS |    ans.\\n\\nPROS |    ans.\\n\\nPROS |    ans.\\n\\nPROS |    ans.\\n\\nPROS\n   age!\\n\\nPROS |    age!\\n\\nPROS |    age!\\n\\nPROS |    age!\\n\\nPROS |    age!\\n\\nPROS |    age!\\n\\nPROS\n   him.\\n\\nPROS |    him.\\n\\nPROS |    him.\\n\\nPROS |    him.\\n\\nPROS |    him.\\n\\nPROS |    him.\\n\\nPROS\n   rit.\\n\\nPROS |    rit.\\n\\nPROS |    rit.\\n\\nPROS |    rit.\\n\\nPROS |    rit.\\n\\nPROS |    rit.\\n\\nPROS\n   ble.\\n\\nPROS |    ble.\\n\\nPROS |    ble.\\n\\nPROS |    ble.\\n\\nPROS |    ble.\\n\\nPROS |    ble.\\n\\nPROS\n   ken.\\n\\nPROS |    ken.\\n\\nPROS |    ken.\\n\\nPROS |    ken.\\n\\nPROS |    ken.\\n\\nPROS |    ken.\\n\\nPROS\n   ain.\\n\\nPROS |    ain.\\n\\nPROS |    ain.\\n\\nPROS |    ain.\\n\\nPROS |    ain.\\n\\nPROS |    ain.\\n\\nPROS\n   les.\\n\\nPROS |    les.\\n\\nPROS |    les.\\n\\nPROS |    les.\\n\\nPROS |    les.\\n\\nPROS |    les.\\n\\nPROS\n   h't.\\n\\nPROS |    h't.\\n\\nPROS |    h't.\\n\\nPROS |    h't.\\n\\nPROS |    h't.\\n\\nPROS |    h't.\\n\\nPROS\n   ful.\\n\\nPROS |    ful.\\n\\nPROS |    ful.\\n\\nPROS |    ful.\\n\\nPROS |    ful.\\n\\nPROS |    ful.\\n\\nPROS\n   ety.\\n\\nPROS |    ety.\\n\\nPROS |    ety.\\n\\nPROS |    ety.\\n\\nPROS |    ety.\\n\\nPROS |    ety.\\n\\nPROS\n   man.\\n\\nPROS |    man.\\n\\nPROS |    man.\\n\\nPROS |    man.\\n\\nPROS |    man.\\n\\nPROS |    man.\\n\\nPROS\n\nQuery string:  him.\\n\\nPRO\n    her.\\n\\nPRO |     her.\\n\\nPRO |     her.\\n\\nPRO |     her.\\n\\nPRO |     her.\\n\\nPRO |     her.\\n\\nPRO\n    day!\\n\\nPRO |     day!\\n\\nPRO |     day!\\n\\nPRO |     day!\\n\\nPRO |     day!\\n\\nPRO |     day!\\n\\nPRO\n   ghts.\\n\\nPRO |    ghts.\\n\\nPRO |    ghts.\\n\\nPRO |    ghts.\\n\\nPRO |    ghts.\\n\\nPRO |    ghts.\\n\\nPRO\n   yet.'\\n\\nPRO |    yet.'\\n\\nPRO |    yet.'\\n\\nPRO |    yet.'\\n\\nPRO |    yet.'\\n\\nPRO |    yet.'\\n\\nPRO\n    can.\\n\\nPRO |     can.\\n\\nPRO |     can.\\n\\nPRO |     can.\\n\\nPRO |     can.\\n\\nPRO |     can.\\n\\nPRO\n   d me?\\n\\nPRO |    d me?\\n\\nPRO |    d me?\\n\\nPRO |    d me?\\n\\nPRO |    d me?\\n\\nPRO |    d me?\\n\\nPRO\n    not.\\n\\nPRO |     not.\\n\\nPRO |     not.\\n\\nPRO |     not.\\n\\nPRO |     not.\\n\\nPRO |     not.\\n\\nPRO\n   ther?\\n\\nPRO |    ther?\\n\\nPRO |    ther?\\n\\nPRO |    ther?\\n\\nPRO |    ther?\\n\\nPRO |    ther?\\n\\nPRO\n    did?\\n\\nPRO |     did?\\n\\nPRO |     did?\\n\\nPRO |     did?\\n\\nPRO |     did?\\n\\nPRO |     did?\\n\\nPRO\n   ther.\\n\\nPRO |    ther.\\n\\nPRO |    ther.\\n\\nPRO |    ther.\\n\\nPRO |    ther.\\n\\nPRO |    ther.\\n\\nPRO\n   ully.\\n\\nPRO |    ully.\\n\\nPRO |    ully.\\n\\nPRO |    ully.\\n\\nPRO |    ully.\\n\\nPRO |    ully.\\n\\nPRO\n   I do.\\n\\nPRO |    I do.\\n\\nPRO |    I do.\\n\\nPRO |    I do.\\n\\nPRO |    I do.\\n\\nPRO |    I do.\\n\\nPRO\n   ness.\\n\\nPRO |    ness.\\n\\nPRO |    ness.\\n\\nPRO |    ness.\\n\\nPRO |    ness.\\n\\nPRO |    ness.\\n\\nPRO\n   vens!\\n\\nPRO |    vens!\\n\\nPRO |    vens!\\n\\nPRO |    vens!\\n\\nPRO |    vens!\\n\\nPRO |    vens!\\n\\nPRO\n   sons.\\n\\nPRO |    sons.\\n\\nPRO |    sons.\\n\\nPRO |    sons.\\n\\nPRO |    sons.\\n\\nPRO |    sons.\\n\\nPRO\n   to't.\\n\\nPRO |    to't.\\n\\nPRO |    to't.\\n\\nPRO |    to't.\\n\\nPRO |    to't.\\n\\nPRO |    to't.\\n\\nPRO\n   y us?\\n\\nPRO |    y us?\\n\\nPRO |    y us?\\n\\nPRO |    y us?\\n\\nPRO |    y us?\\n\\nPRO |    y us?\\n\\nPRO\n    you!\\n\\nPRO |     you!\\n\\nPRO |     you!\\n\\nPRO |     you!\\n\\nPRO |     you!\\n\\nPRO |     you!\\n\\nPRO\n   hore?\\n\\nPRO |    hore?\\n\\nPRO |    hore?\\n\\nPRO |    hore?\\n\\nPRO |    hore?\\n\\nPRO |    hore?\\n\\nPRO\n    man!\\n\\nPRO |     man!\\n\\nPRO |     man!\\n\\nPRO |     man!\\n\\nPRO |     man!\\n\\nPRO |     man!\\n\\nPRO\n   torm?\\n\\nPRO |    torm?\\n\\nPRO |    torm?\\n\\nPRO |    torm?\\n\\nPRO |    torm?\\n\\nPRO |    torm?\\n\\nPRO\n   lity.\\n\\nPRO |    lity.\\n\\nPRO |    lity.\\n\\nPRO |    lity.\\n\\nPRO |    lity.\\n\\nPRO |    lity.\\n\\nPRO\n   hake.\\n\\nPRO |    hake.\\n\\nPRO |    hake.\\n\\nPRO |    hake.\\n\\nPRO |    hake.\\n\\nPRO |    hake.\\n\\nPRO\n   ere.'\\n\\nPRO |    ere.'\\n\\nPRO |    ere.'\\n\\nPRO |    ere.'\\n\\nPRO |    ere.'\\n\\nPRO |    ere.'\\n\\nPRO\n   ster.\\n\\nPRO |    ster.\\n\\nPRO |    ster.\\n\\nPRO |    ster.\\n\\nPRO |    ster.\\n\\nPRO |    ster.\\n\\nPRO\n   knot.\\n\\nPRO |    knot.\\n\\nPRO |    knot.\\n\\nPRO |    knot.\\n\\nPRO |    knot.\\n\\nPRO |    knot.\\n\\nPRO\n   rish.\\n\\nPRO |    rish.\\n\\nPRO |    rish.\\n\\nPRO |    rish.\\n\\nPRO |    rish.\\n\\nPRO |    rish.\\n\\nPRO\n   ason.\\n\\nPRO |    ason.\\n\\nPRO |    ason.\\n\\nPRO |    ason.\\n\\nPRO |    ason.\\n\\nPRO |    ason.\\n\\nPRO\n   d me.\\n\\nPRO |    d me.\\n\\nPRO |    d me.\\n\\nPRO |    d me.\\n\\nPRO |    d me.\\n\\nPRO |    d me.\\n\\nPRO\n   erty.\\n\\nPRO |    erty.\\n\\nPRO |    erty.\\n\\nPRO |    erty.\\n\\nPRO |    erty.\\n\\nPRO |    erty.\\n\\nPRO\n   year.\\n\\nPRO |    year.\\n\\nPRO |    year.\\n\\nPRO |    year.\\n\\nPRO |    year.\\n\\nPRO |    year.\\n\\nPRO\n  :\\nNo.\\n\\nPRO |   :\\nNo.\\n\\nPRO |   :\\nNo.\\n\\nPRO |   :\\nNo.\\n\\nPRO |   :\\nNo.\\n\\nPRO |   :\\nNo.\\n\\nPRO\n    sir.\\n\\nPRO |     sir.\\n\\nPRO |     sir.\\n\\nPRO |     sir.\\n\\nPRO |     sir.\\n\\nPRO |     sir.\\n\\nPRO\n   gier.\\n\\nPRO |    gier.\\n\\nPRO |    gier.\\n\\nPRO |    gier.\\n\\nPRO |    gier.\\n\\nPRO |    gier.\\n\\nPRO\n    son.\\n\\nPRO |     son.\\n\\nPRO |     son.\\n\\nPRO |     son.\\n\\nPRO |     son.\\n\\nPRO |     son.\\n\\nPRO\n   ntly.\\n\\nPRO |    ntly.\\n\\nPRO |    ntly.\\n\\nPRO |    ntly.\\n\\nPRO |    ntly.\\n\\nPRO |    ntly.\\n\\nPRO\n   I do?\\n\\nPRO |    I do?\\n\\nPRO |    I do?\\n\\nPRO |    I do?\\n\\nPRO |    I do?\\n\\nPRO |    I do?\\n\\nPRO\n   n me.\\n\\nPRO |    n me.\\n\\nPRO |    n me.\\n\\nPRO |    n me.\\n\\nPRO |    n me.\\n\\nPRO |    n me.\\n\\nPRO\n   k on.\\n\\nPRO |    k on.\\n\\nPRO |    k on.\\n\\nPRO |    k on.\\n\\nPRO |    k on.\\n\\nPRO |    k on.\\n\\nPRO\n   IBAN:\\n\\nPRO |    IBAN:\\n\\nPRO |    IBAN:\\n\\nPRO |    IBAN:\\n\\nPRO |    IBAN:\\n\\nPRO |    done.\\n\\nPRO\n   done.\\n\\nPRO |    done.\\n\\nPRO |    done.\\n\\nPRO |    done.\\n\\nPRO |    done.\\n\\nPRO |    o'er!\\n\\nPRO\n   o'er!\\n\\nPRO |    o'er!\\n\\nPRO |    o'er!\\n\\nPRO |    o'er!\\n\\nPRO |    o'er!\\n\\nPRO |    land.\\n\\nPRO\n   land.\\n\\nPRO |    land.\\n\\nPRO |    land.\\n\\nPRO |    land.\\n\\nPRO |    land.\\n\\nPRO |    bans.\\n\\nPRO\n   bans.\\n\\nPRO |    bans.\\n\\nPRO |    bans.\\n\\nPRO |    bans.\\n\\nPRO |    bans.\\n\\nPRO |    uage!\\n\\nPRO\n   uage!\\n\\nPRO |    uage!\\n\\nPRO |    uage!\\n\\nPRO |    uage!\\n\\nPRO |    uage!\\n\\nPRO |     him.\\n\\nPRO\n    him.\\n\\nPRO |     him.\\n\\nPRO |     him.\\n\\nPRO |     him.\\n\\nPRO |     him.\\n\\nPRO |    e me.\\n\\nPRO\n   e me.\\n\\nPRO |    e me.\\n\\nPRO |    e me.\\n\\nPRO |    e me.\\n\\nPRO |    e me.\\n\\nPRO |    irit.\\n\\nPRO\n   irit.\\n\\nPRO |    irit.\\n\\nPRO |    irit.\\n\\nPRO |    irit.\\n\\nPRO |    irit.\\n\\nPRO |    oble.\\n\\nPRO\n   oble.\\n\\nPRO |    oble.\\n\\nPRO |    oble.\\n\\nPRO |    oble.\\n\\nPRO |    oble.\\n\\nPRO |    oken.\\n\\nPRO\n   oken.\\n\\nPRO |    oken.\\n\\nPRO |    oken.\\n\\nPRO |    oken.\\n\\nPRO |    oken.\\n\\nPRO |    wain.\\n\\nPRO\n   wain.\\n\\nPRO |    wain.\\n\\nPRO |    wain.\\n\\nPRO |    wain.\\n\\nPRO |    wain.\\n\\nPRO |    ples.\\n\\nPRO\n   ples.\\n\\nPRO |    ples.\\n\\nPRO |    ples.\\n\\nPRO |    ples.\\n\\nPRO |    ples.\\n\\nPRO |    th't.\\n\\nPRO\n   th't.\\n\\nPRO |    th't.\\n\\nPRO |    th't.\\n\\nPRO |    th't.\\n\\nPRO |    th't.\\n\\nPRO |    rful.\\n\\nPRO\n   rful.\\n\\nPRO |    rful.\\n\\nPRO |    rful.\\n\\nPRO |    rful.\\n\\nPRO |    rful.\\n\\nPRO |    rety.\\n\\nPRO\n   rety.\\n\\nPRO |    rety.\\n\\nPRO |    rety.\\n\\nPRO |    rety.\\n\\nPRO |    rety.\\n\\nPRO |     man.\\n\\nPRO\n    man.\\n\\nPRO |     man.\\n\\nPRO |     man.\\n\\nPRO |     man.\\n\\nPRO |     man.\\n\\nPRO |    ison.\\n\\nPRO\n   ison.\\n\\nPRO |    ison.\\n\\nPRO |    ison.\\n\\nPRO |    ison.\\n\\nPRO |    ison.\\n\\nPRO |    able.\\n\\nPRO\n   able.\\n\\nPRO |    able.\\n\\nPRO |    able.\\n\\nPRO |    able.\\n\\nPRO |    able.\\n\\nPRO |                \n\nQuery string: ople.\\n\\nSEB\n   sink?\\n\\nSEB |    sink?\\n\\nSEB |    sink?\\n\\nSEB |    sink?\\n\\nSEB |    sink?\\n\\nSEB |    sink?\\n\\nSEB\n   eirs.\\n\\nSEB |    eirs.\\n\\nSEB |    eirs.\\n\\nSEB |    eirs.\\n\\nSEB |    eirs.\\n\\nSEB |    eirs.\\n\\nSEB\n   king.\\n\\nSEB |    king.\\n\\nSEB |    king.\\n\\nSEB |    king.\\n\\nSEB |    king.\\n\\nSEB |    king.\\n\\nSEB\n   eace.\\n\\nSEB |    eace.\\n\\nSEB |    eace.\\n\\nSEB |    eace.\\n\\nSEB |    eace.\\n\\nSEB |    eace.\\n\\nSEB\n   r so.\\n\\nSEB |    r so.\\n\\nSEB |    r so.\\n\\nSEB |    r so.\\n\\nSEB |    r so.\\n\\nSEB |    r so.\\n\\nSEB\n   ir,--\\n\\nSEB |    ir,--\\n\\nSEB |    ir,--\\n\\nSEB |    ir,--\\n\\nSEB |    ir,--\\n\\nSEB |    ir,--\\n\\nSEB\n   ner--\\n\\nSEB |    ner--\\n\\nSEB |    ner--\\n\\nSEB |    ner--\\n\\nSEB |    ner--\\n\\nSEB |    ner--\\n\\nSEB\n   osed.\\n\\nSEB |    osed.\\n\\nSEB |    osed.\\n\\nSEB |    osed.\\n\\nSEB |    osed.\\n\\nSEB |    osed.\\n\\nSEB\n   et,--\\n\\nSEB |    et,--\\n\\nSEB |    et,--\\n\\nSEB |    et,--\\n\\nSEB |    et,--\\n\\nSEB |    et,--\\n\\nSEB\n   crow?\\n\\nSEB |    crow?\\n\\nSEB |    crow?\\n\\nSEB |    crow?\\n\\nSEB |    crow?\\n\\nSEB |    crow?\\n\\nSEB\n   erel.\\n\\nSEB |    erel.\\n\\nSEB |    erel.\\n\\nSEB |    erel.\\n\\nSEB |    erel.\\n\\nSEB |    erel.\\n\\nSEB\n   hter.\\n\\nSEB |    hter.\\n\\nSEB |    hter.\\n\\nSEB |    hter.\\n\\nSEB |    hter.\\n\\nSEB |    hter.\\n\\nSEB\n   rt,--\\n\\nSEB |    rt,--\\n\\nSEB |    rt,--\\n\\nSEB |    rt,--\\n\\nSEB |    rt,--\\n\\nSEB |    rt,--\\n\\nSEB\n   le,--\\n\\nSEB |    le,--\\n\\nSEB |    le,--\\n\\nSEB |    le,--\\n\\nSEB |    le,--\\n\\nSEB |    le,--\\n\\nSEB\n   ench.\\n\\nSEB |    ench.\\n\\nSEB |    ench.\\n\\nSEB |    ench.\\n\\nSEB |    ench.\\n\\nSEB |    ench.\\n\\nSEB\n   etly.\\n\\nSEB |    etly.\\n\\nSEB |    etly.\\n\\nSEB |    etly.\\n\\nSEB |    etly.\\n\\nSEB |    etly.\\n\\nSEB\n   live.\\n\\nSEB |    live.\\n\\nSEB |    live.\\n\\nSEB |    live.\\n\\nSEB |    live.\\n\\nSEB |    live.\\n\\nSEB\n   awny.\\n\\nSEB |    awny.\\n\\nSEB |    awny.\\n\\nSEB |    awny.\\n\\nSEB |    awny.\\n\\nSEB |    awny.\\n\\nSEB\n   much.\\n\\nSEB |    much.\\n\\nSEB |    much.\\n\\nSEB |    much.\\n\\nSEB |    much.\\n\\nSEB |    much.\\n\\nSEB\n   it,--\\n\\nSEB |    it,--\\n\\nSEB |    it,--\\n\\nSEB |    it,--\\n\\nSEB |    it,--\\n\\nSEB |    it,--\\n\\nSEB\n   lies?\\n\\nSEB |    lies?\\n\\nSEB |    lies?\\n\\nSEB |    lies?\\n\\nSEB |    lies?\\n\\nSEB |    lies?\\n\\nSEB\n   unis.\\n\\nSEB |    unis.\\n\\nSEB |    unis.\\n\\nSEB |    unis.\\n\\nSEB |    unis.\\n\\nSEB |    unis.\\n\\nSEB\n   Dido!\\n\\nSEB |    Dido!\\n\\nSEB |    Dido!\\n\\nSEB |    Dido!\\n\\nSEB |    Dido!\\n\\nSEB |    Dido!\\n\\nSEB\n   hage.\\n\\nSEB |    hage.\\n\\nSEB |    hage.\\n\\nSEB |    hage.\\n\\nSEB |    hage.\\n\\nSEB |    hage.\\n\\nSEB\n   next?\\n\\nSEB |    next?\\n\\nSEB |    next?\\n\\nSEB |    next?\\n\\nSEB |    next?\\n\\nSEB |    next?\\n\\nSEB\n   here.\\n\\nSEB |    here.\\n\\nSEB |    here.\\n\\nSEB |    here.\\n\\nSEB |    here.\\n\\nSEB |    here.\\n\\nSEB\n   gone.\\n\\nSEB |    gone.\\n\\nSEB |    gone.\\n\\nSEB |    gone.\\n\\nSEB |    gone.\\n\\nSEB |    gone.\\n\\nSEB\n   ster.\\n\\nSEB |    ster.\\n\\nSEB |    ster.\\n\\nSEB |    ster.\\n\\nSEB |    ster.\\n\\nSEB |    ster.\\n\\nSEB\n   oudy.\\n\\nSEB |    oudy.\\n\\nSEB |    oudy.\\n\\nSEB |    oudy.\\n\\nSEB |    oudy.\\n\\nSEB |    oudy.\\n\\nSEB\n   seed.\\n\\nSEB |    seed.\\n\\nSEB |    seed.\\n\\nSEB |    seed.\\n\\nSEB |    seed.\\n\\nSEB |    seed.\\n\\nSEB\n   I do?\\n\\nSEB |    I do?\\n\\nSEB |    I do?\\n\\nSEB |    I do?\\n\\nSEB |    I do?\\n\\nSEB |    I do?\\n\\nSEB\n   ty;--\\n\\nSEB |    ty;--\\n\\nSEB |    ty;--\\n\\nSEB |    ty;--\\n\\nSEB |    ty;--\\n\\nSEB |    ty;--\\n\\nSEB\n   ople.\\n\\nSEB |    ople.\\n\\nSEB |    ople.\\n\\nSEB |    ople.\\n\\nSEB |    ople.\\n\\nSEB |    ople.\\n\\nSEB\n    age.\\n\\nSEB |     age.\\n\\nSEB |     age.\\n\\nSEB |     age.\\n\\nSEB |     age.\\n\\nSEB |     age.\\n\\nSEB\n   iven!\\n\\nSEB |    iven!\\n\\nSEB |    iven!\\n\\nSEB |    iven!\\n\\nSEB |    iven!\\n\\nSEB |    iven!\\n\\nSEB\n   ging.\\n\\nSEB |    ging.\\n\\nSEB |    ging.\\n\\nSEB |    ging.\\n\\nSEB |    ging.\\n\\nSEB |    ging.\\n\\nSEB\n   o so.\\n\\nSEB |    o so.\\n\\nSEB |    o so.\\n\\nSEB |    o so.\\n\\nSEB |    o so.\\n\\nSEB |    o so.\\n\\nSEB\n   eavy.\\n\\nSEB |    eavy.\\n\\nSEB |    eavy.\\n\\nSEB |    eavy.\\n\\nSEB |    eavy.\\n\\nSEB |    eavy.\\n\\nSEB\n   mate.\\n\\nSEB |    mate.\\n\\nSEB |    mate.\\n\\nSEB |    mate.\\n\\nSEB |    mate.\\n\\nSEB |    mate.\\n\\nSEB\n   head.\\n\\nSEB |    head.\\n\\nSEB |    head.\\n\\nSEB |    head.\\n\\nSEB |    head.\\n\\nSEB |    head.\\n\\nSEB\n   peak?\\n\\nSEB |    peak?\\n\\nSEB |    peak?\\n\\nSEB |    peak?\\n\\nSEB |    peak?\\n\\nSEB |    peak?\\n\\nSEB\n\nQuery string: ead.\\n\\nSEBA\n   ink?\\n\\nSEBA |    ink?\\n\\nSEBA |    ink?\\n\\nSEBA |    ink?\\n\\nSEBA |    ink?\\n\\nSEBA |    ink?\\n\\nSEBA\n   irs.\\n\\nSEBA |    irs.\\n\\nSEBA |    irs.\\n\\nSEBA |    irs.\\n\\nSEBA |    irs.\\n\\nSEBA |    irs.\\n\\nSEBA\n   ing.\\n\\nSEBA |    ing.\\n\\nSEBA |    ing.\\n\\nSEBA |    ing.\\n\\nSEBA |    ing.\\n\\nSEBA |    ing.\\n\\nSEBA\n   ace.\\n\\nSEBA |    ace.\\n\\nSEBA |    ace.\\n\\nSEBA |    ace.\\n\\nSEBA |    ace.\\n\\nSEBA |    ace.\\n\\nSEBA\n    so.\\n\\nSEBA |     so.\\n\\nSEBA |     so.\\n\\nSEBA |     so.\\n\\nSEBA |     so.\\n\\nSEBA |     so.\\n\\nSEBA\n   r,--\\n\\nSEBA |    r,--\\n\\nSEBA |    r,--\\n\\nSEBA |    r,--\\n\\nSEBA |    r,--\\n\\nSEBA |    r,--\\n\\nSEBA\n   er--\\n\\nSEBA |    er--\\n\\nSEBA |    er--\\n\\nSEBA |    er--\\n\\nSEBA |    er--\\n\\nSEBA |    er--\\n\\nSEBA\n   sed.\\n\\nSEBA |    sed.\\n\\nSEBA |    sed.\\n\\nSEBA |    sed.\\n\\nSEBA |    sed.\\n\\nSEBA |    sed.\\n\\nSEBA\n   t,--\\n\\nSEBA |    t,--\\n\\nSEBA |    t,--\\n\\nSEBA |    t,--\\n\\nSEBA |    t,--\\n\\nSEBA |    t,--\\n\\nSEBA\n   row?\\n\\nSEBA |    row?\\n\\nSEBA |    row?\\n\\nSEBA |    row?\\n\\nSEBA |    row?\\n\\nSEBA |    row?\\n\\nSEBA\n   rel.\\n\\nSEBA |    rel.\\n\\nSEBA |    rel.\\n\\nSEBA |    rel.\\n\\nSEBA |    rel.\\n\\nSEBA |    rel.\\n\\nSEBA\n   ter.\\n\\nSEBA |    ter.\\n\\nSEBA |    ter.\\n\\nSEBA |    ter.\\n\\nSEBA |    ter.\\n\\nSEBA |    ter.\\n\\nSEBA\n   e,--\\n\\nSEBA |    e,--\\n\\nSEBA |    e,--\\n\\nSEBA |    e,--\\n\\nSEBA |    e,--\\n\\nSEBA |    e,--\\n\\nSEBA\n   nch.\\n\\nSEBA |    nch.\\n\\nSEBA |    nch.\\n\\nSEBA |    nch.\\n\\nSEBA |    nch.\\n\\nSEBA |    nch.\\n\\nSEBA\n   tly.\\n\\nSEBA |    tly.\\n\\nSEBA |    tly.\\n\\nSEBA |    tly.\\n\\nSEBA |    tly.\\n\\nSEBA |    tly.\\n\\nSEBA\n   ive.\\n\\nSEBA |    ive.\\n\\nSEBA |    ive.\\n\\nSEBA |    ive.\\n\\nSEBA |    ive.\\n\\nSEBA |    ive.\\n\\nSEBA\n   wny.\\n\\nSEBA |    wny.\\n\\nSEBA |    wny.\\n\\nSEBA |    wny.\\n\\nSEBA |    wny.\\n\\nSEBA |    wny.\\n\\nSEBA\n   uch.\\n\\nSEBA |    uch.\\n\\nSEBA |    uch.\\n\\nSEBA |    uch.\\n\\nSEBA |    uch.\\n\\nSEBA |    uch.\\n\\nSEBA\n   ies?\\n\\nSEBA |    ies?\\n\\nSEBA |    ies?\\n\\nSEBA |    ies?\\n\\nSEBA |    ies?\\n\\nSEBA |    ies?\\n\\nSEBA\n   nis.\\n\\nSEBA |    nis.\\n\\nSEBA |    nis.\\n\\nSEBA |    nis.\\n\\nSEBA |    nis.\\n\\nSEBA |    nis.\\n\\nSEBA\n   ido!\\n\\nSEBA |    ido!\\n\\nSEBA |    ido!\\n\\nSEBA |    ido!\\n\\nSEBA |    ido!\\n\\nSEBA |    ido!\\n\\nSEBA\n   age.\\n\\nSEBA |    age.\\n\\nSEBA |    age.\\n\\nSEBA |    age.\\n\\nSEBA |    age.\\n\\nSEBA |    age.\\n\\nSEBA\n   ext?\\n\\nSEBA |    ext?\\n\\nSEBA |    ext?\\n\\nSEBA |    ext?\\n\\nSEBA |    ext?\\n\\nSEBA |    ext?\\n\\nSEBA\n   ere.\\n\\nSEBA |    ere.\\n\\nSEBA |    ere.\\n\\nSEBA |    ere.\\n\\nSEBA |    ere.\\n\\nSEBA |    ere.\\n\\nSEBA\n   one.\\n\\nSEBA |    one.\\n\\nSEBA |    one.\\n\\nSEBA |    one.\\n\\nSEBA |    one.\\n\\nSEBA |    one.\\n\\nSEBA\n   udy.\\n\\nSEBA |    udy.\\n\\nSEBA |    udy.\\n\\nSEBA |    udy.\\n\\nSEBA |    udy.\\n\\nSEBA |    udy.\\n\\nSEBA\n   eed.\\n\\nSEBA |    eed.\\n\\nSEBA |    eed.\\n\\nSEBA |    eed.\\n\\nSEBA |    eed.\\n\\nSEBA |    eed.\\n\\nSEBA\n    do?\\n\\nSEBA |     do?\\n\\nSEBA |     do?\\n\\nSEBA |     do?\\n\\nSEBA |     do?\\n\\nSEBA |     do?\\n\\nSEBA\n   y;--\\n\\nSEBA |    y;--\\n\\nSEBA |    y;--\\n\\nSEBA |    y;--\\n\\nSEBA |    y;--\\n\\nSEBA |    y;--\\n\\nSEBA\n   ple.\\n\\nSEBA |    ple.\\n\\nSEBA |    ple.\\n\\nSEBA |    ple.\\n\\nSEBA |    ple.\\n\\nSEBA |    ple.\\n\\nSEBA\n   ven!\\n\\nSEBA |    ven!\\n\\nSEBA |    ven!\\n\\nSEBA |    ven!\\n\\nSEBA |    ven!\\n\\nSEBA |    ven!\\n\\nSEBA\n   avy.\\n\\nSEBA |    avy.\\n\\nSEBA |    avy.\\n\\nSEBA |    avy.\\n\\nSEBA |    avy.\\n\\nSEBA |    avy.\\n\\nSEBA\n   ate.\\n\\nSEBA |    ate.\\n\\nSEBA |    ate.\\n\\nSEBA |    ate.\\n\\nSEBA |    ate.\\n\\nSEBA |    ate.\\n\\nSEBA\n   ead.\\n\\nSEBA |    ead.\\n\\nSEBA |    ead.\\n\\nSEBA |    ead.\\n\\nSEBA |    ead.\\n\\nSEBA |    ead.\\n\\nSEBA\n   eak?\\n\\nSEBA |    eak?\\n\\nSEBA |    eak?\\n\\nSEBA |    eak?\\n\\nSEBA |    eak?\\n\\nSEBA |    eak?\\n\\nSEBA\n\nQuery string: time.\\n\\nGON\n   torm.\\n\\nGON |    torm.\\n\\nGON |    torm.\\n\\nGON |    torm.\\n\\nGON |    torm.\\n\\nGON |    torm.\\n\\nGON\n    not.\\n\\nGON |     not.\\n\\nGON |     not.\\n\\nGON |     not.\\n\\nGON |     not.\\n\\nGON |     not.\\n\\nGON\n    say.\\n\\nGON |     say.\\n\\nGON |     say.\\n\\nGON |     say.\\n\\nGON |     say.\\n\\nGON |     say.\\n\\nGON\n    art.\\n\\nGON |     art.\\n\\nGON |     art.\\n\\nGON |     art.\\n\\nGON |     art.\\n\\nGON |     art.\\n\\nGON\n   cold?\\n\\nGON |    cold?\\n\\nGON |    cold?\\n\\nGON |    cold?\\n\\nGON |    cold?\\n\\nGON |    cold?\\n\\nGON\n   ides!\\n\\nGON |    ides!\\n\\nGON |    ides!\\n\\nGON |    ides!\\n\\nGON |    ides!\\n\\nGON |    ides!\\n\\nGON\n    him.\\n\\nGON |     him.\\n\\nGON |     him.\\n\\nGON |     him.\\n\\nGON |     him.\\n\\nGON |     him.\\n\\nGON\n   rike.\\n\\nGON |    rike.\\n\\nGON |    rike.\\n\\nGON |    rike.\\n\\nGON |    rike.\\n\\nGON |    rike.\\n\\nGON\n   tell.\\n\\nGON |    tell.\\n\\nGON |    tell.\\n\\nGON |    tell.\\n\\nGON |    tell.\\n\\nGON |    tell.\\n\\nGON\n   llar.\\n\\nGON |    llar.\\n\\nGON |    llar.\\n\\nGON |    llar.\\n\\nGON |    llar.\\n\\nGON |    llar.\\n\\nGON\n   ould.\\n\\nGON |    ould.\\n\\nGON |    ould.\\n\\nGON |    ould.\\n\\nGON |    ould.\\n\\nGON |    ould.\\n\\nGON\n   pare.\\n\\nGON |    pare.\\n\\nGON |    pare.\\n\\nGON |    pare.\\n\\nGON |    pare.\\n\\nGON |    pare.\\n\\nGON\n    fen.\\n\\nGON |     fen.\\n\\nGON |     fen.\\n\\nGON |     fen.\\n\\nGON |     fen.\\n\\nGON |     fen.\\n\\nGON\n   ttle.\\n\\nGON |    ttle.\\n\\nGON |    ttle.\\n\\nGON |    ttle.\\n\\nGON |    ttle.\\n\\nGON |    ttle.\\n\\nGON\n   ally.\\n\\nGON |    ally.\\n\\nGON |    ally.\\n\\nGON |    ally.\\n\\nGON |    ally.\\n\\nGON |    ally.\\n\\nGON\n    are.\\n\\nGON |     are.\\n\\nGON |     are.\\n\\nGON |     are.\\n\\nGON |     are.\\n\\nGON |     are.\\n\\nGON\n   eport\\n\\nGON |    eport\\n\\nGON |    eport\\n\\nGON |    eport\\n\\nGON |    eport\\n\\nGON |    eport\\n\\nGON\n   ueen.\\n\\nGON |    ueen.\\n\\nGON |    ueen.\\n\\nGON |    ueen.\\n\\nGON |    ueen.\\n\\nGON |    ueen.\\n\\nGON\n   unis.\\n\\nGON |    unis.\\n\\nGON |    unis.\\n\\nGON |    unis.\\n\\nGON |    unis.\\n\\nGON |    unis.\\n\\nGON\n   hage?\\n\\nGON |    hage?\\n\\nGON |    hage?\\n\\nGON |    hage?\\n\\nGON |    hage?\\n\\nGON |    hage?\\n\\nGON\n   ands.\\n\\nGON |    ands.\\n\\nGON |    ands.\\n\\nGON |    ands.\\n\\nGON |    ands.\\n\\nGON |    ands.\\n\\nGON\n   time.\\n\\nGON |    time.\\n\\nGON |    time.\\n\\nGON |    time.\\n\\nGON |    time.\\n\\nGON |    time.\\n\\nGON\n   Dido.\\n\\nGON |    Dido.\\n\\nGON |    Dido.\\n\\nGON |    Dido.\\n\\nGON |    Dido.\\n\\nGON |    Dido.\\n\\nGON\n    for.\\n\\nGON |     for.\\n\\nGON |     for.\\n\\nGON |     for.\\n\\nGON |     for.\\n\\nGON |     for.\\n\\nGON\n   loss.\\n\\nGON |    loss.\\n\\nGON |    loss.\\n\\nGON |    loss.\\n\\nGON |    loss.\\n\\nGON |    loss.\\n\\nGON\n   only.\\n\\nGON |    only.\\n\\nGON |    only.\\n\\nGON |    only.\\n\\nGON |    only.\\n\\nGON |    only.\\n\\nGON\n   foul.\\n\\nGON |    foul.\\n\\nGON |    foul.\\n\\nGON |    foul.\\n\\nGON |    foul.\\n\\nGON |    foul.\\n\\nGON\n   lows.\\n\\nGON |    lows.\\n\\nGON |    lows.\\n\\nGON |    lows.\\n\\nGON |    lows.\\n\\nGON |    lows.\\n\\nGON\n   wine.\\n\\nGON |    wine.\\n\\nGON |    wine.\\n\\nGON |    wine.\\n\\nGON |    wine.\\n\\nGON |    wine.\\n\\nGON\n   ning.\\n\\nGON |    ning.\\n\\nGON |    ning.\\n\\nGON |    ning.\\n\\nGON |    ning.\\n\\nGON |    ning.\\n\\nGON\n   aves.\\n\\nGON |    aves.\\n\\nGON |    aves.\\n\\nGON |    aves.\\n\\nGON |    aves.\\n\\nGON |    aves.\\n\\nGON\n   zalo!\\n\\nGON |    zalo!\\n\\nGON |    zalo!\\n\\nGON |    zalo!\\n\\nGON |    zalo!\\n\\nGON |    zalo!\\n\\nGON\n   o me.\\n\\nGON |    o me.\\n\\nGON |    o me.\\n\\nGON |    o me.\\n\\nGON |    o me.\\n\\nGON |    o me.\\n\\nGON\n   d at.\\n\\nGON |    d at.\\n\\nGON |    d at.\\n\\nGON |    d at.\\n\\nGON |    d at.\\n\\nGON |    d at.\\n\\nGON\n   long.\\n\\nGON |    long.\\n\\nGON |    long.\\n\\nGON |    long.\\n\\nGON |    long.\\n\\nGON |    long.\\n\\nGON\n   ngry.\\n\\nGON |    ngry.\\n\\nGON |    ngry.\\n\\nGON |    ngry.\\n\\nGON |    ngry.\\n\\nGON |    ngry.\\n\\nGON\n\n\n\n\n# Were these strings used in training?\nfor q_idx in torch.nonzero(h &gt; 0.99).squeeze(dim=-1):\n    print(f\"{q_idx.item()}: {repr(strings20k[q_idx.item()])[1:-1]}, in training? {strings20k[q_idx.item()] in substrings_trained_on}\")\n\n4016:  her volub, in training? False\n5411: o'er!\\n\\nPRO, in training? False\n5583: uaint Arie, in training? False\n8172: tly.\\n\\nPROS, in training? False\n13046:  him.\\n\\nPRO, in training? False\n14283: ople.\\n\\nSEB, in training? False\n17567: ead.\\n\\nSEBA, in training? False\n17786: time.\\n\\nGON, in training? False\n\n\nLet’s look at how the Hellinger distance stats differ when looking at only strings that were trained on.\n\nstrings_used_in_training, indices_used_in_training = filter_by_trained_on(\n    strings20k,\n    substrings_trained_on,\n)\n\n\nh[indices_used_in_training].mean(), h[indices_used_in_training].min(), h[indices_used_in_training].max()\n\n(tensor(0.1649), tensor(0.0013), tensor(0.9021))\n\n\nMean improves a tiny bit, min stays the same, and max gets a lot lower. So this suggests it’s throwing out many of the worst strings. Let’s look at the distribution.\n\nsns.kdeplot(h[indices_used_in_training].numpy(), fill=True)\nplt.title(\"Distribution of Hellinger Distance considering only samples used in training\")\nplt.show()\n\n\n\n\n\n\n\n\nLooks like a smaller tail out at the end.\n\n# How many items where there in the original 20k that had worse scores than the\n# worst one that was used in training?\n(h &gt; h[indices_used_in_training].max()).sum()\n\ntensor(34)\n\n\n\n# Confirm these were all not used in training:\nindices = (h &gt; h[indices_used_in_training].max()).nonzero(as_tuple=True)[0]\nall([strings20k[i.item()] not in substrings_trained_on for i in indices])\n\nTrue\n\n\nNow let’s look at just the ones not used in training and see what the distribution is.\n\nindices_not_used_in_training = torch.tensor([i for i in range(len(strings20k)) if i not in indices_used_in_training], dtype=torch.long)\nh[indices_not_used_in_training].shape[0], h[indices_not_used_in_training].mean(), h[indices_not_used_in_training].min(), h[indices_not_used_in_training].max()\n\n(1829, tensor(0.2014), tensor(0.0018), tensor(0.9994))\n\n\n\nsns.kdeplot(h[indices_not_used_in_training].numpy(), fill=True)\nplt.title(\"Distribution of Hellinger Distance considering only samples NOT used in training\")\nplt.show()\n\n\n\n\n\n\n\n\nSo it seems like a lot of the worse performing ones are in this set, but this set also does contain a good number of decently performing ones.",
    "crumbs": [
      "analyses",
      "Widening the Space of Similar Values"
    ]
  },
  {
    "objectID": "analyses/widening_similar_space.html#selecting-thresholds-revisited",
    "href": "analyses/widening_similar_space.html#selecting-thresholds-revisited",
    "title": "Widening the Space of Similar Values",
    "section": "Selecting Thresholds Revisited",
    "text": "Selecting Thresholds Revisited\nIf we select based on the effect of the Hellinger distance, would we choose different thresholds?\n\ndef hellinger_distance(\n    p: torch.Tensor,\n    q: torch.Tensor,\n):\n    return ((p.sqrt() - q.sqrt())**2).sum(dim=-1).sqrt() / math.sqrt(2)\n\n\nn_queries_sample = 500\nq_idx_start = 0\nq_idx_end = n_queries_sample\nall_strings = strings10\nnext_token_map = next_token_map10\nmodel_probs_sample = get_model_probs(strings20k[:n_queries_sample], encoding_helpers)\n\n\ndef h_stats_for_block(\n    block_idx: int,\n    threshold: float,\n    q_idx_start: int = 0,\n    q_idx_end: int = n_queries_sample,\n    all_strings: Sequence[str] = strings10,\n    next_token_map: Dict[str, int] = next_token_map10,\n    model_probs: torch.Tensor = model_probs_sample,\n):\n    matching_indices = filter_on_prefiltered_results(\n        load_prefiltered=lambda q_idx: torch.load(\n            prefiltered_filename(q_idx, block_idx)\n        ),\n        q_idx_start=q_idx_start,\n        q_idx_end=q_idx_end,\n        filter_fn=lambda values: values &gt; threshold,\n    )\n    filter_results_strings = get_matching_strings(matching_indices, all_strings)\n    filter_result_freqs = torch.stack(\n        [\n            torch.stack(\n                [\n                    next_token_map[matching_string]\n                    for matching_string in matching_strings\n                ]\n            ).sum(dim=0)\n            for matching_strings in filter_results_strings\n        ]\n    )\n    filter_result_probs = filter_result_freqs / filter_result_freqs.sum(\n        dim=-1, keepdim=True\n    )\n    h_block = hellinger_distance(model_probs, filter_result_probs)\n    return h_block.mean(), h_block.min(), h_block.max()\n\n\ndef h_stats_for_thresholds(\n    block_idx: int,\n    thresholds: Sequence[float],\n    q_idx_start: int = 0,\n    q_idx_end: int = n_queries_sample,\n    all_strings: Sequence[str] = strings10,\n    next_token_map: Dict[str, int] = next_token_map10,\n    model_probs: torch.Tensor = model_probs_sample,\n):\n    stats = [\n        h_stats_for_block(\n            block_idx=block_idx,\n            threshold=threshold,\n            q_idx_start=q_idx_start,\n            q_idx_end=q_idx_end,\n            all_strings=all_strings,\n            next_token_map=next_token_map,\n            model_probs=model_probs,\n        )\n        for threshold in thresholds\n    ]\n    h_means, h_mins, h_maxs = zip(*stats)\n    return h_means, h_mins, h_maxs\n\n\ndef plot_h_stats_vs_thresholds(\n    thresholds: Sequence[float],\n    data_series: Sequence[Sequence[float]],\n    labels: Sequence[str],\n    title: str,\n):\n    for data, label in zip(data_series, labels):\n        plt.plot(thresholds, data, label=label)\n    plt.legend()\n    plt.title(title)\n    plt.xlabel('Threshold')\n    plt.ylabel('Hellinger Distance')\n    plt.show()\n\n\nblock_idx = 5\nthresholds = np.linspace(0.7, 0.99, 10)\nh_means, h_mins, h_maxs = h_stats_for_thresholds(block_idx=block_idx, thresholds=thresholds)\nplot_h_stats_vs_thresholds(\n    thresholds=thresholds,\n    data_series=[h_means, h_mins, h_maxs],\n    labels=['mean', 'min', 'max'],\n    title=f\"Hellinger Distance for block {block_idx}\",\n)\n\n\n\n\n\n\n\n\n\nblock_idx = 5\nthresholds = np.linspace(0.85, 0.90, 10)\nh_means, _, _ = h_stats_for_thresholds(block_idx=block_idx, thresholds=thresholds)\nplot_h_stats_vs_thresholds(\n    thresholds=thresholds,\n    data_series=[h_means],\n    labels=['mean'],\n    title=f\"Hellinger Distance for block {block_idx} (zoomed in)\",\n)\nmin_idx = torch.stack(h_means).argmin()\nthresholds[min_idx.item()], h_means[min_idx.item()]\n\n\n\n\n\n\n\n\n\nblock_idx = 4\nthresholds = np.linspace(0.7, 0.99, 10)\nh_means, h_mins, h_maxs = h_stats_for_thresholds(block_idx=block_idx, thresholds=thresholds)\nplot_h_stats_vs_thresholds(\n    thresholds=thresholds,\n    data_series=[h_means, h_mins, h_maxs],\n    labels=['mean', 'min', 'max'],\n    title=f\"Hellinger Distance for block {block_idx}\",\n)\n\n\n\n\n\n\n\n\n\nblock_idx = 4\nthresholds = np.linspace(0.77, 0.82, 10)\nh_means, _, _ = h_stats_for_thresholds(block_idx=block_idx, thresholds=thresholds)\nplot_h_stats_vs_thresholds(\n    thresholds=thresholds,\n    data_series=[h_means],\n    labels=['mean'],\n    title=f\"Hellinger Distance for block {block_idx} (zoomed in)\",\n)\nmin_idx = torch.stack(h_means).argmin()\nthresholds[min_idx.item()], h_means[min_idx.item()]\n\n\n\n\n\n\n\n\n\nblock_idx = 3\nthresholds = np.linspace(0.7, 0.99, 10)\nh_means, h_mins, h_maxs = h_stats_for_thresholds(block_idx=block_idx, thresholds=thresholds)\nplot_h_stats_vs_thresholds(\n    thresholds=thresholds,\n    data_series=[h_means, h_mins, h_maxs],\n    labels=['mean', 'min', 'max'],\n    title=f\"Hellinger Distance for block {block_idx}\",\n)\n\n\n\n\n\n\n\n\n\nblock_idx = 3\nthresholds = np.linspace(0.75, 0.80, 10)\nh_means, _, _ = h_stats_for_thresholds(block_idx=block_idx, thresholds=thresholds)\nplot_h_stats_vs_thresholds(\n    thresholds=thresholds,\n    data_series=[h_means],\n    labels=['mean'],\n    title=f\"Hellinger Distance for block {block_idx} (zoomed in)\",\n)\nmin_idx = torch.stack(h_means).argmin()\nthresholds[min_idx.item()], h_means[min_idx.item()]\n\n\n\n\n\n\n\n\n\nblock_idx = 2\nthresholds = np.linspace(0.7, 0.99, 10)\nh_means, h_mins, h_maxs = h_stats_for_thresholds(block_idx=block_idx, thresholds=thresholds)\nplot_h_stats_vs_thresholds(\n    thresholds=thresholds,\n    data_series=[h_means, h_mins, h_maxs],\n    labels=['mean', 'min', 'max'],\n    title=f\"Hellinger Distance for block {block_idx}\",\n)\n\n\n\n\n\n\n\n\n\nblock_idx = 2\nthresholds = np.linspace(0.82, 0.87, 10)\nh_means, _, _ = h_stats_for_thresholds(block_idx=block_idx, thresholds=thresholds)\nplot_h_stats_vs_thresholds(\n    thresholds=thresholds,\n    data_series=[h_means],\n    labels=['mean'],\n    title=f\"Hellinger Distance for block {block_idx} (zoomed in)\",\n)\nmin_idx = torch.stack(h_means).argmin()\nthresholds[min_idx.item()], h_means[min_idx.item()]\n\n\n\n\n\n\n\n\n\nblock_idx = 1\nthresholds = np.linspace(0.7, 0.99, 10)\nh_means, h_mins, h_maxs = h_stats_for_thresholds(block_idx=block_idx, thresholds=thresholds)\nplot_h_stats_vs_thresholds(\n    thresholds=thresholds,\n    data_series=[h_means, h_mins, h_maxs],\n    labels=['mean', 'min', 'max'],\n    title=f\"Hellinger Distance for block {block_idx}\",\n)\n\n\n\n\n\n\n\n\n\nblock_idx = 1\nthresholds = np.linspace(0.92, 0.97, 10)\nh_means, _, _ = h_stats_for_thresholds(block_idx=block_idx, thresholds=thresholds)\nplot_h_stats_vs_thresholds(\n    thresholds=thresholds,\n    data_series=[h_means],\n    labels=['mean'],\n    title=f\"Hellinger Distance for block {block_idx} (zoomed in)\",\n)\nmin_idx = torch.stack(h_means).argmin()\nthresholds[min_idx.item()], h_means[min_idx.item()]\n\n\n\n\n\n\n\n\n\nblock_idx = 0\nthresholds = np.linspace(0.7, 0.99, 10)\nh_means, h_mins, h_maxs = h_stats_for_thresholds(block_idx=block_idx, thresholds=thresholds)\nplot_h_stats_vs_thresholds(\n    thresholds=thresholds,\n    data_series=[h_means, h_mins, h_maxs],\n    labels=['mean', 'min', 'max'],\n    title=f\"Hellinger Distance for block {block_idx}\",\n)\n\n\n\n\n\n\n\n\n\nblock_idx = 0\nthresholds = np.linspace(0.94, 0.98, 10)\nh_means, _, _ = h_stats_for_thresholds(block_idx=block_idx, thresholds=thresholds)\nplot_h_stats_vs_thresholds(\n    thresholds=thresholds,\n    data_series=[h_means],\n    labels=['mean'],\n    title=f\"Hellinger Distance for block {block_idx} (zoomed in)\",\n)\nmin_idx = torch.stack(h_means).argmin()\nthresholds[min_idx.item()], h_means[min_idx.item()]\n\n\n\n\n\n\n\n\n\n# Based on the above, the new thresholds are:\n\nnew_thresholds = [0.9444, 0.9478, 0.8533, 0.7556, 0.7922, 0.8889]\n\n\n# Slow - takes about 7 minutes to run\n\n# Based on the new thresholds, calculate ffwd_freq for all strings again\nn_queries = 20000\n\nffwd_freqs_new = freqs_from_similar_strings(\n    get_prefiltered_data=get_prefiltered_data,\n    n_queries=n_queries,\n    next_token_map=next_token_map10,\n    all_strings=strings10,\n    similarity_thresholds=new_thresholds,\n)\n\n\n\n\n\n(results_folder / 'learn_coefficients').mkdir(exist_ok=True)\ntorch.save(ffwd_freqs_new, str(results_folder / 'learn_coefficients/ffwd_freqs_new.pt'))\n\n\n# Load ffwd_freqs_new from disk\nffwd_freqs_new = torch.load(results_folder / 'learn_coefficients/ffwd_freqs_new.pt')\n\n\nsim_probs_new = get_sim_probs(ffwd_freqs_new, hand_rolled_coeffs)\n\n\nh_new = hellinger_distance(model_probs, sim_probs_new)\nh_new.mean(), h_new.min(), h_new.max()\n\n(tensor(0.1692), tensor(0.0013), tensor(0.9994))\n\n\nThis is actually a slightly worse mean. But it might be the case that the hand-rolled coefficients are no longer optimal. Let’s try tweaking coefficients again.\n\nsim_probs_new = get_sim_probs(ffwd_freqs_new, torch.tensor([0.01, 0.01, 0.1, 1.9, 12, 0.01]).unsqueeze(dim=1).unsqueeze(dim=2))\nh_new = hellinger_distance(model_probs, sim_probs_new)\nh_new.mean(), h_new.min(), h_new.max()\n\n(tensor(0.1690), tensor(0.0013), tensor(0.9994))\n\n\nGave it a few rounds but it didn’t get much better. Maybe we could learn better coefficients but there is probably not a ton more to squeeze out.",
    "crumbs": [
      "analyses",
      "Widening the Space of Similar Values"
    ]
  },
  {
    "objectID": "analyses/widening_similar_space.html#cosine-sims-for-length-256-strings",
    "href": "analyses/widening_similar_space.html#cosine-sims-for-length-256-strings",
    "title": "Widening the Space of Similar Values",
    "section": "Cosine Sims for Length 256 Strings",
    "text": "Cosine Sims for Length 256 Strings\nThis section is a quick sanity check that the basic idea of approximating the transformer output with the ffwd outputs holds for longer strings. It would be time/disk space prohibitive to run the full analysis for much longer lengths so this is a heuristic intended to show that the basic idea holds.\nI created a new experiment (FinalFFWDExperiment) that runs strings through the model and saves only the ffwd output from the final block (block_idx == 5). I ran this for length 256 strings.\nThen here I compute cosine similarity between those final block ffwd outputs and a sample of 500 length 256 prompts. Filtering these down to the most similar, I then create frequency distribution for the next tokens from those strings in the training corpus and compare the results to the model.\n\nstrings256 = all_unique_substrings(ts.text, 256)\n\n\ntorch.manual_seed(1337)\nsample_size = 500\nindices256 = torch.randperm(len(strings256))[:sample_size]\nstrings256_sample = [strings256[i.item()] for i in indices256]\n\n\nmodel_outputs_sample256 = get_model_outputs(strings256_sample, encoding_helpers)\n\n\nprompts_exp256 = BlockInternalsExperiment(encoding_helpers, accessors, strings256_sample)\n\n\nclass CosineSimilaritiesForFinalFFWDExperiment:\n    def __init__(\n        self,\n        exp: FinalFFWDExperiment,\n        output_folder: Path,\n    ):\n        self.exp = exp\n        self.output_folder = output_folder\n\n        self.n_batches = exp.n_batches\n\n    def ffwd_out_sims_filename(self, batch_idx: int, block_idx: int):\n        return self.output_folder / f'ffwds_out_sims_{batch_idx:04d}_{block_idx:02d}.pt'\n\n    def generate_ffwd_out_sims(self, get_queries: Callable[[int], torch.Tensor], disable_progress_bar=False):\n        block_idx = n_layer - 1\n        for batch_idx in tqdm(range(self.exp.n_batches), disable=disable_progress_bar):\n            queries = get_queries(block_idx)\n            assert queries.dim() == 2\n            n_queries = queries.shape[0]\n\n            ffwd_out_batch = torch.load(str(self.exp._ffwd_output_filename(batch_idx=batch_idx, block_idx=block_idx)), mmap=True)\n            batch_size = ffwd_out_batch.shape[0]\n            sims = F.cosine_similarity(\n                ffwd_out_batch.reshape(batch_size, 1, -1).expand(-1, n_queries, -1),\n                queries,\n                dim=-1\n            )\n            torch.save(sims, str(self.ffwd_out_sims_filename(batch_idx=batch_idx, block_idx=block_idx)))\n\n\nffwd_exp256 = FinalFFWDExperiment(\n    eh=encoding_helpers,\n    accessors=accessors,\n    strings=strings256,\n    output_dir=environment.data_root / 'block_internals_results/large_files/slen256',\n    batch_size=400,\n)\n\n\noutput_folder = ffwd_exp256.output_dir / 'cosine_sims'\noutput_folder.mkdir(exist_ok=True)\n\n\ncos_exp256 = CosineSimilaritiesForFinalFFWDExperiment(ffwd_exp256, output_folder)\n\n\ncos_exp256.generate_ffwd_out_sims(get_queries=lambda block_idx: prompts_exp256.ffwd_output(block_idx=block_idx)[:, -1, :])\n\n\n\n\n\nnext_token_map256 = build_next_token_map(ts.text, 256, tokenizer.vocab_size, tokenizer.stoi)\n\n\nblock_idx = n_layer - 1\nffwd256 = filter_across_batches(\n    get_batch=lambda batch_idx: torch.load(str(cos_exp256.ffwd_out_sims_filename(batch_idx=batch_idx, block_idx=block_idx)), mmap=True),\n    n_batches=cos_exp256.n_batches,\n    filter_fn=lambda batch: batch &gt; 0.91,\n    n_queries=sample_size,\n)\nfilter_result_stats(ffwd256)\n\n{'min': 1, 'max': 38780, 'mean': 1561.9, 'std': 4162.8430373964375}\n\n\n\nffwd256_strings = get_matching_strings(ffwd256, strings256)\n\n\nffwd256_freqs = [\n    torch.stack([\n        next_token_map256[matching_string]\n        for matching_string in matching_strings\n    ]).sum(dim=0)\n    for matching_strings in ffwd256_strings\n]\nffwd256_probs = [\n    freqs / freqs.sum()\n    for freqs in ffwd256_freqs\n]\n\n\ntopn_matches, topn_matches_any_order = analyze_simulate_results(ffwd256_probs, model_outputs_sample256)\nfor i in range(10):\n    print(f\"Top {i+1} matches: {topn_matches[i] / sample_size:.3f}\")\n    print(f\"Top {i+1} matches (any order): {topn_matches_any_order[i] / sample_size:.3f}\")\n\nTop 1 matches: 0.802\nTop 1 matches (any order): 0.802\nTop 2 matches: 0.362\nTop 2 matches (any order): 0.412\nTop 3 matches: 0.246\nTop 3 matches (any order): 0.298\nTop 4 matches: 0.200\nTop 4 matches (any order): 0.250\nTop 5 matches: 0.156\nTop 5 matches (any order): 0.154\nTop 6 matches: 0.128\nTop 6 matches (any order): 0.148\nTop 7 matches: 0.070\nTop 7 matches (any order): 0.086\nTop 8 matches: 0.044\nTop 8 matches (any order): 0.068\nTop 9 matches: 0.032\nTop 9 matches (any order): 0.038\nTop 10 matches: 0.030\nTop 10 matches (any order): 0.016\n\n\n\nidx = 0\nprint(f\"Query {idx} ({repr(strings256_sample[idx])}): \")\nresult = ffwd256[idx]\nfor j in result[:20]:\n    print(f\"  {repr(strings256[j])}\")\n\nQuery 0 (\" see my shame in him.\\nThou art a widow; yet thou art a mother,\\nAnd hast the comfort of thy children left thee:\\nBut death hath snatch'd my husband from mine arms,\\nAnd pluck'd two crutches from my feeble limbs,\\nEdward and Clarence. O, what cause have I,\\nThin\"): \n  \" so.\\n\\nSICINIUS:\\nLet them assemble,\\nAnd on a safer judgment all revoke\\nYour ignorant election; enforce his pride,\\nAnd his old hate unto you; besides, forget not\\nWith what contempt he wore the humble weed,\\nHow in his suit he scorn'd you; but your loves,\\nThin\"\n  \"I'ld have beaten him like a dog, but for\\ndisturbing the lords within.\\n\\nAUFIDIUS:\\nWhence comest thou? what wouldst thou? thy name?\\nWhy speak'st not? speak, man: what's thy name?\\n\\nCORIOLANUS:\\nIf, Tullus,\\nNot yet thou knowest me, and, seeing me, dost not\\nThin\"\n  \"e not--to save my life, for if\\nI had fear'd death, of all the men i' the world\\nI would have 'voided thee, but in mere spite,\\nTo be full quit of those my banishers,\\nStand I before thee here. Then if thou hast\\nA heart of wreak in thee, that wilt revenge\\nThin\"\n  \"t,\\nwhich should\\nMake our eyes flow with joy, hearts dance\\nwith comforts,\\nConstrains them weep and shake with fear and sorrow;\\nMaking the mother, wife and child to see\\nThe son, the husband and the father tearing\\nHis country's bowels out. And to poor we\\nThin\"\n  \" abhorr'd.' Speak to me, son:\\nThou hast affected the fine strains of honour,\\nTo imitate the graces of the gods;\\nTo tear with thunder the wide cheeks o' the air,\\nAnd yet to charge thy sulphur with a bolt\\nThat should but rive an oak. Why dost not speak?\\nThin\"\n  \"d me, in the field by Tewksbury\\nWhen Oxford had me down, he rescued me,\\nAnd said, 'Dear brother, live, and be a king'?\\nWho told me, when we both lay in the field\\nFrozen almost to death, how he did lap me\\nEven in his own garments, and gave himself,\\nAll thin\"\n  \" see my shame in him.\\nThou art a widow; yet thou art a mother,\\nAnd hast the comfort of thy children left thee:\\nBut death hath snatch'd my husband from mine arms,\\nAnd pluck'd two crutches from my feeble limbs,\\nEdward and Clarence. O, what cause have I,\\nThin\"\n  \" uncle Clarence' angry ghost:\\nMy grandam told me he was murdered there.\\n\\nPRINCE EDWARD:\\nI fear no uncles dead.\\n\\nGLOUCESTER:\\nNor none that live, I hope.\\n\\nPRINCE EDWARD:\\nAn if they live, I hope I need not fear.\\nBut come, my lord; and with a heavy heart,\\nThin\"\n  \"ard, capable\\nHe is all the mother's, from the top to toe.\\n\\nBUCKINGHAM:\\nWell, let them rest. Come hither, Catesby.\\nThou art sworn as deeply to effect what we intend\\nAs closely to conceal what we impart:\\nThou know'st our reasons urged upon the way;\\nWhat thin\"\n  \"ng that yet think not on it.\\n\\nCATESBY:\\n'Tis a vile thing to die, my gracious lord,\\nWhen men are unprepared and look not for it.\\n\\nHASTINGS:\\nO monstrous, monstrous! and so falls it out\\nWith Rivers, Vaughan, Grey: and so 'twill do\\nWith some men else, who thin\"\n  \"od morrow; good morrow, Catesby:\\nYou may jest on, but, by the holy rood,\\nI do not like these several councils, I.\\n\\nHASTINGS:\\nMy lord,\\nI hold my life as dear as you do yours;\\nAnd never in my life, I do protest,\\nWas it more precious to me than 'tis now:\\nThin\"\n  \"fitting for that royal time?\\n\\nDERBY:\\nIt is, and wants but nomination.\\n\\nBISHOP OF ELY:\\nTo-morrow, then, I judge a happy day.\\n\\nBUCKINGHAM:\\nWho knows the lord protector's mind herein?\\nWho is most inward with the royal duke?\\n\\nBISHOP OF ELY:\\nYour grace, we thin\"\n  \"e English woes will make me smile in France.\\n\\nQUEEN ELIZABETH:\\nO thou well skill'd in curses, stay awhile,\\nAnd teach me how to curse mine enemies!\\n\\nQUEEN MARGARET:\\nForbear to sleep the nights, and fast the days;\\nCompare dead happiness with living woe;\\nThin\"\n  'thy daughter,\\nAnd mean to make her queen of England.\\n\\nQUEEN ELIZABETH:\\nSay then, who dost thou mean shall be her king?\\n\\nKING RICHARD III:\\nEven he that makes her queen who should be else?\\n\\nQUEEN ELIZABETH:\\nWhat, thou?\\n\\nKING RICHARD III:\\nI, even I: what thin'\n  \"w near,\\nAnd list what with our council we have done.\\nFor that our kingdom's earth should not be soil'd\\nWith that dear blood which it hath fostered;\\nAnd for our eyes do hate the dire aspect\\nOf civil wounds plough'd up with neighbours' sword;\\nAnd for we thin\"\n  'd,\\nHaving my freedom, boast of nothing else\\nBut that I was a journeyman to grief?\\n\\nJOHN OF GAUNT:\\nAll places that the eye of heaven visits\\nAre to a wise man ports and happy havens.\\nTeach thy necessity to reason thus;\\nThere is no virtue like necessity.\\nThin'\n  \"eys-general to sue\\nHis livery, and deny his offer'd homage,\\nYou pluck a thousand dangers on your head,\\nYou lose a thousand well-disposed hearts\\nAnd prick my tender patience, to those thoughts\\nWhich honour and allegiance cannot think.\\n\\nKING RICHARD II:\\nThin\"\n  \"their complices,\\nThe caterpillars of the commonwealth,\\nWhich I have sworn to weed and pluck away.\\n\\nDUKE OF YORK:\\nIt may be I will go with you: but yet I'll pause;\\nFor I am loath to break our country's laws.\\nNor friends nor foes, to me welcome you are:\\nThin\"\n  \"ee to France\\nAnd cloister thee in some religious house:\\nOur holy lives must win a new world's crown,\\nWhich our profane hours here have stricken down.\\n\\nQUEEN:\\nWhat, is my Richard both in shape and mind\\nTransform'd and weaken'd? hath Bolingbroke deposed\\nThin\"\n  'ildly, kiss the rod,\\nAnd fawn on rage with base humility,\\nWhich art a lion and a king of beasts?\\n\\nKING RICHARD II:\\nA king of beasts, indeed; if aught but beasts,\\nI had been still a happy king of men.\\nGood sometime queen, prepare thee hence for France:\\nThin'",
    "crumbs": [
      "analyses",
      "Widening the Space of Similar Values"
    ]
  },
  {
    "objectID": "common/environments.html",
    "href": "common/environments.html",
    "title": "environments",
    "section": "",
    "text": "source\n\nEnvironment\n\n Environment (name:str, code_root:pathlib.Path, data_root:pathlib.Path)\n\n\nsource\n\n\nget_environment\n\n get_environment ()",
    "crumbs": [
      "common",
      "environments"
    ]
  },
  {
    "objectID": "common/databatcher.html",
    "href": "common/databatcher.html",
    "title": "databatcher",
    "section": "",
    "text": "source\n\nDataBatcher\n\n DataBatcher (data:torch.Tensor, sample_len:int, max_batch_size:int,\n              stride:int)\n\nIterable that will break a long data tensor into batches of samples.\n\n# Tests for DataBatcher\n\n# Basic example\ndata_batcher = DataBatcher(data=torch.arange(6), sample_len=3, max_batch_size=2, stride=1)\ntest_eq(len(data_batcher), 2)\ntest_eq(\n    list(data_batcher),\n    [\n        [[0, 1, 2], [1, 2, 3]],\n        [[2, 3, 4], [3, 4, 5]],\n    ],\n)\n\n# Basic example with stride\ndata_batcher = DataBatcher(data=torch.arange(10), sample_len=3, max_batch_size=2, stride=2)\ntest_eq(len(data_batcher), 2)\ntest_eq(\n    list(data_batcher),\n    [\n        [[0, 1, 2], [2, 3, 4]],\n        [[4, 5, 6], [6, 7, 8]],\n    ],\n)\n\n# No repeated elements: stride = chunk_len\ndata_batcher = DataBatcher(data=torch.arange(6), sample_len=3, max_batch_size=2, stride=3)\ntest_eq(len(data_batcher), 1)\ntest_eq(\n    list(data_batcher),\n    [\n        [[0, 1, 2], [3, 4, 5]],\n    ],\n)\n\n# Last batch is smaller than max_batch_size\ndata_batcher = DataBatcher(data=torch.arange(7), sample_len=3, max_batch_size=2, stride=2)\ntest_eq(len(data_batcher), 2)\ntest_eq(\n    list(data_batcher),\n    [\n        [[0, 1, 2], [2, 3, 4]],\n        [[4, 5, 6]],\n    ],\n)\n\n# Not even one complete batch\ndata_batcher = DataBatcher(data=torch.arange(3), sample_len=3, max_batch_size=2, stride=2)\ntest_eq(len(data_batcher), 1)\ntest_eq(\n    list(data_batcher),\n    [\n        [[0, 1, 2]],\n    ],\n)\n\n# Same as above but add an extra element which still doesn't make a full batch\ndata_batcher = DataBatcher(data=torch.arange(8), sample_len=3, max_batch_size=2, stride=2)\ntest_eq(len(data_batcher), 2)\ntest_eq(\n    list(data_batcher),\n    [\n        [[0, 1, 2], [2, 3, 4]],\n        [[4, 5, 6]],\n    ],\n)\n\n# Only one chunk can fit\ndata_batcher = DataBatcher(data=torch.arange(8), sample_len=8, max_batch_size=2, stride=2)\ntest_eq(len(data_batcher), 1)\ntest_eq(\n    list(data_batcher),\n    [\n        [[0, 1, 2, 3, 4, 5, 6, 7]],\n    ],\n)\n\n# Large stride makes it so that only one chunk can fit\ndata_batcher = DataBatcher(data=torch.arange(10), sample_len=3, max_batch_size=2, stride=12)\ntest_eq(len(data_batcher), 1)\ntest_eq(\n    list(data_batcher),\n    [\n        [[0, 1, 2]],\n    ],\n)",
    "crumbs": [
      "common",
      "databatcher"
    ]
  },
  {
    "objectID": "common/svd-helpers.html",
    "href": "common/svd-helpers.html",
    "title": "svd-helpers",
    "section": "",
    "text": "source\n\nadjust_singular_vector_sign\n\n adjust_singular_vector_sign (singular_vector:torch.Tensor,\n                              original_matrix:torch.Tensor)\n\nDepending on the algorithm used to compute the SVD, the sign of the singular vectors can be flipped. This function adjusts the sign of the singular vector so that it aligns with the majority of the vectors in the original matrix. Per https://www.osti.gov/servlets/purl/920802, this is a valid way to resolve the sign ambiguity.\n\n# Tests for adjust_singular_vector_sign\ntest_matrix = torch.tensor([[1, 2, 3], [4, 5, 6], [7, 8, 9]])\ntest_singular_vector = torch.tensor([-0.4797, -0.5724, -0.6651])\n\ntest_eq(\n    adjust_singular_vector_sign(test_singular_vector, test_matrix),\n    -test_singular_vector,\n)\n\ntest_eq(\n    adjust_singular_vector_sign(-test_singular_vector, test_matrix),\n    -test_singular_vector,\n)\n\n\nsource\n\n\nprojection_matrix_for_rank_k_approximation\n\n projection_matrix_for_rank_k_approximation (original_matrix:torch.Tensor,\n                                             k:int)\n\nReturns a projection matrix that projects onto the subspace spanned by the top k singular vectors of the original matrix. Derivation of the formula: https://ocw.mit.edu/courses/18-06sc-linear-algebra-fall-2011/00e9c8f0eafedeab21a3d079a17ed3d8_MIT18_06SCF11_Ses2.2sum.pdf\n\n# Tests for projection_matrix_for_rank_k_approximation\n\n# Make up a test matrix where the singular vectors are just the standard\n# basis vectors for R^3\ntest_matrix = torch.tensor([\n    [3, 0, 0],\n    [0, 2, 0],\n    [0, 0, 1],\n], dtype=torch.float32)\n\ntest_vector = torch.tensor([1, 2, 3], dtype=torch.float32)\n\n# Test rank 1 approximation\nproj_matrix = projection_matrix_for_rank_k_approximation(test_matrix, 1)\nprojection = proj_matrix @ test_vector\n\n# The projection should be the projection of the test vector onto the x-axis\ne_1 = torch.tensor([1, 0, 0], dtype=torch.float32)\ntest_eq(projection, test_vector.dot(e_1) * e_1)\n\n# Test rank 2 approximation\nproj_matrix = projection_matrix_for_rank_k_approximation(test_matrix, 2)\nprojection = proj_matrix @ test_vector\n\n# The projection should be the projection of the test vector onto the x-y plane\ne_1 = torch.tensor([1, 0, 0], dtype=torch.float32)\ne_2 = torch.tensor([0, 1, 0], dtype=torch.float32)\ntest_eq(projection, test_vector.dot(e_1) * e_1 + test_vector.dot(e_2) * e_2)",
    "crumbs": [
      "common",
      "svd-helpers"
    ]
  },
  {
    "objectID": "training/dataset-split.html",
    "href": "training/dataset-split.html",
    "title": "dataset-split",
    "section": "",
    "text": "source\n\nsplit_text_dataset\n\n split_text_dataset (text:str, tokenizer:transformer_experiments.tokenizer\n                     s.char_tokenizer.CharacterTokenizer, train_pct:float,\n                     device:str)\n\n\n# Tests for split_text_dataset\ntext_len = 122\ntext = ''.join(['a' for _ in range(text_len)])\ntokenizer = CharacterTokenizer(text)\n\nsplit_pct = 0.7\ntrain_data, val_data = split_text_dataset(text, tokenizer, split_pct, device='cpu')\n\ntest_eq(len(train_data), int(split_pct*text_len))\ntest_eq(len(val_data), text_len - int(split_pct*text_len))",
    "crumbs": [
      "training",
      "dataset-split"
    ]
  },
  {
    "objectID": "datasets/tinyshakespeare.html",
    "href": "datasets/tinyshakespeare.html",
    "title": "tinyshakespeare.ipynb",
    "section": "",
    "text": "source\n\nTinyShakespeareDataSet\n\n TinyShakespeareDataSet (cache_file:str,\n                         url:str='https://raw.githubusercontent.com/karpat\n                         hy/char-\n                         rnn/master/data/tinyshakespeare/input.txt')\n\nInitialize self. See help(type(self)) for accurate signature.",
    "crumbs": [
      "datasets",
      "tinyshakespeare.ipynb"
    ]
  },
  {
    "objectID": "experiments/alternate-models.html",
    "href": "experiments/alternate-models.html",
    "title": "alternate-models",
    "section": "",
    "text": "environment = get_environment()\nprint(f\"environment is {environment.name}\")\n\nenvironment is paperspace\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nprint(f\"device is {device}\")\n\ndevice is cuda\nts = TinyShakespeareDataSet(environment.code_root / 'nbs/artifacts/input.txt')\ntokenizer = CharacterTokenizer(ts.text)\ntrain_data, val_data = split_text_dataset(ts.text, tokenizer, train_pct=0.9, device=device)\nget_batch_func = partial(\n    get_batch,\n    batch_size=batch_size,\n    block_size=block_size,\n    train_data=train_data,\n    val_data=val_data,\n    device=device,\n)\nestimate_loss_func = partial(\n    estimate_loss, eval_iters=eval_iters, get_batch_func=get_batch_func\n)\nexperiment_dir = environment.data_root / 'alternate-models'\nexperiment_dir.mkdir(exist_ok=True)\ntraining_root = experiment_dir / 'model-training' / f'{datetime.now().strftime(\"%Y%m%d\")}-training'\ntraining_root.mkdir(exist_ok=True, parents=True)\ncheckpoint_dir = training_root / 'training_checkpoints'\ncheckpoint_dir.mkdir(exist_ok=True, parents=True)\noutputs_dir = training_root / 'outputs'\noutputs_dir.mkdir(exist_ok=True, parents=True)",
    "crumbs": [
      "experiments",
      "alternate-models"
    ]
  },
  {
    "objectID": "experiments/alternate-models.html#training-model-1",
    "href": "experiments/alternate-models.html#training-model-1",
    "title": "alternate-models",
    "section": "Training Model 1",
    "text": "Training Model 1\n\niteration = 1\n\n\ntorch.manual_seed(1442)\nm = TransformerLanguageModel(vocab_size=tokenizer.vocab_size, device=device)\n\n\n_ = m.to(device)\n\n\ntrainer = Trainer(\n    model=m,\n    checkpointer=CheckPointer(checkpoint_dir, f'shakespeare_{iteration}_checkpoint'),\n    get_batch_func=get_batch_func,\n    estimate_loss_func=estimate_loss_func,\n    iters_trained=0,\n)\n\n\n# Get a starting point\nestimate_loss_func(m)\n\n{'train': tensor(4.2780), 'val': tensor(4.2824)}\n\n\n\n# Start with a modest learning rate and train 5000 iterations\nlearning_rate = 3e-4\noptimizer = torch.optim.AdamW(m.parameters(), lr=learning_rate)\ntrainer.train(3500, optimizer, eval_interval=eval_interval)\n\n\n\n\nstep 499: train loss 1.7921, val loss 1.9340\nstep 999: train loss 1.4039, val loss 1.6217\nstep 1499: train loss 1.2720, val loss 1.5374\nstep 1999: train loss 1.1952, val loss 1.5002\nstep 2499: train loss 1.1385, val loss 1.4993\nstep 2999: train loss 1.0794, val loss 1.4871\nstep 3499: train loss 1.0229, val loss 1.4950\n\n\n\n# Reduce learning rate and see if we can improve without overfitting.\nlearning_rate = 3e-5\noptimizer = torch.optim.AdamW(m.parameters(), lr=learning_rate)\ntrainer.train(3500, optimizer, eval_interval=eval_interval)\n\n\n\n\nstep 499: train loss 0.9652, val loss 1.4848\nstep 999: train loss 0.9445, val loss 1.4929\nstep 1499: train loss 0.9293, val loss 1.5038\nstep 1999: train loss 0.9129, val loss 1.5034\nstep 2499: train loss 0.8994, val loss 1.5133\nstep 2999: train loss 0.8875, val loss 1.5220\nstep 3499: train loss 0.8733, val loss 1.5258\n\n\n\n# Pick the checkpoint with losses closest to our target\ncheckpoint = torch.load(checkpoint_dir / f'shakespeare_{iteration}_checkpoint_000009.pt', map_location=torch.device('cpu'))\ncheckpoint['iters'], checkpoint['train_loss'], checkpoint['val_loss']\n\n(5000, tensor(0.9293), tensor(1.5038))\n\n\n\n# Save checkpoint\ntarget_filename = outputs_dir / f'shakespeare-{datetime.now().strftime(\"%Y%m%d\")}-{iteration}.pt'\ntorch.save(checkpoint['model_state_dict'], target_filename)\nprint(f\"Saved checkpoint to {target_filename}\")\n\nSaved checkpoint to /storage/alternate-models/model-training/20240112-training/outputs/shakespeare-20240112-1.pt",
    "crumbs": [
      "experiments",
      "alternate-models"
    ]
  },
  {
    "objectID": "experiments/alternate-models.html#training-model-2",
    "href": "experiments/alternate-models.html#training-model-2",
    "title": "alternate-models",
    "section": "Training Model 2",
    "text": "Training Model 2\n\niteration = 2\n\n\ntorch.manual_seed(88)\nm = TransformerLanguageModel(vocab_size=tokenizer.vocab_size, device=device)\n\n\n_ = m.to(device)\n\n\ntrainer = Trainer(\n    model=m,\n    checkpointer=CheckPointer(checkpoint_dir, f'shakespeare_{iteration}_checkpoint'),\n    get_batch_func=get_batch_func,\n    estimate_loss_func=estimate_loss_func,\n    iters_trained=0,\n)\n\n\n# Get a starting point\nestimate_loss_func(m)\n\n{'train': tensor(4.3503), 'val': tensor(4.3544)}\n\n\n\n# Start with a modest learning rate and train 5000 iterations\nlearning_rate = 3e-4\noptimizer = torch.optim.AdamW(m.parameters(), lr=learning_rate)\ntrainer.train(3500, optimizer, eval_interval=eval_interval)\n\n\n\n\nstep 499: train loss 1.7591, val loss 1.9024\nstep 999: train loss 1.3939, val loss 1.6083\nstep 1499: train loss 1.2698, val loss 1.5196\nstep 1999: train loss 1.1861, val loss 1.4866\nstep 2499: train loss 1.1303, val loss 1.4812\nstep 2999: train loss 1.0706, val loss 1.4865\nstep 3499: train loss 1.0152, val loss 1.4986\n\n\n\n# Reduce learning rate and see if we can improve without overfitting.\nlearning_rate = 3e-5\noptimizer = torch.optim.AdamW(m.parameters(), lr=learning_rate)\ntrainer.train(3500, optimizer, eval_interval=eval_interval)\n\n\n\n\nstep 499: train loss 0.9525, val loss 1.4957\nstep 999: train loss 0.9294, val loss 1.4991\nstep 1499: train loss 0.9119, val loss 1.5099\nstep 1999: train loss 0.8985, val loss 1.5203\nstep 2499: train loss 0.8825, val loss 1.5316\nstep 2999: train loss 0.8707, val loss 1.5292\nstep 3499: train loss 0.8560, val loss 1.5462\n\n\n\n# Pick the checkpoint with losses closest to our target\ncheckpoint = torch.load(checkpoint_dir / f'shakespeare_{iteration}_checkpoint_000008.pt', map_location=torch.device('cpu'))\ncheckpoint['iters'], checkpoint['train_loss'], checkpoint['val_loss']\n\n(4500, tensor(0.9294), tensor(1.4991))\n\n\n\n# Save checkpoint\ntarget_filename = outputs_dir / f'shakespeare-{datetime.now().strftime(\"%Y%m%d\")}-{iteration}.pt'\ntorch.save(checkpoint['model_state_dict'], target_filename)\nprint(f\"Saved checkpoint to {target_filename}\")\n\nSaved checkpoint to /storage/alternate-models/model-training/20240112-training/outputs/shakespeare-20240112-2.pt",
    "crumbs": [
      "experiments",
      "alternate-models"
    ]
  },
  {
    "objectID": "experiments/alternate-models.html#training-model-3",
    "href": "experiments/alternate-models.html#training-model-3",
    "title": "alternate-models",
    "section": "Training Model 3",
    "text": "Training Model 3\n\niteration = 3\n\n\ntorch.manual_seed(99999)\nm = TransformerLanguageModel(vocab_size=tokenizer.vocab_size, device=device)\n\n\n_ = m.to(device)\n\n\ntrainer = Trainer(\n    model=m,\n    checkpointer=CheckPointer(checkpoint_dir, f'shakespeare_{iteration}_checkpoint'),\n    get_batch_func=get_batch_func,\n    estimate_loss_func=estimate_loss_func,\n    iters_trained=0,\n)\n\n\n# Get a starting point\nestimate_loss_func(m)\n\n{'train': tensor(4.1027), 'val': tensor(4.1104)}\n\n\n\n# Start with a modest learning rate and train 5000 iterations\nlearning_rate = 3e-4\noptimizer = torch.optim.AdamW(m.parameters(), lr=learning_rate)\ntrainer.train(3500, optimizer, eval_interval=eval_interval)\n\n\n\n\nstep 499: train loss 1.7534, val loss 1.9022\nstep 999: train loss 1.3909, val loss 1.6158\nstep 1499: train loss 1.2663, val loss 1.5401\nstep 1999: train loss 1.1896, val loss 1.5024\nstep 2499: train loss 1.1243, val loss 1.4805\nstep 2999: train loss 1.0696, val loss 1.4846\nstep 3499: train loss 1.0183, val loss 1.4951\n\n\n\n# Reduce learning rate and see if we can improve without overfitting.\nlearning_rate = 3e-5\noptimizer = torch.optim.AdamW(m.parameters(), lr=learning_rate)\ntrainer.train(3500, optimizer, eval_interval=eval_interval)\n\n\n\n\nstep 499: train loss 0.9545, val loss 1.4912\nstep 999: train loss 0.9339, val loss 1.4941\nstep 1499: train loss 0.9162, val loss 1.5063\nstep 1999: train loss 0.9015, val loss 1.5131\nstep 2499: train loss 0.8879, val loss 1.5214\nstep 2999: train loss 0.8756, val loss 1.5251\nstep 3499: train loss 0.8614, val loss 1.5348\n\n\n\n# Pick the checkpoint with losses closest to our target\ncheckpoint = torch.load(checkpoint_dir / f'shakespeare_{iteration}_checkpoint_000008.pt', map_location=torch.device('cpu'))\ncheckpoint['iters'], checkpoint['train_loss'], checkpoint['val_loss']\n\n(4500, tensor(0.9339), tensor(1.4941))\n\n\n\n# Save checkpoint\ntarget_filename = outputs_dir / f'shakespeare-{datetime.now().strftime(\"%Y%m%d\")}-{iteration}.pt'\ntorch.save(checkpoint['model_state_dict'], target_filename)\nprint(f\"Saved checkpoint to {target_filename}\")\n\nSaved checkpoint to /storage/alternate-models/model-training/20240112-training/outputs/shakespeare-20240112-3.pt",
    "crumbs": [
      "experiments",
      "alternate-models"
    ]
  },
  {
    "objectID": "experiments/similar-strings.html",
    "href": "experiments/similar-strings.html",
    "title": "similar-strings",
    "section": "",
    "text": "environment = get_environment()\nprint(f\"environment is {environment.name}\")\n\nenvironment is local_mac\n\n\n\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nprint(f\"device is {device}\")\n\ndevice is cpu\n\n\n\nts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\nm, tokenizer = create_model_and_tokenizer(\n    saved_model_filename=environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt',\n    dataset=ts,\n    device=device,\n)\nencoding_helpers = EncodingHelpers(tokenizer, device)\naccessors = TransformerAccessors(m, device)\n\n\nsource\n\nSimilarStringsResult\n\n SimilarStringsResult (s:str, embs:__main__.SimilarStringsData,\n                       proj_out:List[Dict[int,__main__.SimilarStringsData]\n                       ]=&lt;factory&gt;, ffwd_out:List[Dict[int,__main__.Simila\n                       rStringsData]]=&lt;factory&gt;)\n\n\nsource\n\n\nSimilarStringsData\n\n SimilarStringsData (sim_strings:Sequence[str], distances:torch.Tensor)\n\n\n# Tests for SimilarStringsResult\n\nresult = SimilarStringsResult(\n    s='hello',\n    embs=SimilarStringsData(\n        sim_strings=['hello', 'mello'],\n        distances=torch.tensor([0.0, 0.9])\n    ),\n    proj_out=[\n        {\n            2: SimilarStringsData(\n                sim_strings=['bel', 'pel'],\n                distances=torch.tensor([0.4, 0.8])\n            ),\n            3: SimilarStringsData(\n                sim_strings=['hell', 'tell'],\n                distances=torch.tensor([0.3, 0.5])\n            ),\n        }\n        for _ in range(n_layer)\n    ],\n    ffwd_out=[\n        {\n            2: SimilarStringsData(\n                sim_strings=['gel', 'nel'],\n                distances=torch.tensor([0.9, 0.7])\n            ),\n            3: SimilarStringsData(\n                sim_strings=['hell', 'tell'],\n                distances=torch.tensor([0.1, 0.2])\n            ),\n        }\n        for _ in range(n_layer)\n    ],\n)\n\naggr_proj_out, aggr_ffwd_out = result.aggregate_over_t_is([2, 3])\ntest_eq(len(aggr_proj_out), n_layer)\ntest_eq(aggr_proj_out[0].sim_strings, ['hell', 'bel'])\ntest_eq(aggr_proj_out[0].distances, torch.tensor([0.3, 0.4]))\n\ntest_eq(len(aggr_ffwd_out), n_layer)\ntest_eq(aggr_ffwd_out[0].sim_strings, ['hell', 'tell'])\ntest_eq(aggr_ffwd_out[0].distances, torch.tensor([0.1, 0.2]))\n\n# Test invalid t_is\nwith ExceptionExpected(ex=AssertionError):\n    result.aggregate_over_t_is([2, 3, 4])\n\n\nsource\n\n\nSimilarStringsExperiment\n\n SimilarStringsExperiment (output_dir:pathlib.Path, encoding_helpers:trans\n                           former_experiments.models.transformer_helpers.E\n                           ncodingHelpers)\n\nInitialize self. See help(type(self)) for accurate signature.\n\n# Tests for SimilarStringsExperiment\ns_len = 3\nstrings = all_unique_substrings(ts.text[:100], s_len)\nwith tempfile.TemporaryDirectory() as tmpdirname:\n    tmpdir = Path(tmpdirname)\n    experiment = BatchedBlockInternalsExperiment(\n        encoding_helpers, accessors, strings, output_dir=tmpdir, batch_size=10\n    )\n    test_eq(experiment.sample_length(), s_len)\n    experiment.run(disable_progress_bars=True)\n\n    ss_dir = tmpdir / 'similar_strings'\n    ss_dir.mkdir(exist_ok=True)\n    ssexp = SimilarStringsExperiment(ss_dir, encoding_helpers)\n    batch_size = 10\n\n    # Test that the string_to_batch_map file is generated correctly\n    ssexp.generate_string_to_batch_map(\n        strings, batch_size=batch_size, disable_progress_bars=True\n    )\n    test_eq(\n        json.loads(ssexp._string_to_batch_map_filename().read_text()),\n        {s: i // batch_size for i, s in enumerate(strings)},\n    )\n\n    # Test generating embeddings files\n    ssexp.generate_embeddings_files(\n        strings,\n        accessors,\n        experiment,\n        batch_size=batch_size,\n        n_similars=3,\n        disable_progress_bars=True,\n    )\n\n    # Test that the expected files exist\n    expected_n_batches = math.ceil(len(strings) / batch_size)\n    test_eq(len(list(ss_dir.glob('embs_sim_strings-*'))), expected_n_batches)\n\n\n# Additional tests for SimilarStringsExperiment that are slow\ns_len = 3\nstrings = all_unique_substrings(ts.text[:100], s_len)\nwith tempfile.TemporaryDirectory() as tmpdirname:\n    tmpdir = Path(tmpdirname)\n    experiment = BatchedBlockInternalsExperiment(\n        encoding_helpers, accessors, strings, output_dir=tmpdir, batch_size=10\n    )\n    test_eq(experiment.sample_length(), s_len)\n    experiment.run(disable_progress_bars=True)\n\n    ss_dir = tmpdir / 'similar_strings'\n    ss_dir.mkdir(exist_ok=True)\n    ssexp = SimilarStringsExperiment(ss_dir, encoding_helpers)\n    batch_size = 10\n\n    ssexp.generate_string_to_batch_map(\n        strings, batch_size=batch_size, disable_progress_bars=True\n    )\n    ssexp.generate_embeddings_files(\n        strings,\n        accessors,\n        experiment,\n        batch_size=batch_size,\n        n_similars=3,\n        disable_progress_bars=True,\n    )\n\n    # Test generating proj_out files\n    t_is = [1, 2]\n    for t_i in t_is:\n        ssexp.generate_proj_out_files(\n            strings,\n            t_i,\n            accessors,\n            experiment,\n            batch_size=batch_size,\n            n_similars=3,\n            disable_progress_bars=True,\n        )\n    test_eq(\n        len(list(ss_dir.glob('proj_out_sim_strings-*'))), expected_n_batches * n_layer * len(t_is)\n    )\n\n    # Test generating ffwd_out files\n    t_is = [1, 2]\n    for t_i in t_is:\n        ssexp.generate_ffwd_out_files(\n            strings,\n            t_i,\n            accessors,\n            experiment,\n            batch_size=batch_size,\n            n_similars=3,\n            disable_progress_bars=True,\n        )\n    test_eq(\n        len(list(ss_dir.glob('ffwd_out_sim_strings-*'))), expected_n_batches * n_layer * len(t_is)\n    )\n\n    # Test result loading\n    s_to_results = ssexp.load_results_for_strings(['Fir', 'for', 'ize'], load_t_is=t_is)\n    test_eq(len(s_to_results), 3)\n    test_eq(s_to_results['Fir'].s, 'Fir')\n    test_eq(s_to_results['Fir'].embs.sim_strings, ['Fir', 'for', 'fur'])\n    test_close(\n        s_to_results['Fir'].embs.distances, torch.tensor([0.0, 1.29438, 1.30152])\n    )\n\n    test_eq(s_to_results['ize'].s, 'ize')\n\n    # Compare proj_out for first t_i:\n    t_i = 1\n    test_eq(s_to_results['ize'].proj_out[0][t_i].sim_strings, ['ze', 'iz', 'it'])\n    test_close(\n        s_to_results['ize'].proj_out[0][t_i].distances,\n        torch.tensor([1.16243, 1.76756, 2.19904]),\n    )\n\n    # Compare proj_out for second t_i:\n    t_i = 2\n    test_eq(s_to_results['ize'].proj_out[0][t_i].sim_strings, ['ize', 'zen', 'tiz'])\n    test_close(\n        s_to_results['ize'].proj_out[0][t_i].distances,\n        torch.tensor([0.0, 1.47939, 1.59044]),\n    )\n\n    test_eq(s_to_results['for'].s, 'for')\n\n    # Compare ffwd_out for first t_i:\n    t_i = 1\n    test_eq(s_to_results['for'].ffwd_out[3][t_i].sim_strings, ['or', 'ar', 're'])\n    test_close(\n        s_to_results['for'].ffwd_out[3][t_i].distances,\n        torch.tensor([3.51054, 3.67627, 3.68137]),\n    )\n\n    # Compare ffwd_out for second t_i:\n    t_i = 2\n    test_eq(s_to_results['for'].ffwd_out[3][t_i].sim_strings, ['for', 'er,', 'zen'])\n    test_close(\n        s_to_results['for'].ffwd_out[3][t_i].distances,\n        torch.tensor([0.0, 3.76068, 3.77482]),\n    )\n\n\n\n\n\n\n &lt;Command ffwd-out&gt; (*args:Any, **kwargs:Any)\n\n\n\n\n\n\n &lt;Command proj-out&gt; (*args:Any, **kwargs:Any)\n\n\n\n\n\n\n &lt;Command embeddings&gt; (*args:Any, **kwargs:Any)\n\n\n\n\n\n\n &lt;Group generate-similars&gt; (*args:Any, **kwargs:Any)\n\n\n\n\n\n\n &lt;Command generate-string-to-batch-map&gt; (*args:Any, **kwargs:Any)\n\n\n\n\n\n\n &lt;Group run&gt; (*args:Any, **kwargs:Any)",
    "crumbs": [
      "experiments",
      "similar-strings"
    ]
  },
  {
    "objectID": "experiments/logit-lens.html",
    "href": "experiments/logit-lens.html",
    "title": "logit-lens",
    "section": "",
    "text": "source\n\nLogitLens\n\n LogitLens\n            (eh:transformer_experiments.models.transformer_helpers.Encodin\n            gHelpers, accessors:transformer_experiments.models.transformer\n            _helpers.TransformerAccessors, prompt:str, correct:str)\n\nInitialize self. See help(type(self)) for accurate signature.\n\ndef get_fragment_and_correct(data: torch.Tensor, tokenizer: CharacterTokenizer, fragment_size=16, start_idx=0):\n    \"\"\"Return a fragment from a given corpus and the \"correct\" values for\n    the next token at each position.\"\"\"\n    input = data[start_idx : start_idx + fragment_size]\n    correct = data[start_idx + 1 : start_idx + fragment_size + 1]\n\n    return tokenizer.decode(input.tolist()), tokenizer.decode(correct.tolist())\n\n\nenvironment = get_environment()\nprint(f\"environment is {environment.name}\")\n\nenvironment is local_mac\n\n\n\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nprint(f\"device is {device}\")\n\ndevice is cpu\n\n\n\nts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\nm, tokenizer = create_model_and_tokenizer(\n    saved_model_filename=environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt',\n    dataset=ts,\n    device=device,\n)\n_, val_data = split_text_dataset(ts.text, tokenizer, train_pct=0.9, device=device)\nencoding_helpers = EncodingHelpers(tokenizer, device)\naccessors = TransformerAccessors(m, device)\n\n\nprompt, correct = get_fragment_and_correct(val_data, tokenizer, start_idx=50)\nprint(f\"INPUT  : {repr(prompt)}\"),\nprint(f\"CORRECT: {repr(correct)}\")\n\nINPUT  : 'STA:\\nGood morrow'\nCORRECT: 'TA:\\nGood morrow,'\n\n\n\nlogit_lens = LogitLens(encoding_helpers, accessors, prompt, correct)\nlogit_lens.plot()",
    "crumbs": [
      "experiments",
      "logit-lens"
    ]
  },
  {
    "objectID": "experiments/final_ffwd.html",
    "href": "experiments/final_ffwd.html",
    "title": "final-ffwd",
    "section": "",
    "text": "environment = get_environment()\nprint(f\"environment is {environment.name}\")\n\nenvironment is local_mac\n\n\n\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nprint(f\"device is {device}\")\n\ndevice is cpu\n\n\n\nts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\nm, tokenizer = create_model_and_tokenizer(\n    saved_model_filename=environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt',\n    dataset=ts,\n    device=device,\n)\n_, val_data = split_text_dataset(ts.text, tokenizer, train_pct=0.9, device=device)\nencoding_helpers = EncodingHelpers(tokenizer, device)\naccessors = TransformerAccessors(m, device)\n\n\nsource\n\nFinalFFWDExperiment\n\n FinalFFWDExperiment\n                      (eh:transformer_experiments.models.transformer_helpe\n                      rs.EncodingHelpers, accessors:transformer_experiment\n                      s.models.transformer_helpers.TransformerAccessors,\n                      strings:Sequence[str], output_dir:pathlib.Path,\n                      batch_size:int=10000)\n\nInitialize self. See help(type(self)) for accurate signature.\n\n# Test for FinalFFWDExperiment\ns_len = 3\nstrings = all_unique_substrings(ts.text[:100], s_len)\n\nwith tempfile.TemporaryDirectory() as tmpdirname:\n    output_dir = Path(tmpdirname)\n    experiment = FinalFFWDExperiment(\n        encoding_helpers, accessors, strings, output_dir=output_dir, batch_size=10\n    )\n    test_eq(experiment.sample_length(), s_len)\n    experiment.run(disable_progress_bars=True)\n\n    # Test the expected files exist\n    block_idx = n_layer - 1\n    for batch_idx in range(experiment.n_batches):\n        test_eq(experiment._ffwd_output_filename(batch_idx, block_idx).exists(), True)\n\n\n\n\n\n\n &lt;Command run&gt; (*args:Any, **kwargs:Any)",
    "crumbs": [
      "experiments",
      "final-ffwd"
    ]
  },
  {
    "objectID": "experiments/cosine-sims.html",
    "href": "experiments/cosine-sims.html",
    "title": "cosine-sims",
    "section": "",
    "text": "source\n\nCosineSimilaritiesExperiment\n\n CosineSimilaritiesExperiment (strings:Sequence[str], batch_size:int,\n                               output_folder:pathlib.Path, encoding_helper\n                               s:transformer_experiments.models.transforme\n                               r_helpers.EncodingHelpers, accessors:transf\n                               ormer_experiments.models.transformer_helper\n                               s.TransformerAccessors)\n\nInitialize self. See help(type(self)) for accurate signature.\n\nsource\n\n\nget_ffwd_queries\n\n get_ffwd_queries (strings:Sequence[str], encoding_helpers:transformer_exp\n                   eriments.models.transformer_helpers.EncodingHelpers, ac\n                   cessors:transformer_experiments.models.transformer_help\n                   ers.TransformerAccessors)\n\n\nenvironment = get_environment()\nprint(f\"environment is {environment.name}\")\n\nenvironment is local_mac\n\n\n\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nprint(f\"device is {device}\")\n\ndevice is cpu\n\n\n\nts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\nm, tokenizer = create_model_and_tokenizer(\n    saved_model_filename=environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt',\n    dataset=ts,\n    device=device,\n)\nencoding_helpers = EncodingHelpers(tokenizer, device)\naccessors = TransformerAccessors(m, device)\n\n\n_ = m.to(device)\n\n\n# Tests for CosineSimilaritiesExperiment\ns_len = 3\nstrings3 = all_unique_substrings(ts.text[:100], s_len)\nbatch_size = 17\nwith tempfile.TemporaryDirectory() as tmpdirname:\n    output_folder = Path(tmpdirname)\n    experiment = CosineSimilaritiesExperiment(\n        strings=strings3,\n        batch_size=batch_size,\n        output_folder=output_folder,\n        encoding_helpers=encoding_helpers,\n        accessors=accessors,\n    )\n    query_strings = [strings3[i] for i in [10, 75, 3]] # indices are arbitrary\n    queries = get_ffwd_queries(query_strings, encoding_helpers, accessors)\n    experiment.run(queries=queries, disable_progress_bar=True)\n\n    n_expected_batches = math.ceil(len(strings3) / batch_size)\n    for batch_idx in range(n_expected_batches):\n        test_eq(experiment.cosine_sim_ffwd_out_filename(batch_idx).exists(), True)\n\n\n\n\n\n\n &lt;Command run&gt; (*args:Any, **kwargs:Any)\n\n\nsource\n\n\npre_filter_cosine_sim_results\n\n pre_filter_cosine_sim_results (load_batch:__main__.LoadBatchFunction,\n                                n_batches:int, q_idx_start:int,\n                                q_idx_end:int, threshold:float,\n                                disable_progress_bars:bool=False)\n\n\nsource\n\n\nLoadBatchFunction\n\n LoadBatchFunction (*args, **kwargs)\n\nBase class for protocol classes.\nProtocol classes are defined as::\nclass Proto(Protocol):\n    def meth(self) -&gt; int:\n        ...\nSuch classes are primarily used with static type checkers that recognize structural subtyping (static duck-typing), for example::\nclass C:\n    def meth(self) -&gt; int:\n        return 0\n\ndef func(x: Proto) -&gt; int:\n    return x.meth()\n\nfunc(C())  # Passes static type check\nSee PEP 544 for details. Protocol classes decorated with @typing.runtime_checkable act as simple-minded runtime protocols that check only the presence of given attributes, ignoring their type signatures. Protocol classes can be generic, they are defined as::\nclass GenProto(Protocol[T]):\n    def meth(self) -&gt; T:\n        ...\n\n# Tests for pre_filter_cosine_sim_results()\nbatches = [\n    torch.tensor(\n        [\n            [\n                [0.1, 0.2, 0.3, 0.4, 0.5],\n                [0.6, 0.7, 0.8, 0.9, 1.0],\n            ],\n            [\n                [0.6, 0.3, 0.1, 0.4, 0.2],\n                [0.5, 0.3, 0.1, 0.2, 0.7],\n            ],\n            [\n                [0.3, 0.4, 0.9, 1.0, 0.2],\n                [0.2, 1.0, 0.9, 0.6, 0.4],\n            ],\n            [\n                [0.4, 1.0, 0.3, 0.1, 0.2],\n                [0.6, 0.4, 1.0, 0.8, 0.2],\n            ],\n            [\n                [0.1, 0.3, 1.0, 0.9, 0.4],\n                [0.6, 0.2, 0.4, 0.5, 0.8],\n            ],\n            [\n                [0.1, 0.4, 0.9, 0.5, 0.7],\n                [0.2, 0.7, 0.5, 0.3, 0.4],\n            ],\n        ],\n        dtype=torch.float32,\n    ),\n    torch.tensor(\n        [\n            [\n                [0.4, 1.0, 0.9, 0.6, 0.7],\n                [0.8, 0.2, 0.6, 0.7, 1.0],\n            ],\n            [\n                [0.3, 0.8, 0.1, 0.7, 0.6],\n                [0.7, 0.4, 0.2, 0.5, 0.3],\n            ],\n            [\n                [0.2, 0.7, 1.0, 0.9, 0.8],\n                [0.5, 0.3, 0.9, 0.7, 0.4],\n            ],\n            [\n                [0.1, 0.2, 0.9, 0.5, 1.0],\n                [0.6, 0.5, 0.2, 0.4, 0.1],\n            ],\n            [\n                [0.6, 0.5, 0.7, 0.4, 0.9],\n                [1.0, 0.2, 0.3, 0.6, 0.8],\n            ],\n            [\n                [0.9, 0.2, 0.5, 0.1, 0.4],\n                [0.3, 0.4, 0.7, 0.5, 0.6],\n            ],\n        ],\n        dtype=torch.float32,\n    ),\n]\nload_batch = lambda batch_idx: batches[batch_idx]\nq_idx_start = 1\nq_idx_end = 3\nthreshold = 0.7\nresult = pre_filter_cosine_sim_results(\n    load_batch=load_batch,\n    n_batches=len(batches),\n    q_idx_start=q_idx_start,\n    q_idx_end=q_idx_end,\n    threshold=threshold,\n    disable_progress_bars=True,\n)\nexpected_result = [\n    [\n        {\n            \"indices\": torch.tensor([2], dtype=torch.long),\n            \"values\": torch.tensor([1.0], dtype=torch.float32),\n        },\n        {\n            \"indices\": torch.tensor([2], dtype=torch.long),\n            \"values\": torch.tensor([0.8], dtype=torch.float32),\n        },\n        {\n            \"indices\": torch.tensor([1], dtype=torch.long),\n            \"values\": torch.tensor([1.0], dtype=torch.float32),\n        },\n        {\n            \"indices\": torch.tensor([0], dtype=torch.long),\n            \"values\": torch.tensor([1.0], dtype=torch.float32),\n        },\n        {\n            \"indices\": torch.tensor([], dtype=torch.long),\n            \"values\": torch.tensor([], dtype=torch.float32),\n        },\n        {\n            \"indices\": torch.tensor([], dtype=torch.long),\n            \"values\": torch.tensor([], dtype=torch.float32),\n        },\n    ],\n    [\n        {\n            \"indices\": torch.tensor([1, 2], dtype=torch.long),\n            \"values\": torch.tensor([0.8, 0.9], dtype=torch.float32),\n        },\n        {\n            \"indices\": torch.tensor([], dtype=torch.long),\n            \"values\": torch.tensor([], dtype=torch.float32),\n        },\n        {\n            \"indices\": torch.tensor([0, 1, 2, 3], dtype=torch.long),\n            \"values\": torch.tensor([0.9, 0.9, 1.0, 0.9], dtype=torch.float32),\n        },\n        {\n            \"indices\": torch.tensor([1, 2], dtype=torch.long),\n            \"values\": torch.tensor([1.0, 0.9], dtype=torch.float32),\n        },\n        {\n            \"indices\": torch.tensor([0], dtype=torch.long),\n            \"values\": torch.tensor([1.0], dtype=torch.float32),\n        },\n        {\n            \"indices\": torch.tensor([0], dtype=torch.long),\n            \"values\": torch.tensor([0.9], dtype=torch.float32),\n        },\n    ],\n]\nfor q_idx in range(q_idx_end - q_idx_start):\n    for block_idx in range(n_layer):\n        test_eq(\n            result[q_idx][block_idx][\"indices\"],\n            expected_result[q_idx][block_idx][\"indices\"],\n        )\n        test_eq(\n            result[q_idx][block_idx][\"values\"],\n            expected_result[q_idx][block_idx][\"values\"],\n        )\n\n\nsource\n\n\nfilter_on_prefiltered_results\n\n filter_on_prefiltered_results\n                                (load_prefiltered:__main__.LoadPrefiltered\n                                Function, q_idx_start:int, q_idx_end:int, \n                                filter_fn:Callable[[torch.Tensor],torch.Te\n                                nsor])\n\nPerforms filtering over results prefiltered by pre_filter_cosine_sim_results(). The load_prefiltered function will be called with a query index and should return the prefiltered data for it (in the from of a dictionary with indices and values keys, as saved by pre_filter_cosine_sim_results()).\nReturns a list containing one list for each query index containing the indices from the prefiltered data corresponding to the values that passed the filter function.\n\nsource\n\n\nLoadPrefilteredFunction\n\n LoadPrefilteredFunction (*args, **kwargs)\n\nBase class for protocol classes.\nProtocol classes are defined as::\nclass Proto(Protocol):\n    def meth(self) -&gt; int:\n        ...\nSuch classes are primarily used with static type checkers that recognize structural subtyping (static duck-typing), for example::\nclass C:\n    def meth(self) -&gt; int:\n        return 0\n\ndef func(x: Proto) -&gt; int:\n    return x.meth()\n\nfunc(C())  # Passes static type check\nSee PEP 544 for details. Protocol classes decorated with @typing.runtime_checkable act as simple-minded runtime protocols that check only the presence of given attributes, ignoring their type signatures. Protocol classes can be generic, they are defined as::\nclass GenProto(Protocol[T]):\n    def meth(self) -&gt; T:\n        ...\n\n# Tests for filter_on_prefiltered_results()\ntest_data = [\n    {\n        'indices': torch.tensor([3, 7, 9, 10], dtype=torch.long),\n        'values': torch.tensor([0.1, 0.2, 0.3, 0.4], dtype=torch.float32),\n    },\n    {\n        'indices': torch.tensor([1, 2, 3, 4], dtype=torch.long),\n        'values': torch.tensor([0.5, 0.6, 0.7, 0.8], dtype=torch.float32),\n    },\n    {\n        'indices': torch.tensor([19, 86, 733, 855], dtype=torch.long),\n        'values': torch.tensor([0.9, 1.0, 0.1, 0.2], dtype=torch.float32),\n    },\n]\n\nload_prefiltered = lambda q_idx: test_data[q_idx]\nq_idx_start = 1\nq_idx_end = 3\nfilter_fn = lambda x: x &gt; 0.5\nresult = filter_on_prefiltered_results(\n    load_prefiltered=load_prefiltered,\n    q_idx_start=q_idx_start,\n    q_idx_end=q_idx_end,\n    filter_fn=filter_fn,\n)\nexpected_result = [\n    torch.tensor([2, 3, 4], dtype=torch.long), # q_idx = 1\n    torch.tensor([19, 86], dtype=torch.long), # q_idx = 2\n]\ntest_eq(result, expected_result)",
    "crumbs": [
      "experiments",
      "cosine-sims"
    ]
  },
  {
    "objectID": "experiments/block-internals.html",
    "href": "experiments/block-internals.html",
    "title": "block-internals",
    "section": "",
    "text": "source\n\nBlockInternalsAccessors\n\n BlockInternalsAccessors (prompt:str,\n                          eh:transformer_experiments.models.transformer_he\n                          lpers.EncodingHelpers, accessors:transformer_exp\n                          eriments.models.transformer_helpers.TransformerA\n                          ccessors)\n\nHelper class that provides easy access to the block internals values for a given prompt.\n\nenvironment = get_environment()\nprint(f\"environment is {environment.name}\")\n\nenvironment is local_mac\n\n\n\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nprint(f\"device is {device}\")\n\ndevice is cpu\n\n\n\nts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\nm, tokenizer = create_model_and_tokenizer(\n    saved_model_filename=environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt',\n    dataset=ts,\n    device=device,\n)\n_, val_data = split_text_dataset(ts.text, tokenizer, train_pct=0.9, device=device)\nencoding_helpers = EncodingHelpers(tokenizer, device)\naccessors = TransformerAccessors(m, device)\n\n\n# Tests for BlockInternalsAccessors\nprompt = 'ROMEO:'\nb = BlockInternalsAccessors(\n    prompt=prompt,\n    eh=encoding_helpers,\n    accessors=accessors,\n)\n\n# Test shapes of all the things.\ntest_eq(b.input_embedding().shape, (1, len(prompt), n_embed))\nfor block_idx in range(n_layer):\n    test_eq(b.block_input(block_idx).shape, (1, len(prompt), n_embed))\n    test_eq(b.heads_output(block_idx).shape, (1, len(prompt), n_embed))\n    test_eq(b.proj_output(block_idx).shape, (1, len(prompt), n_embed))\n    test_eq(b.ffwd_output(block_idx).shape, (1, len(prompt), n_embed))\n    test_eq(b.block_output(block_idx).shape, (1, len(prompt), n_embed))\n\n# Logits produced by the model should be the same as the logits produced by\n# the output of the last block.\nlogits, _ = m(encoding_helpers.tokenize_string(prompt))\ntest_close(logits, accessors.logits_from_embedding(b.block_output(n_layer-1)))\n\n\nsource\n\n\nBlockInternalsExperiment\n\n BlockInternalsExperiment\n                           (eh:transformer_experiments.models.transformer_\n                           helpers.EncodingHelpers, accessors:transformer_\n                           experiments.models.transformer_helpers.Transfor\n                           merAccessors, strings:Sequence[str])\n\nAn experiment to run a bunch of inputs through the model and save the intermediate values produced within each block.\n\n# Test for BlockInternalsExperiment\ns_len = 3\nstrings = all_unique_substrings(ts.text[:100], s_len)\nexperiment = BlockInternalsExperiment(encoding_helpers, accessors, strings)\n\n# Test the string_idx() method\nfor i, s in enumerate(strings):\n    test_eq(experiment.string_idx(s), i)\n\n# Check that all the accessors return tensors of the expected shape.\nfor block_idx in range(n_layer):\n    test_eq(experiment.block_input(block_idx).shape, (len(strings), s_len, n_embed))\n    test_eq(experiment.heads_output(block_idx).shape, (len(strings), s_len, n_embed))\n    test_eq(experiment.proj_output(block_idx).shape, (len(strings), s_len, n_embed))\n    test_eq(experiment.ffwd_output(block_idx).shape, (len(strings), s_len, n_embed))\n    test_eq(experiment.block_output(block_idx).shape, (len(strings), s_len, n_embed))\n\n# Run the strings through the model directly.\ntokens = encoding_helpers.tokenize_strings(strings)\nlogits, _ = m(tokens)\n\n# Logits generated from the last block output in the experiment should\n# be the same as the logits produced by running the model directly.\nlast_block_output = experiment.block_output(n_layer - 1)\ntest_close(accessors.logits_from_embedding(last_block_output), logits)\n\n\nsource\n\n\nDistanceFunction\n\n DistanceFunction (*args, **kwargs)\n\nA protocol for a function that computes distances between a batch of data and a set of queries.\n\nsource\n\n\nbatch_distances\n\n batch_distances (batch:torch.Tensor, queries:torch.Tensor)\n\nReturns the distance between each item in the batch and the queries.\n\nsource\n\n\nbatch_cosine_sim\n\n batch_cosine_sim (batch:torch.Tensor, queries:torch.Tensor)\n\nReturns the cosine similarity between each item in the batch and the queries.\n\nsource\n\n\nGetFilenameForBatchAndBlock\n\n GetFilenameForBatchAndBlock (*args, **kwargs)\n\nA protocol for a function that returns a filename for given batch and block indices.\n\nsource\n\n\nBatchedBlockInternalsExperiment\n\n BatchedBlockInternalsExperiment\n                                  (eh:transformer_experiments.models.trans\n                                  former_helpers.EncodingHelpers, accessor\n                                  s:transformer_experiments.models.transfo\n                                  rmer_helpers.TransformerAccessors,\n                                  strings:Sequence[str],\n                                  output_dir:pathlib.Path,\n                                  batch_size:int=10000)\n\nSimilar to BlockInternalsExperiment but rather than running all strings as one batch through the model, this one runs them in batches and writes results to disk. This makes it possible to run the analysis on longer strings.\n\n# Test for BatchedBlockInternalsExperiment\ns_len = 3\nstrings = all_unique_substrings(ts.text[:100], s_len)\n\nwith tempfile.TemporaryDirectory() as tmpdirname:\n    experiment = BatchedBlockInternalsExperiment(\n        encoding_helpers, accessors, strings, output_dir=Path(tmpdirname), batch_size=10\n    )\n    test_eq(experiment.sample_length(), s_len)\n    experiment.run(disable_progress_bars=True)\n\n    # Test the string_idx() method\n    for i, s in enumerate(strings):\n        test_eq(experiment.string_idx(s), i)\n\n    prompts = [strings[i] for i in [10, 17, 1]] # indices are arbitrary\n    test_eq(prompts, ['zen', 'for', 'irs']) # ensure that something will fail if we change indices above\n\n    prompt_exp = BlockInternalsExperiment(encoding_helpers, accessors, prompts)\n\n    # Test closest embeddings\n    sim_strings, distances = experiment.strings_with_topk_closest_embeddings(\n        queries=prompt_exp.embeddings,\n        k=3,\n        largest=False\n    )\n    test_eq(sim_strings, [ # compare against known correct results\n        ['zen', 'we ', 'her'],\n        ['for', 'fur', 'Fir'],\n        ['irs', 'ar ', 'urt']\n    ])\n    test_close(distances.cpu(), torch.tensor([ # compare against known correct results\n        [0.0000, 0.0000, 0.0000],\n        [1.4657, 1.0683, 1.4207],\n        [1.4741, 1.2944, 1.4239]\n    ]), eps=1e-4)\n\n    # Test closest proj outputs\n    block_idx = 0\n    t_i = -1\n    sim_strings, distances = experiment.strings_with_topk_closest_proj_outputs(\n        block_idx=block_idx,\n        t_i=t_i,\n        queries=prompt_exp.proj_output(block_idx)[:, t_i, :],\n        k=3,\n        largest=False,\n    )\n    test_eq(\n        sim_strings,\n        [\n            # fmt: off\n            ['zen', 'ize', 'we '],\n            ['for', 'roc', 'efo'],\n            ['irs', 'urt', 'pro'],\n            # fmt: on\n        ],\n    )\n    test_close(\n        distances.cpu(),\n        torch.tensor(\n            [  # compare against known correct results\n                # fmt: off\n                [0.0000, 0.0000, 0.0000],\n                [1.4794, 1.2580, 1.3404],\n                [1.4864, 1.4445, 1.3449],\n                # fmt: on\n            ]\n        ),\n        eps=1e-4,\n    )\n\n    # Test closest ffwd outputs\n    block_idx = 4\n    t_i = -1\n    sim_strings, distances = experiment.strings_with_topk_closest_ffwd_outputs(\n        block_idx=block_idx,\n        t_i=t_i,\n        queries=prompt_exp.ffwd_output(block_idx)[:, t_i, :],\n        k=3,\n        largest=False,\n    )\n    test_eq(\n        sim_strings,\n        [\n            # fmt: off\n            ['zen', 'eak', 'the'],\n            ['for', ' me', 'zen'],\n            ['irs', 'urt', 'eak'],\n            # fmt: on\n        ],\n    )\n    test_close(\n        distances.cpu(),\n        torch.tensor(\n            [  # compare against known correct results\n                # fmt: off\n                [0.0000, 0.0000, 0.0000],\n                [3.4993, 3.7176, 4.8893],\n                [3.5395, 3.7680, 4.9150],\n                # fmt: on\n            ]\n        ),\n        eps=1e-4,\n    )\n\n    # Test closest proj outputs with a non-final t_i\n    block_idx = 2\n    t_i = 1\n    sim_strings, distances = experiment.strings_with_topk_closest_proj_outputs(\n        block_idx=block_idx,\n        t_i=t_i,\n        queries=prompt_exp.proj_output(block_idx)[:, t_i, :],\n        k=3,\n        largest=False,\n    )\n\n    # Test that all strings have length t_i + 1\n    for i in range(3):\n        for j in range(len(prompts)):\n            test_eq(len(sim_strings[i][j]), t_i + 1)\n    test_eq(\n        sim_strings,\n        [\n            # fmt: off\n            ['ze', 'rt', 'iz'],\n            ['fo', 'fu', ' f'],\n            ['ir', 'iz', 'it'],\n            # fmt: on\n        ],\n    )\n    test_close(\n        distances.cpu(),\n        torch.tensor(\n            [  # compare against known correct results\n                # fmt: off\n                [0.0000, 0.0000, 0.0000],\n                [2.0715, 0.9072, 0.9928],\n                [2.1107, 1.6824, 1.0663],\n                # fmt: on\n            ]\n        ),\n        eps=1e-4,\n    )\n\n    # Test closest ffwd outputs with a non-final t_i\n    block_idx = 5\n    t_i = 1\n    sim_strings, distances = experiment.strings_with_topk_closest_ffwd_outputs(\n        block_idx=block_idx,\n        t_i=t_i,\n        queries=prompt_exp.ffwd_output(block_idx)[:, t_i, :],\n        k=3,\n        largest=False,\n    )\n\n    # Test that all strings have length t_i + 1\n    for i in range(3):\n        for j in range(len(prompts)):\n            test_eq(len(sim_strings[i][j]), t_i + 1)\n    test_eq(\n        sim_strings,\n        [\n            # fmt: off\n            ['ze', 'ce', 'we'],\n            ['fo', 'ti', 'st'],\n            ['ir', 'ar', 'ur'],\n            # fmt: on\n        ],\n    )\n    test_close(\n        distances.cpu(),\n        torch.tensor(\n            [  # compare against known correct results\n                # fmt: off\n                [0.0000, 0.0000, 0.0000],\n                [1.9583, 3.3032, 2.0351],\n                [2.0340, 3.3642, 2.2757],\n                # fmt: on\n            ]\n        ),\n        eps=1e-4,\n    )\n\n\n\n\n\n\n &lt;Command run&gt; (*args:Any, **kwargs:Any)\n\n\nsource\n\n\nBlockInternalsAnalysis\n\n BlockInternalsAnalysis (accessors:transformer_experiments.models.transfor\n                         mer_helpers.TransformerAccessors, encoding_helper\n                         s:transformer_experiments.models.transformer_help\n                         ers.EncodingHelpers, prompt:str)\n\nThis class performs analysis of how the next token probabilities change as an embedded input is passed through each of the blocks in the model\n\nbia = BlockInternalsAnalysis(accessors, encoding_helpers, prompt='Citizen')\nbia.plot()\n\n\n\n\n\n\n\n\n\nbia = BlockInternalsAnalysis(accessors, encoding_helpers, prompt='Citizen')\nbia.plot_subset(rows=[0, 1, 2, 3, 4], cols=[tokenizer.stoi[c] for c in ':st'])\n\n\n\n\n\n\n\n\n\n# Sanity check for BlockInternalsAnalysis\n\n# Run a prompt through the real model\nprompt = 'Citizen'\n\ntokens = encoding_helpers.tokenize_string(prompt)\nlogits, _ = m(tokens)\nlw = LogitsWrapper(logits.cpu(), tokenizer)\n\n# Run the same prompt through the analysis\nbia = BlockInternalsAnalysis(accessors, encoding_helpers, prompt)\n\n# The probabilities from the logits that came out of the model\n# should be the same as the last row of data from the analysis.\ntest_close(lw.probs()[0, -1], bia.data[-1])\n\n# Now run it through copied blocks we can look into\nx = accessors.embed_tokens(tokens)\n_, io_accessors = accessors.run_model(x)\n\n# The probabilities from the embedded inputs should be the same as\n# the first row of data from the analysis.\ntest_close(\n    LogitsWrapper(accessors.logits_from_embedding(x).cpu(), tokenizer).probs()[0, -1],\n    bia.data[0],\n)\n\n# The rows containing the inputs for each block should match what the io_accessors\n# say the inputs are.\nfor block_idx, io_accessor in enumerate(io_accessors):\n    block_input = io_accessor.input('.')\n    lw = LogitsWrapper(accessors.logits_from_embedding(block_input).cpu(), tokenizer)\n    test_close(lw.probs()[0, -1], bia.data[bia.idx_input_probs(block_idx)])\n\n# The rows containing the ffwd adjustments for each block should be the same\n# as the outputs from the blocks.\nfor block_idx, io_accessor in enumerate(io_accessors):\n    block_output = io_accessor.output('.')\n    lw = LogitsWrapper(accessors.logits_from_embedding(block_output).cpu(), tokenizer)\n    test_close(lw.probs()[0, -1], bia.data[bia.idx_ffwd_probs(block_idx)])",
    "crumbs": [
      "experiments",
      "block-internals"
    ]
  },
  {
    "objectID": "experiments/learn-embeddings.html",
    "href": "experiments/learn-embeddings.html",
    "title": "learn-embeddings",
    "section": "",
    "text": "environment = get_environment()\nprint(f\"environment is {environment.name}\")\n\nenvironment is paperspace\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\nm, tokenizer = create_model_and_tokenizer(\n    saved_model_filename=environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt',\n    dataset=ts,\n    device=device,\n)\n_, val_data = split_text_dataset(ts.text, tokenizer, train_pct=0.9, device=device)\nencoding_helpers = EncodingHelpers(tokenizer, device)\naccessors = TransformerAccessors(m, device)\nprint(f\"device is {device}\")\n\ndevice is cuda",
    "crumbs": [
      "experiments",
      "learn-embeddings"
    ]
  },
  {
    "objectID": "experiments/learn-embeddings.html#core-idea",
    "href": "experiments/learn-embeddings.html#core-idea",
    "title": "learn-embeddings",
    "section": "Core Idea",
    "text": "Core Idea\nAt any point in the transformer after tokens have been embedded, we can think of the remainder of the pipeline as a function that transforms from embedding space (\\(\\mathbb{R}^{384}\\) since n_embed = 384) to logit space (\\(\\mathbb{R}^{65}\\) vocab_size=65). For a given token, say the letter a, we might ask: at this point in the pipeline, what embedding will produce output logits that result in a probability very close to 1 for this token? In other words, what embedding, if provided as input at this point, will result in the transformer predicting the given token as the next token?\nI suspect this is difficult to determine analytically, especially for earlier parts of the pipeline where the input embedding has to go through many transformer blocks before output logits are computed. But, we can actually learn the embeddings that result in the right kind of logits.\nI say embeddings - plural - because it seems there isn’t just one unique embedding for each token. Likely, there is some subspace of the full embeddings space, \\(\\mathbb{R}^{384}\\), that corresponds to specific tokens being predicted. While I don’t know of a way to find the bounds of this space directly, we can learn several embeddings within the space and then work out a good enough approximation of the space.\nTo do this, we set up a typical deep-learning problem: * The portion of the transformer we’re interested in is fixed; the embeddings input into it are the parameters we’re optimizing and they start with random initialization. * We do a forward pass, computing the logits from the embeddings we have. * We compute negative log likelihood loss relative to the token we’re trying to learn embeddings for. * We do a backward pass, adjusting the values of the embeddings according to the gradients.\nIt works remarkably well.\n\ndef learn_embedding_for_char(\n    target_char: str,\n    embedding_to_logits: Callable[[torch.Tensor], torch.Tensor],\n    n_embeddings_to_learn: int = 1,\n    learning_rate: float = 3e-4,\n    minimum_loss: float = 1e-4,\n    max_iters: int = 50000,\n    device: str = device,\n) -&gt; torch.Tensor:\n    \"\"\"Given a character, learns the embedding that,\n    when given as input to the `embedding_to_logits`\n    function, produces the logits select that character\n    with probability almost 1.\"\"\"\n    assert len(target_char) == 1\n    target = torch.tensor(tokenizer.encode(target_char), device=device)\n\n    lsfm = nn.LogSoftmax(dim=-1)\n    lsfm.to(device)\n\n    x = torch.nn.Parameter(\n        torch.randn(n_embeddings_to_learn, 1, n_embed, device=device),\n        requires_grad=True,\n    )\n\n    optimizer = torch.optim.AdamW([x], lr=learning_rate)\n    eval_iters = max_iters // 10\n\n    print(f\"Optimizing embedding for {repr(target_char)}\")\n    for step in range(max_iters):\n        logits = embedding_to_logits(x)\n        B, T, C = logits.shape\n\n        yhat = lsfm(logits.view(B * T, C))\n        loss = F.nll_loss(yhat, target.expand(n_embeddings_to_learn))\n\n        if loss &lt; minimum_loss:\n            print(f\"ending training at step {step:&gt;5}: loss {loss.item():.6f}\")\n            break\n\n        if step % eval_iters == 0:\n            print(f\"step {step:&gt;5}: loss {loss.item():.6f}\")\n\n        optimizer.zero_grad(set_to_none=True)\n        loss.backward()\n        optimizer.step()\n\n    return x.data.detach(), loss\n\nDefine a function that encapsulate the final output head of the transformer, after all the blocks (basically, a layer norm followed by a linear layer going from embedding space to token space):\n\n# Similar to TransformerAccessors.logits_from_embedding but does not\n# detach the result from the computation graph.\ndef transformer_output_head_function(m: TransformerLanguageModel) -&gt; Callable[[torch.Tensor], torch.Tensor]:\n    ln_f = nn.LayerNorm(n_embed)\n    lm_head = nn.Linear(n_embed, tokenizer.vocab_size)\n\n    ln_f.load_state_dict(m.ln_f.state_dict())\n    lm_head.load_state_dict(m.lm_head.state_dict())\n\n    ln_f.to(device)\n    lm_head.to(device)\n\n    return lambda x: lm_head(ln_f(x))\n\nNow we can use this to learn, e.g., an embedding that, at the very end of the transformer, after all the blocks, is likely to produce a next token probability for a of nearly 1.\n\ntorch.manual_seed(42)\nemb_a, _ = learn_embedding_for_char('a', transformer_output_head_function(m))\n\nOptimizing embedding for 'a'\nstep     0: loss 2.809722\nstep  5000: loss 0.009828\nstep 10000: loss 0.000751\nending training at step 14316: loss 0.000100\n\n\nWe can test this, by sending the resulting embedding through the output head and plotting the next token probabilities:\n\nlogits = LogitsWrapper(accessors.logits_from_embedding(unsqueeze_emb(emb_a)), tokenizer)\nlogits.plot_probs()\n\n\n\n\n\n\n\n\nThat was just one possible embedding that selects a. We can learn others. The following code snippet will learn 100 such embeddings.\n\n# Try learning more than one embedding\n\ntorch.manual_seed(42)\nmulti_emb_a, _ = learn_embedding_for_char(\n    \"a\", transformer_output_head_function(m), n_embeddings_to_learn=100\n)\n\nOptimizing embedding for 'a'\nstep     0: loss 4.480039\nstep  5000: loss 0.014915\nstep 10000: loss 0.001181\nstep 15000: loss 0.000119\nending training at step 15389: loss 0.000100\n\n\n\nmulti_emb_a.shape\n\ntorch.Size([100, 1, 384])\n\n\nWe can convince ourselves that these are sufficiently varied by examining some stats:\n\ndef multi_emb_stats(multi_embs: torch.Tensor):\n    norms = torch.norm(multi_embs[:, 0, :], dim=-1)\n    print(f\"norms: mean {norms.mean().item():.6f}, std {norms.std().item():.6f}\")\n    print(f\"norms: min {norms.min().item():.6f}, max {norms.max().item():.6f}\")\n\n    norm_diffs = []\n    for i in range(multi_embs.shape[0]):\n        for j in range(multi_embs.shape[0]):\n            if i != j:\n                norm_diffs.append(torch.norm(multi_embs[i, 0, :] - multi_embs[j, 0, :]))\n\n    norm_diffs = torch.tensor(norm_diffs)\n    print(f\"norm diffs: mean {norm_diffs.mean().item():.6f}, std {norm_diffs.std().item():.6f}\")\n    print(f\"norm diffs: min {norm_diffs.min().item():.6f}, max {norm_diffs.max().item():.6f}\")\n\n\nmulti_emb_stats(multi_emb_a)\n\nnorms: mean 16.764254, std 0.759987\nnorms: min 15.078418, max 18.306231\nnorm diffs: mean 16.599855, std 0.760862\nnorm diffs: min 13.795146, max 19.167126\n\n\nThe norms of the embeddings range from about 15 to about 18, with a mean of about 16.7. Then if we compute the differences between all the learned embeddings and take the norms of those differences, we see that they are quite large: the differences range from 13.8 to about 19, with a mean of 16.6. If we’d somehow learned 100 nearly identical vectors, the differences would be a lot smaller.\nNow we’ll define a function that implements the portion of a the transformer pipeline from a given block onwards. E.g. If called with n=3, this would implement blocks index 3, 4, and 5, plus the transformer output head.\n\n# Similar to TransformerAccessors.run_model_from_block_n but does not\n# detach the result from the computation graph.\ndef block_n_on_function(m: TransformerLanguageModel, n: int) -&gt; Callable[[torch.Tensor], torch.Tensor]:\n    assert n &gt;= 0 and n &lt; n_layer, \"n must be in [0, n_layer)\"\n\n    blocks, _ = zip(\n        *[\n            accessors.copy_block_from_model(block_idx=i)\n            for i in range(n, n_layer)\n        ]\n    )\n    blocks_module = torch.nn.Sequential(*blocks)\n    output_head = transformer_output_head_function(m)\n    return lambda x: output_head(blocks_module(x))\n\nWe can now learn 100 embeddings for the letter a, from block index 5 (the last block) in transformer.\n\ntorch.manual_seed(42)\nmulti_emb_a_5, _ = learn_embedding_for_char('a', block_n_on_function(m, n=5), n_embeddings_to_learn=100)\n\nOptimizing embedding for 'a'\nstep     0: loss 4.540399\nstep  5000: loss 0.003825\nstep 10000: loss 0.000321\nending training at step 12689: loss 0.000100\n\n\n\nmulti_emb_stats(multi_emb_a_5)\n\nnorms: mean 17.498230, std 0.640826\nnorms: min 15.787105, max 19.508923\nnorm diffs: mean 23.514679, std 0.885002\nnorm diffs: min 20.520039, max 27.281914\n\n\nThese show even more variation than the ones learned for the output head alone.\nAs a spot check, let’s plot an arbitrary one of these:\n\n# Try an arbitrary embedding and plot it.\nlogits = LogitsWrapper(block_n_on_function(m, n=5)(unsqueeze_emb(multi_emb_a_5[22, 0, :])).detach(), tokenizer)\nlogits.plot_probs()\n\n\n\n\n\n\n\n\nIt produces a with probability nearly 1, as we’d expect. I spot checked with several more examples and they all looked right.\nNext, we can learn embeddings from an earlier point, say from block index 1 on:\n\ntorch.manual_seed(42)\nmulti_emb_a_1, _ = learn_embedding_for_char('a', block_n_on_function(m, n=1), n_embeddings_to_learn=100)\n\nOptimizing embedding for 'a'\nstep     0: loss 3.682070\nstep  5000: loss 0.003850\nstep 10000: loss 0.000303\nending training at step 12545: loss 0.000100\n\n\n\nmulti_emb_stats(multi_emb_a_1)\n\nnorms: mean 17.507275, std 0.661216\nnorms: min 15.955662, max 18.931648\nnorm diffs: mean 24.441858, std 0.949635\nnorm diffs: min 21.217833, max 27.614788\n\n\nEven more variation now. Again, let’s spot check:\n\n# Try an arbitrary embedding and plot it.\nlogits = LogitsWrapper(block_n_on_function(m, n=1)(unsqueeze_emb(multi_emb_a_1[63, 0, :])).detach(), tokenizer)\nlogits.plot_probs()\n\n\n\n\n\n\n\n\nWith this in place, we can now learn embeddings for all the tokens and save them for later use.",
    "crumbs": [
      "experiments",
      "learn-embeddings"
    ]
  },
  {
    "objectID": "experiments/learn-embeddings.html#learn-embeddings-for-each-token-and-save-them",
    "href": "experiments/learn-embeddings.html#learn-embeddings-for-each-token-and-save-them",
    "title": "learn-embeddings",
    "section": "Learn embeddings for each token and save them",
    "text": "Learn embeddings for each token and save them\n\nresults_folder = environment.data_root / 'learned_embeddings'\nresults_folder.mkdir(exist_ok=True)\n\n\nfilename_for_token = FilenameForToken(tokenizer)\n\n\nn_embeddings_to_learn = 100\n\n\nNo Blocks\nLearn embeddings for just the output head:\n\nembedding_to_logits_function = transformer_output_head_function(m)\nsub_dir = results_folder / f'no_blocks'\nsub_dir.mkdir(exist_ok=True)\n\n\nfor target_char in tqdm(tokenizer.chars):\n    multi_embs, _ = learn_embedding_for_char(\n        target_char, embedding_to_logits_function, n_embeddings_to_learn=n_embeddings_to_learn\n    )\n    torch.save(multi_embs, sub_dir / f'{filename_for_token(target_char)}.pt')\n\n\n\n\nOptimizing embedding for '\\n'\nstep     0: loss 4.873875\nstep  5000: loss 0.014350\nstep 10000: loss 0.001145\nstep 15000: loss 0.000115\nending training at step 15317: loss 0.000100\nOptimizing embedding for ' '\nstep     0: loss 4.264826\nstep  5000: loss 0.016041\nstep 10000: loss 0.001354\nstep 15000: loss 0.000146\nending training at step 15895: loss 0.000100\nOptimizing embedding for '!'\nstep     0: loss 4.792295\nstep  5000: loss 0.012945\nstep 10000: loss 0.000995\nending training at step 14904: loss 0.000100\nOptimizing embedding for '$'\nstep     0: loss 5.333682\nstep  5000: loss 0.057611\nstep 10000: loss 0.005992\nstep 15000: loss 0.001061\nstep 20000: loss 0.000405\nstep 25000: loss 0.000354\nstep 30000: loss 0.000354\nstep 35000: loss 0.000354\nstep 40000: loss 0.000354\nstep 45000: loss 0.000354\nOptimizing embedding for '&'\nstep     0: loss 5.297050\nstep  5000: loss 0.059776\nstep 10000: loss 0.006204\nstep 15000: loss 0.001161\nstep 20000: loss 0.000509\nstep 25000: loss 0.000470\nstep 30000: loss 0.000469\nstep 35000: loss 0.000469\nstep 40000: loss 0.000469\nstep 45000: loss 0.000469\nOptimizing embedding for \"'\"\nstep     0: loss 4.427784\nstep  5000: loss 0.009131\nstep 10000: loss 0.000668\nending training at step 13922: loss 0.000100\nOptimizing embedding for ','\nstep     0: loss 4.773814\nstep  5000: loss 0.026466\nstep 10000: loss 0.002318\nstep 15000: loss 0.000273\nending training at step 17611: loss 0.000100\nOptimizing embedding for '-'\nstep     0: loss 4.811676\nstep  5000: loss 0.010475\nstep 10000: loss 0.000778\nending training at step 14270: loss 0.000100\nOptimizing embedding for '.'\nstep     0: loss 4.674299\nstep  5000: loss 0.027865\nstep 10000: loss 0.002514\nstep 15000: loss 0.000314\nending training at step 18179: loss 0.000100\nOptimizing embedding for '3'\nstep     0: loss 5.365812\nstep  5000: loss 0.034804\nstep 10000: loss 0.002992\nstep 15000: loss 0.000367\nending training at step 18638: loss 0.000100\nOptimizing embedding for ':'\nstep     0: loss 4.741449\nstep  5000: loss 0.012953\nstep 10000: loss 0.001016\nending training at step 14978: loss 0.000100\nOptimizing embedding for ';'\nstep     0: loss 4.844121\nstep  5000: loss 0.027275\nstep 10000: loss 0.002482\nstep 15000: loss 0.000309\nending training at step 18092: loss 0.000100\nOptimizing embedding for '?'\nstep     0: loss 5.005649\nstep  5000: loss 0.012930\nstep 10000: loss 0.000989\nending training at step 14877: loss 0.000100\nOptimizing embedding for 'A'\nstep     0: loss 5.113842\nstep  5000: loss 0.015388\nstep 10000: loss 0.001204\nstep 15000: loss 0.000119\nending training at step 15387: loss 0.000100\nOptimizing embedding for 'B'\nstep     0: loss 5.215371\nstep  5000: loss 0.017506\nstep 10000: loss 0.001359\nstep 15000: loss 0.000136\nending training at step 15706: loss 0.000100\nOptimizing embedding for 'C'\nstep     0: loss 4.807229\nstep  5000: loss 0.014966\nstep 10000: loss 0.001172\nstep 15000: loss 0.000117\nending training at step 15346: loss 0.000100\nOptimizing embedding for 'D'\nstep     0: loss 5.175806\nstep  5000: loss 0.015056\nstep 10000: loss 0.001147\nstep 15000: loss 0.000111\nending training at step 15225: loss 0.000100\nOptimizing embedding for 'E'\nstep     0: loss 4.931046\nstep  5000: loss 0.012371\nstep 10000: loss 0.000935\nending training at step 14723: loss 0.000100\nOptimizing embedding for 'F'\nstep     0: loss 5.209412\nstep  5000: loss 0.017060\nstep 10000: loss 0.001304\nstep 15000: loss 0.000128\nending training at step 15544: loss 0.000100\nOptimizing embedding for 'G'\nstep     0: loss 5.248595\nstep  5000: loss 0.013182\nstep 10000: loss 0.000999\nending training at step 14870: loss 0.000100\nOptimizing embedding for 'H'\nstep     0: loss 5.152567\nstep  5000: loss 0.017908\nstep 10000: loss 0.001409\nstep 15000: loss 0.000143\nending training at step 15819: loss 0.000100\nOptimizing embedding for 'I'\nstep     0: loss 4.950461\nstep  5000: loss 0.014191\nstep 10000: loss 0.001090\nstep 15000: loss 0.000105\nending training at step 15105: loss 0.000100\nOptimizing embedding for 'J'\nstep     0: loss 5.064102\nstep  5000: loss 0.022407\nstep 10000: loss 0.001807\nstep 15000: loss 0.000198\nending training at step 16662: loss 0.000100\nOptimizing embedding for 'K'\nstep     0: loss 4.987291\nstep  5000: loss 0.014709\nstep 10000: loss 0.001141\nstep 15000: loss 0.000112\nending training at step 15245: loss 0.000100\nOptimizing embedding for 'L'\nstep     0: loss 5.183823\nstep  5000: loss 0.014404\nstep 10000: loss 0.001087\nstep 15000: loss 0.000104\nending training at step 15082: loss 0.000100\nOptimizing embedding for 'M'\nstep     0: loss 5.154094\nstep  5000: loss 0.017238\nstep 10000: loss 0.001342\nstep 15000: loss 0.000134\nending training at step 15652: loss 0.000100\nOptimizing embedding for 'N'\nstep     0: loss 5.410346\nstep  5000: loss 0.012436\nstep 10000: loss 0.000936\nending training at step 14710: loss 0.000100\nOptimizing embedding for 'O'\nstep     0: loss 4.898608\nstep  5000: loss 0.011437\nstep 10000: loss 0.000870\nending training at step 14554: loss 0.000100\nOptimizing embedding for 'P'\nstep     0: loss 4.961571\nstep  5000: loss 0.017236\nstep 10000: loss 0.001346\nstep 15000: loss 0.000136\nending training at step 15711: loss 0.000100\nOptimizing embedding for 'Q'\nstep     0: loss 5.146482\nstep  5000: loss 0.033291\nstep 10000: loss 0.002937\nstep 15000: loss 0.000374\nending training at step 18847: loss 0.000100\nOptimizing embedding for 'R'\nstep     0: loss 5.044732\nstep  5000: loss 0.012409\nstep 10000: loss 0.000931\nending training at step 14697: loss 0.000100\nOptimizing embedding for 'S'\nstep     0: loss 4.984651\nstep  5000: loss 0.014172\nstep 10000: loss 0.001097\nstep 15000: loss 0.000107\nending training at step 15141: loss 0.000100\nOptimizing embedding for 'T'\nstep     0: loss 5.201972\nstep  5000: loss 0.017122\nstep 10000: loss 0.001325\nstep 15000: loss 0.000131\nending training at step 15602: loss 0.000100\nOptimizing embedding for 'U'\nstep     0: loss 5.261983\nstep  5000: loss 0.011479\nstep 10000: loss 0.000862\nending training at step 14514: loss 0.000100\nOptimizing embedding for 'V'\nstep     0: loss 5.383446\nstep  5000: loss 0.014711\nstep 10000: loss 0.001108\nstep 15000: loss 0.000105\nending training at step 15112: loss 0.000100\nOptimizing embedding for 'W'\nstep     0: loss 5.273647\nstep  5000: loss 0.021252\nstep 10000: loss 0.001691\nstep 15000: loss 0.000176\nending training at step 16322: loss 0.000100\nOptimizing embedding for 'X'\nstep     0: loss 5.354009\nstep  5000: loss 0.015729\nstep 10000: loss 0.001203\nstep 15000: loss 0.000117\nending training at step 15351: loss 0.000100\nOptimizing embedding for 'Y'\nstep     0: loss 5.102457\nstep  5000: loss 0.012912\nstep 10000: loss 0.000968\nending training at step 14792: loss 0.000100\nOptimizing embedding for 'Z'\nstep     0: loss 5.203928\nstep  5000: loss 0.015488\nstep 10000: loss 0.001193\nstep 15000: loss 0.000116\nending training at step 15327: loss 0.000100\nOptimizing embedding for 'a'\nstep     0: loss 4.273046\nstep  5000: loss 0.014312\nstep 10000: loss 0.001138\nstep 15000: loss 0.000115\nending training at step 15308: loss 0.000100\nOptimizing embedding for 'b'\nstep     0: loss 4.682340\nstep  5000: loss 0.013746\nstep 10000: loss 0.001014\nending training at step 14867: loss 0.000100\nOptimizing embedding for 'c'\nstep     0: loss 4.690848\nstep  5000: loss 0.011992\nstep 10000: loss 0.000885\nending training at step 14568: loss 0.000100\nOptimizing embedding for 'd'\nstep     0: loss 4.549020\nstep  5000: loss 0.011544\nstep 10000: loss 0.000855\nending training at step 14477: loss 0.000100\nOptimizing embedding for 'e'\nstep     0: loss 4.382761\nstep  5000: loss 0.011802\nstep 10000: loss 0.000924\nending training at step 14748: loss 0.000100\nOptimizing embedding for 'f'\nstep     0: loss 4.842515\nstep  5000: loss 0.013852\nstep 10000: loss 0.001037\nending training at step 14940: loss 0.000100\nOptimizing embedding for 'g'\nstep     0: loss 4.529458\nstep  5000: loss 0.010083\nstep 10000: loss 0.000754\nending training at step 14212: loss 0.000100\nOptimizing embedding for 'h'\nstep     0: loss 4.441307\nstep  5000: loss 0.013397\nstep 10000: loss 0.001038\nstep 15000: loss 0.000101\nending training at step 15032: loss 0.000100\nOptimizing embedding for 'i'\nstep     0: loss 4.120494\nstep  5000: loss 0.012618\nstep 10000: loss 0.000995\nending training at step 14945: loss 0.000100\nOptimizing embedding for 'j'\nstep     0: loss 4.989840\nstep  5000: loss 0.014413\nstep 10000: loss 0.001074\nstep 15000: loss 0.000101\nending training at step 15031: loss 0.000100\nOptimizing embedding for 'k'\nstep     0: loss 4.854855\nstep  5000: loss 0.009786\nstep 10000: loss 0.000723\nending training at step 14104: loss 0.000100\nOptimizing embedding for 'l'\nstep     0: loss 4.350724\nstep  5000: loss 0.011370\nstep 10000: loss 0.000853\nending training at step 14497: loss 0.000100\nOptimizing embedding for 'm'\nstep     0: loss 4.619439\nstep  5000: loss 0.012355\nstep 10000: loss 0.000939\nending training at step 14752: loss 0.000100\nOptimizing embedding for 'n'\nstep     0: loss 4.462899\nstep  5000: loss 0.012318\nstep 10000: loss 0.000935\nending training at step 14727: loss 0.000100\nOptimizing embedding for 'o'\nstep     0: loss 4.410997\nstep  5000: loss 0.014322\nstep 10000: loss 0.001139\nstep 15000: loss 0.000113\nending training at step 15282: loss 0.000100\nOptimizing embedding for 'p'\nstep     0: loss 4.570235\nstep  5000: loss 0.011398\nstep 10000: loss 0.000837\nending training at step 14423: loss 0.000100\nOptimizing embedding for 'q'\nstep     0: loss 5.127600\nstep  5000: loss 0.012552\nstep 10000: loss 0.000936\nending training at step 14693: loss 0.000100\nOptimizing embedding for 'r'\nstep     0: loss 4.435355\nstep  5000: loss 0.011171\nstep 10000: loss 0.000845\nending training at step 14497: loss 0.000100\nOptimizing embedding for 's'\nstep     0: loss 4.184333\nstep  5000: loss 0.011847\nstep 10000: loss 0.000928\nending training at step 14775: loss 0.000100\nOptimizing embedding for 't'\nstep     0: loss 4.536841\nstep  5000: loss 0.013432\nstep 10000: loss 0.001021\nending training at step 14953: loss 0.000100\nOptimizing embedding for 'u'\nstep     0: loss 4.413103\nstep  5000: loss 0.010647\nstep 10000: loss 0.000790\nending training at step 14312: loss 0.000100\nOptimizing embedding for 'v'\nstep     0: loss 4.691413\nstep  5000: loss 0.011501\nstep 10000: loss 0.000860\nending training at step 14509: loss 0.000100\nOptimizing embedding for 'w'\nstep     0: loss 4.491944\nstep  5000: loss 0.013307\nstep 10000: loss 0.000995\nending training at step 14859: loss 0.000100\nOptimizing embedding for 'x'\nstep     0: loss 4.986167\nstep  5000: loss 0.011315\nstep 10000: loss 0.000835\nending training at step 14424: loss 0.000100\nOptimizing embedding for 'y'\nstep     0: loss 4.736977\nstep  5000: loss 0.011138\nstep 10000: loss 0.000828\nending training at step 14408: loss 0.000100\nOptimizing embedding for 'z'\nstep     0: loss 4.985116\nstep  5000: loss 0.009728\nstep 10000: loss 0.000710\nending training at step 14037: loss 0.000100\n\n\n\n\n1 Block\nLearn embeddings from the last block (block index 5 onwards):\n\nblock_n_on = 5\nembedding_to_logits_function = block_n_on_function(m, n=block_n_on)\nsub_dir = results_folder / f'block_{block_n_on}'\nsub_dir.mkdir(exist_ok=True)\n\n\nfor target_char in tqdm(tokenizer.chars):\n    multi_embs, _ = learn_embedding_for_char(\n        target_char, embedding_to_logits_function, n_embeddings_to_learn=n_embeddings_to_learn\n    )\n    torch.save(multi_embs, sub_dir / f'{filename_for_token(target_char)}.pt')\n\n\n\n\nOptimizing embedding for '\\n'\nstep     0: loss 5.347430\nstep  5000: loss 0.007386\nstep 10000: loss 0.000657\nending training at step 14478: loss 0.000100\nOptimizing embedding for ' '\nstep     0: loss 3.744530\nstep  5000: loss 0.005794\nstep 10000: loss 0.000533\nending training at step 14041: loss 0.000100\nOptimizing embedding for '!'\nstep     0: loss 6.476709\nstep  5000: loss 0.007308\nstep 10000: loss 0.000641\nending training at step 14254: loss 0.000100\nOptimizing embedding for '$'\nstep     0: loss 8.133106\nstep  5000: loss 0.085841\nstep 10000: loss 0.009670\nstep 15000: loss 0.001712\nstep 20000: loss 0.000555\nstep 25000: loss 0.000398\nstep 30000: loss 0.000378\nstep 35000: loss 0.000371\nstep 40000: loss 0.000367\nstep 45000: loss 0.000365\nOptimizing embedding for '&'\nstep     0: loss 7.565117\nstep  5000: loss 0.093037\nstep 10000: loss 0.010646\nstep 15000: loss 0.002142\nstep 20000: loss 0.000802\nstep 25000: loss 0.000548\nstep 30000: loss 0.000499\nstep 35000: loss 0.000487\nstep 40000: loss 0.000483\nstep 45000: loss 0.000481\nOptimizing embedding for \"'\"\nstep     0: loss 5.156186\nstep  5000: loss 0.005823\nstep 10000: loss 0.000452\nending training at step 13204: loss 0.000100\nOptimizing embedding for ','\nstep     0: loss 4.808379\nstep  5000: loss 0.015074\nstep 10000: loss 0.001522\nstep 15000: loss 0.000231\nending training at step 17605: loss 0.000100\nOptimizing embedding for '-'\nstep     0: loss 5.895603\nstep  5000: loss 0.005756\nstep 10000: loss 0.000450\nending training at step 13249: loss 0.000100\nOptimizing embedding for '.'\nstep     0: loss 6.209974\nstep  5000: loss 0.023172\nstep 10000: loss 0.002623\nstep 15000: loss 0.000436\nstep 20000: loss 0.000104\nending training at step 20149: loss 0.000100\nOptimizing embedding for '3'\nstep     0: loss 7.941002\nstep  5000: loss 0.044592\nstep 10000: loss 0.004487\nstep 15000: loss 0.000611\nstep 20000: loss 0.000118\nending training at step 20613: loss 0.000100\nOptimizing embedding for ':'\nstep     0: loss 6.865605\nstep  5000: loss 0.006139\nstep 10000: loss 0.000501\nending training at step 13679: loss 0.000100\nOptimizing embedding for ';'\nstep     0: loss 6.623376\nstep  5000: loss 0.028730\nstep 10000: loss 0.002908\nstep 15000: loss 0.000418\nending training at step 19428: loss 0.000100\nOptimizing embedding for '?'\nstep     0: loss 6.516698\nstep  5000: loss 0.007135\nstep 10000: loss 0.000624\nending training at step 14201: loss 0.000100\nOptimizing embedding for 'A'\nstep     0: loss 7.063316\nstep  5000: loss 0.008427\nstep 10000: loss 0.000698\nending training at step 14472: loss 0.000100\nOptimizing embedding for 'B'\nstep     0: loss 7.246926\nstep  5000: loss 0.011748\nstep 10000: loss 0.000978\nstep 15000: loss 0.000113\nending training at step 15292: loss 0.000100\nOptimizing embedding for 'C'\nstep     0: loss 7.449971\nstep  5000: loss 0.008698\nstep 10000: loss 0.000758\nending training at step 14731: loss 0.000100\nOptimizing embedding for 'D'\nstep     0: loss 6.771146\nstep  5000: loss 0.007700\nstep 10000: loss 0.000649\nending training at step 14250: loss 0.000100\nOptimizing embedding for 'E'\nstep     0: loss 7.121366\nstep  5000: loss 0.006511\nstep 10000: loss 0.000531\nending training at step 13697: loss 0.000100\nOptimizing embedding for 'F'\nstep     0: loss 7.631640\nstep  5000: loss 0.013424\nstep 10000: loss 0.001119\nstep 15000: loss 0.000125\nending training at step 15536: loss 0.000100\nOptimizing embedding for 'G'\nstep     0: loss 7.739057\nstep  5000: loss 0.008573\nstep 10000: loss 0.000703\nending training at step 14341: loss 0.000100\nOptimizing embedding for 'H'\nstep     0: loss 6.870086\nstep  5000: loss 0.011302\nstep 10000: loss 0.000955\nstep 15000: loss 0.000113\nending training at step 15317: loss 0.000100\nOptimizing embedding for 'I'\nstep     0: loss 6.524743\nstep  5000: loss 0.006385\nstep 10000: loss 0.000516\nending training at step 13674: loss 0.000100\nOptimizing embedding for 'J'\nstep     0: loss 6.918394\nstep  5000: loss 0.021348\nstep 10000: loss 0.002077\nstep 15000: loss 0.000270\nending training at step 17681: loss 0.000100\nOptimizing embedding for 'K'\nstep     0: loss 7.540547\nstep  5000: loss 0.011649\nstep 10000: loss 0.001001\nstep 15000: loss 0.000115\nending training at step 15346: loss 0.000100\nOptimizing embedding for 'L'\nstep     0: loss 7.171153\nstep  5000: loss 0.007544\nstep 10000: loss 0.000624\nending training at step 14132: loss 0.000100\nOptimizing embedding for 'M'\nstep     0: loss 7.511839\nstep  5000: loss 0.012008\nstep 10000: loss 0.000992\nstep 15000: loss 0.000115\nending training at step 15342: loss 0.000100\nOptimizing embedding for 'N'\nstep     0: loss 7.237311\nstep  5000: loss 0.005385\nstep 10000: loss 0.000439\nending training at step 13250: loss 0.000100\nOptimizing embedding for 'O'\nstep     0: loss 7.000911\nstep  5000: loss 0.005379\nstep 10000: loss 0.000424\nending training at step 13159: loss 0.000100\nOptimizing embedding for 'P'\nstep     0: loss 6.761536\nstep  5000: loss 0.012577\nstep 10000: loss 0.001089\nstep 15000: loss 0.000130\nending training at step 15663: loss 0.000100\nOptimizing embedding for 'Q'\nstep     0: loss 7.574077\nstep  5000: loss 0.036536\nstep 10000: loss 0.003842\nstep 15000: loss 0.000569\nstep 20000: loss 0.000121\nending training at step 20763: loss 0.000100\nOptimizing embedding for 'R'\nstep     0: loss 7.027799\nstep  5000: loss 0.007081\nstep 10000: loss 0.000573\nending training at step 13866: loss 0.000100\nOptimizing embedding for 'S'\nstep     0: loss 7.332571\nstep  5000: loss 0.008095\nstep 10000: loss 0.000670\nending training at step 14317: loss 0.000100\nOptimizing embedding for 'T'\nstep     0: loss 7.321306\nstep  5000: loss 0.007811\nstep 10000: loss 0.000704\nending training at step 14660: loss 0.000100\nOptimizing embedding for 'U'\nstep     0: loss 7.908830\nstep  5000: loss 0.006525\nstep 10000: loss 0.000512\nending training at step 13557: loss 0.000100\nOptimizing embedding for 'V'\nstep     0: loss 7.760444\nstep  5000: loss 0.009805\nstep 10000: loss 0.000795\nending training at step 14672: loss 0.000100\nOptimizing embedding for 'W'\nstep     0: loss 7.053877\nstep  5000: loss 0.013178\nstep 10000: loss 0.001213\nstep 15000: loss 0.000152\nending training at step 16094: loss 0.000100\nOptimizing embedding for 'X'\nstep     0: loss 8.160125\nstep  5000: loss 0.012235\nstep 10000: loss 0.001112\nstep 15000: loss 0.000132\nending training at step 15675: loss 0.000100\nOptimizing embedding for 'Y'\nstep     0: loss 7.260418\nstep  5000: loss 0.007429\nstep 10000: loss 0.000593\nending training at step 13927: loss 0.000100\nOptimizing embedding for 'Z'\nstep     0: loss 7.773640\nstep  5000: loss 0.012257\nstep 10000: loss 0.001111\nstep 15000: loss 0.000131\nending training at step 15655: loss 0.000100\nOptimizing embedding for 'a'\nstep     0: loss 4.141507\nstep  5000: loss 0.003693\nstep 10000: loss 0.000306\nending training at step 12568: loss 0.000100\nOptimizing embedding for 'b'\nstep     0: loss 5.297385\nstep  5000: loss 0.004673\nstep 10000: loss 0.000380\nending training at step 12962: loss 0.000100\nOptimizing embedding for 'c'\nstep     0: loss 5.074947\nstep  5000: loss 0.003856\nstep 10000: loss 0.000303\nending training at step 12421: loss 0.000100\nOptimizing embedding for 'd'\nstep     0: loss 5.328892\nstep  5000: loss 0.003671\nstep 10000: loss 0.000276\nending training at step 12169: loss 0.000100\nOptimizing embedding for 'e'\nstep     0: loss 4.090889\nstep  5000: loss 0.003495\nstep 10000: loss 0.000280\nending training at step 12263: loss 0.000100\nOptimizing embedding for 'f'\nstep     0: loss 5.071789\nstep  5000: loss 0.005350\nstep 10000: loss 0.000426\nending training at step 13240: loss 0.000100\nOptimizing embedding for 'g'\nstep     0: loss 4.969716\nstep  5000: loss 0.003954\nstep 10000: loss 0.000301\nending training at step 12341: loss 0.000100\nOptimizing embedding for 'h'\nstep     0: loss 4.788130\nstep  5000: loss 0.004963\nstep 10000: loss 0.000418\nending training at step 13255: loss 0.000100\nOptimizing embedding for 'i'\nstep     0: loss 3.821693\nstep  5000: loss 0.003995\nstep 10000: loss 0.000322\nending training at step 12586: loss 0.000100\nOptimizing embedding for 'j'\nstep     0: loss 6.758059\nstep  5000: loss 0.013991\nstep 10000: loss 0.001127\nstep 15000: loss 0.000120\nending training at step 15430: loss 0.000100\nOptimizing embedding for 'k'\nstep     0: loss 6.332606\nstep  5000: loss 0.005338\nstep 10000: loss 0.000403\nending training at step 12947: loss 0.000100\nOptimizing embedding for 'l'\nstep     0: loss 4.604065\nstep  5000: loss 0.003959\nstep 10000: loss 0.000300\nending training at step 12355: loss 0.000100\nOptimizing embedding for 'm'\nstep     0: loss 5.128067\nstep  5000: loss 0.005043\nstep 10000: loss 0.000390\nending training at step 12985: loss 0.000100\nOptimizing embedding for 'n'\nstep     0: loss 4.884213\nstep  5000: loss 0.004264\nstep 10000: loss 0.000326\nending training at step 12533: loss 0.000100\nOptimizing embedding for 'o'\nstep     0: loss 4.753374\nstep  5000: loss 0.005272\nstep 10000: loss 0.000444\nending training at step 13389: loss 0.000100\nOptimizing embedding for 'p'\nstep     0: loss 5.534964\nstep  5000: loss 0.004984\nstep 10000: loss 0.000374\nending training at step 12822: loss 0.000100\nOptimizing embedding for 'q'\nstep     0: loss 6.771389\nstep  5000: loss 0.009553\nstep 10000: loss 0.000762\nending training at step 14440: loss 0.000100\nOptimizing embedding for 'r'\nstep     0: loss 4.422514\nstep  5000: loss 0.004006\nstep 10000: loss 0.000300\nending training at step 12342: loss 0.000100\nOptimizing embedding for 's'\nstep     0: loss 4.241723\nstep  5000: loss 0.004333\nstep 10000: loss 0.000347\nending training at step 12766: loss 0.000100\nOptimizing embedding for 't'\nstep     0: loss 4.483743\nstep  5000: loss 0.003839\nstep 10000: loss 0.000315\nending training at step 12538: loss 0.000100\nOptimizing embedding for 'u'\nstep     0: loss 5.174875\nstep  5000: loss 0.004506\nstep 10000: loss 0.000343\nending training at step 12646: loss 0.000100\nOptimizing embedding for 'v'\nstep     0: loss 5.617326\nstep  5000: loss 0.005383\nstep 10000: loss 0.000417\nending training at step 13078: loss 0.000100\nOptimizing embedding for 'w'\nstep     0: loss 4.738924\nstep  5000: loss 0.005459\nstep 10000: loss 0.000426\nending training at step 13187: loss 0.000100\nOptimizing embedding for 'x'\nstep     0: loss 7.199396\nstep  5000: loss 0.007838\nstep 10000: loss 0.000628\nending training at step 14019: loss 0.000100\nOptimizing embedding for 'y'\nstep     0: loss 5.467407\nstep  5000: loss 0.004450\nstep 10000: loss 0.000350\nending training at step 12694: loss 0.000100\nOptimizing embedding for 'z'\nstep     0: loss 7.097597\nstep  5000: loss 0.006247\nstep 10000: loss 0.000488\nending training at step 13385: loss 0.000100\n\n\n\nWith 1000 embeddings per token\nI wanted to see if we got better results with more embeddings, so let’s learn 1000 embeddings / token for the last block.\n\nblock_n_on = 5\nn_embeddings_to_learn=1000\nembedding_to_logits_function = block_n_on_function(m, n=block_n_on)\nsub_dir = results_folder / f'block_{block_n_on}_{n_embeddings_to_learn}'\nsub_dir.mkdir(exist_ok=True)\n\n\nfor target_char in tqdm(tokenizer.chars):\n    multi_embs, _ = learn_embedding_for_char(\n        target_char, embedding_to_logits_function, n_embeddings_to_learn=n_embeddings_to_learn\n    )\n    torch.save(multi_embs, sub_dir / f'{filename_for_token(target_char)}.pt')\n\n\n\n\nOptimizing embedding for 'n'\nstep     0: loss 4.559832\nstep  5000: loss 0.004011\nstep 10000: loss 0.000314\nending training at step 12531: loss 0.000100\nOptimizing embedding for 'o'\nstep     0: loss 4.772153\nstep  5000: loss 0.005388\nstep 10000: loss 0.000453\nending training at step 13553: loss 0.000100\nOptimizing embedding for 'p'\nstep     0: loss 5.451766\nstep  5000: loss 0.004887\nstep 10000: loss 0.000375\nending training at step 12905: loss 0.000100\nOptimizing embedding for 'q'\nstep     0: loss 6.712268\nstep  5000: loss 0.009738\nstep 10000: loss 0.000777\nending training at step 14641: loss 0.000100\nOptimizing embedding for 'r'\nstep     0: loss 4.504239\nstep  5000: loss 0.003917\nstep 10000: loss 0.000304\nending training at step 12451: loss 0.000100\nOptimizing embedding for 's'\nstep     0: loss 3.967334\nstep  5000: loss 0.004284\nstep 10000: loss 0.000346\nending training at step 12817: loss 0.000100\nOptimizing embedding for 't'\nstep     0: loss 4.246644\nstep  5000: loss 0.003862\nstep 10000: loss 0.000315\nending training at step 12615: loss 0.000100\nOptimizing embedding for 'u'\nstep     0: loss 5.164997\nstep  5000: loss 0.004617\nstep 10000: loss 0.000360\nending training at step 12831: loss 0.000100\nOptimizing embedding for 'v'\nstep     0: loss 5.784395\nstep  5000: loss 0.005645\nstep 10000: loss 0.000439\nending training at step 13280: loss 0.000100\nOptimizing embedding for 'w'\nstep     0: loss 5.032755\nstep  5000: loss 0.005488\nstep 10000: loss 0.000441\nending training at step 13393: loss 0.000100\nOptimizing embedding for 'x'\nstep     0: loss 7.050308\nstep  5000: loss 0.007867\nstep 10000: loss 0.000636\nending training at step 14167: loss 0.000100\nOptimizing embedding for 'y'\nstep     0: loss 5.264086\nstep  5000: loss 0.004477\nstep 10000: loss 0.000350\nending training at step 12751: loss 0.000100\nOptimizing embedding for 'z'\nstep     0: loss 7.208733\nstep  5000: loss 0.006133\nstep 10000: loss 0.000482\nending training at step 13441: loss 0.000100\n\n\n\n\nWith 5000 embeddings per token\nLet’s see if even more embeddings help: learn 5000 embeddings/token.\n\nblock_n_on = 5\nn_embeddings_to_learn=5000\nembedding_to_logits_function = block_n_on_function(m, n=block_n_on)\nsub_dir = results_folder / f'block_{block_n_on}_{n_embeddings_to_learn}'\nsub_dir.mkdir(exist_ok=True)\nprint(sub_dir)\n\n/storage/learned_embeddings/block_5_5000\n\n\n\nfor target_char in tqdm(tokenizer.chars):\n    multi_embs, _ = learn_embedding_for_char(\n        target_char, embedding_to_logits_function, n_embeddings_to_learn=n_embeddings_to_learn\n    )\n    torch.save(multi_embs, sub_dir / f'{filename_for_token(target_char)}.pt')\n\n\n\n\nOptimizing embedding for '\\n'\nstep     0: loss 5.594407\nstep  5000: loss 0.007269\nstep 10000: loss 0.000696\nstep 15000: loss 0.000120\nending training at step 15687: loss 0.000100\nOptimizing embedding for ' '\nstep     0: loss 3.438382\nstep  5000: loss 0.005430\nstep 10000: loss 0.000537\nstep 15000: loss 0.000103\nending training at step 15140: loss 0.000100\nOptimizing embedding for '!'\nstep     0: loss 6.517096\nstep  5000: loss 0.007284\nstep 10000: loss 0.000668\nstep 15000: loss 0.000103\nending training at step 15083: loss 0.000100\nOptimizing embedding for '$'\nstep     0: loss 7.965337\nstep  5000: loss 0.082970\nstep 10000: loss 0.009700\nstep 15000: loss 0.001987\nstep 20000: loss 0.000854\nstep 25000: loss 0.000615\nstep 30000: loss 0.000530\nstep 35000: loss 0.000489\nstep 40000: loss 0.000464\nstep 45000: loss 0.000448\nOptimizing embedding for '&'\nstep     0: loss 7.658935\nstep  5000: loss 0.095831\nstep 10000: loss 0.011111\nstep 15000: loss 0.002514\nstep 20000: loss 0.001186\nstep 25000: loss 0.000888\nstep 30000: loss 0.000776\nstep 35000: loss 0.000716\nstep 40000: loss 0.000678\nstep 45000: loss 0.000651\nOptimizing embedding for \"'\"\nstep     0: loss 5.282728\nstep  5000: loss 0.005876\nstep 10000: loss 0.000483\nending training at step 13854: loss 0.000100\nOptimizing embedding for ','\nstep     0: loss 5.069627\nstep  5000: loss 0.015742\nstep 10000: loss 0.001677\nstep 15000: loss 0.000330\nstep 20000: loss 0.000136\nending training at step 23151: loss 0.000100\nOptimizing embedding for '-'\nstep     0: loss 5.793747\nstep  5000: loss 0.005741\nstep 10000: loss 0.000474\nending training at step 13813: loss 0.000100\nOptimizing embedding for '.'\nstep     0: loss 6.198037\nstep  5000: loss 0.023380\nstep 10000: loss 0.002735\nstep 15000: loss 0.000564\nstep 20000: loss 0.000232\nstep 25000: loss 0.000152\nstep 30000: loss 0.000118\nending training at step 34704: loss 0.000100\nOptimizing embedding for '3'\nstep     0: loss 7.771849\nstep  5000: loss 0.044660\nstep 10000: loss 0.004647\nstep 15000: loss 0.000780\nstep 20000: loss 0.000267\nstep 25000: loss 0.000160\nstep 30000: loss 0.000120\nending training at step 34799: loss 0.000100\nOptimizing embedding for ':'\nstep     0: loss 6.816797\nstep  5000: loss 0.006008\nstep 10000: loss 0.000522\nending training at step 14318: loss 0.000100\nOptimizing embedding for ';'\nstep     0: loss 6.429393\nstep  5000: loss 0.027733\nstep 10000: loss 0.002910\nstep 15000: loss 0.000530\nstep 20000: loss 0.000199\nstep 25000: loss 0.000123\nending training at step 28550: loss 0.000100\nOptimizing embedding for '?'\nstep     0: loss 6.720572\nstep  5000: loss 0.007352\nstep 10000: loss 0.000670\nstep 15000: loss 0.000103\nending training at step 15092: loss 0.000100\nOptimizing embedding for 'A'\nstep     0: loss 7.125983\nstep  5000: loss 0.008442\nstep 10000: loss 0.000733\nstep 15000: loss 0.000111\nending training at step 15360: loss 0.000100\nOptimizing embedding for 'B'\nstep     0: loss 7.413654\nstep  5000: loss 0.011906\nstep 10000: loss 0.001031\nstep 15000: loss 0.000155\nending training at step 16551: loss 0.000100\nOptimizing embedding for 'C'\nstep     0: loss 7.379269\nstep  5000: loss 0.008486\nstep 10000: loss 0.000769\nstep 15000: loss 0.000120\nending training at step 15637: loss 0.000100\nOptimizing embedding for 'D'\nstep     0: loss 6.879560\nstep  5000: loss 0.007789\nstep 10000: loss 0.000685\nstep 15000: loss 0.000103\nending training at step 15098: loss 0.000100\nOptimizing embedding for 'E'\nstep     0: loss 7.116797\nstep  5000: loss 0.006545\nstep 10000: loss 0.000557\nending training at step 14334: loss 0.000100\nOptimizing embedding for 'F'\nstep     0: loss 7.536552\nstep  5000: loss 0.013105\nstep 10000: loss 0.001142\nstep 15000: loss 0.000168\nending training at step 16820: loss 0.000100\nOptimizing embedding for 'G'\nstep     0: loss 7.432269\nstep  5000: loss 0.008491\nstep 10000: loss 0.000720\nstep 15000: loss 0.000102\nending training at step 15066: loss 0.000100\nOptimizing embedding for 'H'\nstep     0: loss 6.976287\nstep  5000: loss 0.011694\nstep 10000: loss 0.001028\nstep 15000: loss 0.000160\nending training at step 16740: loss 0.000100\nOptimizing embedding for 'I'\nstep     0: loss 6.453108\nstep  5000: loss 0.006361\nstep 10000: loss 0.000535\nending training at step 14314: loss 0.000100\nOptimizing embedding for 'J'\nstep     0: loss 7.170426\nstep  5000: loss 0.022446\nstep 10000: loss 0.002219\nstep 15000: loss 0.000368\nstep 20000: loss 0.000125\nending training at step 21722: loss 0.000100\nOptimizing embedding for 'K'\nstep     0: loss 7.532418\nstep  5000: loss 0.011812\nstep 10000: loss 0.001049\nstep 15000: loss 0.000156\nending training at step 16562: loss 0.000100\nOptimizing embedding for 'L'\nstep     0: loss 7.310787\nstep  5000: loss 0.007852\nstep 10000: loss 0.000672\nending training at step 14940: loss 0.000100\nOptimizing embedding for 'M'\nstep     0: loss 7.446343\nstep  5000: loss 0.011834\nstep 10000: loss 0.001031\nstep 15000: loss 0.000156\nending training at step 16586: loss 0.000100\nOptimizing embedding for 'N'\nstep     0: loss 7.390759\nstep  5000: loss 0.005521\nstep 10000: loss 0.000460\nending training at step 13744: loss 0.000100\nOptimizing embedding for 'O'\nstep     0: loss 7.084028\nstep  5000: loss 0.005356\nstep 10000: loss 0.000442\nending training at step 13628: loss 0.000100\nOptimizing embedding for 'P'\nstep     0: loss 7.220920\nstep  5000: loss 0.013608\nstep 10000: loss 0.001216\nstep 15000: loss 0.000188\nending training at step 17391: loss 0.000100\nOptimizing embedding for 'Q'\nstep     0: loss 7.621984\nstep  5000: loss 0.036300\nstep 10000: loss 0.003947\nstep 15000: loss 0.000723\nstep 20000: loss 0.000264\nstep 25000: loss 0.000163\nstep 30000: loss 0.000125\nstep 35000: loss 0.000104\nending training at step 36355: loss 0.000100\nOptimizing embedding for 'R'\nstep     0: loss 6.963523\nstep  5000: loss 0.007048\nstep 10000: loss 0.000594\nending training at step 14513: loss 0.000100\nOptimizing embedding for 'S'\nstep     0: loss 7.216874\nstep  5000: loss 0.007949\nstep 10000: loss 0.000687\nstep 15000: loss 0.000102\nending training at step 15060: loss 0.000100\nOptimizing embedding for 'T'\nstep     0: loss 7.100054\nstep  5000: loss 0.007693\nstep 10000: loss 0.000721\nstep 15000: loss 0.000117\nending training at step 15547: loss 0.000100\nOptimizing embedding for 'U'\nstep     0: loss 7.833190\nstep  5000: loss 0.006543\nstep 10000: loss 0.000537\nending training at step 14108: loss 0.000100\nOptimizing embedding for 'V'\nstep     0: loss 7.466230\nstep  5000: loss 0.009653\nstep 10000: loss 0.000824\nstep 15000: loss 0.000118\nending training at step 15542: loss 0.000100\nOptimizing embedding for 'W'\nstep     0: loss 6.921437\nstep  5000: loss 0.013066\nstep 10000: loss 0.001235\nstep 15000: loss 0.000202\nending training at step 17881: loss 0.000100\nOptimizing embedding for 'X'\nstep     0: loss 7.990481\nstep  5000: loss 0.012197\nstep 10000: loss 0.001153\nstep 15000: loss 0.000179\nending training at step 17133: loss 0.000100\nOptimizing embedding for 'Y'\nstep     0: loss 7.431907\nstep  5000: loss 0.007709\nstep 10000: loss 0.000641\nending training at step 14677: loss 0.000100\nOptimizing embedding for 'Z'\nstep     0: loss 8.011966\nstep  5000: loss 0.012419\nstep 10000: loss 0.001168\nstep 15000: loss 0.000180\nending training at step 17139: loss 0.000100\nOptimizing embedding for 'a'\nstep     0: loss 4.276280\nstep  5000: loss 0.003790\nstep 10000: loss 0.000337\nending training at step 13200: loss 0.000100\nOptimizing embedding for 'b'\nstep     0: loss 5.436181\nstep  5000: loss 0.004718\nstep 10000: loss 0.000403\nending training at step 13505: loss 0.000100\nOptimizing embedding for 'c'\nstep     0: loss 5.123799\nstep  5000: loss 0.004070\nstep 10000: loss 0.000332\nending training at step 12919: loss 0.000100\nOptimizing embedding for 'd'\nstep     0: loss 5.108806\nstep  5000: loss 0.003689\nstep 10000: loss 0.000294\nending training at step 12559: loss 0.000100\nOptimizing embedding for 'e'\nstep     0: loss 3.921755\nstep  5000: loss 0.003373\nstep 10000: loss 0.000291\nending training at step 12680: loss 0.000100\nOptimizing embedding for 'f'\nstep     0: loss 5.214041\nstep  5000: loss 0.005233\nstep 10000: loss 0.000446\nending training at step 13841: loss 0.000100\nOptimizing embedding for 'g'\nstep     0: loss 5.360433\nstep  5000: loss 0.004195\nstep 10000: loss 0.000333\nending training at step 12860: loss 0.000100\nOptimizing embedding for 'h'\nstep     0: loss 4.889000\nstep  5000: loss 0.005076\nstep 10000: loss 0.000449\nending training at step 13988: loss 0.000100\nOptimizing embedding for 'i'\nstep     0: loss 3.911887\nstep  5000: loss 0.004062\nstep 10000: loss 0.000353\nending training at step 13265: loss 0.000100\nOptimizing embedding for 'j'\nstep     0: loss 6.693477\nstep  5000: loss 0.013910\nstep 10000: loss 0.001173\nstep 15000: loss 0.000168\nending training at step 16807: loss 0.000100\nOptimizing embedding for 'k'\nstep     0: loss 6.102386\nstep  5000: loss 0.005243\nstep 10000: loss 0.000413\nending training at step 13369: loss 0.000100\nOptimizing embedding for 'l'\nstep     0: loss 4.647025\nstep  5000: loss 0.003966\nstep 10000: loss 0.000324\nending training at step 12858: loss 0.000100\nOptimizing embedding for 'm'\nstep     0: loss 4.994263\nstep  5000: loss 0.004958\nstep 10000: loss 0.000411\nending training at step 13551: loss 0.000100\nOptimizing embedding for 'n'\nstep     0: loss 4.590691\nstep  5000: loss 0.004071\nstep 10000: loss 0.000335\nending training at step 12967: loss 0.000100\nOptimizing embedding for 'o'\nstep     0: loss 4.697253\nstep  5000: loss 0.005286\nstep 10000: loss 0.000470\nending training at step 14138: loss 0.000100\nOptimizing embedding for 'p'\nstep     0: loss 5.542086\nstep  5000: loss 0.004964\nstep 10000: loss 0.000399\nending training at step 13345: loss 0.000100\nOptimizing embedding for 'q'\nstep     0: loss 6.669010\nstep  5000: loss 0.009706\nstep 10000: loss 0.000805\nstep 15000: loss 0.000112\nending training at step 15362: loss 0.000100\nOptimizing embedding for 'r'\nstep     0: loss 4.539549\nstep  5000: loss 0.003973\nstep 10000: loss 0.000325\nending training at step 12862: loss 0.000100\nOptimizing embedding for 's'\nstep     0: loss 3.938461\nstep  5000: loss 0.004231\nstep 10000: loss 0.000364\nending training at step 13304: loss 0.000100\nOptimizing embedding for 't'\nstep     0: loss 4.229414\nstep  5000: loss 0.003895\nstep 10000: loss 0.000332\nending training at step 13033: loss 0.000100\nOptimizing embedding for 'u'\nstep     0: loss 5.161785\nstep  5000: loss 0.004642\nstep 10000: loss 0.000378\nending training at step 13232: loss 0.000100\nOptimizing embedding for 'v'\nstep     0: loss 5.768043\nstep  5000: loss 0.005681\nstep 10000: loss 0.000460\nending training at step 13746: loss 0.000100\nOptimizing embedding for 'w'\nstep     0: loss 4.945869\nstep  5000: loss 0.005471\nstep 10000: loss 0.000461\nending training at step 13916: loss 0.000100\nOptimizing embedding for 'x'\nstep     0: loss 7.026910\nstep  5000: loss 0.007881\nstep 10000: loss 0.000660\nending training at step 14750: loss 0.000100\nOptimizing embedding for 'y'\nstep     0: loss 5.312238\nstep  5000: loss 0.004572\nstep 10000: loss 0.000374\nending training at step 13189: loss 0.000100\nOptimizing embedding for 'z'\nstep     0: loss 7.262398\nstep  5000: loss 0.006220\nstep 10000: loss 0.000506\nending training at step 13876: loss 0.000100\n\n\n\n\n\n2 Blocks\nLearn embeddings for last 2 blocks:\n\nblock_n_on = 4\nembedding_to_logits_function = block_n_on_function(m, n=block_n_on)\nsub_dir = results_folder / f'block_{block_n_on}'\nsub_dir.mkdir(exist_ok=True)\n\n\nfor target_char in tqdm(tokenizer.chars):\n    multi_embs, _ = learn_embedding_for_char(\n        target_char, embedding_to_logits_function, n_embeddings_to_learn=n_embeddings_to_learn\n    )\n    torch.save(multi_embs, sub_dir / f'{filename_for_token(target_char)}.pt')\n\n\n\n\nOptimizing embedding for '\\n'\nstep     0: loss 5.976839\nstep  5000: loss 0.008648\nstep 10000: loss 0.000779\nending training at step 14971: loss 0.000100\nOptimizing embedding for ' '\nstep     0: loss 3.259852\nstep  5000: loss 0.005781\nstep 10000: loss 0.000530\nending training at step 14046: loss 0.000100\nOptimizing embedding for '!'\nstep     0: loss 6.406515\nstep  5000: loss 0.006404\nstep 10000: loss 0.000584\nending training at step 14109: loss 0.000100\nOptimizing embedding for '$'\nstep     0: loss 8.885063\nstep  5000: loss 0.086875\nstep 10000: loss 0.010300\nstep 15000: loss 0.001904\nstep 20000: loss 0.000638\nstep 25000: loss 0.000440\nstep 30000: loss 0.000404\nstep 35000: loss 0.000392\nstep 40000: loss 0.000385\nstep 45000: loss 0.000380\nOptimizing embedding for '&'\nstep     0: loss 8.174032\nstep  5000: loss 0.101088\nstep 10000: loss 0.011571\nstep 15000: loss 0.002427\nstep 20000: loss 0.000948\nstep 25000: loss 0.000637\nstep 30000: loss 0.000550\nstep 35000: loss 0.000525\nstep 40000: loss 0.000515\nstep 45000: loss 0.000509\nOptimizing embedding for \"'\"\nstep     0: loss 5.590206\nstep  5000: loss 0.005999\nstep 10000: loss 0.000472\nending training at step 13324: loss 0.000100\nOptimizing embedding for ','\nstep     0: loss 5.080379\nstep  5000: loss 0.017123\nstep 10000: loss 0.001732\nstep 15000: loss 0.000253\nending training at step 17830: loss 0.000100\nOptimizing embedding for '-'\nstep     0: loss 6.024865\nstep  5000: loss 0.005053\nstep 10000: loss 0.000398\nending training at step 12993: loss 0.000100\nOptimizing embedding for '.'\nstep     0: loss 6.162129\nstep  5000: loss 0.023845\nstep 10000: loss 0.002738\nstep 15000: loss 0.000466\nstep 20000: loss 0.000115\nending training at step 20629: loss 0.000100\nOptimizing embedding for '3'\nstep     0: loss 8.444758\nstep  5000: loss 0.045061\nstep 10000: loss 0.004679\nstep 15000: loss 0.000691\nstep 20000: loss 0.000141\nending training at step 21408: loss 0.000100\nOptimizing embedding for ':'\nstep     0: loss 6.848844\nstep  5000: loss 0.005700\nstep 10000: loss 0.000439\nending training at step 13367: loss 0.000100\nOptimizing embedding for ';'\nstep     0: loss 6.361838\nstep  5000: loss 0.028255\nstep 10000: loss 0.003009\nstep 15000: loss 0.000456\nending training at step 19825: loss 0.000100\nOptimizing embedding for '?'\nstep     0: loss 7.329531\nstep  5000: loss 0.007494\nstep 10000: loss 0.000675\nending training at step 14452: loss 0.000100\nOptimizing embedding for 'A'\nstep     0: loss 7.462622\nstep  5000: loss 0.006849\nstep 10000: loss 0.000583\nending training at step 14158: loss 0.000100\nOptimizing embedding for 'B'\nstep     0: loss 7.803836\nstep  5000: loss 0.010118\nstep 10000: loss 0.000860\nstep 15000: loss 0.000106\nending training at step 15146: loss 0.000100\nOptimizing embedding for 'C'\nstep     0: loss 7.431258\nstep  5000: loss 0.006722\nstep 10000: loss 0.000611\nending training at step 14388: loss 0.000100\nOptimizing embedding for 'D'\nstep     0: loss 7.259895\nstep  5000: loss 0.006637\nstep 10000: loss 0.000560\nending training at step 13992: loss 0.000100\nOptimizing embedding for 'E'\nstep     0: loss 7.600525\nstep  5000: loss 0.006000\nstep 10000: loss 0.000471\nending training at step 13459: loss 0.000100\nOptimizing embedding for 'F'\nstep     0: loss 8.173978\nstep  5000: loss 0.012628\nstep 10000: loss 0.001058\nstep 15000: loss 0.000124\nending training at step 15532: loss 0.000100\nOptimizing embedding for 'G'\nstep     0: loss 8.104610\nstep  5000: loss 0.007674\nstep 10000: loss 0.000619\nending training at step 14100: loss 0.000100\nOptimizing embedding for 'H'\nstep     0: loss 7.396293\nstep  5000: loss 0.010146\nstep 10000: loss 0.000857\nstep 15000: loss 0.000108\nending training at step 15205: loss 0.000100\nOptimizing embedding for 'I'\nstep     0: loss 6.843120\nstep  5000: loss 0.005367\nstep 10000: loss 0.000421\nending training at step 13261: loss 0.000100\nOptimizing embedding for 'J'\nstep     0: loss 7.682026\nstep  5000: loss 0.022274\nstep 10000: loss 0.002175\nstep 15000: loss 0.000297\nending training at step 18032: loss 0.000100\nOptimizing embedding for 'K'\nstep     0: loss 8.034242\nstep  5000: loss 0.010027\nstep 10000: loss 0.000878\nstep 15000: loss 0.000106\nending training at step 15157: loss 0.000100\nOptimizing embedding for 'L'\nstep     0: loss 7.222985\nstep  5000: loss 0.005296\nstep 10000: loss 0.000452\nending training at step 13489: loss 0.000100\nOptimizing embedding for 'M'\nstep     0: loss 7.745698\nstep  5000: loss 0.009881\nstep 10000: loss 0.000868\nstep 15000: loss 0.000109\nending training at step 15222: loss 0.000100\nOptimizing embedding for 'N'\nstep     0: loss 8.020021\nstep  5000: loss 0.004542\nstep 10000: loss 0.000362\nending training at step 12857: loss 0.000100\nOptimizing embedding for 'O'\nstep     0: loss 7.501211\nstep  5000: loss 0.004781\nstep 10000: loss 0.000361\nending training at step 12822: loss 0.000100\nOptimizing embedding for 'P'\nstep     0: loss 7.623023\nstep  5000: loss 0.012417\nstep 10000: loss 0.001034\nstep 15000: loss 0.000127\nending training at step 15612: loss 0.000100\nOptimizing embedding for 'Q'\nstep     0: loss 8.380750\nstep  5000: loss 0.035819\nstep 10000: loss 0.004029\nstep 15000: loss 0.000652\nstep 20000: loss 0.000150\nending training at step 21871: loss 0.000100\nOptimizing embedding for 'R'\nstep     0: loss 7.295828\nstep  5000: loss 0.006140\nstep 10000: loss 0.000475\nending training at step 13437: loss 0.000100\nOptimizing embedding for 'S'\nstep     0: loss 7.297294\nstep  5000: loss 0.005677\nstep 10000: loss 0.000485\nending training at step 13702: loss 0.000100\nOptimizing embedding for 'T'\nstep     0: loss 7.263091\nstep  5000: loss 0.005888\nstep 10000: loss 0.000538\nending training at step 14109: loss 0.000100\nOptimizing embedding for 'U'\nstep     0: loss 7.996090\nstep  5000: loss 0.005224\nstep 10000: loss 0.000412\nending training at step 13103: loss 0.000100\nOptimizing embedding for 'V'\nstep     0: loss 7.998583\nstep  5000: loss 0.008571\nstep 10000: loss 0.000676\nending training at step 14284: loss 0.000100\nOptimizing embedding for 'W'\nstep     0: loss 7.612405\nstep  5000: loss 0.011744\nstep 10000: loss 0.001060\nstep 15000: loss 0.000141\nending training at step 15938: loss 0.000100\nOptimizing embedding for 'X'\nstep     0: loss 8.956954\nstep  5000: loss 0.011808\nstep 10000: loss 0.001073\nstep 15000: loss 0.000130\nending training at step 15650: loss 0.000100\nOptimizing embedding for 'Y'\nstep     0: loss 7.662042\nstep  5000: loss 0.006023\nstep 10000: loss 0.000485\nending training at step 13533: loss 0.000100\nOptimizing embedding for 'Z'\nstep     0: loss 8.492460\nstep  5000: loss 0.011471\nstep 10000: loss 0.001044\nstep 15000: loss 0.000128\nending training at step 15617: loss 0.000100\nOptimizing embedding for 'a'\nstep     0: loss 3.811878\nstep  5000: loss 0.003351\nstep 10000: loss 0.000269\nending training at step 12259: loss 0.000100\nOptimizing embedding for 'b'\nstep     0: loss 5.239269\nstep  5000: loss 0.003815\nstep 10000: loss 0.000299\nending training at step 12449: loss 0.000100\nOptimizing embedding for 'c'\nstep     0: loss 5.045540\nstep  5000: loss 0.003449\nstep 10000: loss 0.000268\nending training at step 12143: loss 0.000100\nOptimizing embedding for 'd'\nstep     0: loss 4.871099\nstep  5000: loss 0.003597\nstep 10000: loss 0.000258\nending training at step 11999: loss 0.000100\nOptimizing embedding for 'e'\nstep     0: loss 3.123604\nstep  5000: loss 0.002169\nstep 10000: loss 0.000172\nending training at step 11193: loss 0.000100\nOptimizing embedding for 'f'\nstep     0: loss 5.064374\nstep  5000: loss 0.005404\nstep 10000: loss 0.000425\nending training at step 13219: loss 0.000100\nOptimizing embedding for 'g'\nstep     0: loss 5.496363\nstep  5000: loss 0.003857\nstep 10000: loss 0.000278\nending training at step 12196: loss 0.000100\nOptimizing embedding for 'h'\nstep     0: loss 4.893647\nstep  5000: loss 0.004864\nstep 10000: loss 0.000385\nending training at step 13053: loss 0.000100\nOptimizing embedding for 'i'\nstep     0: loss 3.567966\nstep  5000: loss 0.003641\nstep 10000: loss 0.000283\nending training at step 12313: loss 0.000100\nOptimizing embedding for 'j'\nstep     0: loss 6.891648\nstep  5000: loss 0.012717\nstep 10000: loss 0.001040\nstep 15000: loss 0.000116\nending training at step 15350: loss 0.000100\nOptimizing embedding for 'k'\nstep     0: loss 6.694317\nstep  5000: loss 0.005149\nstep 10000: loss 0.000386\nending training at step 12889: loss 0.000100\nOptimizing embedding for 'l'\nstep     0: loss 3.972925\nstep  5000: loss 0.003409\nstep 10000: loss 0.000254\nending training at step 12011: loss 0.000100\nOptimizing embedding for 'm'\nstep     0: loss 4.716524\nstep  5000: loss 0.004574\nstep 10000: loss 0.000338\nending training at step 12668: loss 0.000100\nOptimizing embedding for 'n'\nstep     0: loss 3.947883\nstep  5000: loss 0.003402\nstep 10000: loss 0.000255\nending training at step 12002: loss 0.000100\nOptimizing embedding for 'o'\nstep     0: loss 4.209094\nstep  5000: loss 0.004597\nstep 10000: loss 0.000385\nending training at step 13129: loss 0.000100\nOptimizing embedding for 'p'\nstep     0: loss 5.491922\nstep  5000: loss 0.004592\nstep 10000: loss 0.000334\nending training at step 12591: loss 0.000100\nOptimizing embedding for 'q'\nstep     0: loss 7.071236\nstep  5000: loss 0.009648\nstep 10000: loss 0.000780\nending training at step 14544: loss 0.000100\nOptimizing embedding for 'r'\nstep     0: loss 4.199371\nstep  5000: loss 0.003764\nstep 10000: loss 0.000269\nending training at step 12097: loss 0.000100\nOptimizing embedding for 's'\nstep     0: loss 3.382303\nstep  5000: loss 0.003826\nstep 10000: loss 0.000292\nending training at step 12371: loss 0.000100\nOptimizing embedding for 't'\nstep     0: loss 3.480482\nstep  5000: loss 0.002713\nstep 10000: loss 0.000215\nending training at step 11708: loss 0.000100\nOptimizing embedding for 'u'\nstep     0: loss 4.638258\nstep  5000: loss 0.004020\nstep 10000: loss 0.000304\nending training at step 12410: loss 0.000100\nOptimizing embedding for 'v'\nstep     0: loss 5.588468\nstep  5000: loss 0.005722\nstep 10000: loss 0.000431\nending training at step 13151: loss 0.000100\nOptimizing embedding for 'w'\nstep     0: loss 5.171694\nstep  5000: loss 0.005444\nstep 10000: loss 0.000419\nending training at step 13169: loss 0.000100\nOptimizing embedding for 'x'\nstep     0: loss 7.298410\nstep  5000: loss 0.006922\nstep 10000: loss 0.000575\nending training at step 13903: loss 0.000100\nOptimizing embedding for 'y'\nstep     0: loss 4.950903\nstep  5000: loss 0.004004\nstep 10000: loss 0.000316\nending training at step 12507: loss 0.000100\nOptimizing embedding for 'z'\nstep     0: loss 7.318987\nstep  5000: loss 0.005466\nstep 10000: loss 0.000425\nending training at step 13100: loss 0.000100",
    "crumbs": [
      "experiments",
      "learn-embeddings"
    ]
  },
  {
    "objectID": "trained_models/tinyshakespeare-transformer.html",
    "href": "trained_models/tinyshakespeare-transformer.html",
    "title": "tinyshakespeare-transformer",
    "section": "",
    "text": "from transformer_experiments.environments import get_environment\n\n\nsource\n\ncreate_model_and_tokenizer\n\n create_model_and_tokenizer (saved_model_filename:str, dataset:transformer\n                             _experiments.datasets.tinyshakespeare.TinySha\n                             kespeareDataSet, device:str)\n\nInstantiates a pre-trained TinyShakespeare model: creates transformer model, loads the model params from a saved file, and creates a tokenizer from the dataset’s text.\n\nsource\n\n\nFilenameForToken\n\n FilenameForToken (tokenizer:transformer_experiments.tokenizers.char_token\n                   izer.CharacterTokenizer)\n\nInitialize self. See help(type(self)) for accurate signature.\n\nenvironment = get_environment()\nprint(f\"environment is {environment.name}\")\n\nenvironment is local_mac\n\n\n\nts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\ntokenizer = CharacterTokenizer(ts.text)\n\n\n# Tests for FilenameForToken\nfilename_for_token = FilenameForToken(tokenizer)\n\ntest_eq(filename_for_token('A'), 'capital_a')\ntest_eq(filename_for_token('a'), 'lower_a')\ntest_eq(filename_for_token(' '), 'space')\ntest_eq(filename_for_token('\\n'), 'newline')\ntest_eq(filename_for_token('!'), 'exclamation')\n\n# Test that we never get the ValueError exception at the end of the function for any character in chars.\nfor token in tokenizer.chars:\n    filename_for_token(token)\n\n# Test that we do get an exception for an unknown character.\nwith ExceptionExpected(ex=ValueError):\n    filename_for_token('🤔')",
    "crumbs": [
      "trained_models",
      "tinyshakespeare-transformer"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "transformer-experiments",
    "section": "",
    "text": "This repo contains experiments I did on the simple transformer developed in Andrej Karpathy’s excellent video, Let’s build GPT: from scratch, in code, spelled out. The transformer architecture, training, and basic inference code comes from that video. The experiments and analyses are my own.",
    "crumbs": [
      "transformer-experiments"
    ]
  },
  {
    "objectID": "index.html#dev-environment-setup",
    "href": "index.html#dev-environment-setup",
    "title": "transformer-experiments",
    "section": "Dev Environment Setup",
    "text": "Dev Environment Setup\n\nCreate a virtual environment\n\npython3 -m venv ~/venv/venv-transformer-experiments\nsource ~/venv/venv-transformer-experiments/bin/activate\n\nInstall dependencies\n\npip install -r requirements.txt\npip install -r requirements.dev.txt\n\nInstall this library in editable mode\n\npip install -e '.[dev]'\n\nBefore committing any changes\nRun the following to ensure all dependencies are generated from notebooks and notebooks are cleaned:\nmake all",
    "crumbs": [
      "transformer-experiments"
    ]
  },
  {
    "objectID": "training/training-utils.html",
    "href": "training/training-utils.html",
    "title": "training-utils.ipynb",
    "section": "",
    "text": "source\n\nCheckPointer\n\n CheckPointer (output_dir:pathlib.Path, filename_stem:str,\n               start_num:int=0)\n\nInitialize self. See help(type(self)) for accurate signature.\n\n## Tests for CheckPointer\nclass TestModule(torch.nn.Module):\n    def __init__(self):\n        super().__init__()\n        self.some_param = torch.nn.Linear(10, 1)\n\n    def forward(self, x):\n        return self.some_param(x)\n\nwith tempfile.TemporaryDirectory() as tmpdirname:\n    output_dir = Path(tmpdirname)\n    checkpointer = CheckPointer(output_dir, 'test')\n\n    test_model = TestModule()\n    test_train_loss = 0.123\n    test_val_loss = 0.125\n\n    filename = checkpointer.save_checkpoint(10, test_model, test_train_loss, test_val_loss)\n    test_eq(filename, output_dir / 'test_000000.pt')\n    test_eq(filename.exists(), True)\n\n    checkpoint = torch.load(str(output_dir / 'test_000000.pt'))\n    test_eq(checkpoint['iters'], 10)\n    test_eq(checkpoint['train_loss'], test_train_loss)\n    test_eq(checkpoint['val_loss'], test_val_loss)\n    test_eq('model_state_dict' in checkpoint, True)\n\n    filename = checkpointer.save_checkpoint(11, test_model, test_train_loss, test_val_loss)\n    test_eq(filename, output_dir / 'test_000001.pt')\n    test_eq(filename.exists(), True)\n\n    # Test start_num\n    checkpointer = CheckPointer(output_dir, 'test', start_num=14)\n    filename = checkpointer.save_checkpoint(11, test_model, test_train_loss, test_val_loss)\n    test_eq(filename, output_dir / 'test_000014.pt')\n    test_eq(filename.exists(), True)\n\n\nsource\n\n\nTrainer\n\n Trainer (model:-TModel, checkpointer:__main__.CheckPointer,\n          get_batch_func:__main__.GetBatchFunction,\n          estimate_loss_func:__main__.EstimateLossFunction[-TModel],\n          iters_trained:int=0)\n\nAbstract base class for generic types.\nA generic type is typically declared by inheriting from this class parameterized with one or more type variables. For example, a generic mapping type might be defined as::\nclass Mapping(Generic[KT, VT]): def getitem(self, key: KT) -&gt; VT: … # Etc.\nThis class can then be used as follows::\ndef lookup_name(mapping: Mapping[KT, VT], key: KT, default: VT) -&gt; VT: try: return mapping[key] except KeyError: return default\n\nsource\n\n\nOnCheckpointSavedHandler\n\n OnCheckpointSavedHandler (*args, **kwargs)\n\nBase class for protocol classes.\nProtocol classes are defined as::\nclass Proto(Protocol):\n    def meth(self) -&gt; int:\n        ...\nSuch classes are primarily used with static type checkers that recognize structural subtyping (static duck-typing), for example::\nclass C:\n    def meth(self) -&gt; int:\n        return 0\n\ndef func(x: Proto) -&gt; int:\n    return x.meth()\n\nfunc(C())  # Passes static type check\nSee PEP 544 for details. Protocol classes decorated with @typing.runtime_checkable act as simple-minded runtime protocols that check only the presence of given attributes, ignoring their type signatures. Protocol classes can be generic, they are defined as::\nclass GenProto(Protocol[T]):\n    def meth(self) -&gt; T:\n        ...\n\nsource\n\n\nOnBatchTrainedHandler\n\n OnBatchTrainedHandler (*args, **kwargs)\n\nBase class for protocol classes.\nProtocol classes are defined as::\nclass Proto(Protocol):\n    def meth(self) -&gt; int:\n        ...\nSuch classes are primarily used with static type checkers that recognize structural subtyping (static duck-typing), for example::\nclass C:\n    def meth(self) -&gt; int:\n        return 0\n\ndef func(x: Proto) -&gt; int:\n    return x.meth()\n\nfunc(C())  # Passes static type check\nSee PEP 544 for details. Protocol classes decorated with @typing.runtime_checkable act as simple-minded runtime protocols that check only the presence of given attributes, ignoring their type signatures. Protocol classes can be generic, they are defined as::\nclass GenProto(Protocol[T]):\n    def meth(self) -&gt; T:\n        ...\n\nsource\n\n\nGetBatchFunction\n\n GetBatchFunction (*args, **kwargs)\n\nBase class for protocol classes.\nProtocol classes are defined as::\nclass Proto(Protocol):\n    def meth(self) -&gt; int:\n        ...\nSuch classes are primarily used with static type checkers that recognize structural subtyping (static duck-typing), for example::\nclass C:\n    def meth(self) -&gt; int:\n        return 0\n\ndef func(x: Proto) -&gt; int:\n    return x.meth()\n\nfunc(C())  # Passes static type check\nSee PEP 544 for details. Protocol classes decorated with @typing.runtime_checkable act as simple-minded runtime protocols that check only the presence of given attributes, ignoring their type signatures. Protocol classes can be generic, they are defined as::\nclass GenProto(Protocol[T]):\n    def meth(self) -&gt; T:\n        ...\n\nsource\n\n\nEstimateLossFunction\n\n EstimateLossFunction (*args, **kwargs)\n\nBase class for protocol classes.\nProtocol classes are defined as::\nclass Proto(Protocol):\n    def meth(self) -&gt; int:\n        ...\nSuch classes are primarily used with static type checkers that recognize structural subtyping (static duck-typing), for example::\nclass C:\n    def meth(self) -&gt; int:\n        return 0\n\ndef func(x: Proto) -&gt; int:\n    return x.meth()\n\nfunc(C())  # Passes static type check\nSee PEP 544 for details. Protocol classes decorated with @typing.runtime_checkable act as simple-minded runtime protocols that check only the presence of given attributes, ignoring their type signatures. Protocol classes can be generic, they are defined as::\nclass GenProto(Protocol[T]):\n    def meth(self) -&gt; T:\n        ...\n\n# Tests for Trainer\nclass TestModule(torch.nn.Module):\n    def __init__(self):\n        super().__init__()\n        self.some_param = torch.nn.Linear(10, 1)\n\n    def forward(self, x, y):\n        return self.some_param(x), torch.randn(1, 1, requires_grad=True)\n\n\nwith tempfile.TemporaryDirectory() as tmpdirname:\n    output_dir = Path(tmpdirname)\n    checkpointer = CheckPointer(output_dir, \"test\")\n\n    test_model = TestModule()\n\n    xbs = []\n\n    def get_batch_func(split: str):\n        xb = torch.randn(1, 10)\n        xbs.append(xb)\n        yb = torch.randn(1, 1)\n\n        return xb, yb\n\n    def estimate_loss_func(model: TestModule):\n        return {\"train\": 0.123, \"val\": 0.125}\n\n    iters_trained_start = 10\n    trainer = Trainer(\n        test_model,\n        checkpointer,\n        get_batch_func,\n        estimate_loss_func,\n        iters_trained=iters_trained_start,\n    )\n\n    on_batch_trained_data = []\n    trainer.add_on_batch_trained_handler(\n        lambda iters_trained, batch: on_batch_trained_data.append(\n            (iters_trained, batch)\n        )\n    )\n\n    on_checkpoint_saved_data = []\n    trainer.add_on_checkpoint_saved_handler(\n        lambda iters_trained, checkpoint_file: on_checkpoint_saved_data.append(\n            (iters_trained, checkpoint_file)\n        )\n    )\n\n    trainer.train(\n        10,\n        torch.optim.Adam(test_model.parameters()),\n        eval_interval=5,\n        disable_progress_bar=True,\n        disable_output=True,\n    )\n    test_eq(len(on_batch_trained_data), 10)\n    test_eq(len(on_checkpoint_saved_data), 2)\n\n    for i, (iters_trained, batch) in enumerate(on_batch_trained_data):\n        test_eq(iters_trained, iters_trained_start + i + 1)\n        test_eq(batch.shape, (1, 10))\n        test_eq(batch, xbs[i])\n\n    for i, (iters_trained, checkpoint_file) in enumerate(on_checkpoint_saved_data):\n        test_eq(iters_trained, iters_trained_start + (i + 1) * 5)\n        test_eq(checkpoint_file, output_dir / f\"test_{i:06d}.pt\")",
    "crumbs": [
      "training",
      "training-utils.ipynb"
    ]
  },
  {
    "objectID": "common/text-analysis.html",
    "href": "common/text-analysis.html",
    "title": "text-analysis",
    "section": "",
    "text": "source\n\nbuild_next_token_map\n\n build_next_token_map (text:str, prefix_len:int, vocab_size:int,\n                       stoi:Dict[str,int])\n\nFor a given body of text, build a map of all prefixes of a given length to the frequencies of the next token.\n\n# Tests for build_next_token_map\ntest_text = \"abcabcc\"\ntest_prefix_len = 2\ntest_vocab_size = 3\ntest_stoi = {\"a\": 0, \"b\": 1, \"c\": 2}\ntest_next_token_map = build_next_token_map(\n    test_text, test_prefix_len, test_vocab_size, test_stoi\n)\ntest_eq(len(test_next_token_map), 4)\ntest_eq(test_next_token_map[\"ab\"], torch.tensor([0, 0, 2]))\ntest_eq(test_next_token_map[\"bc\"], torch.tensor([1, 0, 1]))\ntest_eq(test_next_token_map[\"ca\"], torch.tensor([0, 1, 0]))\n\n# The last substring should be in the map with all zeros\ntest_eq(test_next_token_map[\"cc\"], torch.tensor([0, 0, 0]))\n\n# Test the case where the last substring is already in the map.\ntest_next_token_map = build_next_token_map(\n    \"abcabc\", test_prefix_len, test_vocab_size, test_stoi\n)\ntest_eq(test_next_token_map[\"bc\"], torch.tensor([1, 0, 0]))\n\n# Test that accessing a non-existent prefix raises a KeyError\nwith ExceptionExpected(ex=KeyError):\n    test_next_token_map[\"zz\"]\n\n\nsource\n\n\ntop_nonzero_tokens\n\n top_nonzero_tokens (freqs:torch.Tensor, itos:Dict[int,str])\n\n\n# Tests for top_nonzero_tokens\nitos = {0: 'a', 1: 'b', 2: 'c', 3: 'd'}\n\n# All zeros\nfreqs = torch.tensor([0, 0, 0, 0])\ntest_eq(top_nonzero_tokens(freqs, itos), [])\n\n# All non-zeros\nfreqs = torch.tensor([1, 2, 3, 4])\ntest_eq(top_nonzero_tokens(freqs, itos), [('d', 4), ('c', 3), ('b', 2), ('a', 1)])\n\n# Some zeros\nfreqs = torch.tensor([0, 2, 0, 4])\ntest_eq(top_nonzero_tokens(freqs, itos), [('d', 4), ('b', 2)])\n\n\nsource\n\n\nSubstringFrequencyAnalysis\n\n SubstringFrequencyAnalysis (substrs:Sequence[str],\n                             next_token_map:Dict[str,torch.Tensor],\n                             itos:Dict[int,str])\n\nClass that performs frequency analysis on a body of text for a set of substrings.\n\n# Tests for SubstringFrequencyAnalysis\nitos = {0: 'a', 1: 'b', 2: 'c', 3: 'd'}\nstoi = {v: k for k, v in itos.items()}\ntext = 'aaabbbcccddd'\nsubstrs = ['aaa', 'bbb', 'ccc', 'ddd']\n\nnext_token_map = build_next_token_map(text, len(substrs[0]), len(itos), stoi)\nsfa = SubstringFrequencyAnalysis(\n    substrs=substrs, next_token_map=next_token_map, itos=itos\n)\ntest_eq(sfa.freq_map['aaa'].tolist(), [0, 1, 0, 0])\ntest_eq(sfa.freq_map['bbb'].tolist(), [0, 0, 1, 0])\ntest_eq(sfa.freq_map['ccc'].tolist(), [0, 0, 0, 1])\ntest_eq(sfa.freq_map['ddd'].tolist(), [0, 0, 0, 0])\n\ntest_close(sfa.norm_cumulative_freqs.tolist(), [0, 1/3, 1/3, 1/3])\n\ntest_eq(sfa.top_tokens['aaa'], [('b', 1)])\ntest_eq(sfa.top_tokens['bbb'], [('c', 1)])\ntest_eq(sfa.top_tokens['ccc'], [('d', 1)])",
    "crumbs": [
      "common",
      "text-analysis"
    ]
  },
  {
    "objectID": "common/utils.html",
    "href": "common/utils.html",
    "title": "utils",
    "section": "",
    "text": "source\n\naggregate_by_string_key\n\n aggregate_by_string_key (items:Iterable[~T], key:Callable[[~T],str])\n\nAggregates an iterable of items into a dictionary, where the key is the result of applying the key function to the item. If multiple items have the same key, the last item is used.\n\n# Tests for aggregate_by_string_key\nitems = [('a', 1), ('b', 2), ('a', 3)]\ntest_eq(aggregate_by_string_key(items, lambda x: x[0]), {'a': ('a', 3), 'b': ('b', 2)})\n\n\nsource\n\n\nDataWrapper\n\n DataWrapper (data:Sequence[~T], format_item_fn:Callable[[~T],str]=&lt;built-\n              in function repr&gt;)\n\nAbstract base class for generic types.\nA generic type is typically declared by inheriting from this class parameterized with one or more type variables. For example, a generic mapping type might be defined as::\nclass Mapping(Generic[KT, VT]): def getitem(self, key: KT) -&gt; VT: … # Etc.\nThis class can then be used as follows::\ndef lookup_name(mapping: Mapping[KT, VT], key: KT, default: VT) -&gt; VT: try: return mapping[key] except KeyError: return default\n\n# Tests for DataWrapper\ndw = DataWrapper([1, 2, 3], format_item_fn=lambda x: f\"{x}!\")\ntest_eq(str(dw), '1!, 2!, 3!')\n\n/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/fastcore/docscrape.py:225: UserWarning: Unknown section Parameters:\n  else: warn(msg)\n/opt/hostedtoolcache/Python/3.9.18/x64/lib/python3.9/site-packages/fastcore/docscrape.py:225: UserWarning: Unknown section Returns:\n  else: warn(msg)\n\nsource\n\n\ntopk_across_batches\n\n topk_across_batches (n_batches:int, k:int, largest:bool,\n                      load_batch:Callable[[int],torch.Tensor],\n                      process_batch:Callable[[torch.Tensor],torch.Tensor])\n\nLike torch.topk, but works across multiple batches of data. Always works over the batch dimension, which is assumed to be the first dimension of each batch.\n\n# Tests for topk_across_batches()\n\nbatches = [\n    [100, 98, 96, 94, 92],\n    [99, 97, 95, 93, 91],\n]\n\n# Test with largest=True\nvalues, indices = topk_across_batches(\n    n_batches=len(batches),\n    k=4,\n    largest=True,\n    load_batch=lambda i: torch.tensor(batches[i]),\n    process_batch=lambda batch: batch,\n)\ntest_eq(values, torch.tensor([100, 99, 98, 97]))\ntest_eq(indices, torch.tensor([0, 5, 1, 6]))\n\n# Test with largest=False\nvalues, indices = topk_across_batches(\n    n_batches=len(batches),\n    k=4,\n    largest=False,\n    load_batch=lambda i: torch.tensor(batches[i]),\n    process_batch=lambda batch: batch,\n)\ntest_eq(values, torch.tensor([91, 92, 93, 94]))\ntest_eq(indices, torch.tensor([9, 4, 8, 3]))\n\n# Test where the last batch is smaller than the others\nbatches = [\n    [100, 98, 96, 94, 92],\n    [99, 97, 95, 93, 91],\n    [90, 88, 86, 84],\n]\nvalues, indices = topk_across_batches(\n    n_batches=len(batches),\n    k=4,\n    largest=False,\n    load_batch=lambda i: torch.tensor(batches[i]),\n    process_batch=lambda batch: batch,\n)\ntest_eq(values, torch.tensor([84, 86, 88, 90]))\ntest_eq(indices, torch.tensor([13, 12, 11, 10]))\n\n# Test where the all the batches are different sizes.\nbatches = [\n    [100, 98, 96, 120, 160],\n    [94, 92, 130, 140],\n    [99, 97, 95, 93, 91, 109, 110],\n    [90, 101, 104, 108],\n]\nvalues, indices = topk_across_batches(\n    n_batches=len(batches),\n    k=4,\n    largest=False,\n    load_batch=lambda i: torch.tensor(batches[i]),\n    process_batch=lambda batch: batch,\n)\ntest_eq(values, torch.tensor([90, 91, 92, 93]))\ntest_eq(indices, torch.tensor([16, 13, 6, 12]))\n\n# Test where the results are 2-D tensors\nbatches = [\n    [\n        [100, 98, 96, 94, 92],\n        [99, 97, 95, 93, 91],\n        [90, 88, 86, 84, 82],\n    ],\n    [\n        [200, 198, 196, 194, 192],\n        [199, 197, 195, 193, 191],\n        [190, 188, 186, 184, 182],\n    ],\n    [\n        [300, 298, 296, 294, 292],\n        [299, 297, 295, 293, 291],\n    ],\n]\nvalues, indices = topk_across_batches(\n    n_batches=len(batches),\n    k=2,\n    largest=False,\n    load_batch=lambda i: torch.tensor(batches[i]),\n    process_batch=lambda batch: batch,\n)\n# fmt: off\ntest_eq(values, torch.tensor([\n    [90, 88, 86, 84, 82],\n    [99, 97, 95, 93, 91],\n]))\ntest_eq(indices, torch.tensor([\n    [2, 2, 2, 2, 2],\n    [1, 1, 1, 1, 1]\n]))\n# fmt: on\n\n# A more interesting 2-D example\n# fmt: off\nbatches = [\n    [                          # Overall index:\n        [14,  8,  1, 13, 13],  # 0\n        [18, 13, 11,  1, 10],  # 1\n        [ 8, 16, 15, 10, 14]   # 2\n    ],\n    [\n        [12, 14, 19,  3,  1],  # 3\n        [ 1, 15, 16,  3,  0],  # 4\n        [ 7, 18,  5,  0,  6]   # 5\n    ],\n    [\n        [10,  7, 16,  9,  0],  # 6\n        [ 0, 12,  1,  9,  3],  # 7\n        [14, 18, 14,  1,  8]   # 8\n    ]\n]\n# fmt: on\nvalues, indices = topk_across_batches(\n    n_batches=len(batches),\n    k=2,\n    largest=False,\n    load_batch=lambda i: torch.tensor(batches[i]),\n    process_batch=lambda batch: batch,\n)\n# fmt: off\ntest_eq(values, torch.tensor([\n    [0, 7, 1, 0, 0],\n    [1, 8, 1, 1, 0],\n]))\n# fmt: on\n\n# The indices picked for duplicates are apparently not stable\n# across platforms. So we can't just test for equality with a\n# known indices result. Instead let's check:\n# - that the shape of the values and indices tensors are the same\n# - that the values at the given indices are the same as what was\n#   returned in the values array.\ntest_eq(indices.shape, values.shape)\n\n# Cat the batches into one big tensor so we can index into it.\nall_data = torch.cat([torch.tensor(b) for b in batches])\n\n# Test that the values at the indices are the same as the returned values\ntest_eq(torch.gather(all_data, dim=0, index=indices), values)\n\n# A 3-D example: 2 batches of shape (3, 3, 2)\n# fmt: off\nbatches = [\n    [\n        [\n            [15, 19],\n            [19,  8],\n            [10, 12]\n        ],\n        [\n            [17,  0],\n            [ 3, 15],\n            [ 5, 15]\n        ],\n        [\n            [19, 10],\n            [ 7, 17],\n            [ 8,  0]\n        ]\n    ],\n    [\n        [\n            [ 9, 15],\n            [13, 11],\n            [ 8, 15]\n        ],\n        [\n            [ 5,  0],\n            [ 3,  6],\n            [10, 15]\n        ],\n        [\n            [ 6, 19],\n            [11, 15],\n            [ 2,  5]\n        ]\n    ]\n]\n# fmt: on\nvalues, indices = topk_across_batches(\n    n_batches=len(batches),\n    k=2,\n    largest=False,\n    load_batch=lambda i: torch.tensor(batches[i]),\n    process_batch=lambda batch: batch,\n)\n# fmt: off\ntest_eq(values, torch.tensor([\n    [\n        [ 5,  0],\n        [ 3,  6],\n        [ 2,  0]\n    ],\n    [\n        [ 6,  0],\n        [ 3,  8],\n        [ 5,  5]\n    ]\n]))\n# fmt: on\n\n# Same issue as above re: duplicates\ntest_eq(indices.shape, values.shape)\n\n# Cat the batches into one big tensor so we can index into it.\nall_data = torch.cat([torch.tensor(b) for b in batches])\n\n# Test that the values at the indices are the same as the returned values\ntest_eq(torch.gather(all_data, dim=0, index=indices), values)\n\n# Test with processing function\nbatches = [\n    [100, 98, 96, 94, 92],\n    [99, 97, 95, 93, 91],\n    [90, 88, 86, 84],\n]\nvalues, indices = topk_across_batches(\n    n_batches=len(batches),\n    k=4,\n    largest=False,\n    load_batch=lambda i: torch.tensor(batches[i]),\n    process_batch=lambda batch: 2 * batch,\n)\ntest_eq(values, torch.tensor([168, 172, 176, 180]))\ntest_eq(indices, torch.tensor([13, 12, 11, 10]))\n\n# Test that processing function can't change size of batch\nbatches = [\n    [100, 98, 96, 94, 92],\n    [99, 97, 95, 93, 91],\n    [90, 88, 86, 84],\n]\nwith ExceptionExpected(ex=AssertionError):\n    values, indices = topk_across_batches(\n        n_batches=len(batches),\n        k=4,\n        largest=False,\n        load_batch=lambda i: torch.tensor(batches[i]),\n        process_batch=lambda batch: batch[:3],\n    )\n\n# Test that batch can't be smaller than k\nbatches = [\n    [100, 98],\n    [99, 97, 95, 93, 91],\n    [90, 88, 86, 84],\n]\nwith ExceptionExpected(ex=AssertionError):\n    values, indices = topk_across_batches(\n        n_batches=len(batches),\n        k=4,\n        largest=False,\n        load_batch=lambda i: torch.tensor(batches[i]),\n        process_batch=lambda batch: batch[:3],\n    )",
    "crumbs": [
      "common",
      "utils"
    ]
  },
  {
    "objectID": "common/substring-generator.html",
    "href": "common/substring-generator.html",
    "title": "substring-generator",
    "section": "",
    "text": "source\n\nSubstringGenerator\n\n SubstringGenerator (text:str, substring_length:int)\n\nIterable that produces all possible substrings of a given length from a given text.\n\n# Tests for SubstringGenerator\n\n# Substring length longer than text\nwith ExceptionExpected(ValueError):\n    SubstringGenerator(\"abc\", 4)\n\n# Invalid substring length\nwith ExceptionExpected(ValueError):\n    SubstringGenerator(\"abc\", 0)\n\nwith ExceptionExpected(ValueError):\n    SubstringGenerator(\"abc\", -1)\n\n# Valid substring length\nsg = SubstringGenerator(\"abcd\", 2)\ntest_eq(len(sg), 3)\ntest_eq(list(sg), [\"ab\", \"bc\", \"cd\"])\n\n\nsource\n\n\nall_unique_substrings\n\n all_unique_substrings (text:str, substring_length:int)\n\nReturns all unique substrings of a given length from a given text. Substrings are returned in the order of first occurrence in the text.\n\n# Tests for all_unique_substrings\n\n# No duplicates\ntest_eq(all_unique_substrings(\"abc\", 2), [\"ab\", \"bc\"])\n\n# Duplicates are removed and appear in order of first occurrence\ntest_eq(all_unique_substrings(\"abcab\", 2), [\"ab\", \"bc\", \"ca\"])",
    "crumbs": [
      "common",
      "substring-generator"
    ]
  },
  {
    "objectID": "analyses/approximation_details.html",
    "href": "analyses/approximation_details.html",
    "title": "Approximation Interpretation",
    "section": "",
    "text": "Let’s instantiate the model, grab the 20,000 strings we used to analyze the quality of the approximation, run them all through the model, and grab the feed-forward network outputs at each layer.\n\nenvironment = get_environment()\nprint(f\"environment is {environment.name}\")\n\nenvironment is local_mac\n\n\n\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\nm, tokenizer = create_model_and_tokenizer(\n    saved_model_filename=environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt',\n    dataset=ts,\n    device=device,\n)\n_, val_data = split_text_dataset(ts.text, tokenizer, train_pct=0.9, device=device)\nencoding_helpers = EncodingHelpers(tokenizer, device)\naccessors = TransformerAccessors(m, device)\n\n\n# Get all the unique substrings of length 10 from the text\nstrings10 = all_unique_substrings(text=ts.text, substring_length=10)\n\n\nn_prompts = 20000\n\ntorch.manual_seed(1337)\nindices = torch.randperm(len(strings10))[:n_prompts]\nprompts = [strings10[i.item()] for i in indices]\nprompts[:5]\n\n['is dreams,', 'by present', 's eyes may', 'eart of ho', ' man, as I']\n\n\n\n# Tokenize the strings\ntokens = encoding_helpers.tokenize_strings(prompts)\n\n# Embed the tokens\naccessors = TransformerAccessors(m, device)\nembeddings = accessors.embed_tokens(tokens)\n\n# Run them through the model with hooks attached that let us look at\n# intermediate values\n_, io_accessors = accessors.run_model(embeddings)\n\n\n# Grab the outputs of the ffwd networks at each layer\nffwd_outs = torch.stack([\n    io_accessors[block_idx].output('ffwd')[:, -1, :].clone()\n    for block_idx in range(n_layer)\n])\n\nffwd_outs.shape\n\ntorch.Size([6, 20000, 384])\n\n\n\n# Free up some memory\ndel io_accessors\n_ = gc.collect()\n\nNow let’s set ourselves up to find similar strings based on the pre-filtered cosine similarities.\n\nprefiltered_threshold=0.7\nprefiltered_results_folder = environment.data_root / 'cosine_sim_results/large_files/slen10' / f'prefiltered_{prefiltered_threshold}'\n\ndef prefiltered_filename(block_idx: int, q_idx: int) -&gt; Path:\n    return prefiltered_results_folder / f'cosine_sim_ffwd_out_{q_idx:05d}_{block_idx:02d}.pt'\n\ndef load_prefiltered_data(block_idx: int, q_idx: int):\n    return torch.load(prefiltered_filename(block_idx, q_idx))\n\n\nsimilarity_thresholds=[0.95, 0.94, 0.85, 0.76, 0.81, 0.89]\n\nLastly, let’s define some basic building blocks we’ll need.\n\nnext_token_map10 = build_next_token_map(\n    text=ts.text,\n    prefix_len=10,\n    vocab_size=tokenizer.vocab_size,\n    stoi=tokenizer.stoi\n)\n\n\ndef hellinger_distance(\n    p: torch.Tensor,\n    q: torch.Tensor,\n):\n    return ((p.sqrt() - q.sqrt())**2).sum(dim=-1).sqrt() / math.sqrt(2)\n\n\ndef plot_prob_distribution_for_tokens(\n    prob_distribution: torch.Tensor,\n    title: str = \"\",\n    ax: Optional[Axes] = None,\n    figsize=(12, 4),\n):\n    if ax is None:\n        _, ax = plt.subplots(figsize=figsize)\n\n    x_indices = np.arange(tokenizer.vocab_size)\n    x_labels = [repr(c)[1:-1] for c in tokenizer.chars]\n\n    ax.bar(x_indices, prob_distribution)\n    ax.set_xticks(x_indices, x_labels, rotation=\"vertical\")\n    ax.set_title(title)\n    ax.set_ylim(0.0, 1.0)\n\n    return ax",
    "crumbs": [
      "analyses",
      "Approximation Interpretation"
    ]
  },
  {
    "objectID": "analyses/approximation_details.html#preliminaries",
    "href": "analyses/approximation_details.html#preliminaries",
    "title": "Approximation Interpretation",
    "section": "",
    "text": "Let’s instantiate the model, grab the 20,000 strings we used to analyze the quality of the approximation, run them all through the model, and grab the feed-forward network outputs at each layer.\n\nenvironment = get_environment()\nprint(f\"environment is {environment.name}\")\n\nenvironment is local_mac\n\n\n\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\nm, tokenizer = create_model_and_tokenizer(\n    saved_model_filename=environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt',\n    dataset=ts,\n    device=device,\n)\n_, val_data = split_text_dataset(ts.text, tokenizer, train_pct=0.9, device=device)\nencoding_helpers = EncodingHelpers(tokenizer, device)\naccessors = TransformerAccessors(m, device)\n\n\n# Get all the unique substrings of length 10 from the text\nstrings10 = all_unique_substrings(text=ts.text, substring_length=10)\n\n\nn_prompts = 20000\n\ntorch.manual_seed(1337)\nindices = torch.randperm(len(strings10))[:n_prompts]\nprompts = [strings10[i.item()] for i in indices]\nprompts[:5]\n\n['is dreams,', 'by present', 's eyes may', 'eart of ho', ' man, as I']\n\n\n\n# Tokenize the strings\ntokens = encoding_helpers.tokenize_strings(prompts)\n\n# Embed the tokens\naccessors = TransformerAccessors(m, device)\nembeddings = accessors.embed_tokens(tokens)\n\n# Run them through the model with hooks attached that let us look at\n# intermediate values\n_, io_accessors = accessors.run_model(embeddings)\n\n\n# Grab the outputs of the ffwd networks at each layer\nffwd_outs = torch.stack([\n    io_accessors[block_idx].output('ffwd')[:, -1, :].clone()\n    for block_idx in range(n_layer)\n])\n\nffwd_outs.shape\n\ntorch.Size([6, 20000, 384])\n\n\n\n# Free up some memory\ndel io_accessors\n_ = gc.collect()\n\nNow let’s set ourselves up to find similar strings based on the pre-filtered cosine similarities.\n\nprefiltered_threshold=0.7\nprefiltered_results_folder = environment.data_root / 'cosine_sim_results/large_files/slen10' / f'prefiltered_{prefiltered_threshold}'\n\ndef prefiltered_filename(block_idx: int, q_idx: int) -&gt; Path:\n    return prefiltered_results_folder / f'cosine_sim_ffwd_out_{q_idx:05d}_{block_idx:02d}.pt'\n\ndef load_prefiltered_data(block_idx: int, q_idx: int):\n    return torch.load(prefiltered_filename(block_idx, q_idx))\n\n\nsimilarity_thresholds=[0.95, 0.94, 0.85, 0.76, 0.81, 0.89]\n\nLastly, let’s define some basic building blocks we’ll need.\n\nnext_token_map10 = build_next_token_map(\n    text=ts.text,\n    prefix_len=10,\n    vocab_size=tokenizer.vocab_size,\n    stoi=tokenizer.stoi\n)\n\n\ndef hellinger_distance(\n    p: torch.Tensor,\n    q: torch.Tensor,\n):\n    return ((p.sqrt() - q.sqrt())**2).sum(dim=-1).sqrt() / math.sqrt(2)\n\n\ndef plot_prob_distribution_for_tokens(\n    prob_distribution: torch.Tensor,\n    title: str = \"\",\n    ax: Optional[Axes] = None,\n    figsize=(12, 4),\n):\n    if ax is None:\n        _, ax = plt.subplots(figsize=figsize)\n\n    x_indices = np.arange(tokenizer.vocab_size)\n    x_labels = [repr(c)[1:-1] for c in tokenizer.chars]\n\n    ax.bar(x_indices, prob_distribution)\n    ax.set_xticks(x_indices, x_labels, rotation=\"vertical\")\n    ax.set_title(title)\n    ax.set_ylim(0.0, 1.0)\n\n    return ax",
    "crumbs": [
      "analyses",
      "Approximation Interpretation"
    ]
  },
  {
    "objectID": "analyses/approximation_details.html#hypothesis",
    "href": "analyses/approximation_details.html#hypothesis",
    "title": "Approximation Interpretation",
    "section": "Hypothesis",
    "text": "Hypothesis\nLet’s think about the transformer model from the end and go backwards. At the end of the sequence of blocks, the model has computed some value in embedding space. It then sends this through a final layer norm and then a final linear layer, which produces a value in logit space. The softmax operation at the very end transforms the logits into probabilities, one for each token.\nMy hypothesis of what’s going on is:\n\nThere’s a subspace of the whole embedding space that corresponds to each token being predicted.\nThe value computed by the feed forward network provides an “adjustment” to the input embedding that orients it towards the subspaces that correspond to the next token probabilities defined by the similar strings.",
    "crumbs": [
      "analyses",
      "Approximation Interpretation"
    ]
  },
  {
    "objectID": "analyses/approximation_details.html#approximating-token-subspaces",
    "href": "analyses/approximation_details.html#approximating-token-subspaces",
    "title": "Approximation Interpretation",
    "section": "Approximating Token Subspaces",
    "text": "Approximating Token Subspaces\n\ndef create_token_subspace_projection_matrices(\n    subspace_dims: int,\n    load_token_embeddings: Callable[[str], torch.Tensor],\n    all_tokens: Sequence[str],\n) -&gt; torch.Tensor:\n    \"\"\"Returns a tensor of projection matrices that project onto\n    the `subspace_dims`-dimensional space that approximates the\n    subspace for each token. Returned tensor is of shape\n    (vocab_size, n_embed, n_embed).\"\"\"\n\n    return torch.stack([\n        projection_matrix_for_rank_k_approximation(\n            original_matrix=load_token_embeddings(token),\n            k=subspace_dims,\n        )\n        for token in all_tokens\n    ])\n\n\ndef topk_similar_projections(\n    token_subspace_projection_matrices: torch.Tensor,\n    embedding: torch.Tensor,\n    k: int,\n    all_tokens: Sequence[str],\n) -&gt; Sequence[Tuple[str, float]]:\n    \"\"\"Projects `embedding` onto the subspaces for each token and then\n    calculates the cosine similarity between the projected vector and\n    `embedding`. Determines the top `k` most similar, and returns a\n    sequence of tuples of the form (token, cosine_similarity).\"\"\"\n\n    assert token_subspace_projection_matrices.ndim == 3\n    assert token_subspace_projection_matrices.shape[1] == token_subspace_projection_matrices.shape[2]\n    assert token_subspace_projection_matrices.shape[1] == embedding.shape[0]\n\n    projections = token_subspace_projection_matrices @ embedding\n\n    values, indices = torch.topk(\n        F.cosine_similarity(projections, embedding, dim=-1),\n        k=k,\n        dim=0,\n    )\n    tokens = [all_tokens[i.item()] for i in indices]\n    return list(zip(tokens, values.tolist()))",
    "crumbs": [
      "analyses",
      "Approximation Interpretation"
    ]
  },
  {
    "objectID": "analyses/approximation_details.html#demonstrating-the-hypothesis",
    "href": "analyses/approximation_details.html#demonstrating-the-hypothesis",
    "title": "Approximation Interpretation",
    "section": "Demonstrating the Hypothesis",
    "text": "Demonstrating the Hypothesis\n\nSetup\n\nlearned_embeddings_dir = environment.data_root / 'learned_embeddings'\nassert learned_embeddings_dir.exists(), \"Learned embeddings directory doesn't exist. Run the code in experiments/learn-embeddings.ipynb to learn embeddings.\"\n\n\nfilename_for_token = FilenameForToken(tokenizer)\n\n\ndef perform_approximation(block_idx: int, q_idx: int) -&gt; torch.Tensor:\n    # Find similar strings\n    similar_indices = filter_on_prefiltered_results(\n        load_prefiltered=lambda q_idx: load_prefiltered_data(block_idx, q_idx),\n        q_idx_start=q_idx,\n        q_idx_end=q_idx+1,\n        filter_fn=lambda values: values &gt; similarity_thresholds[block_idx]\n    )\n    similar_strings = [\n        [strings10[i] for i in indices]\n        for indices in similar_indices\n    ]\n\n    # Compute Probability Distribution from Similar Strings\n    total_freq_distribution = torch.stack(\n        [next_token_map10[string] for string in similar_strings[0]]\n    ).sum(dim=0)\n    prob_distribution = total_freq_distribution / total_freq_distribution.sum()\n\n    return prob_distribution, len(similar_strings[0])\n\n\ndef perform_approximation_and_plot(block_idx: int, q_idx: int):\n    prob_distribution, n_strings = perform_approximation(block_idx, q_idx)\n\n    print(f\"Found {n_strings} similar strings.\")\n\n    # Plot the probability distribution\n    plot_prob_distribution_for_tokens(\n        prob_distribution,\n        title=f\"Probability Distribution from Approximation (block_idx={block_idx}, q_idx={q_idx}, prompt={repr(prompts[q_idx])})\",\n    )\n\n\n\nExamples for the Final Output Head: Output Embedding –&gt; Logits (No Blocks)\n\nno_blocks_proj_matrices = create_token_subspace_projection_matrices(\n    subspace_dims=1,\n    load_token_embeddings=lambda token: torch.load(\n        learned_embeddings_dir /  'no_blocks' / f\"{filename_for_token(token)}.pt\",\n        map_location=device,\n    )[:, 0, :],\n    all_tokens=tokenizer.chars\n)\nno_blocks_proj_matrices.shape\n\ntorch.Size([65, 384, 384])\n\n\n\nblock_idx = 5\nq_idx = 33\nperform_approximation_and_plot(block_idx, q_idx)\n\nFound 3 similar strings.\n\n\n\n\n\n\n\n\n\n\ntopk_similar_projections(no_blocks_proj_matrices, ffwd_outs[block_idx, q_idx, :], k=5, all_tokens=tokenizer.chars)\n\n[('o', 0.5074884295463562),\n ('h', 0.40787822008132935),\n ('i', 0.26926180720329285),\n ('u', 0.22823508083820343),\n ('y', 0.20325089991092682)]\n\n\n\nblock_idx = 5\nq_idx = 36\nperform_approximation_and_plot(block_idx, q_idx)\n\nFound 823 similar strings.\n\n\n\n\n\n\n\n\n\n\ntopk_similar_projections(no_blocks_proj_matrices, ffwd_outs[block_idx, q_idx, :], k=5, all_tokens=tokenizer.chars)\n\n[(' ', 0.5869003534317017),\n ('s', 0.47689366340637207),\n ('\\n', 0.38412901759147644),\n ('$', 0.23048195242881775),\n ('a', 0.21783535182476044)]\n\n\n\n\nExamples with One Block: Block 5 –&gt; Logits\n\nblock_5_proj_matrices = create_token_subspace_projection_matrices(\n    subspace_dims=1,\n    load_token_embeddings=lambda token: torch.load(\n        learned_embeddings_dir /  'block_5' / f\"{filename_for_token(token)}.pt\",\n        map_location=device,\n    )[:, 0, :],\n    all_tokens=tokenizer.chars\n)\nblock_5_proj_matrices.shape\n\ntorch.Size([65, 384, 384])\n\n\n\nblock_idx = 4\nq_idx = 22\nperform_approximation_and_plot(block_idx, q_idx)\n\nFound 3 similar strings.\n\n\n\n\n\n\n\n\n\n\ntopk_similar_projections(block_5_proj_matrices, ffwd_outs[block_idx, q_idx, :], k=5, all_tokens=tokenizer.chars)\n\n[('e', 0.39072519540786743),\n ('t', 0.22815877199172974),\n ('w', 0.16565938293933868),\n ('O', 0.16220779716968536),\n (\"'\", 0.15983152389526367)]\n\n\n\nblock_idx = 4\nq_idx = 55\nperform_approximation_and_plot(block_idx, q_idx)\n\nFound 13 similar strings.\n\n\n\n\n\n\n\n\n\n\ntopk_similar_projections(block_5_proj_matrices, ffwd_outs[block_idx, q_idx, :], k=5, all_tokens=tokenizer.chars)\n\n[('e', 0.3601665794849396),\n ('l', 0.19291123747825623),\n ('O', 0.172983318567276),\n ('r', 0.15273427963256836),\n ('V', 0.14703969657421112)]\n\n\nIt doesn’t work that well.\nWhat if we tried a higher dimensional approximation?\n\ntopk_similar_projections(\n    create_token_subspace_projection_matrices(\n        subspace_dims=3,\n        load_token_embeddings=lambda token: torch.load(\n            learned_embeddings_dir /  'block_5' / f\"{filename_for_token(token)}.pt\",\n            map_location=device,\n        )[:, 0, :],\n        all_tokens=tokenizer.chars\n    ),\n    ffwd_outs[block_idx, q_idx, :], k=5, all_tokens=tokenizer.chars\n)\n\n[('e', 0.3763144314289093),\n ('l', 0.21268059313297272),\n ('Q', 0.19100935757160187),\n ('r', 0.1881854087114334),\n ('p', 0.18020297586917877)]\n\n\nNot much changed. What if we try sampling more embeddings, like 1000, instead of 100?\n\ntopk_similar_projections(\n    create_token_subspace_projection_matrices(\n        subspace_dims=3,\n        load_token_embeddings=lambda token: torch.load(\n            learned_embeddings_dir /  'block_5_1000' / f\"{filename_for_token(token)}.pt\",\n            map_location=device,\n        )[:, 0, :],\n        all_tokens=tokenizer.chars\n    ),\n    ffwd_outs[block_idx, q_idx, :], k=5, all_tokens=tokenizer.chars\n)\n\n[('e', 0.45469194650650024),\n ('l', 0.23989447951316833),\n ('r', 0.2296566665172577),\n ('Q', 0.22248920798301697),\n ('u', 0.18954990804195404)]\n\n\nNot much changed. What if we try 5000?\n\ntopk_similar_projections(\n    create_token_subspace_projection_matrices(\n        subspace_dims=3,\n        load_token_embeddings=lambda token: torch.load(\n            learned_embeddings_dir /  'block_5_5000' / f\"{filename_for_token(token)}.pt\",\n            map_location=device,\n        )[:, 0, :],\n        all_tokens=tokenizer.chars\n    ),\n    ffwd_outs[block_idx, q_idx, :], k=5, all_tokens=tokenizer.chars\n)\n\n[('e', 0.4560593366622925),\n ('l', 0.2688257694244385),\n ('r', 0.2324495017528534),\n ('Q', 0.2060614824295044),\n ('b', 0.20078855752944946)]\n\n\n\n\nExamples with Two Blocks: Block 4 –&gt; Logits\n\nblock_4_proj_matrices = create_token_subspace_projection_matrices(\n    subspace_dims=1,\n    load_token_embeddings=lambda token: torch.load(\n        learned_embeddings_dir /  'block_4' / f\"{filename_for_token(token)}.pt\",\n        map_location=device,\n    )[:, 0, :],\n    all_tokens=tokenizer.chars\n)\nblock_4_proj_matrices.shape\n\ntorch.Size([65, 384, 384])\n\n\n\nblock_idx = 3\nq_idx = 852\nperform_approximation_and_plot(block_idx, q_idx)\n\nFound 90 similar strings.\n\n\n\n\n\n\n\n\n\n\ntopk_similar_projections(block_4_proj_matrices, ffwd_outs[block_idx, q_idx, :], k=5, all_tokens=tokenizer.chars)\n\n[('n', 0.21810972690582275),\n ('R', 0.14459426701068878),\n ('c', 0.1221529021859169),\n ('G', 0.11818694323301315),\n ('U', 0.11376696825027466)]",
    "crumbs": [
      "analyses",
      "Approximation Interpretation"
    ]
  },
  {
    "objectID": "analyses/approximation_details.html#aggregate-performance",
    "href": "analyses/approximation_details.html#aggregate-performance",
    "title": "Approximation Interpretation",
    "section": "Aggregate Performance",
    "text": "Aggregate Performance\n\nImplementation of the Metric\n\ndef get_top_approximation_tokens_and_probs(\n    block_idx: int,\n    q_idx: int,\n    prob_threshold=0.99,  # We'll include however many tokens needed to cover this much probability mass\n) -&gt; Tuple[List[str], torch.Tensor]:\n    \"\"\"Determine the tokens and their corresponding probabilities\n    that cover `prob_threshold` probability mass in the distribution\n    from the approximation based on similar strings.\"\"\"\n    distribution, _ = perform_approximation(block_idx, q_idx)\n\n    # Find the number of tokens needed to cover `prob_threshold` probability mass\n    sorted = distribution.sort(descending=True)\n    n_tokens = (\n        distribution.shape[0] - (sorted.values.cumsum(dim=0) &gt; prob_threshold).sum() + 1\n    )\n    tokens = [tokenizer.itos[i.item()] for i in sorted.indices[:n_tokens]]\n    probs = sorted.values[:n_tokens]\n    return tokens, probs\n\n\ndef get_tokens_ordered_by_most_subspaces_similarity(\n    embedding: torch.Tensor,\n    token_subspace_projection_matrices: torch.Tensor,\n) -&gt; Sequence[str]:\n    \"\"\"Return the tokens ordered by the similarity of their token subspaces\n    to the given embedding vector.\"\"\"\n    tokens, _ = zip(\n        *topk_similar_projections(\n            token_subspace_projection_matrices,\n            embedding,\n            k=tokenizer.vocab_size,\n            all_tokens=tokenizer.chars,\n        )\n    )\n    return tokens\n\n\ndef get_data_for_all_queries(\n    block_idx: int,\n    n_prompts: int,\n    ffwd_outs: torch.Tensor,\n    token_subspace_projection_matrices: torch.Tensor,\n) -&gt; Tuple[List[List[str]], List[torch.Tensor], List[List[str]]]:\n    approx_tokens = []\n    approx_probs = []\n    subspace_tokens = []\n    for q_idx in tqdm(range(n_prompts)):\n        tokens, probs = get_top_approximation_tokens_and_probs(block_idx, q_idx)\n        approx_tokens.append(tokens)\n        approx_probs.append(probs)\n\n        subspace_tokens.append(\n            get_tokens_ordered_by_most_subspaces_similarity(\n                ffwd_outs[block_idx, q_idx, :],\n                token_subspace_projection_matrices,\n            )\n        )\n\n    return approx_tokens, approx_probs, subspace_tokens\n\n\ndef n_entries_needed_to_cover_mass_threshold(\n    sorted_probs: torch.Tensor,\n    prob_threshold: float,\n) -&gt; torch.Tensor:\n    \"\"\"Given a tensor of probabilities sorted in descending order, return\n    the number of entries needed to cover `prob_threshold` probability mass.\"\"\"\n    return (\n        sorted_probs.shape[0] - (sorted_probs.cumsum(dim=0) &gt; prob_threshold).sum() + 1\n    )\n\n\ndef count_queries_satisfying_criteria(\n    approx_tokens: List[List[str]],\n    approx_probs: List[torch.Tensor],\n    subspace_tokens: List[List[str]],\n    prob_threshold: float = 0.90,\n    n_subspaces: int = tokenizer.vocab_size // 2,\n):\n    assert len(approx_tokens) == len(approx_probs) == len(subspace_tokens)\n    n_prompts = len(approx_tokens)\n\n    count = 0\n    for i in range(n_prompts):\n        # Figure out how many tokens we need to look at to get to\n        # `prob_threshold` cumulative probability.\n        n_tokens = n_entries_needed_to_cover_mass_threshold(approx_probs[i], prob_threshold)\n\n        if all(\n            [\n                approx_tokens[i][j] in subspace_tokens[i][:n_subspaces]\n                for j in range(n_tokens)\n            ]\n        ):\n            count += 1\n\n    return count\n\n\n# Dict that will hold data per block_idx\n\nper_block_data = defaultdict(lambda: {'approx_tokens': [], 'approx_probs': [], 'subspace_tokens': []})\n\n\n\nOutput Embedding –&gt; Logits (No Blocks)\n\nblock_idx = 5\nproj_matrices = no_blocks_proj_matrices\n(\n    per_block_data[block_idx][\"approx_tokens\"],\n    per_block_data[block_idx][\"approx_probs\"],\n    per_block_data[block_idx][\"subspace_tokens\"],\n) = get_data_for_all_queries(\n    block_idx=block_idx,\n    n_prompts=n_prompts,\n    ffwd_outs=ffwd_outs,\n    token_subspace_projection_matrices=proj_matrices,\n)\n\n\n\n\n\nblock_idx = 5\nprob_threshold = 0.90\ncount = count_queries_satisfying_criteria(\n    approx_tokens=per_block_data[block_idx][\"approx_tokens\"],\n    approx_probs=per_block_data[block_idx][\"approx_probs\"],\n    subspace_tokens=per_block_data[block_idx][\"subspace_tokens\"],\n    prob_threshold=0.90,\n    n_subspaces=tokenizer.vocab_size // 2,\n)\nprint(f\"{count:&gt;5} ({count / n_prompts:.2%}) queries had {prob_threshold:.0%} of the predicted probability mass or top {top_n} tokens in the list of top token subspaces.\")\n\n16357 (81.78%) queries had 90% of the predicted probability mass or top 65 tokens in the list of top token subspaces.\n\n\n\n\nBlock 5 –&gt; Logits (1 Block)\n\nblock_idx = 4\nproj_matrices = block_5_proj_matrices\n(\n    per_block_data[block_idx][\"approx_tokens\"],\n    per_block_data[block_idx][\"approx_probs\"],\n    per_block_data[block_idx][\"subspace_tokens\"],\n) = get_data_for_all_queries(\n    block_idx=block_idx,\n    n_prompts=n_prompts,\n    ffwd_outs=ffwd_outs,\n    token_subspace_projection_matrices=proj_matrices,\n)\n\n\n\n\n\nblock_idx = 4\nprob_threshold = 0.90\ncount = count_queries_satisfying_criteria(\n    approx_tokens=per_block_data[block_idx][\"approx_tokens\"],\n    approx_probs=per_block_data[block_idx][\"approx_probs\"],\n    subspace_tokens=per_block_data[block_idx][\"subspace_tokens\"],\n    prob_threshold=0.90,\n    n_subspaces=tokenizer.vocab_size // 2,\n)\nprint(f\"{count:&gt;5} ({count / n_prompts:.2%}) queries had {prob_threshold:.0%} of the predicted probability mass or top {top_n} tokens in the list of top token subspaces.\")\n\n10142 (50.71%) queries had 90% of the predicted probability mass or top 65 tokens in the list of top token subspaces.\n\n\n\n\nBlock 4 –&gt; Logits (2 Block)\n\nblock_idx = 3\nproj_matrices = block_4_proj_matrices\n(\n    per_block_data[block_idx][\"approx_tokens\"],\n    per_block_data[block_idx][\"approx_probs\"],\n    per_block_data[block_idx][\"subspace_tokens\"],\n) = get_data_for_all_queries(\n    block_idx=block_idx,\n    n_prompts=n_prompts,\n    ffwd_outs=ffwd_outs,\n    token_subspace_projection_matrices=proj_matrices,\n)\n\n\n\n\n\nblock_idx = 3\nprob_threshold = 0.90\ncount = count_queries_satisfying_criteria(\n    approx_tokens=per_block_data[block_idx][\"approx_tokens\"],\n    approx_probs=per_block_data[block_idx][\"approx_probs\"],\n    subspace_tokens=per_block_data[block_idx][\"subspace_tokens\"],\n    prob_threshold=0.90,\n    n_subspaces=tokenizer.vocab_size // 2,\n)\nprint(f\"{count:&gt;5} ({count / n_prompts:.2%}) queries had {prob_threshold:.0%} of the predicted probability mass or top {top_n} tokens in the list of top token subspaces.\")\n\n 7760 (38.80%) queries had 90% of the predicted probability mass or top 65 tokens in the list of top token subspaces.\n\n\n\n# How many tokens were considered for each query?\nn_tokens = torch.stack([\n    torch.tensor(\n        [\n            n_entries_needed_to_cover_mass_threshold(\n                per_block_data[block_idx][\"approx_probs\"][i], prob_threshold\n            )\n            for i in range(n_prompts)\n        ],\n        dtype=torch.float32,\n    )\n    for block_idx in [5, 4, 3]\n])\n\n\nn_tokens.shape, n_tokens.mean(dim=-1), n_tokens.std(dim=-1), n_tokens.max(dim=-1).values, n_tokens.min(dim=-1).values\n\n(torch.Size([3, 20000]),\n tensor([4.6268, 5.0133, 5.0152]),\n tensor([4.9515, 5.3788, 4.9571]),\n tensor([28., 28., 28.]),\n tensor([1., 1., 1.]))\n\n\n\n\nWhat If We Always Use the Final Projection Matrices?\n\nalt_per_block_data = defaultdict(lambda: {'approx_tokens': [], 'approx_probs': [], 'subspace_tokens': []})\n\n\n# The data for block 5 is the same\nblock_idx = 5\nalt_per_block_data[block_idx] = per_block_data[block_idx]\n\n\nblock_idx = 4\nproj_matrices = no_blocks_proj_matrices # This is actually the post block 5 projection matrices\n(\n    alt_per_block_data[block_idx][\"approx_tokens\"],\n    alt_per_block_data[block_idx][\"approx_probs\"],\n    alt_per_block_data[block_idx][\"subspace_tokens\"],\n) = get_data_for_all_queries(\n    block_idx=block_idx,\n    n_prompts=n_prompts,\n    ffwd_outs=ffwd_outs,\n    token_subspace_projection_matrices=proj_matrices,\n)\n\n\n\n\n\nblock_idx = 4\nprob_threshold = 0.90\ncount = count_queries_satisfying_criteria(\n    approx_tokens=alt_per_block_data[block_idx][\"approx_tokens\"],\n    approx_probs=alt_per_block_data[block_idx][\"approx_probs\"],\n    subspace_tokens=alt_per_block_data[block_idx][\"subspace_tokens\"],\n    prob_threshold=0.90,\n    n_subspaces=tokenizer.vocab_size // 2,\n)\nprint(f\"{count:&gt;5} ({count / n_prompts:.2%}) queries had {prob_threshold:.0%} of the predicted probability mass or top {top_n} tokens in the list of top token subspaces.\")\n\n13652 (68.26%) queries had 90% of the predicted probability mass or top 65 tokens in the list of top token subspaces.\n\n\n\nblock_idx = 3\nproj_matrices = no_blocks_proj_matrices # This is actually the post block 5 projection matrices\n(\n    alt_per_block_data[block_idx][\"approx_tokens\"],\n    alt_per_block_data[block_idx][\"approx_probs\"],\n    alt_per_block_data[block_idx][\"subspace_tokens\"],\n) = get_data_for_all_queries(\n    block_idx=block_idx,\n    n_prompts=n_prompts,\n    ffwd_outs=ffwd_outs,\n    token_subspace_projection_matrices=proj_matrices,\n)\n\n\n\n\n\nblock_idx = 3\nprob_threshold = 0.90\ncount = count_queries_satisfying_criteria(\n    approx_tokens=alt_per_block_data[block_idx][\"approx_tokens\"],\n    approx_probs=alt_per_block_data[block_idx][\"approx_probs\"],\n    subspace_tokens=alt_per_block_data[block_idx][\"subspace_tokens\"],\n    prob_threshold=0.90,\n    n_subspaces=tokenizer.vocab_size // 2,\n)\nprint(f\"{count:&gt;5} ({count / n_prompts:.2%}) queries had {prob_threshold:.0%} of the predicted probability mass or top {top_n} tokens in the list of top token subspaces.\")\n\n11630 (58.15%) queries had 90% of the predicted probability mass or top 65 tokens in the list of top token subspaces.\n\n\n\nblock_idx = 2\nproj_matrices = no_blocks_proj_matrices # This is actually the post block 5 projection matrices\n(\n    alt_per_block_data[block_idx][\"approx_tokens\"],\n    alt_per_block_data[block_idx][\"approx_probs\"],\n    alt_per_block_data[block_idx][\"subspace_tokens\"],\n) = get_data_for_all_queries(\n    block_idx=block_idx,\n    n_prompts=n_prompts,\n    ffwd_outs=ffwd_outs,\n    token_subspace_projection_matrices=proj_matrices,\n)\n\n\n\n\n\nblock_idx = 2\nprob_threshold = 0.90\ncount = count_queries_satisfying_criteria(\n    approx_tokens=alt_per_block_data[block_idx][\"approx_tokens\"],\n    approx_probs=alt_per_block_data[block_idx][\"approx_probs\"],\n    subspace_tokens=alt_per_block_data[block_idx][\"subspace_tokens\"],\n    prob_threshold=0.90,\n    n_subspaces=tokenizer.vocab_size // 2,\n)\nprint(f\"{count:&gt;5} ({count / n_prompts:.2%}) queries had {prob_threshold:.0%} of the predicted probability mass or top {top_n} tokens in the list of top token subspaces.\")\n\n11469 (57.34%) queries had 90% of the predicted probability mass or top 65 tokens in the list of top token subspaces.\n\n\n\nblock_idx = 1\nproj_matrices = no_blocks_proj_matrices # This is actually the post block 5 projection matrices\n(\n    alt_per_block_data[block_idx][\"approx_tokens\"],\n    alt_per_block_data[block_idx][\"approx_probs\"],\n    alt_per_block_data[block_idx][\"subspace_tokens\"],\n) = get_data_for_all_queries(\n    block_idx=block_idx,\n    n_prompts=n_prompts,\n    ffwd_outs=ffwd_outs,\n    token_subspace_projection_matrices=proj_matrices,\n)\n\n\n\n\n\nblock_idx = 1\nprob_threshold = 0.90\ncount = count_queries_satisfying_criteria(\n    approx_tokens=alt_per_block_data[block_idx][\"approx_tokens\"],\n    approx_probs=alt_per_block_data[block_idx][\"approx_probs\"],\n    subspace_tokens=alt_per_block_data[block_idx][\"subspace_tokens\"],\n    prob_threshold=0.90,\n    n_subspaces=tokenizer.vocab_size // 2,\n)\nprint(f\"{count:&gt;5} ({count / n_prompts:.2%}) queries had {prob_threshold:.0%} of the predicted probability mass or top {top_n} tokens in the list of top token subspaces.\")\n\n10404 (52.02%) queries had 90% of the predicted probability mass or top 65 tokens in the list of top token subspaces.\n\n\n\nblock_idx = 0\nproj_matrices = no_blocks_proj_matrices # This is actually the post block 5 projection matrices\n(\n    alt_per_block_data[block_idx][\"approx_tokens\"],\n    alt_per_block_data[block_idx][\"approx_probs\"],\n    alt_per_block_data[block_idx][\"subspace_tokens\"],\n) = get_data_for_all_queries(\n    block_idx=block_idx,\n    n_prompts=n_prompts,\n    ffwd_outs=ffwd_outs,\n    token_subspace_projection_matrices=proj_matrices,\n)\n\n\n\n\n\nblock_idx = 0\nprob_threshold = 0.90\ncount = count_queries_satisfying_criteria(\n    approx_tokens=alt_per_block_data[block_idx][\"approx_tokens\"],\n    approx_probs=alt_per_block_data[block_idx][\"approx_probs\"],\n    subspace_tokens=alt_per_block_data[block_idx][\"subspace_tokens\"],\n    prob_threshold=0.90,\n    n_subspaces=tokenizer.vocab_size // 2,\n)\nprint(f\"{count:&gt;5} ({count / n_prompts:.2%}) queries had {prob_threshold:.0%} of the predicted probability mass or top {top_n} tokens in the list of top token subspaces.\")\n\n 9942 (49.71%) queries had 90% of the predicted probability mass or top 65 tokens in the list of top token subspaces.\n\n\n\n# How many tokens were considered for each query?\nn_tokens = torch.stack([\n    torch.tensor(\n        [\n            n_entries_needed_to_cover_mass_threshold(\n                alt_per_block_data[block_idx][\"approx_probs\"][i], prob_threshold\n            )\n            for i in range(n_prompts)\n        ],\n        dtype=torch.float32,\n    )\n    for block_idx in range(n_layer)\n])\n\n\nn_tokens.shape, n_tokens.mean(dim=-1), n_tokens.std(dim=-1), n_tokens.max(dim=-1).values, n_tokens.min(dim=-1).values\n\n(torch.Size([6, 20000]),\n tensor([5.3407, 5.2765, 5.0173, 5.0152, 5.0133, 4.6268]),\n tensor([4.9333, 4.9405, 4.8050, 4.9571, 5.3788, 4.9515]),\n tensor([27., 27., 26., 28., 28., 28.]),\n tensor([1., 1., 1., 1., 1., 1.]))\n\n\n\n\nIs This Better Than Chance?\nTo help understand whether or not the results above are meaningful, it’s worth thinking about how easy it would be to satisfy our criteria by random chance. What if the similarities between the feed-forward network output and the token spaces were totally random, rather than related to the similar strings predictions. What percentage of the queries would still satisfy our criteria?\nSpecifically, for a given query and a feed-forward output, what is the probability that n specific tokens are in the top n_subspaces entries of a randomly generated similarities tensor?\nIf we can assume that each of the similarity values is independent and that they are distributed uniformly, then the probability that n tokens all appear in the top n_subspaces entries when ordered by value is simply:\n\\[\n\\frac{1}{\\lfloor \\frac{vocab\\_size}{n\\_subspaces} \\rfloor^{n}}\n\\]\nIn the real data, the similarity values are probably not totally independent (because some subspaces may be closer together than others). But for the purposes of this exercise, I’m going to treat them as independent.\nBut they are also definitely not uniformly distributed. By definition, cosine similarity can range between -1 and 1, but ours don’t seem to seem to be uniform in that range. A random example:\n\nblock_idx = 5\nq_idx = 33\nsims = F.cosine_similarity(no_blocks_proj_matrices @ ffwd_outs[block_idx, q_idx, :], ffwd_outs[block_idx, q_idx, :], dim=-1)\nsns.kdeplot(sims.cpu().numpy())\n_ = plt.axvline(sims.median().item(), color='red')\n\n\n\n\n\n\n\n\nWe don’t have an accurate mathematical description of the distribution of the real data so we can’t say how the probability would precisely deviate from the formula above. But thankfully, we can estimate it empirically, via simulation. We can generate fake similarities with a similar distribution to the real data and then measure how often n selected tokens appear in the top n_subspaces entries over many iteratons.\nFirst, let’s define a helper to generate the similarities for all prompts for a given block:\n\ndef compute_all_similarities_to_subspace_projections(\n    block_idx: int,\n    ffwd_outs: torch.Tensor,\n    token_subspace_projection_matrices: torch.Tensor,\n):\n    \"\"\"Returns a tensor of shape (n_prompts, vocab_size). The element\n    at indices i, j is the cosine similarity between the ffwd output\n    from `block_idx` for query i and the projection of that ffwd output\n    onto the subspace for token j.\"\"\"\n    n_prompts = ffwd_outs.shape[1]\n\n    embeddings = ffwd_outs[block_idx, :, :]\n    all_sims = torch.stack(\n        [\n            F.cosine_similarity(\n                token_subspace_projection_matrices @ embeddings[q_idx, :],\n                embeddings[q_idx, :],\n                dim=-1,\n            )\n            for q_idx in tqdm(range(n_prompts))\n        ]\n    )\n    return all_sims\n\nNow we run it on the block 5 data:\n\nblock_idx = 5\nproj_matrices = no_blocks_proj_matrices\nblock_5_sims = compute_all_similarities_to_subspace_projections(\n    block_idx=block_idx,\n    ffwd_outs=ffwd_outs,\n    token_subspace_projection_matrices=proj_matrices,\n)\nblock_5_sims.shape\n\n\n\n\ntorch.Size([20000, 65])\n\n\nLet’s look at the distribution across all the similarities (the previous plot just looked at one query):\n\n_ = sns.kdeplot(block_5_sims.flatten(), label=\"real sims\")\n\n\n\n\n\n\n\n\nNext, we need something to generate random numbers with the same distribution. The helper below returns a function that samples from the KDE of the original data:\n\ndef create_fake_sims_generator(\n    reference_sims: torch.Tensor,\n) -&gt; Callable[[int], torch.Tensor]:\n    \"\"\"Returns a function that will generate fake similarities\n    with roughly the same distribution as reference_sims.\"\"\"\n    kde = gaussian_kde(reference_sims)\n    def fake_sims_generator(n: int):\n        return torch.from_numpy(kde.resample(n).squeeze()).to(reference_sims.dtype)\n    return fake_sims_generator\n\nIt produces fake data with the right distribution:\n\n# Show that the fake sims generator produces sims with roughly the same distribution\n# as the real sims.\nfake_sims_generator = create_fake_sims_generator(block_5_sims.flatten())\n\nnp.random.seed(123412) # Keep outputs stable\nfake_sims = fake_sims_generator(block_5_sims.numel())\n\n\nsns.kdeplot(block_5_sims.flatten(), label=\"real sims\")\nsns.kdeplot(fake_sims, label=\"fake sims\")\n_ = plt.legend()\n\n\n\n\n\n\n\n\nNow we’ll define functions that perform the actual simulation:\n\ndef run_simulation(\n    top_n: int,\n    n_subspaces: int,\n    reference_sims: torch.Tensor,\n    iterations: int,\n) -&gt; int:\n    # Generate `top_n` random token idxs to stand in for the\n    # top_n tokens predicted by the similar strings approximation.\n    token_idxs = torch.randperm(tokenizer.vocab_size)[:top_n]\n\n    fake_sims_generator = create_fake_sims_generator(reference_sims)\n\n    count = 0\n    for i in range(iterations):\n        # Generate fake similarities, to stand in for the real\n        # similarities between the ffwd outputs and the token subspaces.\n        fake_sims = fake_sims_generator(tokenizer.vocab_size)\n\n        # Sort the fake similarities. The sorted indices are the token indexes\n        # for the \"most similar\" tokens.\n        sorted = fake_sims.sort(descending=True)\n\n        # The criteria is satisfied if all token_idxs appear in the first `n_subspaces`\n        # elements of the sorted indices (standing in for the token ids for the most\n        # similar subspaces).\n        if all([token_idx in sorted.indices[:n_subspaces] for token_idx in token_idxs]):\n            count += 1\n\n    return count\n\n\ndef run_multi_simulations(\n    top_ns: Iterable[int],\n    iteration_sizes: Iterable[int],\n    n_subspaces: int,\n    reference_sims: torch.Tensor,\n):\n    \"\"\"Returns a dict of the form {top_n: {iteration_size: count}}.\"\"\"\n    results = defaultdict(lambda: defaultdict(int))\n    for top_n in tqdm(top_ns):\n        for iteration_size in iteration_sizes:\n            results[top_n][iteration_size] = run_simulation(\n                top_n=top_n,\n                n_subspaces=n_subspaces,\n                reference_sims=reference_sims,\n                iterations=iteration_size,\n            )\n\n    # Clear all the default factories\n    results.default_factory = None\n    for v in results.values():\n        v.default_factory = None\n\n    return results\n\n\ntop_ns = [1, 2, 3, 4, 5]\niteration_sizes = range(100, 1000, 25)\nn_subspaces=tokenizer.vocab_size // 2\nresults_block_5 = run_multi_simulations(\n    top_ns=top_ns,\n    iteration_sizes=iteration_sizes,\n    n_subspaces=n_subspaces,\n    reference_sims=block_5_sims.flatten(),\n)\n\n\n\n\n\ndef plot_results(\n    top_ns: Iterable[int],\n    iteration_sizes: Iterable[int],\n    results: Dict[int, Dict[int, int]],\n    title: str = \"\",\n):\n    fig, ax = plt.subplots(figsize=(12, 8))\n    for top_n in top_ns:\n        ax.plot(\n            iteration_sizes,\n            [results[top_n][iteration_size] / iteration_size for iteration_size in iteration_sizes],\n            label=f\"top_n = {top_n}\",\n        )\n        line_label = f\"1 / {tokenizer.vocab_size // n_subspaces}^{top_n}\"\n        expected = 1 / ((tokenizer.vocab_size // n_subspaces) ** top_n)\n        ax.hlines(\n            y=expected,\n            xmin=iteration_sizes[0],\n            xmax=iteration_sizes[-1],\n            colors=\"grey\",\n            linestyles=\"dashed\",\n        )\n        ax.text(\n            iteration_sizes[-1] + 10,\n            expected,\n            line_label,\n            verticalalignment=\"center\",\n        )\n\n    ax.set_xlabel(\"Iterations\")\n    ax.set_ylabel(\"Fraction Satisfying Criteria\")\n    ax.set_ylim(0.0, 1.0)\n    ax.set_title(title)\n    ax.legend()\n    return ax\n\n\n_ = plot_results(\n    top_ns=top_ns,\n    iteration_sizes=iteration_sizes,\n    results=results_block_5,\n    title=f\"Results with Random Similarities (Block {block_idx} Distribution, n_subspaces={n_subspaces})\",\n)\n\n\n\n\n\n\n\n\nNow let’s run it for other blocks:\n\nblock_idx = 4\nproj_matrices = block_5_proj_matrices\nblock_4_sims = compute_all_similarities_to_subspace_projections(\n    block_idx=block_idx,\n    ffwd_outs=ffwd_outs,\n    token_subspace_projection_matrices=proj_matrices,\n)\nblock_4_sims.shape\n\n\n\n\ntorch.Size([20000, 65])\n\n\n\ntop_ns = [1, 2, 3, 4, 5]\niteration_sizes = range(100, 1000, 25)\nn_subspaces=tokenizer.vocab_size // 2\nresults_block_4 = run_multi_simulations(\n    top_ns=top_ns,\n    iteration_sizes=iteration_sizes,\n    n_subspaces=n_subspaces,\n    reference_sims=block_4_sims.flatten(),\n)\n\n\n\n\n\n_ = plot_results(\n    top_ns=top_ns,\n    iteration_sizes=iteration_sizes,\n    results=results_block_4,\n    title=f\"Results with Random Similarities (Block {block_idx} Distribution, n_subspaces={n_subspaces})\",\n)\n\n\n\n\n\n\n\n\n\nblock_idx = 3\nproj_matrices = block_4_proj_matrices\nblock_3_sims = compute_all_similarities_to_subspace_projections(\n    block_idx=block_idx,\n    ffwd_outs=ffwd_outs,\n    token_subspace_projection_matrices=proj_matrices,\n)\nblock_3_sims.shape\n\n\n\n\ntorch.Size([20000, 65])\n\n\n\ntop_ns = [1, 2, 3, 4, 5]\niteration_sizes = range(100, 1000, 25)\nn_subspaces=tokenizer.vocab_size // 2\nresults_block_3 = run_multi_simulations(\n    top_ns=top_ns,\n    iteration_sizes=iteration_sizes,\n    n_subspaces=n_subspaces,\n    reference_sims=block_3_sims.flatten(),\n)\n\n\n\n\n\n_ = plot_results(\n    top_ns=top_ns,\n    iteration_sizes=iteration_sizes,\n    results=results_block_3,\n    title=f\"Results with Random Similarities (Block {block_idx} Distribution, n_subspaces={n_subspaces})\",\n)\n\n\n\n\n\n\n\n\nAcross all 3 blocks, the results appear quite consistent and close to 1 / ((tokenizer.vocab_size // n_subspaces) ** top_n). So for the following top_n values, these are roughly the chances of satisfying our criteria:\n\n\n\ntop_n\nProbability from Formula\nSimulated Probability\n\n\n\n\n1\n50%\n50.04% ± 1.78%\n\n\n2\n25%\n24.18% ± 1.19%\n\n\n3\n12.5%\n10.92% ± 0.73%\n\n\n4\n6.25%\n5.14% ± 0.70%\n\n\n5\n3.12%\n2.51% ± 0.43%\n\n\n\nThis gives us a sense of the chance of a single query satisfying the criteria given a specific number of tokens considered. But in our calculations of aggregate performance above, each query considered a different number of tokens based on how many were needed to hit the 90% probability mass. So now lets go through and for each block, use the actual number of tokens considered for each query along with the probabilities above to simulate several runs and see what the aggregate results would be.\nFirst, we need to compute reference similarities for all blocks:\n\nproj_matrices = no_blocks_proj_matrices\n\nreference_sims = [\n    compute_all_similarities_to_subspace_projections(\n        block_idx=block_idx,\n        ffwd_outs=ffwd_outs,\n        token_subspace_projection_matrices=proj_matrices,\n    )\n    for block_idx in range(n_layer)\n]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNext, we have to run the simulation with top_n ranging over the full range of potential numbers of tokens we would need to consider (previously we only considered 5):\n\ntop_ns = range(1, 29) # Data in prev section shows that 28 is the max tokens that were used\niterations = 1000\niteration_sizes = [iterations] # Don't need to vary the iteration sizes\nn_subspaces=tokenizer.vocab_size // 2\n\nnp.random.seed(123412) # Keep outputs stable\ntorch.manual_seed(123412) # Keep outputs stable\n\nper_block_sim_results = [\n    run_multi_simulations(\n        top_ns=top_ns,\n        iteration_sizes=iteration_sizes,\n        n_subspaces=n_subspaces,\n        reference_sims=reference_sims[block_idx].flatten(),\n    )\n    for block_idx in range(n_layer)\n]\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nNow we’ll define a function that runs another simulation. In this one, we’ll do the following:\n\nGo through each prompt, and figured out how many tokens were needed to cover 90% probability mass\nBased on the simulation above, look up what the probability is that that number of tokens would satisfy the criteria by chance.\nFor the specified number of iterations:\n\nInitialize a count with 0\nFor each prompt\n\nGenerate a boolean that is true with that probability\nAdd 1 to the count if the boolean is true\n\n\nReturn a tensor of the counts for all iterations, divided by the number of iterations.\n\n\ndef simulate_aggregate_results(\n    all_top_ns: Sequence[int],\n    prob_threshold: float,\n    approx_probs: List[List[float]],\n    simulation_results: Dict[int, int],\n    sim_iterations: int,\n    iterations: int,\n):\n    \"\"\"Based on the number of tokens actually matched for each query, run\n    `iterations` simulations using the probabilities of chance success\n    computed in the previous simulation. This gives an estimate of the\n    expected percentage of queries that will satisfy the criteria if\n    it was all chance.\"\"\"\n\n    # Get the probabilities from the earlier simulation results\n    probs = torch.zeros(len(all_top_ns), dtype=torch.float32)\n    for n in all_top_ns:\n        probs[n-1] = simulation_results[n] / float(sim_iterations)\n\n    # Get the number of tokens needed to cover `prob_threshold` probability mass\n    # using the same criteria as the main evaluation.\n\n    n_tokens = [\n        n_entries_needed_to_cover_mass_threshold(\n            approx_probs[i],\n            prob_threshold,\n        )\n        for i in range(n_prompts)\n    ]\n\n    # Create a tensor to hold the counts for each iteration\n    counts = torch.zeros(iterations, dtype=torch.float32)\n\n    for it in tqdm(range(iterations)):\n        count = 0\n        for i in range(n_prompts):\n            n = n_tokens[i] # How many tokens used for this prompt\n            target_probs = probs[n-1] # What's the probability of a chance right answer with this many tokens\n            if torch.rand(1) &lt; target_probs:\n                count += 1\n        counts[it] = count\n\n    return counts / n_prompts\n\n\n# Reshape the simulation results to get rid of the iteration size dimension\nper_block_sim_results_reshaped = [\n    {\n        top_n: count\n        for top_n, results in per_block_sim_results[block_idx].items()\n        for count in results.values()\n    }\n    for block_idx in range(n_layer)\n]\n\n\ntorch.manual_seed(1442)\nagg_sim_results = torch.stack([\n    simulate_aggregate_results(\n        all_top_ns=top_ns,\n        prob_threshold=0.90,\n        approx_probs=alt_per_block_data[block_idx][\"approx_probs\"],\n        simulation_results=per_block_sim_results_reshaped[block_idx],\n        sim_iterations=iterations,\n        iterations=1000,\n    )\n    for block_idx in range(n_layer)\n])\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n# Pretty print results\nfor block_idx in range(n_layer):\n    data = agg_sim_results[block_idx]\n    print(f\"Block {block_idx}: {data.mean().item():.2%} ± {data.std().item():.2%}\")\n\nBlock 0: 16.31% ± 0.23%\nBlock 1: 17.04% ± 0.23%\nBlock 2: 18.20% ± 0.24%\nBlock 3: 18.37% ± 0.24%\nBlock 4: 20.55% ± 0.26%\nBlock 5: 20.76% ± 0.25%",
    "crumbs": [
      "analyses",
      "Approximation Interpretation"
    ]
  },
  {
    "objectID": "analyses/cosine_sim_intermediates.html",
    "href": "analyses/cosine_sim_intermediates.html",
    "title": "Investigation of Cosine Similarity of Block Intermediates",
    "section": "",
    "text": "environment = get_environment()\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\nm, tokenizer = create_model_and_tokenizer(\n    saved_model_filename=environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt',\n    dataset=ts,\n    device=device,\n)\n_, val_data = split_text_dataset(ts.text, tokenizer, train_pct=0.9, device=device)\nencoding_helpers = EncodingHelpers(tokenizer, device)\naccessors = TransformerAccessors(m, device)\n\n\nprint(f\"environment is {environment.name}\")\nprint(f\"device is {device}\")\n\nenvironment is local_mac\ndevice is cpu\n\n\n\nif list((environment.data_root / 'block_internals_results/large_files/slen10/').glob('*')) == []:\n    print(\"Run `make block_internals_slen10_dataset` in the project root to generate the required dataset\")\n\n\nstrings10 = all_unique_substrings(ts.text, 10)\n\n\nexp10 = BatchedBlockInternalsExperiment(\n    eh=encoding_helpers,\n    accessors=accessors,\n    strings=strings10,\n    output_dir=environment.data_root / 'block_internals_results/large_files/slen10/',\n    batch_size=10000,\n)\n\nFirst, investigate whether there is a lot of variance in the norms of the block intermediates. If so, it suggests that cosine similarity may be a better measure than Euclidean distance.\n\nfor block_idx in range(n_layer):\n    proj_out_batch = torch.load(str(exp10._block_output_filename(batch_idx=0, block_idx=block_idx)), mmap=True)\n    proj_out_norms = torch.norm(proj_out_batch[:, -1, :], dim=-1)\n    print(f\"Layer {block_idx}: mean {proj_out_norms.mean()}, std {proj_out_norms.std()}\")\n\nLayer 0: mean 6.742733478546143, std 0.5781376361846924\nLayer 1: mean 9.9436674118042, std 0.732509434223175\nLayer 2: mean 13.363844871520996, std 0.8933441638946533\nLayer 3: mean 16.3056583404541, std 1.2311681509017944\nLayer 4: mean 18.925506591796875, std 2.3209304809570312\nLayer 5: mean 22.887157440185547, std 3.547220468521118\n\n\n\nfor block_idx in range(n_layer):\n    ffwd_out_batch = torch.load(str(exp10._ffwd_output_filename(batch_idx=0, block_idx=block_idx)), mmap=True)\n    ffwd_out_norms = torch.norm(ffwd_out_batch[:, -1, :], dim=-1)\n    print(f\"Layer {block_idx}: mean {ffwd_out_norms.mean()}, std {ffwd_out_norms.std()}\")\n\nLayer 0: mean 5.740758419036865, std 0.5919678211212158\nLayer 1: mean 3.5539472103118896, std 0.48989471793174744\nLayer 2: mean 4.147891044616699, std 0.5498831868171692\nLayer 3: mean 4.534223556518555, std 0.8501486778259277\nLayer 4: mean 5.168319225311279, std 1.311710238456726\nLayer 5: mean 7.545808792114258, std 2.7754971981048584\n\n\nOK, so for both proj_out and ffwd_out, norm goes up in the later layers and so does std dev. So, cosine similarity is probably a better measure than Euclidean distance.\n\nprompts = ['my most gr', 'is dreams,']\nprompts_exp = BlockInternalsExperiment(encoding_helpers, accessors, prompts)\n\n\nqueries = prompts_exp.proj_output(block_idx=0)[:, -1, :]\n\n\n# Mock up of what a cosine similarity function would look like\nbatch = proj_out_batch[:, -1, :]\nB, _ = batch.shape\nn_queries, _ = queries.shape\nsims = F.cosine_similarity(batch.reshape(B, 1, -1).expand(-1, n_queries, -1), queries, dim=-1)\nsims.shape\n\ntorch.Size([10000, 2])\n\n\n\nblock_idx = 0\nsims, distances = exp10.strings_with_topk_closest_proj_outputs(\n    block_idx=block_idx,\n    t_i = -1,\n    queries=prompts_exp.proj_output(block_idx=block_idx)[:, -1, :],\n    k=10,\n    largest=True,\n    distance_function=batch_cosine_sim,\n)\n\nfor idx, strings in enumerate(sims):\n    print(f\"Closest to {repr(prompts[idx])}: \")\n\n    for i, s in enumerate(strings):\n        print(f\"\\t{repr(s):&gt;14} ({distances[i][idx]:.3f})\")\n    print()\n\nClosest to 'my most gr': \n      'my most gr' (1.000)\n      'ur most gr' (0.995)\n      'is most gr' (0.995)\n      'ne most gr' (0.995)\n      'ilst my gr' (0.995)\n      'he most gr' (0.994)\n      'unto my gr' (0.994)\n      'e, most gr' (0.994)\n      't, most gr' (0.994)\n      'yman to gr' (0.993)\n\nClosest to 'is dreams,': \n      'is dreams,' (1.000)\n      'ly dreams,' (0.995)\n      'en dreams,' (0.994)\n      'he dreams,' (0.994)\n      'ur dreams,' (0.994)\n      'nd dreams,' (0.993)\n      'ery beams,' (0.992)\n      'of dreams,' (0.991)\n      \"n's beams,\" (0.990)\n      'hese arms,' (0.989)\n\n\n\n\nblock_idx = 0\nsims, distances = exp10.strings_with_topk_closest_ffwd_outputs(\n    block_idx=block_idx,\n    t_i = -1,\n    queries=prompts_exp.proj_output(block_idx=block_idx)[:, -1, :],\n    k=10,\n    largest=True,\n    distance_function=batch_cosine_sim,\n)\nfor idx, strings in enumerate(sims):\n    print(f\"Closest to {repr(prompts[idx])}: \")\n\n    for i, s in enumerate(strings):\n        print(f\"\\t{repr(s):&gt;14} ({distances[i][idx]:.3f})\")\n    print()\n\nClosest to 'my most gr': \n      'at unsubst' (0.454)\n      't in subst' (0.454)\n      'ften burst' (0.454)\n      'd by subst' (0.454)\n      'n of subst' (0.454)\n      'most burst' (0.453)\n      'it unconst' (0.453)\n      'l, inconst' (0.453)\n      'o be subst' (0.453)\n      're unconst' (0.453)\n\nClosest to 'is dreams,': \n      'Schoolmast' (0.473)\n      'schoolmast' (0.472)\n      'hath chast' (0.471)\n      'Stand fast' (0.470)\n      ' notwithst' (0.470)\n     'ng\\nfantast' (0.470)\n      'stand fast' (0.470)\n     'thou\\nhadst' (0.469)\n      'ough chast' (0.469)\n      'ch fantast' (0.469)\n\n\n\n\nblock_idx = 5\nsims, distances = exp10.strings_with_topk_closest_proj_outputs(\n    block_idx=block_idx,\n    t_i = -1,\n    queries=prompts_exp.proj_output(block_idx=block_idx)[:, -1, :],\n    k=10,\n    largest=True,\n    distance_function=batch_cosine_sim,\n)\nfor idx, strings in enumerate(sims):\n    print(f\"Closest to {repr(prompts[idx])}: \")\n\n    for i, s in enumerate(strings):\n        print(f\"\\t{repr(s):&gt;14} ({distances[i][idx]:.3f})\")\n    print()\n\nClosest to 'my most gr': \n      'my most gr' (1.000)\n      'my most st' (0.897)\n      'my most sa' (0.864)\n      ' my most r' (0.849)\n      ' my most l' (0.809)\n      'my high bl' (0.799)\n      'mt my mast' (0.799)\n      'm thy moth' (0.795)\n      'm, my mour' (0.788)\n      'my most he' (0.784)\n\nClosest to 'is dreams,': \n      'is dreams,' (1.000)\n      'is hoarse,' (0.932)\n      'ish hairs,' (0.924)\n      'ith oaths,' (0.914)\n      'is events,' (0.912)\n      'ish tears,' (0.911)\n      'ir mouths,' (0.911)\n      'ir plumes,' (0.905)\n      'is throne,' (0.899)\n      'is mother,' (0.896)\n\n\n\n\nblock_idx = 5\nsims, distances = exp10.strings_with_topk_closest_ffwd_outputs(\n    block_idx=block_idx,\n    t_i = -1,\n    queries=prompts_exp.proj_output(block_idx=block_idx)[:, -1, :],\n    k=10,\n    largest=True,\n    distance_function=batch_cosine_sim,\n)\nfor idx, strings in enumerate(sims):\n    print(f\"Closest to {repr(prompts[idx])}: \")\n\n    for i, s in enumerate(strings):\n        print(f\"\\t{repr(s):&gt;14} ({distances[i][idx]:.3f})\")\n    print()\n\nClosest to 'my most gr': \n      's fast bel' (0.347)\n      's part bel' (0.337)\n      's that bel' (0.334)\n      ' drops bel' (0.331)\n      'assage bel' (0.331)\n      'e step bel' (0.325)\n      'y best bel' (0.325)\n      'w then bel' (0.323)\n      'myself bel' (0.319)\n     'ts:\\nSometi' (0.317)\n\nClosest to 'is dreams,': \n      ' may she--' (0.402)\n      '! should--' (0.397)\n     'tantly,\\n--' (0.396)\n      ' it were--' (0.391)\n      's is she--' (0.390)\n     'LO:\\nAnd,--' (0.390)\n      \"ty in't,--\" (0.390)\n      'im--dead--' (0.390)\n      't are so--' (0.389)\n      \": here's--\" (0.389)\n\n\n\n\nblock_idx = 5\nsims, distances = exp10.strings_with_topk_closest_ffwd_outputs(\n    block_idx=block_idx,\n    t_i = 8,\n    queries=prompts_exp.proj_output(block_idx=block_idx)[:, -1, :],\n    k=10,\n    largest=True,\n    distance_function=batch_cosine_sim,\n)\nfor idx, strings in enumerate(sims):\n    print(f\"Closest to {repr(prompts[idx])}: \")\n\n    for i, s in enumerate(strings):\n        print(f\"\\t{repr(s):&gt;14} ({distances[i][idx]:.3f})\")\n    print()\n\nClosest to 'my most gr': \n       'ssage bel' (0.346)\n       ' step bel' (0.339)\n       ' fast bel' (0.337)\n      'g\\ninto so' (0.322)\n       'drops bel' (0.320)\n       'grave bel' (0.320)\n      ' it\\nTo so' (0.317)\n       ' part bel' (0.311)\n       ' best bel' (0.310)\n       'place bel' (0.307)\n\nClosest to 'is dreams,': \n       ' should--' (0.400)\n       'who has--' (0.397)\n       'may she--' (0.395)\n       ' so mad--' (0.391)\n       'derates--' (0.387)\n      'antly,\\n--' (0.386)\n       ' is she--' (0.386)\n       'no soul--' (0.384)\n       ' camest--' (0.384)\n       'f these--' (0.384)\n\n\n\nTry it for embeddings:\n\nsims, distances = exp10.strings_with_topk_closest_embeddings(\n    queries=prompts_exp.embeddings,\n    k=10,\n    largest=True,\n    distance_function=batch_cosine_sim,\n)\nfor idx, strings in enumerate(sims):\n    print(f\"Closest to {repr(prompts[idx])}: \")\n\n    for i, s in enumerate(strings):\n        print(f\"\\t{repr(s):&gt;14} ({distances[i][idx]:.3f})\")\n    print()\n\nClosest to 'my most gr': \n      'my most gr' (1.000)\n      'my most sa' (0.912)\n      't, most gr' (0.909)\n      'my most st' (0.909)\n      'my most so' (0.906)\n      'e, most gr' (0.905)\n      'my most re' (0.905)\n      'ur most gr' (0.905)\n      'my most he' (0.905)\n      'is most gr' (0.904)\n\nClosest to 'is dreams,': \n      'is dreams,' (1.000)\n      'is dream o' (0.906)\n      'ur dreams,' (0.906)\n      'of dreams,' (0.905)\n      'us dreams.' (0.904)\n      'he dreams,' (0.903)\n      'ly dreams,' (0.902)\n      'en dreams,' (0.902)\n      'nd dreams,' (0.896)\n     'as dream\\nS' (0.865)",
    "crumbs": [
      "analyses",
      "Investigation of Cosine Similarity of Block Intermediates"
    ]
  },
  {
    "objectID": "analyses/introduction.html",
    "href": "analyses/introduction.html",
    "title": "Introduction",
    "section": "",
    "text": "import numpy as np\nimport torch\n\n\n# Set a manual seed so output is deterministic (used same value as @karpathy)\n_ = torch.manual_seed(1337)\n\n\nfrom transformer_experiments.datasets.tinyshakespeare import (\n    TinyShakespeareDataSet,\n)\nfrom transformer_experiments.environments import get_environment\nfrom transformer_experiments.models.transformer import TransformerLanguageModel\nfrom transformer_experiments.models.transformer_helpers import EncodingHelpers\nfrom transformer_experiments.trained_models.tinyshakespeare_transformer import (\n    create_model_and_tokenizer\n)\n\n\nenvironment = get_environment()\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\nm, tokenizer = create_model_and_tokenizer(\n    saved_model_filename=environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt',\n    dataset=ts,\n    device=device,\n)\nencoding_helpers = EncodingHelpers(tokenizer, device)\n\n\nprint(f\"environment is {environment.name}\")\nprint(f\"device is {device}\")\n\nenvironment is local_mac\ndevice is cpu\n\n\n\n# Peek at the model size\ntrainable_params = [p for p in m.parameters() if p.requires_grad]\nnparams = sum([np.prod(p.size()) for p in trainable_params])\nnparams\n\n10788929\n\n\n\n# Helper function to generate text\n\ndef generate(m: TransformerLanguageModel, initial_text: str, max_new_tokens=100):\n    input = encoding_helpers.tokenize_string(initial_text)\n    return tokenizer.decode(m.generate(input, max_new_tokens=max_new_tokens)[0].tolist())\n\n\nprint(generate(m, 'Hello'))\n\nHellow doth my lord and myself?\n\nLUCIO:\nLeave me.\n\nDUKE VINCENTIO:\nSave you neither.\n\nProvost:\nBut I am t\n\n\n\n# Generate some longer text\nprint(generate(m, '\\n', max_new_tokens=1000))\n\n\nAnd that which I, infects thy seat false forth,\nThat Berkeley hath not open? through thyself to be monarch,\nAnd clubs venomourous misfortune's end:\nThe grace of Buckingham, like a feast.\n\nGLOUCESTER:\nEdward murderer, for thanks: my glory,\nSweet life and all my son's death, and Clifford's love,\nHath he touch'd the high ado a toad child,\nAnd see his precious farthen a royal stay:\nNow she is only poor house; but in evil,\n'What she spares, we'll quick Henry leave last\nBy Henry the Duke of Norfolk in leaves.'\nBut, come, O fortune, to our schoolmaster son\nFor soul men, were spented to them, or unconquest?\n\nCLARENCE:\nSweet lord, die upon the book of hell.\n\nWARWICK:\nMy soul I must deserve what deny hours\nWith my followers and turn kings, and to the queen,\nWho now deliver'd him and I siege my knees;\nIdly no reconcilence may perfect him to the regal.\n3 KING HENRY VI\n\nYORK:\nWell, Exeter, England, how would he that set us on!\n\nYORK:\nYea, have so far off; I was loathed for thee?\n\nEXETER:\nA thriving\n\n\n\nprint(generate(m, 'There once was a man from Nantucket', max_new_tokens=200))\n\nThere once was a man from Nantuckets,\nAnd rich'd it with so ppresent for you\nTo commit it.\n\nAUFIDIUS:\nI pray thee, I have not a soul\nNow that our country, nor being grieved, nor no;\nBut one of our body's death and with what.\n\nCORIOLANU",
    "crumbs": [
      "analyses",
      "Introduction"
    ]
  },
  {
    "objectID": "analyses/similar_strings_deep_dive.html",
    "href": "analyses/similar_strings_deep_dive.html",
    "title": "Deep Dive into Similar Strings Progress through the Model",
    "section": "",
    "text": "environment = get_environment()\ndevice = 'cuda' if torch.cuda.is_available() else 'cpu'\nts = TinyShakespeareDataSet(cache_file=environment.code_root / 'nbs/artifacts/input.txt')\nm, tokenizer = create_model_and_tokenizer(\n    saved_model_filename=environment.code_root / 'nbs/artifacts/shakespeare-20231112.pt',\n    dataset=ts,\n    device=device,\n)\n_, val_data = split_text_dataset(ts.text, tokenizer, train_pct=0.9, device=device)\nencoding_helpers = EncodingHelpers(tokenizer, device)\naccessors = TransformerAccessors(m, device)\n\n\nprint(f\"environment is {environment.name}\")\nprint(f\"device is {device}\")\n\nenvironment is local_mac\ndevice is cpu\n\n\n\nif list((environment.data_root / 'block_internals_results/large_files/slen10/').glob('*')) == []:\n    print(\"Run `make block_internals_slen10_dataset` in the project root to generate the required dataset\")\n\n\nstrings10 = all_unique_substrings(ts.text, 10)\n\n\nexp10 = BatchedBlockInternalsExperiment(\n    eh=encoding_helpers,\n    accessors=accessors,\n    strings=strings10,\n    output_dir=environment.data_root / 'block_internals_results/large_files/slen10/',\n    batch_size=10000,\n)\n\n\nprompt1 = 'my most gr'\nprompt2 = 'ur most gr'\n\nbia1 = BlockInternalsAccessors(prompt1, encoding_helpers, accessors)\nbia2 = BlockInternalsAccessors(prompt2, encoding_helpers, accessors)\n\nLet’s look at how the proj outputs for these diverge across the model:\n\nfor block_idx in range(n_layer):\n    proj_out1 = bia1.proj_output(block_idx)[0, -1, :]\n    proj_out2 = bia2.proj_output(block_idx)[0, -1, :]\n\n    print(f\"Block {block_idx}: distance {torch.norm(proj_out1-proj_out2):.3f}, cosine sim {F.cosine_similarity(proj_out1, proj_out2, dim=-1):.3f}\")\n\nBlock 0: distance 0.792, cosine sim 0.995\nBlock 1: distance 0.949, cosine sim 0.997\nBlock 2: distance 2.432, cosine sim 0.968\nBlock 3: distance 3.950, cosine sim 0.932\nBlock 4: distance 6.427, cosine sim 0.780\nBlock 5: distance 5.856, cosine sim 0.740\n\n\nThey get further apart and less cosine similar.\nAnd same for ffwd output:\n\nfor block_idx in range(n_layer):\n    ffwd_out1 = bia1.ffwd_output(block_idx)[0, -1, :]\n    ffwd_out2 = bia2.ffwd_output(block_idx)[0, -1, :]\n\n    print(f\"Block {block_idx}: distance {torch.norm(ffwd_out1-ffwd_out2):.3f}, cosine sim {F.cosine_similarity(ffwd_out1, ffwd_out2, dim=-1):.3f}\")\n\nBlock 0: distance 0.140, cosine sim 1.000\nBlock 1: distance 0.443, cosine sim 0.999\nBlock 2: distance 0.746, cosine sim 0.997\nBlock 3: distance 1.767, cosine sim 0.991\nBlock 4: distance 2.762, cosine sim 0.985\nBlock 5: distance 3.446, cosine sim 0.995\n\n\nThey do get further apart but cosine similarity stays very close to 1.\nWhat does the model predict for these?\n\n# What are the predicted outputs for these two:\ntokens1 = encoding_helpers.tokenize_string(prompt1)\nlogits1, _ = m(tokens1)\nlogits1 = LogitsWrapper(logits1.detach(), tokenizer)\n\ntokens2 = encoding_helpers.tokenize_string(prompt2)\nlogits2, _ = m(tokens2)\nlogits2 = LogitsWrapper(logits2.detach(), tokenizer)\n\nlogits1.topk_tokens(k=10)[0][-1], logits2.topk_tokens(k=10)[0][-1]\n\n([('a', 0.4602494537830353),\n  ('e', 0.35252559185028076),\n  ('o', 0.09188850224018097),\n  ('i', 0.09030349552631378),\n  ('u', 0.004192721098661423),\n  ('y', 0.0007521358784288168),\n  ('r', 6.647213740507141e-05),\n  ('l', 3.957989065384027e-06),\n  ('v', 2.812936827467638e-06),\n  ('w', 2.738903503995971e-06)],\n [('a', 0.42030981183052063),\n  ('e', 0.3680994510650635),\n  ('o', 0.10530176013708115),\n  ('i', 0.1002618744969368),\n  ('u', 0.0053354003466665745),\n  ('y', 0.0005905701545998454),\n  ('r', 6.933557597221807e-05),\n  ('l', 6.059422503312817e-06),\n  ('w', 4.522385552263586e-06),\n  ('n', 2.6605287075653905e-06)])\n\n\nThese are extremely close.\n\ntorch.norm(logits1.probs() - logits2.probs()), torch.norm(logits1.logits - logits2.logits)\n\n(tensor(0.7939), tensor(20.7882))\n\n\n\ndef imshow_tensor_in_chunks(\n    x: torch.Tensor,\n    n_chunks: int = 6,\n    n_embed: int = n_embed,\n    axes: Sequence[Axes] = [],\n    min: Optional[float] = None,\n    max: Optional[float] = None,\n):\n    if len(axes) == 0:\n        fig, axes = plt.subplots(n_chunks, 1, figsize=(24, 16))\n    else:\n        assert len(axes) == n_chunks\n    if x.dim() == 1:\n        x = x.unsqueeze(dim=0)\n\n    assert x.dim() == 2, 'x must be 2D'\n    N, C = x.shape\n    assert C == n_embed, f'C must be {n_embed}'\n    assert C % n_chunks == 0, 'C must be divisible by n_chunks'\n\n    # Get the min and max of the whole tensor - we'll use these to set the clim\n    # values to be the same for all images (even though each one will have its\n    # own colorbar)\n    if min is None:\n        min = x.flatten().min().item()\n    if max is None:\n        max = x.flatten().max().item()\n\n    chunk_size = C // n_chunks\n    for i in range(n_chunks):\n        im = axes[i].imshow(\n            x[:, i * chunk_size : (i + 1) * chunk_size].detach().numpy(),\n            cmap='viridis',\n            interpolation='none',\n        )\n        im.set_clim(min, max)\n        axes[i].set_xlabel('Embedding Dimension', fontsize=12)\n        axes[i].set_xticks(range(0, chunk_size, 10))\n        axes[i].set_xticklabels(range(i * chunk_size, (i + 1) * chunk_size, 10))\n        axes[i].set_ylabel('Position', fontsize=12)\n        axes[i].set_yticks(range(N))\n        plt.colorbar(im, ax=[axes[i]], location='top')\n\n\nblock_idx = 0\nproj_out1 = bia1.proj_output(block_idx=block_idx)[0, -1, :]\nproj_out2 = bia2.proj_output(block_idx=block_idx)[0, -1, :]\nx = torch.stack([\n    proj_out1,\n    proj_out2,\n    (proj_out1 - proj_out2) * 10,\n])\nimshow_tensor_in_chunks(x)\n\n\n\n\n\n\n\n\n\nblock_idx = 5\nproj_out1 = bia1.proj_output(block_idx=block_idx)[0, -1, :]\nproj_out2 = bia2.proj_output(block_idx=block_idx)[0, -1, :]\nx = torch.stack([\n    proj_out1,\n    proj_out2,\n    (proj_out1 - proj_out2) * 10,\n])\nimshow_tensor_in_chunks(x)\n\n\n\n\n\n\n\n\n\nblock_idx = 0\nffwd_out1 = bia1.ffwd_output(block_idx=block_idx)[0, -1, :]\nffwd_out2 = bia2.ffwd_output(block_idx=block_idx)[0, -1, :]\nx = torch.stack([\n    ffwd_out1,\n    ffwd_out2,\n    (ffwd_out1 - ffwd_out2) * 10,\n])\nimshow_tensor_in_chunks(x)\n\n\n\n\n\n\n\n\n\nblock_idx = 5\nffwd_out1 = bia1.ffwd_output(block_idx=block_idx)[0, -1, :]\nffwd_out2 = bia2.ffwd_output(block_idx=block_idx)[0, -1, :]\nx = torch.stack([\n    ffwd_out1,\n    ffwd_out2,\n    (ffwd_out1 - ffwd_out2) * 10,\n])\nimshow_tensor_in_chunks(x)\n\n\n\n\n\n\n\n\n\nblock_idx = 5\nemb = bia1.io_accessors[block_idx].output('.')[0, -1, :]\nzero_out_idx = n_embed - 1\nemb2 = torch.cat([emb[:zero_out_idx], torch.zeros(n_embed-zero_out_idx)])\nlogits = LogitsWrapper(accessors.logits_from_embedding(unsqueeze_emb(emb)), tokenizer)\nlogits2 = LogitsWrapper(accessors.logits_from_embedding(unsqueeze_emb(emb2)), tokenizer)\nlogits.topk_tokens(k=10)[0][-1], logits2.topk_tokens(k=10)[0][-1]\n\n([('a', 0.46024957299232483),\n  ('e', 0.35252535343170166),\n  ('o', 0.09188905358314514),\n  ('i', 0.09030317515134811),\n  ('u', 0.004192722495645285),\n  ('y', 0.0007521368097513914),\n  ('r', 6.647209374932572e-05),\n  ('l', 3.957986336899921e-06),\n  ('v', 2.8129350084782345e-06),\n  ('w', 2.7389019123802427e-06)],\n [('a', 0.4389830529689789),\n  ('e', 0.36069250106811523),\n  ('i', 0.09699754416942596),\n  ('o', 0.09658170491456985),\n  ('u', 0.005966253113001585),\n  ('y', 0.0006952937110327184),\n  ('r', 6.115536234574392e-05),\n  ('l', 3.7959973724355223e-06),\n  ('v', 3.4647534903342603e-06),\n  ('w', 2.603939492473728e-06)])",
    "crumbs": [
      "analyses",
      "Deep Dive into Similar Strings Progress through the Model"
    ]
  },
  {
    "objectID": "tokenizers/char-tokenizer.html",
    "href": "tokenizers/char-tokenizer.html",
    "title": "char-tokenizer.ipynb",
    "section": "",
    "text": "The code in this notebook (char-tokenizer.ipynb) and the resulting module (transformer_experiments.tokenizers.char_tokenizer) is not mine. It comes from Andrej Karpathy’s excellent video, Let’s build GPT: from scratch, in code, spelled out. I typed in the code by copying what I saw on the screen as I watched the video. For things that weren’t clear onscreen, I referenced the GitHub repo for the video and the nanoGPT repo. After getting it working, I made only minor changes to make it work with the rest of the code in/structure of this repository. In summary: this module is Andrej Karpathy’s work, not mine.\n\nsource\n\n\n\n CharacterTokenizer (text:str)\n\nInitialize self. See help(type(self)) for accurate signature.\n\n# Tests for CharacterTokenizer\ntokenizer = CharacterTokenizer('abcabc')\ntest_eq(tokenizer.chars, ['a', 'b', 'c'])\ntest_eq(tokenizer.vocab_size, 3)\ntest_eq(tokenizer.stoi, {'a': 0, 'b': 1, 'c': 2})\ntest_eq(tokenizer.itos, {0: 'a', 1: 'b', 2: 'c'})\ntest_eq(tokenizer.encode('cab'), [2, 0, 1])\ntest_eq(tokenizer.decode([2, 1, 0]), 'cba')",
    "crumbs": [
      "tokenizers",
      "char-tokenizer.ipynb"
    ]
  },
  {
    "objectID": "tokenizers/char-tokenizer.html#attribution",
    "href": "tokenizers/char-tokenizer.html#attribution",
    "title": "char-tokenizer.ipynb",
    "section": "",
    "text": "The code in this notebook (char-tokenizer.ipynb) and the resulting module (transformer_experiments.tokenizers.char_tokenizer) is not mine. It comes from Andrej Karpathy’s excellent video, Let’s build GPT: from scratch, in code, spelled out. I typed in the code by copying what I saw on the screen as I watched the video. For things that weren’t clear onscreen, I referenced the GitHub repo for the video and the nanoGPT repo. After getting it working, I made only minor changes to make it work with the rest of the code in/structure of this repository. In summary: this module is Andrej Karpathy’s work, not mine.\n\nsource\n\n\n\n CharacterTokenizer (text:str)\n\nInitialize self. See help(type(self)) for accurate signature.\n\n# Tests for CharacterTokenizer\ntokenizer = CharacterTokenizer('abcabc')\ntest_eq(tokenizer.chars, ['a', 'b', 'c'])\ntest_eq(tokenizer.vocab_size, 3)\ntest_eq(tokenizer.stoi, {'a': 0, 'b': 1, 'c': 2})\ntest_eq(tokenizer.itos, {0: 'a', 1: 'b', 2: 'c'})\ntest_eq(tokenizer.encode('cab'), [2, 0, 1])\ntest_eq(tokenizer.decode([2, 1, 0]), 'cba')",
    "crumbs": [
      "tokenizers",
      "char-tokenizer.ipynb"
    ]
  }
]